import{j as e,b as w,M as L,g as I,r as C,m as H}from"./gg0tb34p9fzo1omt.js";import{i as P,b as O,T as ee}from"./gffsn29yylc5pncm.js";import{c7 as te,bM as W,c$ as ae,cU as q,gZ as se,b as ne,c1 as Z,c6 as z,c5 as oe,lz as de,lA as le,lB as re,bE as ce}from"./forbprkns1cohsbl.js";import{u as ie,c as me,D as xe}from"./ejkv34dzwipa230i.js";import{cp as fe,bU as j,c5 as y,dX as k,bg as G,nn as ue,f9 as he,it as V}from"./g670b8vtkhx0yc6d.js";import{S as be}from"./dwweugcujrtabsgm.js";import{r as ge}from"./kinvcw3l5cx6b6nu.js";import{C as _,T as pe}from"./di9mvml43ysl6waf.js";import{g as je}from"./btagl6w1gub4aw61.js";import"./ihgbljwwpo1mzi43.js";import"./jy1u8exw8iz2slve.js";import"./k5ngqk6bkqja3f09.js";import"./go2lz3yja1ixfdzl.js";import"./gomrh6779xe4lvq3.js";function ye({textdocVersion:l,clientThreadId:o}){const{handleCopy:d,copyLabel:x}=ie({textdocVersion:l,clientThreadId:o}),c=!fe();return e.jsx(te,{onCopy:d,className:"py-1",iconClassName:j("icon-md",!c&&"hidden"),iconOnly:c,buttonText:c?void 0:x})}function ve({textdocVersion:l,disabled:o}){const d=w(),{handleFileDownload:x,handleBlobDownload:c,isLoading:f,downloadCopyLabel:u,isDocument:a}=me(l);return a?e.jsxs(y.Root,{open:!f&&!o?void 0:!1,children:[e.jsx(y.BasicTrigger,{className:"hover:bg-transparent focus-visible:bg-transparent",children:e.jsxs("button",{className:"flex items-center gap-1 py-1 select-none disabled:cursor-not-allowed disabled:opacity-50",disabled:f||o,children:[e.jsx("span",{className:"block sm:hidden",children:e.jsx(k,{label:u,children:e.jsx(W,{className:"icon-md"})})}),e.jsx("span",{className:"hidden sm:block",children:d.formatMessage({id:"eSxJm/",defaultMessage:"Download"})})]})}),e.jsx(y.Portal,{children:e.jsxs(y.Content,{align:"end",children:[e.jsx(y.Item,{onClick:t=>{t.preventDefault(),x("pdf")},children:d.formatMessage({id:"canvas.download-pdf-button.menu",defaultMessage:"PDF Document (.pdf)"})}),e.jsx(y.Item,{onClick:t=>{t.preventDefault(),x("docx")},children:d.formatMessage({id:"canvas.download-docx-button.menu",defaultMessage:"Microsoft Word Document (.docx)"})}),e.jsx(y.Item,{onClick:t=>{t.preventDefault(),x("md")},children:d.formatMessage({id:"canvas.download-md-button.menu",defaultMessage:"Markdown Document (.md)"})})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"block sm:hidden",children:e.jsx(k,{label:u,children:e.jsx("button",{className:"flex items-center gap-1 py-1 select-none disabled:cursor-not-allowed disabled:opacity-50",disabled:f||o,onClick:c,children:e.jsx(W,{className:"icon-md"})})})}),e.jsx("span",{className:"hidden sm:block",children:e.jsx("button",{className:"flex items-center gap-1 py-1 select-none disabled:cursor-not-allowed disabled:opacity-50",disabled:f||o,onClick:c,children:d.formatMessage({id:"eSxJm/",defaultMessage:"Download"})})})]})}function ke({onClick:l}){const o=w();return e.jsxs("button",{className:"flex items-center gap-1 py-1 select-none",onClick:l,children:[e.jsx(k,{label:e.jsx(L,{id:"EditCanvasButton.editTooltip",defaultMessage:"Edit canvas"}),children:e.jsx(ae,{className:"icon-md block sm:hidden"})}),e.jsx("span",{className:"hidden sm:block",children:o.formatMessage({id:"dd2tHH",defaultMessage:"Edit"})})]})}function Ne({onClick:l,disabled:o}){const d=w();return o?e.jsx(G,{className:"flex cursor-not-allowed items-center gap-1 py-1 opacity-50 select-none",disabled:!0,children:e.jsxs(k,{label:e.jsx(L,{id:"PreviewCanvasButton.canvasStillStreaming",defaultMessage:"Content is being generated..."}),children:[e.jsx(q,{className:"icon-md block sm:hidden"}),e.jsx("span",{className:"hidden sm:block",children:d.formatMessage({id:"Al1dzr",defaultMessage:"Run code"})})]})}):e.jsxs(G,{className:"flex items-center gap-1 py-1 select-none",onClick:l,disabled:!1,children:[e.jsx(k,{label:e.jsx(L,{id:"PreviewCanvasButton.previewTooltip",defaultMessage:"Run code"}),children:e.jsx(q,{className:"icon-md block sm:hidden"})}),e.jsx("span",{className:"hidden sm:block",children:d.formatMessage({id:"Al1dzr",defaultMessage:"Run code"})})]})}var T,J;function Me(){if(J)return T;J=1;var l=ge(),o=se(),d=ue(),x=parseFloat,c=Math.min,f=Math.random;function u(a,t,r){if(r&&typeof r!="boolean"&&o(a,t,r)&&(t=r=void 0),r===void 0&&(typeof t=="boolean"?(r=t,t=void 0):typeof a=="boolean"&&(r=a,a=void 0)),a===void 0&&t===void 0?(a=0,t=1):(a=d(a),t===void 0?(t=a,a=0):t=d(t)),a>t){var s=a;a=t,t=s}if(r||a%1||t%1){var h=f();return c(a+h*(t-a+x("1e-"+((h+"").length-1))),t)}return l(a,t)}return T=u,T}var Ce=Me();const we=I(Ce),De=({isCanvasHovered:l=!1,onClick:o})=>{const d=w();return e.jsx(k,{label:d.formatMessage({id:"KMbgyZ",defaultMessage:"Open in canvas"}),children:e.jsx(ce,{color:l?"primary":"secondary",icon:be,onClick:o})})},Be=({textdocId:l,clientThreadId:o,name:d,tag:x,icon:c,iconSelected:f,marginBottom:u,size:a="large",height:t=a==="large"?"22rem":"10rem",minHeight:r,isCanvasOpen:s=!1,isDisabled:h=!1,isFocused:b=!1,isInferring:D=!1,isInlinePreview:n=!1,isStreaming:g=!1,isUserMessage:p=!1,onClick:N,onPreview:B,children:E})=>{const S=C.useRef(null),[v,A]=C.useState(!1),[K]=C.useState(()=>we(100,180,!1)),i=he(ne(l)?.versions),m=Z(),M=!m,X=i==null||g,$=i&&i.type!==z.LOADING&&P(i.type,i.content),R=b&&s?f??c:c,Q=R?e.jsx("span",{className:j("shrink-0 transition-[filter]",{grayscale:!b&&!v}),children:R}):e.jsx("div",{className:"icon flex items-center overflow-hidden",children:e.jsx(V,{lines:1,size:"base",width:100,widthVariance:0})}),F=i?.type&&oe(i.type)?O(i.type):void 0,Y=!d||D?e.jsx("div",{className:"flex h-6 grow items-center overflow-hidden",style:{width:K},children:e.jsx(V,{lines:1,size:"base",width:100,widthVariance:0})}):e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:j("min-w-0 truncate",{"text-token-text-primary font-semibold":m}),children:d}),m&&F&&e.jsxs("span",{className:"text-token-text-tertiary font-normal",children:["Â· ",F]})]}),U=()=>{!S.current||h||(de.logButtonClick(le.MESSAGE_ATTACHMENT,{type:x}),re(S.current),N?.())};return e.jsxs(H.div,{role:M?"button":void 0,id:je(l),initial:{opacity:g?0:1,scale:g?.9:1},animate:{opacity:1,scale:1},transition:{type:"spring",bounce:0,duration:.72},className:j("popover bg-token-bg-primary dark:bg-token-bg-elevated-secondary border-token-border-default dark:border-token-border-light relative z-0 border",m?"overflow-visible":"overflow-hidden",h?"cursor-default":M?"cursor-pointer":"cursor-text",{"select-none":M,"border-token-text-tertiary font-medium dark:border-gray-600":b&&s,"font-regular":!b,"flex min-w-0 shrink grow-0 items-center justify-between self-start rounded-xl":s||!n,"rounded-[20px]":!s&&n,"max-w-full":!p&&(s||!n),"max-w-[var(--user-chat-width,70%)]":p&&(s||!n),"w-full":!p&&!s&&n,"w-[var(--user-chat-width,70%)]":p&&!s&&n,"w-full py-3 sm:-mx-6 sm:w-[calc(100%+3rem)] sm:max-w-none":n&&m}),onMouseEnter:()=>!h&&A(!0),onMouseLeave:()=>A(!1),onClick:()=>M?U():void 0,ref:S,style:{marginBottom:u,height:n&&!s?t:void 0,minHeight:n&&!s?r:void 0,width:a==="small"?"300px":void 0},children:[e.jsxs("div",{className:j("flex w-full min-w-0 items-center justify-between gap-2 self-start px-4 transition-colors duration-700",{"border-token-border-default":!v&&!b,"border-token-border-heavy":v&&!b,"text-token-text-primary text-sm font-medium":!s&&v&&n,"py-2":s||!n,"py-3":!m&&!s&&n,"text-token-text-secondary text-sm font-medium":!s&&!v&&n,"pt-0 pb-2 sm:px-6":m}),children:[e.jsxs("div",{className:j("flex min-w-0 items-center",{"gap-2":s||!n,"gap-3.5":!s&&n}),children:[!m&&Q,Y]}),s?e.jsx(H.span,{animate:g?"show":"initial",variants:{initial:{opacity:0,paddingLeft:0,width:"0"},show:{opacity:1,paddingLeft:2,width:"24px"}},transition:{type:"tween",duration:.18},children:g&&e.jsx(ee,{gap:1,padding:0})}):e.jsx(De,{isCanvasHovered:v,onClick:N})]}),m&&n&&!h?e.jsx("div",{className:"sticky top-13 z-20 @[84rem]/thread:top-2",children:e.jsx("div",{className:j("text-token-text-secondary bg-token-bg-primary dark:bg-token-bg-elevated-secondary absolute end-0 bottom-0 z-20 me-2 flex flex-row items-center justify-end gap-4 rounded-se-lg rounded-es-lg ps-3 pe-1 pt-3 pb-2 font-sans text-sm font-normal"),children:m&&!s?e.jsxs(e.Fragment,{children:[o&&e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(ye,{textdocVersion:i??null,clientThreadId:o})}),e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(ke,{onClick:N})}),i&&i.type!==z.LOADING&&e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(ve,{disabled:X,textdocVersion:i})}),$&&e.jsx("div",{className:"hover:text-token-text-primary",children:e.jsx(Ne,{disabled:g,onClick:B})})]}):null})}):null,e.jsxs("div",{className:"relative flex min-h-0 w-full flex-1 flex-col self-end",children:[!s&&E,n&&!s&&!m&&e.jsx(_,{size:a,position:"bottom"}),n&&a==="small"&&!s&&!m&&e.jsx(_,{size:a,position:"right"})]})]})},Je=({textdocId:l,clientThreadId:o,name:d,tag:x,icon:c,iconSelected:f,isCanvasOpen:u=!1,isFetching:a=!1,isFocused:t=!1,isInlinePreview:r=!1,isStreaming:s=!1,isUserMessage:h=!1,onClick:b,onPreview:D})=>{const[n,g]=C.useState(!1),p=Z(),N=E=>{g(E>0)},B=r&&!u?16:12;return e.jsx(Be,{textdocId:l,name:d,tag:x,icon:c,height:p?"auto":void 0,iconSelected:f,marginBottom:B,isCanvasOpen:u,isFocused:t,isInlinePreview:r,isStreaming:s,isUserMessage:h,onClick:b,onPreview:D,clientThreadId:o,children:r&&e.jsx("div",{className:j("relative flex min-h-0 flex-auto flex-col overflow-hidden border-t transition-colors",{"border-token-border-default":n,"border-transparent":!n}),children:a&&!(p&&s)?e.jsx(xe,{numLines:20}):!!l&&e.jsx(pe,{disableScroll:p,onScroll:N,textdocId:l,clientThreadId:o})})})};export{Je as CanvasMessageAttachment,Be as CanvasMessageAttachmentWrapper};
//# sourceMappingURL=nx5q0n9n8728lqw2.js.map
