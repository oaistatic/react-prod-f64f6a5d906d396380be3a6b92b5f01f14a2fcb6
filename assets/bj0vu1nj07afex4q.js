const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/fuvc81vmwlhx5j5l.js","assets/gg0tb34p9fzo1omt.js","assets/g670b8vtkhx0yc6d.js","assets/root-ilxovqci.css","assets/hsr6nqstg4abtqru.js","assets/k5ngqk6bkqja3f09.js","assets/forbprkns1cohsbl.js","assets/conversation-small-mtta3ozz.css","assets/je4q4vopywnye8lt.js","assets/jhjkuez66hdb5deb.js","assets/hecirjrcp1pgfsfa.js","assets/h431y4zi2z7ivdmh.js","assets/gomrh6779xe4lvq3.js","assets/b07550145r5z9uf7.js","assets/foly6q6x9dui805g.js","assets/jnwbhjiq0zuf26x3.js","assets/oqyy1xfq5y51tstr.js"])))=>i.map(i=>d[i]);
import{iT as O,s as WA,iS as IA,iV as UA,dw as wA,q4 as Se,eb as be,P as Be,d as KA,o as Me,g4 as Ie,b0 as we,e as HA,eh as xe,dT as Te,hx as zA,q5 as ye,cz as RA,h as cA,j as BA,bd as Qe,cY as Ve,be as Re,bU as dA,dX as $A,c6 as xA,cO as je,bg as De,i$ as jA,iZ as _e,bo as Ze,m as Oe,bW as Ae,q6 as Le,bV as Ye}from"./g670b8vtkhx0yc6d.js";import{r as n,g as Fe,o as Ne,h as ee,b as L,j as r,m as j,A as eA}from"./gg0tb34p9fzo1omt.js";import{hC as uA,qm as lA,qn as EA,qo as DA,qp as Ge,qq as Je,qr as qe,qs as Xe,qt as Pe,qu as We,qv as _A,qw as ZA,qx as Ue,qy as te,qz as x,qA as Ke,hB as w,ah as He,it as ze,c9 as TA,hD as $e,qB as At,hy as et,qC as mA,qD as gA,qE as tt,qF as Z,ct as ot}from"./forbprkns1cohsbl.js";import{a as nt,$ as st,C as it,_ as Q,R as at,b as F,y as rt,M as ct,c as N,W as lt,T as sA,O as oe,N as dt,I as ut,d as mt,e as gt,f as ht,Y as pt,F as ft,S as iA,h as yA,u as ne,g as MA,i as se,j as Ct,k as hA,A as QA,l as K,m as Et,s as kt,B as ie,n as vt,o as St,p as bt,G as Bt,q as Mt,v as It,r as wt,t as xt,w as OA,x as Tt,z as yt,V as Qt,D as Vt,L as Rt,E as jt,H as Dt,J as _t,K as Zt}from"./jhjkuez66hdb5deb.js";import{S as Ot}from"./jnwbhjiq0zuf26x3.js";import Lt from"./b07550145r5z9uf7.js";import{L as Yt}from"./oqyy1xfq5y51tstr.js";function Ft(){const A=uA(),e=nt(),t=n.useCallback(()=>{lA.debug("disconnected from room"),EA(A)},[A]),s=n.useCallback(c=>{e.danger("Something went wrong",{toastId:"livekit_room_error"}),lA.error("an error occurred within the room",c);const a=DA(A.getState());O.voiceMode.error({...a,error:c.message}),A.setState(i=>{i.metrics.livekitConnectSuccessTime||(i.metrics.livekitConnectFailTime=new Date)}),EA(A)},[e,A]),o=n.useCallback(c=>{e.danger("Something went wrong",{toastId:"livekit_room_error",loggingTitle:"Encryption error",loggingDescription:c.message}),lA.error("an encryption error occurred within the room",c);const a=DA(A.getState());O.voiceMode.error({encryptionError:c.message,eventSource:"voice-session",...a}),A.setState(i=>{i.metrics.livekitConnectSuccessTime||(i.metrics.livekitConnectFailTime=new Date)}),EA(A)},[e,A]);return{onDisconnected:t,onError:s,onEncryptionError:o}}function ae(A){var e,t,s="";if(typeof A=="string"||typeof A=="number")s+=A;else if(typeof A=="object")if(Array.isArray(A)){var o=A.length;for(e=0;e<o;e++)A[e]&&(t=ae(A[e]))&&(s&&(s+=" "),s+=t)}else for(t in A)A[t]&&(s&&(s+=" "),s+=t);return s}function Nt(){for(var A,e,t=0,s="",o=arguments.length;t<o;t++)(A=arguments[t])&&(e=ae(A))&&(s&&(s+=" "),s+=e);return s}function Gt(...A){return(...e)=>{for(const t of A)if(typeof t=="function")try{t(...e)}catch(s){console.error(s)}}}function re(...A){const e={...A[0]};for(let t=1;t<A.length;t++){const s=A[t];for(const o in s){const c=e[o],a=s[o];typeof c=="function"&&typeof a=="function"&&o[0]==="o"&&o[1]==="n"&&o.charCodeAt(2)>=65&&o.charCodeAt(2)<=90?e[o]=Gt(c,a):(o==="className"||o==="UNSAFE_className")&&typeof c=="string"&&typeof a=="string"?e[o]=Nt(c,a):e[o]=a!==void 0?a:c}}return e}const Jt={connect:!0,audio:!1,video:!1};function qt(A){const{token:e,serverUrl:t,options:s,room:o,connectOptions:c,connect:a,audio:i,video:l,screen:d,onConnected:u,onDisconnected:m,onError:g,onMediaDeviceFailure:h,onEncryptionError:v,simulateParticipants:f,...E}={...Jt,...A};s&&o&&Q.warn("when using a manually created room, the options object will be ignored. set the desired options directly when creating the room instead.");const[k,S]=n.useState();n.useEffect(()=>{S(o??new at(s))},[o]);const T=n.useMemo(()=>{const{className:b}=rt();return re(E,{className:b})},[E]);return n.useEffect(()=>{if(!k)return;const b=()=>{const B=k.localParticipant;Q.debug("trying to publish local tracks"),Promise.all([B.setMicrophoneEnabled(!!i,typeof i!="boolean"?i:void 0),B.setCameraEnabled(!!l,typeof l!="boolean"?l:void 0),B.setScreenShareEnabled(!!d,typeof d!="boolean"?d:void 0)]).catch(D=>{Q.warn(D),g?.(D)})},p=B=>{const D=ct.getFailure(B);h?.(D)},y=B=>{v?.(B)};return k.on(F.SignalConnected,b).on(F.MediaDevicesError,p).on(F.EncryptionError,y),()=>{k.off(F.SignalConnected,b).off(F.MediaDevicesError,p).off(F.EncryptionError,y)}},[k,i,l,d,g,v,h]),n.useEffect(()=>{if(k){if(f){k.simulateParticipants({participants:{count:f},publish:{audio:!0,useRealTracks:!0}});return}if(!e){Q.debug("no token yet");return}if(!t){Q.warn("no livekit url provided"),g?.(Error("no livekit url provided"));return}a?(Q.debug("connecting"),k.connect(t,e,c).catch(b=>{Q.warn(b),g?.(b)})):(Q.debug("disconnecting because connect is false"),k.disconnect())}},[a,e,JSON.stringify(c),k,g,t,f]),n.useEffect(()=>{if(!k)return;const b=p=>{switch(p){case N.Disconnected:m&&m();break;case N.Connected:u&&u();break}};return k.on(F.ConnectionStateChanged,b),()=>{k.off(F.ConnectionStateChanged,b)}},[e,u,m,k]),n.useEffect(()=>{if(k)return()=>{Q.info("disconnecting on onmount"),k.disconnect()}},[k]),{room:k,htmlProps:T}}const Xt=n.forwardRef(function(A,e){const{room:t,htmlProps:s}=qt(A);return n.createElement("div",{ref:e,...s},t&&n.createElement(st.Provider,{value:t},n.createElement(it.Provider,{value:A.featureFlags},A.children)))});function Pt(A){return A!==void 0}function Wt(...A){return re(...A.filter(Pt))}function Ut(A,e={}){const[t,s]=n.useState(ht(A)),[o,c]=n.useState(t?.isMuted),[a,i]=n.useState(t?.isSubscribed),[l,d]=n.useState(t?.track),[u,m]=n.useState("landscape"),g=n.useRef(),{className:h,trackObserver:v}=n.useMemo(()=>pt(A),[A.participant.sid??A.participant.identity,A.source,ft(A)&&A.publication.trackSid]);return n.useEffect(()=>{const f=v.subscribe(E=>{Q.debug("update track",E),s(E),c(E?.isMuted),i(E?.isSubscribed),d(E?.track)});return()=>f?.unsubscribe()},[v]),n.useEffect(()=>{var f,E;return l&&(g.current&&l.detach(g.current),(f=e.element)!=null&&f.current&&!(oe(A.participant)&&l?.kind==="audio")&&l.attach(e.element.current)),g.current=(E=e.element)==null?void 0:E.current,()=>{g.current&&l?.detach(g.current)}},[l,e.element]),n.useEffect(()=>{var f,E;if(typeof((f=t?.dimensions)==null?void 0:f.width)=="number"&&typeof((E=t?.dimensions)==null?void 0:E.height)=="number"){const k=t.dimensions.width>t.dimensions.height?"landscape":"portrait";m(k)}},[t]),{publication:t,isMuted:o,isSubscribed:a,track:l,elementProps:Wt(e.props,{className:h,"data-lk-local-participant":A.participant.isLocal,"data-lk-source":t?.source,...t?.kind==="video"&&{"data-lk-orientation":u}})}}var Kt=typeof iA=="object"&&iA&&iA.Object===Object&&iA,Ht=typeof self=="object"&&self&&self.Object===Object&&self;Kt||Ht||Function("return this")();const zt=n.forwardRef(function({trackRef:A,onSubscriptionStatusChanged:e,volume:t,muted:s,...o},c){const a=ut(A),i=n.useRef(null);n.useImperativeHandle(c,()=>i.current);const{elementProps:l,isSubscribed:d,track:u,publication:m}=Ut(a,{element:i,props:o});return n.useEffect(()=>{e?.(!!d)},[d,e]),n.useEffect(()=>{u===void 0||t===void 0||(u instanceof mt?u.setVolume(t):Q.warn("Volume can only be set on remote audio tracks."))},[t,u]),n.useEffect(()=>{m===void 0||s===void 0||(m instanceof gt?m.setEnabled(!s):Q.warn("Can only call setEnabled on remote track publications."))},[s,m,u]),n.createElement("audio",{ref:i,...l})});function $t({volume:A,muted:e}){const t=lt([sA.Source.Microphone,sA.Source.ScreenShareAudio,sA.Source.Unknown],{updateOnlyOn:[],onlySubscribed:!0}).filter(s=>!oe(s.participant)&&s.publication.kind===sA.Kind.Audio);return n.createElement("div",{style:{display:"none"}},t.map(s=>n.createElement(zt,{key:dt(s),trackRef:s,volume:A,muted:e})))}const X=WA("unknown");async function Ao(){try{return await IA(async()=>{if(X()!=="unknown")return X();X.set("pending");const A=await navigator.permissions.query({name:"microphone"});return X.set(A.state),A.state})}catch(A){return lA.info("Failed to check microphone permission state",A),X.set("unknown"),"unknown"}}function eo(){X.set("unknown")}const LA=A=>A.length>0?Ue(A):null,M=A=>A?.toISOString()??null;async function to(A){return await IA(async()=>{const{voiceMode:e,metrics:t}=A.getState(),s=Ge(),o=await Je(),c=await qe(),a=await Xe(),i=await Pe();return{session_create_time:M(t.sessionCreateTime),get_status_sent_time:M(t.getStatusSentTime),get_status_success_time:M(t.getStatusSuccessTime),get_status_failed_time:M(t.getStatusFailedTime),proof_of_work_start_time:M(t.proofOfWorkStartTime),proof_of_work_end_time:M(t.proofOfWorkEndTime),get_token_sent_time:M(t.getTokenSentTime),get_token_success_time:M(t.getTokenSuccessTime),get_token_failed_time:M(t.getTokenFailedTime),conversation_start_success_time:M(t.conversationStartSuccessTime),conversation_start_fail_time:M(t.conversationStartFailTime),livekit_connect_time:M(t.livekitConnectTime),livekit_connect_success_time:M(t.livekitConnectSuccessTime),livekit_connect_fail_time:M(t.livekitConnectFailTime),session_connected_time:M(t.sessionConnectedTime),data_channel_open_time:M(t.dataChannelOpenTime),conversation_latency_ms:t.conversationLatency,voice_mode:e,get_token:{...s},peer_connection:{...o},pre_connect:{...c},connect:{...i},post_connect:{...a}}})}function oo(A,e,t){return IA(()=>{const{voiceMode:s,metrics:o}=A.getState(),c=UA(),a=We();return{session_end_time:M(o.sessionEndTime),avg_total_latency_ms:LA(o.totalLatencyMs),avg_rtt_ms:LA(o.currentRttMs),num_of_turns_speaking:o.numSpeaking,num_of_turns_thinking:o.numThinking,num_of_turns_listening:o.numListening,protocol:c,voice_session_id:t,reason:t.length===0?"aborted":e,conversation_latency_ms:o.conversationLatency,...ZA().length>0?{status_prefetch_failed_reasons:ZA().join(",")}:{},..._A().length>0?{status_prefetch_ineligible_reasons:_A().join(",")}:{},...a?{status_cache_skipped_reason:a}:{},voice_mode:s,microphone_permission_state:X()}})}function ce({conversationId:A}){const{shouldDelayDisconnect:e,delayDisconnect:t,immediateDisconnect:s}=yA({refetchLater:!0}),{toggleMute:o}=te(),c=wA(A),a=uA(),i=Se();return n.useCallback(async l=>{O.voiceSessionEndedByUser.click(),a.setState(m=>{m.metrics.sessionEndTime=new Date}),be.setState({voiceFeedbackThread:c,lastVoiceSessionEndTime:new Date});const d=await oo(a,l,i),u=await to(a);Be.logEvent("Voice Session End Summary",{...d,...u}),eo(),e?(a.setState(m=>{m.video=x.Stopping,m.screenshare=x.Stopping}),await o(),t()):(s(),Ke())},[t,s,c,e,o,a,i])}var kA,YA;function no(){return YA||(YA=1,kA={webm:"data:video/webm;base64,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",mp4:"data:video/mp4;base64,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"}),kA}var vA,FA;function so(){if(FA)return vA;FA=1;const{webm:A,mp4:e}=no(),t=()=>typeof navigator<"u"&&parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))<10&&!window.MSStream,s=()=>"wakeLock"in navigator;class o{constructor(){if(this.enabled=!1,s()){this._wakeLock=null;const a=()=>{this._wakeLock!==null&&document.visibilityState==="visible"&&this.enable()};document.addEventListener("visibilitychange",a),document.addEventListener("fullscreenchange",a)}else t()?this.noSleepTimer=null:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("title","No Sleep"),this.noSleepVideo.setAttribute("playsinline",""),this._addSourceToVideo(this.noSleepVideo,"webm",A),this._addSourceToVideo(this.noSleepVideo,"mp4",e),this.noSleepVideo.addEventListener("loadedmetadata",()=>{this.noSleepVideo.duration<=1?this.noSleepVideo.setAttribute("loop",""):this.noSleepVideo.addEventListener("timeupdate",()=>{this.noSleepVideo.currentTime>.5&&(this.noSleepVideo.currentTime=Math.random())})}))}_addSourceToVideo(a,i,l){var d=document.createElement("source");d.src=l,d.type=`video/${i}`,a.appendChild(d)}get isEnabled(){return this.enabled}enable(){return s()?navigator.wakeLock.request("screen").then(a=>{this._wakeLock=a,this.enabled=!0,console.log("Wake Lock active."),this._wakeLock.addEventListener("release",()=>{console.log("Wake Lock released.")})}).catch(a=>{throw this.enabled=!1,console.error(`${a.name}, ${a.message}`),a}):t()?(this.disable(),console.warn(`
        NoSleep enabled for older iOS devices. This can interrupt
        active or long-running network requests from completing successfully.
        See https://github.com/richtr/NoSleep.js/issues/15 for more details.
      `),this.noSleepTimer=window.setInterval(()=>{document.hidden||(window.location.href=window.location.href.split("#")[0],window.setTimeout(window.stop,0))},15e3),this.enabled=!0,Promise.resolve()):this.noSleepVideo.play().then(i=>(this.enabled=!0,i)).catch(i=>{throw this.enabled=!1,i})}disable(){s()?(this._wakeLock&&this._wakeLock.release(),this._wakeLock=null):t()?this.noSleepTimer&&(console.warn(`
          NoSleep now disabled for older iOS devices.
        `),window.clearInterval(this.noSleepTimer),this.noSleepTimer=null):this.noSleepVideo.pause(),this.enabled=!1}}return vA=o,vA}var io=so();const ao=Fe(io),NA="mode",ro="voice",co=()=>{const[A,e]=Ne(),t=A.get(NA),s=uA(),o=w(u=>u.isVoiceModeActive),c=KA(),a=!Me(c),i=Ie(),l=!a,d=ee();n.useEffect(()=>{t===ro&&!o&&(e(u=>(u.delete(NA),u)),i?d("/update-app"):l?s.setState({isVoiceModeActive:!0}):we(c,{authType:"login",callbackUrl:window.location.href}))},[c,l,i,t,d,e,o,s])},lo=A=>n.createElement("svg",{width:20,height:20,viewBox:"0 0 20 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...A},n.createElement("path",{d:"M15.7806 10.1963C16.1326 10.3011 16.3336 10.6714 16.2288 11.0234L16.1487 11.2725C15.3429 13.6262 13.2236 15.3697 10.6644 15.6299L10.6653 16.835H12.0833L12.2171 16.8486C12.5202 16.9106 12.7484 17.1786 12.7484 17.5C12.7484 17.8214 12.5202 18.0894 12.2171 18.1514L12.0833 18.165H7.91632C7.5492 18.1649 7.25128 17.8672 7.25128 17.5C7.25128 17.1328 7.5492 16.8351 7.91632 16.835H9.33527L9.33429 15.6299C6.775 15.3697 4.6558 13.6262 3.84992 11.2725L3.76984 11.0234L3.74445 10.8906C3.71751 10.5825 3.91011 10.2879 4.21808 10.1963C4.52615 10.1047 4.84769 10.2466 4.99347 10.5195L5.04523 10.6436L5.10871 10.8418C5.8047 12.8745 7.73211 14.335 9.99933 14.335C12.3396 14.3349 14.3179 12.7789 14.9534 10.6436L15.0052 10.5195C15.151 10.2466 15.4725 10.1046 15.7806 10.1963ZM13.5814 9.16699C13.5812 11.1448 11.9781 12.7479 10.0003 12.748C8.02232 12.748 6.41845 11.1449 6.41828 9.16699V5.41699C6.41828 3.43889 8.02221 1.83496 10.0003 1.83496C11.9783 1.83514 13.5814 3.439 13.5814 5.41699V9.16699Z"})),uo=A=>n.createElement("svg",{width:20,height:20,viewBox:"0 0 20 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...A},n.createElement("path",{d:"M4.21847 10.1963C4.52646 10.1048 4.84811 10.2467 4.99386 10.5195L5.04561 10.6436L5.10909 10.8418C5.80511 12.8745 7.73253 14.335 9.99972 14.335C10.5286 14.3349 11.0387 14.2541 11.5192 14.1064L12.5534 15.1406C11.9635 15.3929 11.3293 15.5623 10.6648 15.6299L10.6657 16.835H12.0837L12.2175 16.8486C12.5205 16.9107 12.7487 17.1787 12.7487 17.5C12.7487 17.8213 12.5205 18.0893 12.2175 18.1514L12.0837 18.165H7.91671C7.54959 18.1649 7.25167 17.8672 7.25167 17.5C7.25167 17.1328 7.54959 16.8351 7.91671 16.835H9.33565L9.33468 15.6299C6.77542 15.3697 4.65621 13.6261 3.8503 11.2725L3.77022 11.0234L3.74483 10.8906C3.71789 10.5825 3.9105 10.2879 4.21847 10.1963Z"}),n.createElement("path",{d:"M2.52901 2.5293C2.75621 2.3021 3.10782 2.274 3.36593 2.44434L3.47042 2.5293L17.4704 16.5293L17.5554 16.6338C17.7259 16.8919 17.6977 17.2434 17.4704 17.4707C17.2431 17.6978 16.8916 17.7261 16.6335 17.5557L16.529 17.4707L2.52901 3.4707L2.44405 3.36621C2.2737 3.10816 2.30194 2.75653 2.52901 2.5293Z"}),n.createElement("path",{d:"M15.0056 10.5195C15.1514 10.2467 15.4729 10.1047 15.781 10.1963C16.1328 10.3012 16.3339 10.6715 16.2292 11.0234L16.1491 11.2725C15.9624 11.8178 15.7043 12.3299 15.3874 12.7988L14.4245 11.8359C14.6481 11.4661 14.8279 11.0665 14.9538 10.6436L15.0056 10.5195Z"}),n.createElement("path",{d:"M10.156 12.7432C10.1045 12.7454 10.0527 12.748 10.0007 12.748C8.0227 12.748 6.41884 11.1449 6.41866 9.16699V9.00586L10.156 12.7432Z"}),n.createElement("path",{d:"M10.0007 1.83496C11.9785 1.83529 13.5817 3.4391 13.5817 5.41699V9.16699C13.5817 9.70173 13.4627 10.2084 13.2526 10.6641L6.67452 4.08594C7.20297 2.76693 8.49303 1.83496 10.0007 1.83496Z"})),mo=A=>n.createElement("svg",{width:20,height:20,viewBox:"0 0 20 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...A},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.5 2.66797C14.1891 2.66797 14.7461 2.66732 15.1963 2.7041C15.654 2.74151 16.0599 2.82094 16.4365 3.0127L16.6553 3.13477C17.1509 3.43881 17.5548 3.87557 17.8203 4.39649L17.8867 4.53906C18.0309 4.87526 18.0962 5.23621 18.1289 5.63672C18.1657 6.08689 18.165 6.64407 18.165 7.33301V12.666C18.165 13.3548 18.1656 13.9122 18.1289 14.3623C18.0962 14.7631 18.0311 15.1245 17.8867 15.4609L17.8203 15.6035C17.5549 16.1244 17.1508 16.5602 16.6553 16.8643L16.4365 16.9863C16.0599 17.1782 15.6541 17.2575 15.1963 17.2949C14.746 17.3317 14.1891 17.3311 13.5 17.3311H6.5C5.81091 17.3311 5.25395 17.3317 4.80371 17.2949C4.40304 17.2622 4.04236 17.197 3.70606 17.0527L3.56348 16.9863C3.04242 16.7208 2.60583 16.3171 2.30176 15.8213L2.17969 15.6035C1.98782 15.2268 1.90851 14.8202 1.87109 14.3623C1.83435 13.9122 1.83496 13.3548 1.83496 12.666V7.33301C1.83496 6.64407 1.83431 6.08689 1.87109 5.63672C1.90852 5.17906 1.98793 4.77301 2.17969 4.39649C2.48314 3.80107 2.96803 3.31609 3.56348 3.0127C3.94005 2.82094 4.34597 2.74151 4.80371 2.7041C5.25395 2.66732 5.81092 2.66797 6.5 2.66797H13.5ZM5.41699 11.418C5.04984 11.418 4.75214 11.7159 4.75195 12.083C4.75195 12.4044 4.98008 12.6724 5.2832 12.7344L5.41699 12.748L5.51953 12.7529C6.02437 12.8044 6.41878 13.2316 6.41895 13.75C6.41912 14.1171 6.71682 14.415 7.08399 14.415C7.45088 14.4147 7.74885 14.1169 7.74902 13.75C7.74885 12.5429 6.8309 11.5491 5.65527 11.4297L5.41699 11.418ZM5.41699 8.08496C5.04972 8.08496 4.75195 8.38273 4.75195 8.75C4.75195 9.07143 4.98008 9.33944 5.2832 9.40137L5.41699 9.41504L5.63965 9.4209C7.93021 9.53692 9.75195 11.4306 9.75195 13.75C9.75195 14.1173 10.0497 14.415 10.417 14.415C10.7842 14.4149 11.082 14.1172 11.082 13.75C11.082 10.7193 8.70186 8.24487 5.70899 8.09277L5.41699 8.08496Z"})),go=A=>n.createElement("svg",{width:20,height:20,viewBox:"0 0 20 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...A},n.createElement("path",{d:"M6.46567 3.75C5.79487 3.74999 5.24122 3.74998 4.79023 3.78683C4.32181 3.8251 3.89123 3.90724 3.48678 4.11331C2.85957 4.43289 2.34964 4.94283 2.03006 5.57003C1.82399 5.97448 1.74185 6.40507 1.70358 6.87348C1.66673 7.32447 1.66674 7.8781 1.66675 8.5489V11.4511C1.66674 12.1219 1.66673 12.6755 1.70358 13.1265C1.74185 13.5949 1.82399 14.0255 2.03006 14.43C2.34964 15.0572 2.85957 15.5671 3.48678 15.8867C3.89123 16.0928 4.32181 16.1749 4.79023 16.2132C5.24123 16.25 5.79487 16.25 6.46569 16.25H8.95114C9.62196 16.25 10.1756 16.25 10.6266 16.2132C11.095 16.1749 11.5256 16.0928 11.93 15.8867C12.5573 15.5671 13.0672 15.0572 13.3868 14.43C13.5928 14.0255 13.675 13.5949 13.7133 13.1265C13.7501 12.6755 13.7501 12.1219 13.7501 11.4511V8.54894C13.7501 7.87812 13.7501 7.32448 13.7133 6.87348C13.675 6.40507 13.5928 5.97448 13.3868 5.57003C13.0672 4.94283 12.5573 4.43289 11.93 4.11331C11.5256 3.90724 11.095 3.8251 10.6266 3.78683C10.1756 3.74998 9.62198 3.74999 8.95118 3.75H6.46567Z"}),n.createElement("path",{d:"M19.1667 6.526C19.1667 5.46049 17.919 4.88349 17.1072 5.57357L15.4405 6.99024C15.1611 7.22774 15.0001 7.57595 15.0001 7.94267V12.0573C15.0001 12.424 15.1611 12.7722 15.4405 13.0097L17.1072 14.4264C17.919 15.1165 19.1667 14.5395 19.1667 13.474V6.526Z"})),le=WA(void 0),ho=()=>HA(le),de="inline-flex items-center bg-transparent text-token-text-secondary hover:text-token-text-primary",po=({message:A,onClick:e,type:t})=>{const s=L(),o=xe()&&Te;if(!A)return null;switch(t){case"microphone_denied":return o?r.jsxs("a",{href:"ms-settings:privacy-microphone",className:de,children:[A,r.jsx(zA,{className:"icon-sm ms-1"})]}):r.jsx(GA,{onClick:e,message:A});case"connection_quality":return r.jsxs("div",{className:"inline-flex items-center",children:[A,r.jsx("button",{onClick:e,className:"ms-1",children:r.jsx("strong",{children:s.formatMessage(ue.retry)})})]});case"normal":return r.jsx(GA,{onClick:e,message:A})}},GA=({message:A,onClick:e})=>{const t=L();return r.jsxs("button",{onClick:e,className:de,"aria-label":t.formatMessage(ue.openInfoModal),children:[A,r.jsx(zA,{className:"icon-sm ms-1"})]})},ue={openInfoModal:{id:"hintMessage.openInfoModal",defaultMessage:"Open info modal",description:"Open info modal about voice mode usage"},retry:{id:"hintMessage.retry",defaultMessage:"Retry",description:"Retry text next to lost connection message"}};function fo(A){const{button:e,conversationId:t,onClick:s}=A,o=wA(t),{startVoiceMode:c}=ne(),a=ee(),i=n.useCallback(()=>{switch(e.action){case"new_chat":{He("/"),c(MA({serverThreadId:void 0,isAdvancedMode:!0,eventSource:`modal_${e.action}`,parentMessageId:void 0,clientThreadId:Qe(),gizmoId:void 0,skipCacheReason:"modal-new-chat-button"}));break}case"switch_to_standard":o&&c(MA({serverThreadId:o,isAdvancedMode:!1,eventSource:`modal_${e.action}`,parentMessageId:void 0,clientThreadId:o,gizmoId:cA.getGizmoId(BA(t)),skipCacheReason:"modal-switch-to-standard-button"}));break;case"upgrade_to_plus":RA(a,"Voice Mode Upgrade To Plus Modal");break;case"upgrade_to_pro":RA(a,"Voice Mode Upgrade To Pro Modal");break}s?.()},[e.action,t,a,s,o,c]);return r.jsx(Ve.Button,{onClick:i,title:e.title,color:A.color})}const Co={primary:"primary",secondary:"secondary",tertiary:"ghost"};function Eo({buttons:A,conversationId:e,onClick:t}){let s,o,c;const a=n.useCallback(i=>()=>{i==="upgrade_to_plus"?O.upsell.upgradeToPlus():i==="upgrade_to_pro"&&O.upsell.upgradeToPro(),t()},[t]);return!A||A.length===0?{primary:void 0,secondary:void 0,tertiary:void 0}:(A.forEach(i=>{if(!ye.includes(i.action))return;const d=r.jsx(fo,{button:i,conversationId:e,onClick:a(i.action),color:Co[i.style]});switch(i.style){case"primary":s=d;break;case"secondary":o=d;break;case"tertiary":c=d;break}}),{primary:s,secondary:o,tertiary:c})}function ko({conversationId:A,isOpen:e,onClose:t,buttons:s,title:o,description_markdown:c}){const a=Eo({buttons:s,conversationId:A,onClick:t}),i=r.jsx(Lt,{className:"markdown text-token-text-secondary mb-6",urlTransform:l=>l,children:c});return r.jsx(Re,{testId:"modal-voice-rate-limit",title:o,isOpen:e,onClose:t,size:"custom",className:"max-w-[550px]",type:"warning",showCloseButton:!0,children:r.jsxs("div",{className:"w-full",children:[i,r.jsxs("div",{className:"flex flex-row justify-end gap-6",children:[a.primary,a.secondary,a.tertiary]})]})})}function vo({conversationId:A}){const e=L(),t=uA(),s=ce({conversationId:A}),o=w(C=>C.server.usage),c=w(C=>C.server.voiceConnectionQuality),a=C=>C===se.LOST,i=ze(),{voiceName:l}=TA(),[d,u]=n.useState(!1),m=w(C=>C.server.toolUpdate),[g,h]=n.useState(!1),[v,f]=n.useState(!0),E=ho(),[k,S]=n.useState(null),[T,b]=n.useState(null),[p,y]=n.useState(null),B=n.useRef(!1),{prospectiveModelId:D}=$e(A),G=wA(A),{startVoiceMode:H,stopVoiceMode:_,isVoiceModeActive:P}=ne(),Y=w(C=>C.server.connectionState),oA=n.useCallback(()=>{const C=Y==null||Y===N.Connecting;s(C?"user-aborted":"user-requested")},[Y,s]),{requestMicrophonePermissions:J,userDeclinedMicrophonePermissions:R,microphoneAvailable:W,microphoneLabel:pA}=At();n.useEffect(()=>{Ao(),J()},[J]),n.useEffect(()=>{P&&R&&(u(!1),y(null),S(e.formatMessage(SA.hint)),b({title:e.formatMessage(SA.title),description_markdown:e.formatMessage(SA.description_markdown),buttons:[]}))},[e,P,R]),n.useEffect(()=>{if(W&&!Y&&!B.current){B.current=!0,S(null),b(null);const C=BA(A);let V;E!==void 0?(V=E,le.set(void 0)):(V=MA({serverThreadId:G,parentMessageId:cA.getCurrentNode(C)?.id,isAdvancedMode:!0,eventSource:"composer_speech_button",clientThreadId:A,gizmoId:cA.getGizmoId(C)}),O.voiceSessionStarted.click({voice:l}),V.requested_default_model=D??void 0),H(V)}},[Y,A,W,D,G,H,l,E]);const{reaching_limit_disclosure:z,exceed_limit_message:I}=o?.rate_limit_message??{},q=i?.modes.find(C=>C.mode===i?.default_voice_mode),$=q?.disclosure_message,fA=q?.info_message,CA=a(c)?"Lost connection.":z?.hint??I?.title??$?.hint??fA?.title??null;n.useEffect(()=>{q&&!R&&S(q.disclosure_message?.hint??null)},[q,R]),n.useEffect(()=>{const C=m?.text;let V,nA,U;return C&&(f(!1),V=setTimeout(()=>{h(!0),nA=setTimeout(()=>{h(!1),U=setTimeout(()=>{f(!0),t.setState(ve=>{ve.server.toolUpdate=null})},750)},3e3)},750)),()=>{clearTimeout(V),clearTimeout(nA),clearTimeout(U)}},[m,t]),n.useEffect(()=>{if(!R){if(CA&&S(CA),I&&P){_();const C={title:I.title,description_markdown:I.description_markdown,buttons:I.buttons};d?y(C):(b(C),u(!0));const V=I.buttons.some(U=>U.action==="upgrade_to_plus"),nA=I.buttons.some(U=>U.action==="upgrade_to_pro");O.rateLimitReached.success({upgrade_to_plus:V,upgrade_to_pro:nA})}else if(!T){const C=z??$??fA;C&&b({title:C.title,description_markdown:C.message_markdown,buttons:C.buttons})}}},[$,I,CA,d,P,T,z,_,R,fA]);const fe=n.useCallback(()=>{p&&(b(p),y(null)),u(!0)},[p]),Ce=n.useCallback(()=>{u(!1)},[]),Ee=w(C=>C.voiceMode),ke=async()=>{try{S(null),await H({conversation_id:G,eventSource:"lost_connection_hint_message",voice_mode:Ee,voice:l,clientThreadId:A,gizmo_id:cA.getGizmoId(BA(A)),skipCacheReason:"lost-connection-retry"})}catch(C){const V=C instanceof Error?C.message:String(C);O.voiceMode.error({error:V,eventSource:"lost_connection_hint_message"})}};let AA;return R?AA="microphone_denied":a(c)?AA="connection_quality":AA="normal",r.jsxs("div",{className:"flex w-full flex-col items-center",children:[r.jsxs("div",{className:"text-token-text-secondary relative mb-6 flex min-h-5 w-full items-center justify-center text-xs",children:[m?.text&&r.jsx(j.div,{initial:{opacity:0},animate:{opacity:g?1:0},transition:{duration:.5},style:{position:"absolute",left:"50%",transform:"translateX(-50%)",textAlign:"center"},children:r.jsxs("div",{className:"flex items-center",children:[m?.text&&r.jsx(Ot,{className:"icon-sm me-1"}),m?.text]})}),r.jsx(j.div,{initial:{opacity:0},animate:{opacity:v?1:0},transition:{duration:.5},style:{position:"absolute",left:"50%",transform:"translateX(-50%)",textAlign:"center",pointerEvents:m?.text?"none":"auto",cursor:m?.text?"default":"pointer"},children:r.jsx("div",{className:"flex items-center",children:r.jsx(po,{type:AA,message:k,onClick:AA==="connection_quality"?ke:fe})})})]}),r.jsxs("div",{className:dA("flex flex-row items-center gap-6","rounded-full px-3 py-1","transition-width duration-200 ease-in-out"),children:[r.jsx(JA,{capability:"video",children:r.jsx(So,{})}),r.jsx(bo,{hideTooltip:R,microphoneLabel:pA,isMicrophoneEnabled:W}),r.jsx(JA,{capability:"screenshare",children:r.jsx(Bo,{})}),r.jsx(VA,{onClick:oA})]}),r.jsx(ko,{conversationId:A,isOpen:d,onClose:Ce,title:T?.title,description_markdown:T?.description_markdown,buttons:T?.buttons??[]}),!1]})}function JA({children:A,capability:e}){return Ct()[e]?A:null}function So(){const{cameraTrackState:A,toggleCamera:e}=mA(),t=L();let s=null;const o=[x.Starting,x.Stopping].includes(A),c=A===x.Started;o?s=xA:s=go;const a=c?"bg-gray-900 hover:bg-gray-800 active:bg-gray-700":"bg-black/5 hover:bg-black/10 active:bg-black/20 dark:bg-[rgba(255,255,255,0.04)] dark:hover:bg-white/5 dark:active:bg-white/10",i=c?"text-token-main-surface-primary":"text-token-main-surface-primary-inverse",l=t.formatMessage({id:"SRVwhB",defaultMessage:"Toggle video"});return r.jsx(tA,{"aria-label":l,onClick:()=>e("ControlButton"),disabled:o,icon:s,className:a,iconColor:i})}function bo({hideTooltip:A,microphoneLabel:e,isMicrophoneEnabled:t}){const{isMuting:s,toggleMute:o}=te(),c=L(),{disconnectPending:a}=yA(),i=!!w(h=>h.dev.room?.localParticipant.isMicrophoneEnabled),l=t&&i,d=l?lo:uo,u=l?"bg-black/5 hover:bg-black/10 active:bg-black/20 dark:bg-[rgba(255,255,255,0.04)] dark:hover:bg-white/5 dark:active:bg-white/10":"bg-red-500/10 hover:bg-red-500/15 active:bg-red-500/20 dark:bg-red-500/10 dark:hover:bg-red-500/15 dark:active:bg-red-500/20",m=l?"text-token-main-surface-primary-inverse":"text-danger",g=l?c.formatMessage({id:"PJzixV",defaultMessage:"Turn off microphone"}):c.formatMessage({id:"nbbUMb",defaultMessage:"Turn on microphone"});return r.jsx(tA,{"aria-label":g,onClick:o,icon:d,disabled:s||a,className:u,iconColor:m,tooltipPrimaryLabel:!A&&e?g:"",tooltipSecondaryLabel:e})}function Bo(){const{screenshareTrackState:A,toggleScreenShare:e}=gA(),t=L();let s=null;const o=[x.Starting,x.Stopping].includes(A),c=A===x.Started;o?s=xA:s=mo;const a=c?"bg-gray-900 hover:bg-gray-800 active:bg-gray-700":"bg-black/5 hover:bg-black/10 active:bg-black/20 dark:bg-[rgba(255,255,255,0.04)] dark:hover:bg-white/5 dark:active:bg-white/10",i=c?"text-token-main-surface-primary":"text-token-main-surface-primary-inverse",l=t.formatMessage({id:"ShdqyW",defaultMessage:"Toggle screenshare"});return r.jsx(tA,{"aria-label":l,onClick:()=>e("ControlButton"),disabled:o,icon:s,className:a,iconColor:i})}function VA({className:A,onClick:e}){const t=L(),{disconnectPending:s}=yA(),o="bg-black/5 hover:bg-black/10 active:bg-black/20 dark:bg-[rgba(255,255,255,0.04)] dark:hover:bg-white/5 dark:active:bg-white/10",c=t.formatMessage({id:"9Mto0a",defaultMessage:"End"});return r.jsx(tA,{disabled:s,onClick:e,icon:s?xA:je,iconColor:"text-token-main-surface-primary-inverse",className:A??o,"aria-label":t.formatMessage({id:"7/8k4Y",defaultMessage:"End voice mode"}),tooltipPrimaryLabel:c})}function tA(A){const{icon:e,disabled:t,className:s,iconColor:o="text-current",iconSize:c="icon-xl",buttonSize:a="h-16 w-16",tooltipPrimaryLabel:i,tooltipSecondaryLabel:l,...d}=A,[u,m]=n.useState(!1),g=n.useRef(void 0),h=n.useCallback(()=>{const E=window.setTimeout(()=>{m(!0)},et);g.current=E},[]),v=n.useCallback(()=>{clearTimeout(g.current),m(!1)},[]),f=r.jsx(Io,{className:dA(s,a,"text-token-text-primary hover:text-token-text-secondary overflow-hidden rounded-full border-none p-0.5 transition-colors duration-200 ease-in-out"),disabled:t,...d,children:r.jsx(e,{className:dA(c,o)})});return i?r.jsx($A,{sideOffset:14,label:i,secondaryLabel:l,contentClassName:"flex flex-col items-center justify-center",className:"flex",open:u,side:"top",children:r.jsx("span",{onPointerEnter:h,onPointerLeave:v,children:f})}):f}const Mo=n.forwardRef(function(e,t){return r.jsx(De,{...e,ref:t})}),Io=j.create(Mo),SA={hint:{id:"micMessages.hint",defaultMessage:"Enable microphone access in Settings",description:"Hint to the user to manually enable microphone access for voice mode"},title:{id:"micMessages.title",defaultMessage:"Microphone access required",description:"Title for modal that informs the user that microphone access is required for voice mode"},description_markdown:{id:"micMessages.description_markdown",defaultMessage:"To use voice mode, you'll need to enable your microphone and try again.",description:"Description for modal that informs the user that microphone access is required for voice mode"}};function me(A,e){if(e.srcObject instanceof MediaStream){const t=e.srcObject;t.removeTrack(A),t.getTracks().length>0?e.srcObject=t:e.srcObject=null}}function ge(A,e){let t;e.srcObject instanceof MediaStream?t=e.srcObject:t=new MediaStream;let s;A.kind==="audio"?s=t.getAudioTracks():s=t.getVideoTracks(),s.includes(A)||(s.forEach(o=>{t.removeTrack(o)}),t.addTrack(A)),(!jA()||!(e instanceof HTMLVideoElement))&&(e.autoplay=!0),e.muted=t.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==t&&(e.srcObject=t,(jA()||_e())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=t,e.play().catch(()=>{})},0))}function wo({children:A}){const{cameraTrackState:e}=mA(),{screenshareTrackState:t}=gA(),s=e===x.Started||t===x.Started,o=e===x.Started;return r.jsx(eA,{mode:"wait",children:s?r.jsx("div",{className:"flex h-full w-full flex-nowrap items-center",children:o?r.jsx(xo,{}):r.jsx(To,{})}):r.jsx(j.div,{className:"flex h-full w-full items-center justify-center",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:A},"children")})}function xo(){const{cameraTrackState:A,toggleCamera:e}=mA(),{getTracks:t}=hA(),o=t([QA.Camera]).find(i=>i.origin===K.Local),c=n.useRef(null),a=A===x.Started&&o;return n.useEffect(()=>{if(o){const i=()=>{e("Browser Video Controls")};return o.onEnded(i),()=>{o.offEnded(i)}}},[o,e]),n.useEffect(()=>{const i=c.current;return i&&o&&ge(o.track,i),()=>{i&&o&&me(o.track,i)}},[o]),r.jsx(eA,{children:a&&r.jsx(he,{children:r.jsxs("div",{className:"aspect-w-16 aspect-h-9 group relative max-h-[95%] w-fit max-w-[60%] overflow-hidden rounded-3xl shadow-md",children:[r.jsx("div",{className:"absolute end-2 top-2 z-10 opacity-0 transition-opacity group-hover:opacity-90",children:r.jsx(VA,{onClick:()=>e("StopButton"),className:"bg-gray-900/20 backdrop-blur-lg hover:bg-gray-900/30 dark:backdrop-blur-lg"})}),r.jsx("video",{ref:c,className:"h-full w-full object-contain",muted:!0})]})},"camera-renderer")})}function To(){const{screenshareTrackState:A,toggleScreenShare:e}=gA(),{getTracks:t}=hA(),o=t([QA.ScreenShare]).find(i=>i.origin===K.Local),c=n.useRef(null),a=A===x.Started&&o;return n.useEffect(()=>{if(o){const i=()=>{e("Browser ScreenShare Controls")};return o.onEnded(i),()=>{o.offEnded(i)}}},[o,e]),n.useEffect(()=>{const i=c.current;return i&&o&&a&&ge(o.track,i),()=>{i&&o&&me(o.track,i)}},[o,a]),r.jsx(eA,{children:a&&r.jsx(he,{children:r.jsxs("div",{className:"aspect-w-16 aspect-h-9 group relative max-h-[95%] w-fit max-w-[60%] overflow-hidden rounded-3xl shadow-md",children:[r.jsx("div",{className:"absolute end-2 top-2 z-10 opacity-0 transition-opacity group-hover:opacity-90",children:r.jsx(VA,{onClick:()=>e("StopButton"),className:"bg-gray-900/20 backdrop-blur-lg hover:bg-gray-900/30 dark:backdrop-blur-lg"})}),r.jsx("video",{ref:c,className:"h-full w-full object-contain",muted:!0})]})},"screenshare-renderer")})}function he({children:A,key:e}){return r.jsx(j.div,{className:"bg-token-main-surface-primary flex h-full w-full flex-col items-center justify-center gap-2",initial:{opacity:0,transform:"blur(12px)",scale:.75},animate:{opacity:1,transform:"blur(0px)",scale:1},exit:{opacity:0,transform:"blur(12px)",scale:.75},transition:{duration:.2},children:A},e)}const aA=(A,e)=>{const[t,s]=n.useState(A===e?performance.now():0),o=n.useRef(e);n.useEffect(()=>{o.current!==e&&A===e&&s(performance.now()),o.current=e},[e,A]);const c=n.useCallback(()=>{s(0)},[]);return[A===e?1:0,t,c]},rA=([A,e,t],s=500)=>{const[o,c]=n.useState(A),a=n.useRef(A),i=n.useRef(void 0),l=n.useCallback((d,u,m)=>{const g=h=>{const v=Math.min((h-d)/s,1),f=u+v*(m-u);c(f),v<1&&(i.current=requestAnimationFrame(g))};i.current=requestAnimationFrame(g)},[s]);return n.useEffect(()=>{if(a.current!==A){a.current=A,i.current&&cancelAnimationFrame(i.current);const d=o,u=A;l(performance.now(),d,u)}},[l,o,A]),[o,e/1e3,t]},qA=A=>{const[e,t]=n.useState({audioData:[0,0,0,0],cumulativeAudioData:[0,0,0,0]}),s=n.useRef([0,0,0,0]),o=n.useRef(void 0),c=n.useRef(performance.now()),{bandMagnitudes:a,cumulativeMagnitude:i}=Et(A,{bands:3,bins:1,gainMultipliers:[10,1,1]});s.current=[...a,i].flat();const l=n.useCallback(()=>{const d=performance.now(),u=(d-c.current)/1e3;c.current=d;const m=s.current,{audioData:g,cumulativeAudioData:h}=e,v=kt({deltaTimeS:u,audioDataRaw:m,prevAudioData:g,prevCumulativeAudioData:h});t(v)},[e]);return n.useEffect(()=>(o.current||(o.current=window.setInterval(l,ie)),()=>{clearInterval(o.current),o.current=void 0}),[l]),e},pe=()=>HA(()=>UA())==="transceiver";function XA({className:A}){return r.jsx(Zo,{className:A})}const yo=1.55,Qo=1.4,Vo="audio",Ro="shout",jo="User",Do={bands:4,loPass:0,hiPass:400},PA=[300,300];function _o(){const A=Ze(),e=w(p=>p.voiceMode==="advanced"),t=pe(),s=KA(),o=Oe(s,"2624610486"),{getTracks:c}=hA(),a=c([QA.Microphone]),i=a.find(p=>p.name===Vo),l=a.find(p=>p.name===Ro);let d=OA(l?.track,Do);d.length===0&&(d=[0,0,0,0]),d.map(p=>p*Qo);const u=qA(l?.track),m=qA(i?.track),g=u.audioData.map((p,y)=>{const B=m.audioData[y];return p>0&&B>0?(p+B)/2:p>0?p:B}),h=u.cumulativeAudioData.map((p,y)=>{const B=m.cumulativeAudioData[y];return p>0&&B>0?(p+B)/2:p>0?p:B}),v=w(p=>p.server.remoteState),f=w(p=>p.server.connectionState),E=n.useMemo(()=>{switch(f){case N.Connected:return v;case N.Connecting:case N.Reconnecting:case N.SignalReconnecting:case null:return null;case N.Disconnected:return Z.Halted}},[f,v]),k=n.useMemo(()=>a.find(p=>p.userName===jo)?.track,[a]),S=(OA(k,{bands:1,loPass:0,hiPass:400})[0]??0)*yo,{voiceName:T}=TA();let b;return t&&o?b="HELLO_TIBOR":T==="shade"&&(b="ANGSTY_BLACK"),{remoteState:E,userVolume:S,isAdvanced:e,avgMag:g,cumulativeAudio:h,isDarkMode:A,standardBloopVolumes:d,overrideColor:b}}function Zo({className:A}){const{remoteState:e,userVolume:t,isAdvanced:s,avgMag:o,cumulativeAudio:c,isDarkMode:a,standardBloopVolumes:i,overrideColor:l}=_o(),[d,u]=n.useState(PA),{canvasSizeRef:m,handleCanvasSizeUpdate:g}=tt(PA),h=n.useRef(void 0),v=n.useCallback(I=>{u([I.width,I.height])},[]),f=n.useRef([0,0,0,0]);n.useEffect(()=>{e===Z.Connecting&&(f.current=[0,0,0,0])},[e]);const E=n.useRef(performance.now());n.useEffect(()=>{const I=performance.now();e===Z.Speaking&&I-E.current>50&&(E.current=I,f.current=f.current.map((q,$)=>q+o[$]))},[e,o]);const[k,S]=rA(aA(Z.Listening,e)),[T,b]=rA(aA(Z.Speaking,e)),[p,y]=rA(aA(Z.Thinking,e)),[B,D]=rA(aA(Z.Halted,e)),[G,H]=n.useState(performance.now()/1e3);n.useEffect(()=>{const I=setInterval(()=>{H(performance.now()/1e3)},ie);return()=>clearInterval(I)},[]);const _=n.useMemo(()=>performance.now()/1e3,[]),[P,Y]=n.useState(1e5),oA=n.useRef(e);n.useEffect(()=>{e===Z.Connecting?Y(1e5):oA.current===Z.Connecting&&Y(G),oA.current=e},[e,G]);const J=vt({isAdvanced:s,overrideColor:l}),R=s?o:i,W=k===1||T===1,pA=St({viewport:d,canvasSize:m.current,shouldMeasurePerf:W,source:"VoiceMode"}),z=bt({shouldCalibrate:W,viewport:d,initialScale:1});return h.current={time:G-_,micLevel:t,stateListen:k,listenTimestamp:Math.max(S-_,0),stateThink:p,thinkTimestamp:Math.max(y-_,0),stateSpeak:T,speakTimestamp:Math.max(b-_,0),readyTimestamp:P-_,stateHalt:B,haltTimestamp:Math.max(D-_,0),touchDownTimestamp:0,touchUpTimestamp:0,stateFailedToConnect:0,failedToConnectTimestamp:0,avgMag:R,cumulativeAudio:c??f.current,isNewBloop:!0,isAdvancedBloop:s,bloopColorMain:Array.from(J.bloopColorMain),bloopColorLow:Array.from(J.bloopColorLow),bloopColorMid:Array.from(J.bloopColorMid),bloopColorHigh:Array.from(J.bloopColorHigh),isDarkMode:a,screenScaleFactor:window.devicePixelRatio,viewport:d,silenceAmount:0,silenceTimestamp:0,fadeBloopWhileListening:!1},r.jsx(Bt,{className:dA("flex items-center justify-center",A),variablesRef:h,onViewportUpdate:v,textureImage:xt,textureName:"uTextureNoise",onGlAvailable:pA,onCanvasSizeUpdate:g,scale:z,GLUniformsSetter:wt,vert:It,frag:Mt})}const Oo=({conversationId:A})=>{const{getTracks:e}=hA(),t=e(),[s,o]=n.useState(!1),[c,a]=n.useState(!1),{voiceName:i}=TA(),l=L(),d=n.useCallback(()=>{for(const S of t)S.origin===K.Local?(a(S.isMuted),S.setMuted(!0)):S.origin===K.Remote&&S.setMuted(!0)},[t]),u=n.useCallback(()=>{for(const S of t)S.origin===K.Local?c||S.setMuted(!1):S.origin===K.Remote&&S.setMuted(!1)},[t,c]),m=n.useCallback(()=>{O.voiceSelectionShown.click({voice:i}),d(),o(!0)},[i,d]),g=()=>{u(),o(!1)},h=Tt(),v=i==="shade",{alreadyTriggered:f}=yt(),E=h&&!v&&!f,k=n.useMemo(()=>r.jsx(tA,{onClick:m,icon:ot,iconColor:"text-token-text-secondary",className:"h-[40px] w-[40px] bg-transparent hover:bg-black/10 active:bg-black/20 dark:bg-transparent dark:hover:bg-white/5 dark:active:bg-white/10",iconSize:"icon"}),[m]);return r.jsxs("div",{className:"relative h-[40px] w-[40px]",children:[E?r.jsx($A,{label:l.formatMessage({id:"SxYG4e",defaultMessage:"Talk to Monday (ugh)"}),children:k}):k,s&&r.jsx(Qt,{conversationId:A,onClose:g})]})};function Lo(A={}){const[e,t]=n.useState(!1),[s,o]=n.useState(!1),[c,a]=n.useState(!1);let i=Vt().microphoneTrack;const[l,d]=n.useState();A.trackRef&&(i=A.trackRef.publication);const u=n.useCallback(async m=>{if(m){const{KrispNoiseFilter:g,isKrispNoiseFilterSupported:h}=await Ae(async()=>{const{KrispNoiseFilter:v,isKrispNoiseFilterSupported:f}=await import("./bcef2kukc614r4kn.js");return{KrispNoiseFilter:v,isKrispNoiseFilterSupported:f}},[]);if(!h()){console.warn("Krisp noise filter is not supported in this browser");return}l||d(g(A.filterOptions))}t(g=>(g!==m&&o(!0),m))},[]);return n.useEffect(()=>{var m;if(i&&i.track instanceof Rt&&l){const g=i.track.getProcessor();g&&g.name==="livekit-noise-filter"?(o(!0),g.setEnabled(e).finally(()=>{o(!1),a(e)})):!g&&e&&(o(!0),(m=i?.track)==null||m.setProcessor(l).then(()=>l.setEnabled(e)).then(()=>{a(!0)}).catch(h=>{a(!1),console.error(h)}).finally(()=>{o(!1)}))}},[e,i,l]),{setNoiseFilterEnabled:u,isNoiseFilterEnabled:c,isNoiseFilterPending:s,processor:l}}const Yo=n.memo(function(){const{setNoiseFilterEnabled:e}=Lo();return n.useEffect(()=>{e(!0)},[e]),null}),Fo=new Yt(new URL("/assets/livekit-client.e2ee.worker-s9h8y0dQ.js",import.meta.url),{type:"module"}),No=n.memo(function({children:e}){const t=n.useRef({keyProvider:new jt}).current,[s,o]=n.useState(!1),{token:c,url:a,e2eeKey:i}=w(h=>h.credentials),l=Ft(),d=w(h=>h.isVoiceModeActive),u=w(h=>h.audioInputDevice?.deviceId),m=pe(),g=m?Dt:_t;return n.useEffect(()=>{const h=c&&a&&i;!s&&h?t.keyProvider.setKey(i).then(()=>{o(!0)}):s&&!h&&o(!1)},[c,a,i,s,t]),d?r.jsx(Xt,{...l,connect:!0,token:c??void 0,serverUrl:a??void 0,audio:{deviceId:{ideal:u,exact:u},noiseSuppression:!0,echoCancellation:!0},options:{e2ee:{keyProvider:t.keyProvider,worker:Fo}},children:r.jsxs(g,{children:[e,m||s&&c&&a?r.jsx(Zt,{}):null,s&&c&&a&&r.jsx($t,{}),s&&c&&a&&r.jsx(Yo,{})]})}):null}),Go=Ye(()=>Ae(()=>import("./fuvc81vmwlhx5j5l.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16])).then(A=>A.VoiceModeDevPanel));function Jo({conversationId:A}){const[e,t]=n.useState(!1),{screenshareTrackState:s}=gA(),{cameraTrackState:o}=mA(),c=s===x.Started||o===x.Started,a=w(u=>u.isVoiceModeActive),i=w(u=>u.server.voiceConnectionQuality),l=L();co();const d=ce({conversationId:A});return Le(()=>{a&&d("electron-app-minimized")}),n.useEffect(()=>{const u=new ao;return a?u.enable():u.disable(),()=>{u.disable()}},[a]),r.jsxs(No,{conversationId:A,children:[r.jsx(eA,{children:a?r.jsx(j.div,{className:"bg-token-main-surface-primary fixed start-0 top-0 z-50 flex h-full w-full flex-col",initial:"hidden",animate:"visible",exit:"hidden",variants:bA,children:r.jsx(j.div,{className:"relative h-full w-full",variants:bA,children:r.jsxs(j.div,{variants:bA,className:"flex h-full w-full flex-col justify-between gap-6",children:[r.jsxs(j.div,{className:"relative mt-6 flex w-full justify-center",children:[r.jsx("div",{className:"flex w-full items-center justify-center",children:c&&r.jsx(XA,{className:"h-16 w-16"})}),r.jsxs("div",{className:"me-4 flex flex-row gap-2",children:[!1,r.jsx(Oo,{conversationId:A})]})]}),r.jsxs("div",{className:"flex h-full min-h-0 items-center justify-center",children:[r.jsx(wo,{children:r.jsx(XA,{className:"min-h-bloop min-w-bloop h-max w-max"})}),r.jsx(eA,{children:e?r.jsx(Go,{conversationId:A}):null})]}),r.jsx(j.div,{className:"mb-6 flex justify-center",children:r.jsx(vo,{conversationId:A})})]})})}):null}),i===se.POOR&&r.jsx("div",{className:"absolute start-1/2 top-6 z-50 -translate-x-1/2 transform",children:r.jsx("div",{className:"border-token-border-default bg-token-main-surface-primary inline-flex flex-col items-center rounded-full border px-6 py-3",children:r.jsx("span",{className:"text-token-text-secondary",children:l.formatMessage({id:"YE2Eng",defaultMessage:"Poor connection"})})})})]})}const bA={hidden:{opacity:0,transform:"blur(4px)"},visible:{transform:"blur(0px)",opacity:1},exit:{opacity:0,transform:"blur(4px)"}},zo=Object.freeze(Object.defineProperty({__proto__:null,VoiceModeLayout:Jo},Symbol.toStringTag,{value:"Module"}));export{to as g,Eo as u,zo as v};
//# sourceMappingURL=bj0vu1nj07afex4q.js.map
