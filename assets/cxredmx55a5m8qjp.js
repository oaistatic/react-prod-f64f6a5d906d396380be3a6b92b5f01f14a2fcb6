import{r as N,l as ue,h as Ee,b as O,j as e,M as r}from"./gg0tb34p9fzo1omt.js";import{bR as q,cz as Q,cA as C,cB as W,cC as $,cD as H,cE as ve,cF as ge,cG as V,cH as xe,cI as he,cJ as Ae,X as Le,cK as ke,ai as ae,B as ne,cL as oe,cM as B,cN as le,cO as S,cP as Y,cQ as ce,cR as G,cS as Be}from"./forbprkns1cohsbl.js";import{cD as z,d as Oe,b6 as Re,dj as De,cG as fe,ch as pe,de as Ie,P as v,be as ie,cC as Ue,bU as X,eW as F,D as K,c2 as Fe}from"./g670b8vtkhx0yc6d.js";import{c as ye}from"./iej0cupg2dqkmejt.js";import{u as J,P as We}from"./j8pmm8m4sd7eamqj.js";import{u as Se}from"./bckf7qgfy3ojc3v4.js";import{u as Te}from"./pnx8yl9r7yj5moem.js";const $e=ye(H),He=({promoData:n}={})=>{const c=q(),p=Q(),{data:T}=J(p??"");let m=n;!n&&T&&(m=T);const o=m?.coupon===C&&m.state==="eligible",t=typeof window<"u"?new URLSearchParams(window?.location.search):new URLSearchParams,h=t.get(W),s=t.get($),d=o?H.FLEXIBLE:s&&$e(s)?s:H.FLEXIBLE,[a,u]=N.useState(d),[y,i]=N.useState(h&&!isNaN(parseInt(h,10))?parseInt(h,10):Math.max(ve,c));return{promoData:m,selectedPlan:a,setSelectedPlan:u,numSeats:y,setNumSeats:i,minTeamSeats:c,TEAM1DOLLAR_COUPON_IsEligible:o}},j=Ae;var je=(n=>(n.FLEXIBLE="month",n.ANNUAL="year",n))(je||{});const re=ye(je),Ze=n=>{const c=N.useRef(!1),p=ue(),T=p.hash.split("#")[1]===ge||p.hash.split("#")[1]===V,m=z(),o=!c.current&&T&&m&&!n,t=Oe(),h=o&&Re(t,"4250628994").get("enabled",!1),{initialBillingDetails:s}=Te(m,!0),d=Q(),{data:a,isLoading:u}=J(d??""),y=q();N.useEffect(()=>{h&&o&&(De.setPurchaseWorkspaceData({minimumSeats:y,billingDetails:s,promoData:a}),c.current=!0)},[m,s,y,T,n,d,a,u,h,o])},me=Fe.p`text-base font-medium mb-3`,Pe=({isOpen:n,onClose:c,onSubmit:p,minimumSeats:T,billingDetails:m,isDirectFlow:o=!1,promoData:t=void 0})=>{const h=z(),{selectedPlan:s,setSelectedPlan:d,numSeats:a,setNumSeats:u,minTeamSeats:y,TEAM1DOLLAR_COUPON_IsEligible:i}=He({promoData:t}),[f,g]=N.useState(!1),l=O(),M=m.currency,R=Math.max(T,y),{flexibleBillingPlan:be,annualBillingPlan:Z}=he(M);let P=be,A=null;i&&(A=G(M),P={...P,cost:{...M===Ie?j.team1dollarMonthlyCostINR:j.team1dollarMonthlyCost},costStructure:{...j.team1dollarMonthlyStructure,defaultMessage:`then ${l.formatMessage(P.currencySign)}${P.monthlyCost} monthly per seat`,id:"promo.team1dollar.monthlyPlanStructure",description:"Subsequent pricing description for team1dollar promo. Describing the monthly then the annual price after."}});const L=t?.coupon===C&&t.state==="not_eligible",k=t?.coupon===C&&t.state==="temporary_disabled",ee=t?.coupon===C&&t.state==="offline",b=Le(isNaN(a)?0:a,R,ke),_=N.useMemo(()=>h?.subscriptionAnalyticsParams,[h]);N.useEffect(()=>{v.logEvent("Account Pay: Select Team Plan Modal Show",_)},[_]);const te=x=>{switch(x){case"month":v.logEvent("Account Pay: Team Plan Selection Clicked",{..._,buttonType:"Continue",numberOfSeats:a,planLength:ce.MONTHLY});break;case"year":v.logEvent("Account Pay: Select Team Plan Modal Clicked",{..._,buttonType:"Continue",numberOfSeats:a,planLength:ce.ANNUAL});break}},se=(x,E)=>{v.logEventWithStatsig("Account Pay: Select Team Plan Modal Clicked","chatgpt_select_team_plan_modal_continue_to_billing_clicked",{..._,buttonType:"Continue",numberOfSeats:E,planLength:x}),K.addAction("chatgpt_funnel.team_plan_modal_checkout_initiated",{planLength:x,numberOfSeats:E.toString(),accountId:h?.id}),t?.coupon===C&&t.state==="eligible"&&We.logCouponApplied(t.coupon)},D=()=>{v.logEvent("Account Pay: Select Team Plan Modal Dismiss",_)},w=ue(),I=N.useMemo(()=>w.hash.split("#")[1]===V,[w.hash]);return N.useEffect(()=>{const x=new URLSearchParams;x.set(W,b.toString()),x.set($,s),t?.coupon&&x.set(ae,t.coupon);const E=o||I?`#${V}`:`#${ge}`,Ne=`${w.pathname}?${x.toString()}${E}`,U=new URL(window.location.href).searchParams,Me=U.get(W)===b.toString(),we=U.get($)===s,Ce=t?.coupon==null||U.get(ae)===t.coupon,_e=window.location.hash===E;(!Me||!we||!Ce||!_e)&&window.history.pushState({from:w.pathname+w.search},"",Ne)},[b,o,I,w.pathname,w.search,w.hash,s,t?.coupon]),o||I?e.jsx(ie,{testId:"modal-workspace-purchase",type:"success",isOpen:n,onClose:()=>{c(),D()},size:"fullscreen",noPadding:!0,removePopoverStyling:!0,showCloseButton:!0,children:e.jsxs("div",{className:"grid grid-flow-row grid-cols-1 md:h-full md:grid-cols-2",children:[e.jsx("div",{className:"flex-column col-span-1 flex justify-center p-5 md:grid-cols-2",children:e.jsxs("div",{className:"flex w-full max-w-[400px] flex-col items-center",children:[e.jsx(Ue,{className:"mt-8 mb-6 h-8 w-8 md:fixed md:start-4 md:top-4 md:mt-0 md:h-6 md:w-6"}),(L||k||ee)&&e.jsx("div",{className:"mb-4 w-full",children:e.jsx(ne,{content:l.formatMessage(L?j.team1dollarNotEligible:k?j.team1dollarTemporarilyDisabled:j.team1dollarOffline),type:"info"})}),e.jsx("div",{className:"mb-8 text-3xl font-medium md:mt-[120px]",children:e.jsx(r,{id:"selectTeamPlanModal.title",defaultMessage:"Pick your plan"})}),e.jsxs(oe,{className:X("col-span-3 mb-6 grid w-full gap-4 md:col-span-2","md:grid-cols-2"),defaultValue:s,onValueChange:x=>{re(x)&&(d(x),te(x))},children:[e.jsx(B,{billingType:"year",...Z,selectedValue:s,hideSavingsMessage:i,hideDetails:!0}),e.jsx(B,{billingType:"month",...P,selectedValue:s,hideDetails:!0,showWelcomeOfferLabel:t?.state==="eligible",promoDisclaimer:t?.state==="eligible"&&e.jsx(r,{...j.team1dollarPromoDisclaimer,values:{currencySign:l.formatMessage(P.currencySign),cost:P.monthlyCost}})})]}),e.jsx(le,{numSeats:a,minSeats:R,setNumSeats:u}),e.jsx("div",{className:"text-token-text-secondary self-start text-xs",children:l.formatMessage({id:"selectTeamPlanModal.seatsDescription",defaultMessage:"Add more seats at any time. Minimum of {minSeats} seats."},{minSeats:y})})]})}),e.jsx("div",{className:"col-span-3 flex h-full flex-col items-center overflow-hidden p-6 md:col-span-1 md:shadow-lg",children:e.jsxs("div",{className:"flex w-full max-w-[400px] flex-col md:mt-[120px]",children:[e.jsx(me,{className:"mb-8 text-xl font-medium",children:e.jsx(r,{...S.summaryTitle})}),e.jsx(de,{numSeats:b,selectedPlan:s,billingDetails:m,totalLabel:S.allPlansTodayTotal,billDate:e.jsx(r,{...S.today}),promoData:t}),e.jsx(F,{title:l.formatMessage(S.continueToBillingButton),onClick:async()=>{g(!0),se(s,b),await p(s,b),g(!1)},disabled:!1,loading:f,color:"green",className:"w-full rounded-xl"}),e.jsx(F,{title:l.formatMessage(S.cancel),onClick:()=>{c(),D()},color:"ghost",className:"mt-4 w-full rounded-xl"})]})})]})}):e.jsxs(ie,{testId:"modal-select-team-plan",type:"success",isOpen:n,onClose:()=>{c(),D()},size:"custom",noPadding:!0,removePopoverStyling:!0,className:"max-w-4xl",showCloseButton:!0,hasSeparator:!0,title:l.formatMessage(S.selectTeamPlanModalTitle),children:[(L||k||ee)&&e.jsx("div",{className:"px-5 pt-4",children:e.jsx(ne,{content:l.formatMessage(L?j.team1dollarNotEligible:k?j.team1dollarTemporarilyDisabled:j.team1dollarOffline),type:"info"})}),e.jsxs("div",{className:"grid grid-flow-row grid-cols-3",children:[e.jsxs("div",{className:"flex-column col-span-3 p-5 md:col-span-2 md:grid-cols-2",children:[e.jsx(le,{numSeats:a,minSeats:R,setNumSeats:u}),t?.coupon===C&&t.state==="eligible"&&s==="month"&&a>Y&&e.jsx("div",{className:"text-token-text-secondary mt-1 self-start text-xs",children:e.jsx(r,{...j.team1dollarOverSeatsDisclaimer})}),e.jsxs(oe,{className:X("col-span-3 mt-5 grid gap-4 md:col-span-2","md:grid-cols-2"),defaultValue:s,onValueChange:x=>{re(x)&&(d(x),te(x))},children:[e.jsx(B,{billingType:"year",...Z,selectedValue:s,hideSavingsMessage:i}),e.jsx(B,{billingType:"month",...P,selectedValue:s,showWelcomeOfferLabel:i,promoDisclaimer:i&&e.jsx(r,{...A===1?j.team1dollarPromoDisclaimer:j.team1dollarPromoDisclaimerWithAmount,values:{currencySign:l.formatMessage(P.currencySign),amount:A&&l.formatNumber(A,{style:"currency",currency:M,trailingZeroDisplay:"stripIfInteger"})}})})]})]}),e.jsxs("div",{className:"border-token-main-surface-tertiary bg-token-bg-elevated-secondary col-span-3 flex h-full flex-col overflow-hidden border-s p-6 md:col-span-1",children:[e.jsx(me,{children:e.jsx(r,{...S.summaryTitle})}),e.jsx(de,{numSeats:b,selectedPlan:s,billingDetails:m,totalLabel:S.allPlansTodayTotal,billDate:e.jsx(r,{...S.today}),promoData:t}),e.jsx(F,{title:l.formatMessage(S.continueToBillingButton),onClick:async()=>{g(!0),se(s,b),await p(s,b),g(!1)},disabled:!1,loading:f,color:"primary",className:"w-full rounded-xl"})]})]})]})},de=({numSeats:n,selectedPlan:c,billingDetails:p,totalLabel:T,billDate:m,promoData:o})=>{const t=O(),{flexibleBillingPlan:h,annualBillingPlan:s}=he(p.currency),d=h,a=c==="month"?d:s,u=Be[c],y=(n||0)*(c==="year"?s.monthlyCost*12:d.monthlyCost);let i=(n||0)*a.unitCost,f=y-i,g=0,l=y,M=!1;return o?.coupon===C&&o.state==="eligible"&&c==="month"&&(M=!0,n<=Y?(g=G(p.currency),l=n*d.monthlyCost,f=l-g,i=g):(g=G(p.currency)+(n-Y)*d.monthlyCost,l=n*d.monthlyCost,f=l-g,i=g)),e.jsxs("div",{className:"flex grow flex-col text-sm",children:[e.jsxs("div",{className:"text-token-text-secondary flex w-full justify-between text-sm",children:[e.jsx("div",{className:"flex",children:e.jsx(r,{...u.name})}),e.jsx("div",{className:"flex",children:e.jsx(r,{...S.allPlansPreDiscountTotal,values:{currencySign:t.formatMessage(a.currencySign),preDiscountTotalAmount:y.toLocaleString()}})})]}),e.jsxs("div",{className:"text-token-text-tertiary flex w-full justify-between text-xs",children:[e.jsx("div",{className:"flex",children:e.jsx(r,{...u.breakdown,values:{numSeats:n}})}),e.jsx("div",{className:"flex",children:e.jsx(r,{...S.breakdownAmount,values:{currencySign:t.formatMessage(a.currencySign),amount:a.monthlyCost}})})]}),e.jsxs("div",{className:"text-token-text-secondary mt-3 flex w-full justify-between text-sm",children:[e.jsx("div",{className:"flex",children:e.jsx(r,{...S.planDiscountLabel})}),e.jsx("div",{className:X("flex",f>0&&"font-medium text-[#10A37F]"),children:e.jsx(r,{...u.discountAmount,values:{currencySign:t.formatMessage(d.currencySign),discountAmount:f.toLocaleString()}})})]}),o?.coupon===C&&o.state==="eligible"&&c==="month"&&e.jsx("div",{className:"text-token-text-tertiary text-xs",children:e.jsx(r,{...j.team1dollarBelowDiscount})}),u.discountDescription&&s.discountedMonthlyCost<s.monthlyCost&&c==="year"&&e.jsx("div",{className:"text-token-text-tertiary text-xs",children:e.jsx(r,{...u.discountDescription,values:{discountPercentage:Math.floor((1-s.discountedMonthlyCost/s.monthlyCost)*100)}})}),e.jsx("hr",{className:"border-token-border-default my-3"}),e.jsxs("div",{className:"flex w-full justify-between text-base font-medium",children:[e.jsx("div",{className:"flex",children:e.jsx(r,{...T})}),e.jsx("div",{className:"flex",children:M?e.jsxs(e.Fragment,{children:[t.formatMessage(a.currencyCode)," ",t.formatMessage(a.currencySign),i.toLocaleString()]}):e.jsx(r,{...u.total,values:{currencyCode:t.formatMessage(a.currencyCode),currencySign:t.formatMessage(a.currencySign),totalAmount:i.toLocaleString()}})})]}),e.jsx("div",{className:"text-token-text-tertiary text-xs",children:M?e.jsx(e.Fragment,{children:e.jsx("div",{className:"text-token-text-tertiary mt-2 text-xs",children:e.jsx(r,{id:"vgDSPO",defaultMessage:"After promotional period {currencySign}{amount} per month",values:{currencySign:t.formatMessage(d.currencySign),amount:l.toLocaleString()}})})}):e.jsx(r,{...u.billed,values:{billDate:m}})})]})};function et(){const n=z(),c=Ee(),{prepareCheckoutSession:p,navigateToCheckout:T}=Se(),m=q(),{initialBillingDetails:o}=Te(n,!0),t=O(),h=fe(),s=xe(t,void 0,h),d=pe(),a=Q(),{data:u}=J(a??""),y=async(f,g)=>{try{const l=await p({plan_name:"chatgptteamplan",team_plan_data:{workspace_name:s,price_interval:f,seat_quantity:g},billing_details:o,promo_campaign:f==="month"?u?.coupon:null});await T(l)}catch(l){K.addError(l),d.warning(t.formatMessage(S.paymentErrorWarning),{hasCloseButton:!0})}},i=()=>{c("/")};return e.jsx(Pe,{isOpen:!0,onClose:i,onSubmit:(f,g)=>y(f,g),isDirectFlow:!0,minimumSeats:m,billingDetails:o,promoData:u})}const tt=({isOpen:n,onClose:c,minimumSeats:p,billingDetails:T,existingAccount:m=void 0,promoData:o=void 0})=>{const t=O(),h=pe(),s=fe(),{prepareCheckoutSession:d,navigateToCheckout:a}=Se(),u=xe(t,m,s),y=async(i,f)=>{try{const g=await d({plan_name:"chatgptteamplan",team_plan_data:{workspace_name:u,price_interval:i,seat_quantity:f,existing_workspace_id:m?.id},billing_details:T,cancel_url:window.location.href,promo_campaign:i==="month"?o?.coupon:null});await a(g)}catch(g){K.addError(g),h.warning(t.formatMessage(S.paymentErrorWarning),{hasCloseButton:!0})}};return e.jsx(Pe,{isOpen:n,onClose:c,onSubmit:(i,f)=>y(i,f),minimumSeats:p,billingDetails:T,promoData:o})};export{de as B,et as T,Ze as a,tt as b,He as u};
//# sourceMappingURL=cxredmx55a5m8qjp.js.map
