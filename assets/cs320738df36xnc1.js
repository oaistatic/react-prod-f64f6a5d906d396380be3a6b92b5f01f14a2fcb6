import{e as z,b as N,j as e,M as y,r as Z}from"./gg0tb34p9fzo1omt.js";import{P as v,ia as S,d as T,G as w,c5 as b,dX as W,mx as q,cE as R,ch as O,g0 as K,co as Q,gn as X,g2 as V,bS as J,my as $,mz as Y,mA as ee,g1 as U,c2 as te,o as se,gr as oe,hj as ae,i_ as le,hr as ie,hY as ne,hk as E,mB as re,mC as ce,mD as de}from"./g670b8vtkhx0yc6d.js";import{u as ue}from"./f51c6zie1stj9anw.js";import{bV as D,bW as ge,bX as pe,bY as me,bZ as C,b_ as fe,b$ as he,c0 as Fe}from"./forbprkns1cohsbl.js";function ve({clientThreadId:t,openFileDialog:s,icon:n,isDisabled:a=!1,isSmall:l=!1,showLabel:r=!1,showUpsell:o=!1,hideBorder:h=!1,highlightTooltip:c=!1,disabledReason:g,currentModelName:F,visualTreatment:p,showMenuForNoAuth:i,modelSupportsImages:m}){const d=N(),u=S(),f=T(),M=w(f);a=(a||!!u)&&!o;const _=e.jsxs(ge,{disabled:a,$showLabel:r,$hideBorder:h,$isSmall:l,$visualTreatment:p,onClick:x=>{if(x.preventDefault(),i||o){v.logNoAuthAttachButtonClicked({location:i?"No auth file upload":"No auth upsell"});return}s()},"aria-label":pe(d,a,g,F,M),children:[n,r&&e.jsx(me,{})]}),A=e.jsx("div",{className:"flex",children:_});if(i||o){const x=i?e.jsx(fe,{openFileDialog:s,showMenuForNoAuth:!0,modelSupportsImages:m}):e.jsx(q,{location:"attach",statsig_login_event:"chatgpt_composer_upsell_login_button_clicked",statsig_signup_event:"chatgpt_composer_upsell_signup_button_clicked"}),P=e.jsx(b.BasicTrigger,{asChild:!0,children:A});return e.jsxs(b.Root,{children:[i?e.jsx(C,{clientThreadId:t,rateLimitPopup:u,highlightTooltip:c,disabled:a,children:P}):e.jsx(W,{label:e.jsx(y,{id:"wkpQmi",defaultMessage:"Upload files and more"}),side:"bottom",open:c||void 0,children:P}),e.jsx(b.Portal,{children:e.jsx(b.Content,{alignOffset:-8,side:"bottom",size:"small",className:"radix-side-bottom:flex-col-reverse flex flex-col",children:x})})]})}return e.jsx(C,{disabled:a,clientThreadId:t,rateLimitPopup:u,highlightTooltip:c,children:A})}function xe({code:t,message:s}){switch(t){case D.FileTooLarge:return I.errorFileTooLarge;case D.TooManyFiles:return v.logEvent("Uploaded Max Files Error"),I.errorTooManyFiles;default:return s}}const I=z({attachImages:{id:"PromptFilePicker.attachImages",defaultMessage:"Attach images"},attachFiles:{id:"PromptFilePicker.attachFiles",defaultMessage:"Upload files and more"},errorFileTooLarge:{id:"PromptFilePicker.errorFileTooLarge",defaultMessage:"Your file is too large. The maximum file size is {size}MB."},errorTooManyFiles:{id:"PromptFilePicker.errorTooManyFiles",defaultMessage:"You may only upload {maxNum} files at a time."},defaultFileUploadRateLimited:{id:"U5qAWP",defaultMessage:"You've reached your daily upload limit. Get ChatGPT Plus to unlock more."}}),B=z({dragInstructions:{id:"FileDropZone.dragInstructions",defaultMessage:"Add anything"},dragAllAccepted:{id:"FileDropZone.dragAllAccepted",defaultMessage:"Drop any file here to add it to the conversation"}});function Me(t){if(!t.accept||Object.keys(t.accept).length===0)return[];const s=[];return Object.values(t.accept).forEach(n=>s.push(...n)),s.sort()}function Te(t){const{className:s,children:n,clientThreadId:a,currentModelConfig:l,noKeyboard:r}=t,o=N(),h=O(),c=T(),g=se(c),p=R(c).flags?.includes(X.NoAuthEnableFileUploads),i=he(a),m=oe(),d=ae(l,i,m),u=d!==U.None,f=le(j=>j.files),M=(d===U.Multimodal?$:Y)-f.length,_=M<=0,{getGizmoId:A}=ie(),{handleFileAccepted:x}=Pe(o,d,E(l,i),"drag",A,ne(l,i)?.attachments),P=S(),k=re(!g&&p?E(l,i):ce(l,i)),{getRootProps:G,isDragActive:H}=ue({maxFiles:M,disabled:!u||_||P!=null,noClick:!0,noKeyboard:r,onDropAccepted:x,onDropRejected:j=>Ae(j,o,h,d),multiple:!0,maxSize:de,...k}),L=Me(k);return e.jsxs("div",{...G({className:s}),children:[n,H&&e.jsxs(be,{children:[e.jsx(Fe,{}),e.jsx("h3",{children:e.jsx(y,{...B.dragInstructions})}),e.jsx("h4",{className:"w-2/3 text-center",children:L.length>0?L.join(", "):e.jsx(y,{...B.dragAllAccepted})})]})]})}function Ae(t,s,n,a){const{errors:l}=t[0];l.forEach(r=>{const o=xe(r);typeof o=="string"?n.danger(o,{hasCloseButton:!0,loggingTitle:"File upload error",loggingDescription:o,toastId:"file_upload_error"}):n.danger(s.formatMessage(o,{size:ee,maxNum:a===U.Multimodal?$:Y}),{hasCloseButton:!0,loggingTitle:o.defaultMessage||"File upload error",loggingDescription:o.defaultMessage||"File upload error",toastId:"file_upload_error"})})}function Pe(t,s,n,a,l,r){const o=T(),h=R(o).flags,c=O(),g=K(),{isUnauthenticated:F}=Q(),p=h?.includes(X.NoAuthEnableFileUploads);return{handleFileAccepted:Z.useCallback(async(m,d)=>{v.logEvent("Upload File",{client:"web",eventSource:a,intent:s.toString()});const u=l!=null?await l():void 0;m.length>0&&m.forEach(f=>{V.uploadFile(g,J(f),f,s,n,t,c,{gizmoId:u,...p&&{isUnauthenticated:F}},r)})},[a,s,l,g,n,t,c,r,p,F])}}const be=te.div`absolute z-50 inset-0 flex gap-2 flex-col justify-center items-center after:contents-[""] after:absolute after:opacity-80 after:z-[-1] after:bg-token-main-surface-primary after:inset-0`;export{be as D,Te as F,ve as P,Me as g,Ae as h,Pe as u};
//# sourceMappingURL=cs320738df36xnc1.js.map
