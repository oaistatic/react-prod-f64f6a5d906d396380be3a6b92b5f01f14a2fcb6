import{kw as m,ch as R,g7 as h,g8 as g,R as S}from"./g670b8vtkhx0yc6d.js";import{N as E,h as k,r as n,j as O}from"./gg0tb34p9fzo1omt.js";import{a as T}from"./itdwpc2q0aiung3v.js";const d="chatgpt://oauth_complete";async function b(u,e,s,r){const t=await S.safeGet("/aip/p/{id}/user-settings/oauth/callback",{parameters:{path:{id:u},query:{code:e,redirect_uri:s,...r!=null?{state:r}:{}}}});return{...t,redirect_path:T(t.redirect_path).toString()}}const C=m(function(){const{pluginId:e,code:s,state:r,error:t,errorDesc:c}=E(),i=k(),l=n.useRef(!1);n.useEffect(()=>{if(l.current===!0)return;l.current=!0;async function f(){const _=`https://chat.openai.com/aip/${e}/oauth/callback`;try{const a=await b(e,s,_,r);if(a.success)if(a.redirect_path===d)window.location.href=d;else{const o=new URL(h(g.OAUTH_SUCCESS,a.redirect_path),location.origin);o.searchParams.set("oauth_success","true"),i(o.pathname+o.search+o.hash)}else i(h(g.CUSTOM_ERROR,a.redirect_path,a.error??a.message))}catch{i({pathname:"/",search:new URLSearchParams({model:"gpt-4-plugins",loginAip:e,loginSuccess:"false"}).toString()})}}f()},[e,s,r,i]);const p=R();return n.useEffect(()=>{t&&p.danger(`${t}${c?`: ${c}`:""}`,{duration:5,toastId:"oauth_callback: AIPOauth",loggingTitle:t,loggingDescription:c??""})},[t,c,p]),O.jsx("div",{})});export{C as default};
//# sourceMappingURL=f5u3xmsfw8lqe9co.js.map
