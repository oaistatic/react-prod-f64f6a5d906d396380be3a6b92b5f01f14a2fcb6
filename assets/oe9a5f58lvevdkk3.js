import{pQ as se,j2 as q,pR as ie,pS as ae,pT as le,fv as ue,fw as de,nw as G,oG as E,D as R,pU as P,pV as f,pW as I,pX as _,pY as pe,pZ as F,p_ as O,ny as ce,p$ as me,nz as Ne,f4 as B,jw as U,aG as fe,f9 as Me,q0 as he,f as ke}from"./g670b8vtkhx0yc6d.js";import{w as L,c as h,I as J,T as Q,t as xe,a as ge,b as ye,P as we,H as be,R as Ee}from"./j0nw4kv698ot3br0.js";import{M as T,N as M,S,E as Ie}from"./f76gy0b8ieo4s693.js";import{bT as X,x as Te,qk as Ae}from"./forbprkns1cohsbl.js";import{k as Y,H as w,l as Ce,m as _e}from"./gffsn29yylc5pncm.js";import{r as Se,a as ve,b as De,c as Pe,d as Oe}from"./k7lsvlcih6dj1cdg.js";import{c as Re}from"./jec2dxephizdapuu.js";import{t as Le}from"./f4wsvwai0sxxe1lf.js";class $e extends T{unistNodeName(){return"link"}static proseMirrorMarkName(){return"link"}proseMirrorMarkSpec(){return{attrs:{href:{},title:{default:null},disabled:{default:!0}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs(e){return{href:e.getAttribute("href"),title:e.getAttribute("title")}}}],toDOM(e){return["a",{...e.attrs,...e.attrs.disabled?{href:void 0}:{}}]}}}unistNodeToProseMirrorNodes({node:e,convertedChildren:t,schema:n}){const{url:r,title:s}=e;return t.map(i=>i.mark(i.marks.concat([n.marks[this.proseMirrorMarkName()].create({href:r,title:s})])))}processConvertedUnistNode(e,t){return{type:this.unistNodeName(),url:t.attrs.href,...t.attrs.title!=null&&{title:t.attrs.title},children:[e]}}}class Be extends M{unistNodeName(){return"blockquote"}static proseMirrorNodeName(){return"blockquote"}proseMirrorNodeSpec(){return{content:"block+",group:"block",parseDOM:[{tag:"blockquote"}],toDOM(){return["blockquote",0]}}}proseMirrorInputRules(e){return[L(/^\s{0,3}>\s$/,e.nodes[this.proseMirrorNodeName()])]}proseMirrorKeymap(e){return{"Mod->":se(e.nodes[this.proseMirrorNodeName()])}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:t,attrs:n}){return h(this.proseMirrorNodeName(),e,t,n)}proseMirrorNodeToUnistNodes(e,t){return[{type:this.unistNodeName(),children:t}]}}function Ue(o,e,t,n){for(let r=0;r<e.length;r++){const{$from:s,$to:i}=e[r];let a=s.depth===0?o.inlineContent&&o.type.allowsMarkType(t):!1;if(o.nodesBetween(s.pos,i.pos,(l,d)=>{if(a)return!1;a=l.inlineContent&&l.type.allowsMarkType(t)}),a)return!0}return!1}function H(o){return/^\s*/.exec(o)?.[0]?.length??0}function K(o){return/\s*$/.exec(o)?.[0]?.length??0}function He(o,e,t){for(;e>0;){const n=e-1;if(!o.rangeHasMark(n,e,t))break;e=n}return e}function Ke(o,e,t){for(;e<o.content.size&&o.rangeHasMark(e,e+1,t);)e+=1;return e}function ze(o,e,t,n=null){const{selection:r}=o;if(!(r instanceof q))return!1;const{empty:s,$cursor:i,ranges:a}=r;if(s&&!i||!Ue(o.doc,a,t))return!1;if(i)t.isInSet(o.storedMarks||i.marks())?e(o.tr.removeStoredMark(t)):e(o.tr.addStoredMark(t.create(n)));else{const l=o.tr,d=!a.some(u=>o.doc.rangeHasMark(u.$from.pos,u.$to.pos,t));for(let u=0;u<a.length;u++){const{$from:p,$to:m}=a[u];let c=p.pos,N=m.pos;const k=o.doc.textBetween(c,N,`
`);if(/^\s*$/.test(k))continue;const y=p.nodeBefore?.text??"",g=p.nodeAfter?.text??"",v=m.nodeBefore?.text??"",oe=m.nodeAfter?.text??"";if(d){const A=H(g),D=K(v);c+A<N&&(c+=A,N-=D),c=He(o.doc,c,t),N=Ke(o.doc,N,t),l.removeMark(c,N,o.schema.marks[S.proseMirrorMarkName()]),l.addMark(c,N,t.create(n))}else{const A=K(y),D=H(oe);c-=A,N+=D,l.removeMark(c,N,t)}}e(l.scrollIntoView())}return!0}function z(o,e=null){return(t,n)=>n?ze(t,n,o,e):!0}class x extends J{markType;constructor(e,t){super(e,(n,r,s,i)=>this.markHandler(n,r,s,i)),this.markType=t}static markApplies(e,t,n){for(const r of t){const{$from:s,$to:i}=r;let a=s.depth===0?e.type.allowsMarkType(n):!1;if(e.nodesBetween(s.pos,i.pos,l=>a?!1:(a=l.inlineContent&&l.type.allowsMarkType(n),!0)),a)return!0}return!1}markHandler(e,t,n,r){if(!(e.selection instanceof q))return null;const s=e.doc.resolve(n),i=e.doc.resolve(r),a=[new ie(s,i)];if(!x.markApplies(e.doc,a,this.markType))return null;const l=e.doc.nodeAt(n)?.marks.map(u=>u.type)??[];l.push(this.markType);const d=e.tr.replaceWith(n,r,this.markType.schema.text(t[1]));for(const u of l)d.addMark(d.mapping.map(n),d.mapping.map(r),u.create(null));for(const u of l)d.removeStoredMark(u);return d.insertText(t[2])}}class Ve extends T{unistNodeName(){return"strong"}static proseMirrorMarkName(){return"strong"}proseMirrorMarkSpec(){return{parseDOM:[{tag:"b"},{tag:"strong"},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}],toDOM(){return["strong"]}}}proseMirrorInputRules(e){return[new x(/\*\*([^\s](?:.*[^\s])?)\*\*([\s\S])$/,e.marks[this.proseMirrorMarkName()]),new x(/__([^\s](?:.*[^\s])?)__([\s\S])$/,e.marks[this.proseMirrorMarkName()])]}proseMirrorKeymap(e){const t=e.marks[this.proseMirrorMarkName()];return{"Mod-b":z(t),"Mod-B":z(t)}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:t,attrs:n}){return t.map(r=>r.mark(r.marks.concat([e.marks[this.proseMirrorMarkName()].create(n)])))}processConvertedUnistNode(e){return{type:this.unistNodeName(),children:[e]}}}const Z=92,We=10,C="backslashEscape";function je(o,e,t){function n(r){return r==null||r===We?(o.exit(C),e(r)):t(r)}return r=>r!==Z?t(r):(o.enter(C),o.consume(r),n)}function qe(){return{text:{[Z]:{name:C,tokenize:je}}}}function Ge(){const o=this.data();o.micromarkExtensions??=[],o.micromarkExtensions.push(qe()),o.fromMarkdownExtensions??=[],o.fromMarkdownExtensions.push({enter:{[C](e){this.enter({type:"break"},e),this.exit(e)}}})}class Fe extends M{unistNodeName(){return"break"}static proseMirrorNodeName(){return"hard_break"}proseMirrorNodeSpec(){return{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],marks:S.proseMirrorMarkName(),toDOM(){return["br"]}}}proseMirrorKeymap(e){const t=ae(le,(r,s)=>(s&&s(r.tr.replaceSelectionWith(e.nodes[this.proseMirrorNodeName()].create()).scrollIntoView()),!0)),n=ue()||de();return{"Mod-Enter":t,"Shift-Enter":t,...n&&{"Ctrl-Enter":t}}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:t,attrs:n}){return h(this.proseMirrorNodeName(),e,t,n)}proseMirrorNodeToUnistNodes(){return[{type:this.unistNodeName()}]}unifiedInitializationHook(e){return e.use(Ge)}}const Je="code_block",V="```\n";function Qe(o,e){const{start:t,end:n}=o;return t==null||n==null?null:{start:t+V.length+(e.lang??"").length,end:n-V.length}}class Xe extends M{dependencies(){return[new Q]}unistNodeName(){return"code"}static proseMirrorNodeName(){return Je}proseMirrorNodeSpec(){return{content:"text*",group:"block",code:!0,defining:!0,marks:[S.proseMirrorMarkName()].join(" "),attrs:{lang:{default:null},isDarkMode:{default:null}},parseDOM:[{tag:"pre",preserveWhitespace:"full"}],toDOM(){return["pre",["code",0]]}}}proseMirrorInputRules(e){return[xe(/^\s{0,3}```$/,e.nodes[this.proseMirrorNodeName()])]}unistNodeToProseMirrorNodes({node:e,attrs:t,schema:n}){const{lang:r}=e;return h(this.proseMirrorNodeName(),n,G(e,n,{...t,...Qe(t,e)??{}}),{lang:r,...t})}proseMirrorNodeToUnistNodes(e,t){return[{type:this.unistNodeName(),value:t.map(n=>n.type==="startend"?n.children.map(r=>r.value).join(""):n.value).join(""),lang:e.attrs.lang}]}}class Ye extends M{unistNodeName(){return"textDirective"}customDirectiveName(){return E}static proseMirrorNodeName(){return E}proseMirrorNodeSpec(){return{group:"inline",inline:!0,content:"inline*",atom:!0,attrs:{index:{default:null},displayLayout:{default:"inline"}},toDOM:e=>["span",{"data-type":"content-reference","data-content-reference-index":e.attrs.index,"data-display-layout":e.attrs.displayLayout},`:contentReference[oaicite:${e.attrs.index}]{index="${e.attrs.index}" displayLayout="${e.attrs.displayLayout}"}`],parseDOM:[{tag:'span[data-type="content-reference"]',getAttrs(e){return{index:e.getAttribute("data-index"),displayLayout:e.getAttribute("data-display-layout")||"inline"}}}]}}unistNodeToProseMirrorNodes({node:e,schema:t,convertedChildren:n}){if(!X(e)||e.name!==E||e.type!==this.unistNodeName())return R.addError("ContentReferenceExtension: unistNodeToProseMirrorNodes: node is not a directive node or name is not contentReference",e),null;const r={index:e.attributes?.index,displayLayout:e.attributes?.displayLayout??"inline"};return t.nodes.contentReference.create(r,n)}proseMirrorNodeToUnistNodes(e,t){if(t.length!==1)return console.warn("ContentReferenceExtension: proseMirrorNodeToUnistNodes: convertedChildren.length != 1",t),[];const s=[{type:"text",value:t[0].children[0].value}];return[{type:"textDirective",name:E,attributes:{index:e.attrs.index,displayLayout:e.attrs.displayLayout},children:s,data:{hName:E,hProperties:{displayLayout:e.attrs.displayLayout,index:e.attrs.index}}}]}}class Ze extends M{unistNodeName(){return"thematicBreak"}static proseMirrorNodeName(){return"horizontal_rule"}proseMirrorNodeSpec(){return{group:"block",parseDOM:[{tag:"hr"}],toDOM(){return["div",["hr"]]}}}proseMirrorInputRules(e){return[new J(/^\s{0,3}(?:\*\*\*|---|___)\n$/,(t,n,r,s)=>t.tr.replaceWith(r,s,h(this.proseMirrorNodeName(),e,[])??[]))]}proseMirrorKeymap(e){return{"Mod-_":(t,n)=>(n&&n(t.tr.replaceSelectionWith(e.nodes[this.proseMirrorNodeName()].create()).scrollIntoView()),!0)}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:t,attrs:n}){return h(this.proseMirrorNodeName(),e,t,n)}proseMirrorNodeToUnistNodes(){return[{type:this.unistNodeName()}]}}class et extends T{unistNodeName(){return"inlineCode"}static proseMirrorMarkName(){return"code"}proseMirrorMarkSpec(){return{inclusive:!1,parseDOM:[{tag:"code"}],toDOM(){return["code"]}}}proseMirrorInputRules(e){return[new x(/`([^\s](?:.*[^\s])?)`([\s\S])$/,e.marks[this.proseMirrorMarkName()])]}proseMirrorKeymap(e){const t=e.marks[this.proseMirrorMarkName()];return{"Ctrl-`":P(t)}}unistNodeToProseMirrorNodes({node:e,schema:t,attrs:n}){const r=G(e,t,n,[t.marks[this.proseMirrorMarkName()].create(n)]);return r?[r]:[]}processConvertedUnistNode(e){return{type:this.unistNodeName(),value:e.value}}}class tt extends M{unistNodeName(){return"inlineMath"}static proseMirrorNodeName(){return"inline_math"}proseMirrorNodeSpec(){return{group:"inline",inline:!0,content:"text*",atom:!0,attrs:{latex:{default:null}},parseDOM:[{tag:"span.inline-math",getAttrs(e){return{latex:e.getAttribute("latex")}}}],toDOM(){return["span",{class:"inline-math"},0]}}}unistNodeToProseMirrorNodes({node:e,schema:t,convertedChildren:n,attrs:r}){const{value:s}=e;return h(this.proseMirrorNodeName(),t,n,{...r,latex:s})}proseMirrorNodeToUnistNodes(e){return[{type:this.unistNodeName(),value:e.attrs.latex}]}}class rt extends T{unistNodeName(){return"emphasis"}static proseMirrorMarkName(){return"em"}proseMirrorMarkSpec(){return{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style",getAttrs:e=>e==="italic"&&null}],toDOM(){return["em"]}}}proseMirrorInputRules(e){try{return[new x(new RegExp("(?<!\\*)\\*([^\\s*](?:.*[^\\s])?)\\*([^*])$"),e.marks[this.proseMirrorMarkName()]),new x(new RegExp("(?<!_)_([^\\s_](?:.*[^\\s])?)_([^_])$"),e.marks[this.proseMirrorMarkName()])]}catch(t){return R.addError(t),[]}}proseMirrorKeymap(e){const t=e.marks[this.proseMirrorMarkName()];return{"Mod-i":P(t),"Mod-I":P(t)}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:t,attrs:n}){return t.map(r=>r.mark(r.marks.concat([e.marks[this.proseMirrorMarkName()].create(n)])))}processConvertedUnistNode(e){return{type:this.unistNodeName(),children:[e]}}}const b="lineEndingBlank";function W(o){return o.type===b}const nt=({startIndex:o,endIndex:e,depth:t,isLastChild:n,parent:r=null})=>{const s=e-o;return t>0&&r?.type!=="list"?s:n||o===0?s-Math.floor((s+1)/2):s-Math.floor((s-1)/2)};function ot(){const o=this.data();o.fromMarkdownExtensions??=[],o.fromMarkdownExtensions.push({enter:{lineEndingBlank(t){this.enter({type:b},t)}},exit:{lineEndingBlank(t){this.exit(t)}}});const e=(t,n=0)=>{if(!Y(t))return;const{children:r}=t;let s=0,i=null,a=null;const l=r.length;for(let d=0;d<l;d++){const u=r[d-s];e(u,n+1);const{type:p}=u,c=d===l-1&&p===b;if(p===b&&i==null?i=d:p!==b&&i!=null?a=d:c&&i!=null&&(a=d+1),i!=null&&a!=null){const N=nt({startIndex:i,endIndex:a,depth:n,isLastChild:c,parent:t});r.splice(i-s,N),i=null,a=null,s+=N}}};return t=>{e(t)}}class st extends M{unistNodeName(){return b}static proseMirrorNodeName(){return"paragraph"}proseMirrorNodeSpec(){return ge}unistNodeToProseMirrorNodes({schema:e,convertedChildren:t,attrs:n}){return h(this.proseMirrorNodeName(),e,t,n)}proseMirrorNodeToUnistNodes(e,t){return[{type:ye,children:t}]}unifiedInitializationHook(e){return e.use(ot)}}function ee(o,e=null){return function(t,n){let{$from:r,$to:s}=t.selection,i=r.blockRange(s),a=!1,l=i;if(!i)return!1;if(i.depth>=2&&r.node(i.depth-1).type.compatibleContent(o)&&i.startIndex==0){if(r.index(i.depth-1)==0)return!1;let u=t.doc.resolve(i.start-2);l=new O(u,u,i.depth),i.endIndex<i.parent.childCount&&(i=new O(r,t.doc.resolve(s.end(i.depth)),i.depth)),a=!0}let d=ce(l,o,e,i);return d?(n&&n(it(t.tr,i,d,a,o).scrollIntoView()),!0):!1}}function it(o,e,t,n,r){let s=f.empty;for(let u=t.length-1;u>=0;u--)s=f.from(t[u].type.create(t[u].attrs,s));o.step(new _(e.start-(n?2:0),e.end,e.start,e.end,new I(s,0,0),t.length,!0));let i=0;for(let u=0;u<t.length;u++)t[u].type==r&&(i=u+1);let a=t.length-i,l=e.start+t.length-(n?2:0),d=e.parent;for(let u=e.startIndex,p=e.endIndex,m=!0;u<p;u++,m=!1)!m&&F(o.doc,l,a)&&(o.split(l,a),l+=2*a),l+=d.child(u).nodeSize;return o}function at(o,e){return function(t,n){let{$from:r,$to:s,node:i}=t.selection;if(i&&i.isBlock||r.depth<2||!r.sameParent(s))return!1;let a=r.node(-1);if(a.type!=o)return!1;if(r.parent.content.size==0&&r.node(-1).childCount==r.indexAfter(-1)){if(r.depth==3||r.node(-3).type!=o||r.index(-2)!=r.node(-2).childCount-1)return!1;if(n){let p=f.empty,m=r.index(-1)?1:r.index(-2)?2:3;for(let g=r.depth-m;g>=r.depth-3;g--)p=f.from(r.node(g).copy(p));let c=r.indexAfter(-1)<r.node(-2).childCount?1:r.indexAfter(-2)<r.node(-3).childCount?2:3;p=p.append(f.from(o.createAndFill()));let N=r.before(r.depth-(m-1)),k=t.tr.replace(N,r.after(-c),new I(p,4-m,0)),y=-1;k.doc.nodesBetween(N,k.doc.content.size,(g,v)=>{if(y>-1)return!1;g.isTextblock&&g.content.size==0&&(y=v+1)}),y>-1&&k.setSelection(pe.near(k.doc.resolve(y))),n(k.scrollIntoView())}return!0}let l=s.pos==r.end()?a.contentMatchAt(0).defaultType:null,d=t.tr.delete(r.pos,s.pos),u=l?[null,{type:l}]:void 0;return F(d.doc,r.pos,2,u)?(n&&n(d.split(r.pos,2,u).scrollIntoView()),!0):!1}}function lt(o){return function(e,t){let{$from:n,$to:r}=e.selection,s=n.blockRange(r,i=>i.childCount>0&&i.firstChild.type==o);return s?t?n.node(s.depth-1).type==o?ut(e,t,o,s):dt(e,t,s):!0:!1}}function ut(o,e,t,n){let r=o.tr,s=n.end,i=n.$to.end(n.depth);s<i&&(r.step(new _(s-1,i,s,i,new I(f.from(t.create(null,n.parent.copy())),1,0),1,!0)),n=new O(r.doc.resolve(n.$from.pos),r.doc.resolve(i),n.depth));const a=me(n);if(a==null)return!1;r.lift(n,a);let l=r.mapping.map(s,-1)-1;return Ne(r.doc,l)&&r.join(l),e(r.scrollIntoView()),!0}function dt(o,e,t){let n=o.tr,r=t.parent;for(let c=t.end,N=t.endIndex-1,k=t.startIndex;N>k;N--)c-=r.child(N).nodeSize,n.delete(c-1,c+1);let s=n.doc.resolve(t.start),i=s.nodeAfter;if(n.mapping.map(t.end)!=t.start+s.nodeAfter.nodeSize)return!1;let a=t.startIndex==0,l=t.endIndex==r.childCount,d=s.node(-1),u=s.index(-1);if(!d.canReplace(u+(a?0:1),u+1,i.content.append(l?f.empty:f.from(r))))return!1;let p=s.pos,m=p+i.nodeSize;return n.step(new _(p-(a?1:0),m+(l?1:0),p+1,m-1,new I((a?f.empty:f.from(r.copy(f.empty))).append(l?f.empty:f.from(r.copy(f.empty))),a?0:1,l?0:1),a?0:1)),e(n.scrollIntoView()),!0}function pt(o){return function(e,t){let{$from:n,$to:r}=e.selection,s=n.blockRange(r,d=>d.childCount>0&&d.firstChild.type==o);if(!s)return!1;let i=s.startIndex;if(i==0)return!1;let a=s.parent,l=a.child(i-1);if(l.type!=o)return!1;if(t){let d=l.lastChild&&l.lastChild.type==a.type,u=f.from(d?o.create():null),p=new I(f.from(o.create(null,f.from(a.type.create(null,u)))),d?3:1,0),m=s.start,c=s.end;t(e.tr.step(new _(m-(d?3:1),c,m,c,p,1,!0)).scrollIntoView())}return!0}}class $ extends M{unistNodeName(){return"listItem"}static proseMirrorNodeName(){return"regular_list_item"}proseMirrorNodeSpec(){return{content:"paragraph block*",defining:!0,group:"list_item",parseDOM:[{tag:"li"}],toDOM(){return["li",0]}}}unistToProseMirrorTest(e){return e.type===this.unistNodeName()&&(!("checked"in e)||typeof e.checked!="boolean")}proseMirrorKeymap(e){const t=e.nodes[this.proseMirrorNodeName()];return{Enter:at(t),"Shift-Tab":lt(t),Tab:pt(t)}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:t,attrs:n}){return h(this.proseMirrorNodeName(),e,t,n)}proseMirrorNodeToUnistNodes(e,t){return[{type:this.unistNodeName(),children:t}]}}class ct extends M{unistNodeName(){return"math"}static proseMirrorNodeName(){return"math_block"}proseMirrorNodeSpec(){return{group:"block",content:"text*",atom:!0,code:!0,attrs:{latex:{default:null}},parseDOM:[{tag:"div.math-block",getAttrs(e){return{latex:e.getAttribute("latex")}}}],toDOM(){return["div",{class:"math-block"},0]}}}unistNodeToProseMirrorNodes({node:e,schema:t,convertedChildren:n,attrs:r}){const{value:s}=e;return h(this.proseMirrorNodeName(),t,n,{...r,latex:s})}proseMirrorNodeToUnistNodes(e){return[{type:this.unistNodeName(),value:e.attrs.latex}]}}class mt extends M{dependencies(){return[new $]}unistNodeName(){return"list"}unistToProseMirrorTest(e){return e.type===this.unistNodeName()&&e.ordered===!0}static proseMirrorNodeName(){return"ordered_list"}proseMirrorNodeSpec(){return{content:"list_item+",group:"block",attrs:{spread:{default:!1},startingNumber:{default:1}},parseDOM:[{getAttrs(e){const t=e.getAttribute("start");return{spread:e.getAttribute("data-spread")==="true",startingNumber:t!=null?parseInt(t):1}},tag:"ol"}],toDOM(e){return["ol",{"data-spread":e.attrs.spread,start:e.attrs.startingNumber},0]}}}proseMirrorInputRules(e){return[L(/^\s{0,3}(\d+)\.\s$/,e.nodes[this.proseMirrorNodeName()],t=>({startingNumber:+t[1]}),(t,n)=>n.childCount+n.attrs.startingNumber===+t[1])]}proseMirrorKeymap(e){return{"Shift-Mod-9":ee(e.nodes[this.proseMirrorNodeName()])}}unistNodeToProseMirrorNodes({node:e,schema:t,convertedChildren:n,attrs:r}){const{spread:s,start:i}=e;return h(this.proseMirrorNodeName(),t,n,{...r,spread:s,startingNumber:i??1})}proseMirrorNodeToUnistNodes(e,t){const n=e.attrs.spread;return[{type:this.unistNodeName(),ordered:!0,spread:n,start:e.attrs.startingNumber,children:t.map(r=>(r.spread=n,r))}]}}class Nt extends T{unistNodeName(){return"delete"}static proseMirrorMarkName(){return"strikethrough"}proseMirrorMarkSpec(){return{parseDOM:[{tag:"s"},{tag:"del"},{style:"text-decoration",getAttrs:e=>/(^|[\s])line-through([\s]|$)/.test(e)&&null}],toDOM(){return["s"]}}}proseMirrorInputRules(e){return[new x(/~([^\s](?:.*[^\s~])?)~([^~])$/,e.marks[this.proseMirrorMarkName()]),new x(/~~([^\s](?:.*[^\s])?)~~([\s\S])$/,e.marks[this.proseMirrorMarkName()])]}unistNodeToProseMirrorNodes({schema:e,convertedChildren:t}){return t.map(n=>n.mark(n.marks.concat([e.marks[this.proseMirrorMarkName()].create()])))}processConvertedUnistNode(e){return{type:this.unistNodeName(),children:[e]}}}function ft(){return o=>{let e=-1;function t(r,s){if(r.type==="tableRow"&&e++,r.type==="tableCell"){const i=r;i.data={...i.data??{},rowIndex:e,columnIndex:s}}}function n(r){if(Y(r))for(let s=0;s<r.children.length;s++){const i=r.children[s];t(i,s),n(i)}}n(o)}}class te extends M{unistNodeName(){return"tableCell"}unistToProseMirrorTest(e){return e.type===this.unistNodeName()}static proseMirrorNodeName(){return"table_cell"}proseMirrorNodeSpec(){return{content:"inline*",attrs:{rowIndex:{default:null},columnIndex:{default:null},colspan:{default:1},rowspan:{default:1}},tableRole:"cell",isolating:!0,parseDOM:[{tag:"td",getAttrs(e){const t=e;return{colspan:U(t.getAttribute("colspan"),1),rowspan:U(t.getAttribute("rowspan"),1)}}}],toDOM(e){const{colspan:t,rowspan:n}=e.attrs,r={colspan:t!==1?B(t,void 0):void 0,rowspan:n!==1?B(n,void 0):void 0};return[e.attrs.rowIndex==null||e.attrs.rowIndex>0?"td":"th",r,0]}}}proseMirrorInputRules(e){return[]}proseMirrorKeymap(e){return{}}unistNodeToProseMirrorNodes({node:e,schema:t,convertedChildren:n,attrs:r}){return h(this.proseMirrorNodeName(),t,n,{...r,colspan:1,rowspan:1,rowIndex:e.data?.rowIndex,columnIndex:e.data?.columnIndex})}proseMirrorNodeToUnistNodes(e,t){return[{type:this.unistNodeName(),children:t,data:{rowIndex:e.attrs.rowIndex,columnIndex:e.attrs.columnIndex}}]}}class re extends M{dependencies(){return[new te]}unistNodeName(){return"tableRow"}static proseMirrorNodeName(){return"table_row"}proseMirrorNodeSpec(){return{content:"(table_cell+)",tableRole:"row",parseDOM:[{tag:"tr"}],toDOM(){return["tr",0]}}}proseMirrorInputRules(e){return[]}proseMirrorKeymap(e){return{}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:t,attrs:n}){return h(this.proseMirrorNodeName(),e,t,n)}proseMirrorNodeToUnistNodes(e,t){return[{type:this.unistNodeName(),children:t}]}}class Mt extends M{dependencies(){return[new re]}unistNodeName(){return"table"}static proseMirrorNodeName(){return"table"}proseMirrorNodeSpec(){return{content:"(table_row+)",tableRole:"table",isolating:!0,group:"block",parseDOM:[{tag:"table"}],toDOM(){return["table",["tbody",0]]}}}proseMirrorInputRules(e){return[]}proseMirrorKeymap(e){return{}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:t,attrs:n}){return h(this.proseMirrorNodeName(),e,t,n)}proseMirrorNodeToUnistNodes(e,t){return[{type:this.unistNodeName(),align:[],children:t}]}unifiedInitializationHook(e){return e.use(ft)}}class ht extends M{dependencies(){return[new $]}unistNodeName(){return"list"}unistToProseMirrorTest(e){return e.type===this.unistNodeName()&&e.ordered!==!0}static proseMirrorNodeName(){return"list"}proseMirrorNodeSpec(){return{content:"list_item+",group:"block",attrs:{spread:{default:!1}},parseDOM:[{getAttrs(e){return{spread:e.getAttribute("data-spread")==="true"}},tag:"ul"}],toDOM(e){return["ul",{"data-spread":e.attrs.spread},0]}}}proseMirrorInputRules(e){return[L(/^\s{0,3}([-+*])\s$/,e.nodes[this.proseMirrorNodeName()])]}proseMirrorKeymap(e){return{"Shift-Mod-8":ee(e.nodes[this.proseMirrorNodeName()])}}unistNodeToProseMirrorNodes({node:e,schema:t,convertedChildren:n,attrs:r}){const{spread:s}=e;return h(this.proseMirrorNodeName(),t,n,{...r,spread:s})}proseMirrorNodeToUnistNodes(e,t){const n=e.attrs.spread;return[{type:this.unistNodeName(),ordered:!1,spread:n,children:t.map(r=>(r.spread=n,r))}]}}function j(o,e){if(!(o==null||e==null))return{start:{...o},end:{...e}}}const kt=()=>o=>{Te(o,"list",(e,t,n)=>{if(n==null||t==null)return;const r=[];let s=[],i=0;for(;i<e.children.length;){const a=e.children[i];if(W(a)){const l=[];for(;i<e.children.length&&W(e.children[i]);)l.push(e.children[i]),i++;if(s.length===0)throw new Error("Unexpected state: currentListItems is empty after encountering blank lines.");const d=s[0],u=fe(Me(s)),p=j(d.position?.start??e.position?.start,u.position?.end??e.position?.end),m={type:"list",ordered:e.ordered,start:e.start,spread:e.spread,children:s,position:p};r.push(m),s=[],r.push(...l.map(c=>({type:"lineEndingBlank",position:c.position})))}else s.push(a),i++}if(s.length>0){const a=s[0],l=s[s.length-1],d=j(a.position?.start??e.position?.start,l.position?.end??e.position?.end),u={type:"list",ordered:e.ordered,start:e.start,spread:e.spread,children:s,position:d};r.push(u)}n.children.splice(t,1,...r)})};class xt extends M{unistNodeName(){return"textDirective"}customDirectiveName(){return w}static proseMirrorNodeName(){return w}proseMirrorNodeSpec(){return{group:"inline",inline:!0,atom:!0,selectable:!1,attrs:{timestamp:{default:null}},toDOM:e=>["span",{"data-type":"hive-log","data-timestamp":e.attrs.timestamp}],parseDOM:[{tag:'span[data-type="hive-log"]',getAttrs(e){return{timestamp:e.getAttribute("data-timestamp")}}}]}}unistNodeToProseMirrorNodes({node:e,schema:t,convertedChildren:n}){if(!X(e)||e.name!==w||e.type!==this.unistNodeName())return R.addError("HiveLogExtension: unistNodeToProseMirrorNodes: node is not a directive node or name is not HIVE_LOG_DIRECTIVE_NAME",e),null;const r={timestamp:e.attributes?.timestamp??null};return t.nodes[w].create(r,n)}proseMirrorNodeToUnistNodes(e){return[{type:"textDirective",name:w,attributes:{timestamp:e.attrs.timestamp},children:[],data:{hName:w,hProperties:{timestamp:e.attrs.timestamp}}}]}}const gt=(o,e,t,n)=>o.children.map(r=>t.handle(r,void 0,t,n)).join(""),yt=(o,e,t,n)=>t.safe(o.value,n).replaceAll("\\[","[").replaceAll("\\&","&"),wt=o=>`\\(${o.value}\\)`;function bt(){const o=this;o.compiler=e;function e(t){return Le(t,{...o.data("settings"),fences:!0,bullet:"-",bulletOther:"*",listItemIndent:"one",resourceLink:!0,tightDefinitions:!0,rule:"-",handlers:{text:yt,startend:gt,inlineMath:wt},extensions:o.data("toMarkdownExtensions")||[]})}}const ne=[Ae,Se,[ve,{singleDollarTextMath:!1}],De,Pe,Oe,Ce,kt,bt,_e];class Et extends Ie{dependencies(){const e=he(ke());return[new st,new we,new Be,new Ve,new Fe,new Xe,new be,new Ze,new et,new tt,new ct,new rt,new $e,new $,new mt,new Ee,new Q,new ht,new Nt,new S,new Mt,new re,new te,...e?[new Ye]:[],...Re()?[new xt]:[]]}unifiedInitializationHook(e){return e.use(ne)}}const Pt=Object.freeze(Object.defineProperty({__proto__:null,CANVAS_REMARK_PLUGINS:ne,MarkdownExtension:Et},Symbol.toStringTag,{value:"Module"}));export{Ve as B,Ye as C,rt as I,$e as L,Et as M,Je as a,Xe as b,Pt as p,ze as t};
//# sourceMappingURL=oe9a5f58lvevdkk3.js.map
