import{mc as j,ch as w,c6 as y,kw as b}from"./g670b8vtkhx0yc6d.js";import{O as M,j as n,ai as k,b as C,h as N,u as A,a as F,M as u}from"./gg0tb34p9fzo1omt.js";import{bP as P}from"./forbprkns1cohsbl.js";import{R as W,I as r,S as l}from"./gg2pnagosqtjj3o6.js";import{E as R,R as T,g as U}from"./ozskczphry8ftt9p.js";import{u as O}from"./in4vq4r5bpli843p.js";import{d as D,W as I,a as B,e as L}from"./nir0q9e2l94u37hi.js";import{W as $}from"./gltmx7p7ryx2z3jy.js";import"./bg3lnoqnod0uwuhc.js";import"./o1efssv80j1s2jn6.js";import"./mu0w85wyyiji3bj8.js";import"./eyn5f5xfm2iythcf.js";import"./lptwpbjabrvjmhsj.js";import"./jnf6ovox5e5qitwu.js";import"./iot1vlqga29hiiwl.js";import"./h431y4zi2z7ivdmh.js";import"./ogvupmk4xezkmrqf.js";import"./juuj7s9t3x7u9it2.js";import"./go2lz3yja1ixfdzl.js";import"./btvken3m81tjj676.js";import"./cnl9n9geu2oxb8o4.js";import"./f4wsvwai0sxxe1lf.js";import"./cf441rgiwd88s4mv.js";import"./fz8lyjvdpywhlf94.js";import"./cs320738df36xnc1.js";import"./f51c6zie1stj9anw.js";import"./jpdmr6hprcjyd5ie.js";import"./me58wahxzwibdrxp.js";import"./pnx8yl9r7yj5moem.js";import"./felxwdrg3fgsr1mu.js";import"./e3erq0emp0cqk1ou.js";import"./eqymi4bdej7dbca6.js";import"./ds557awgotgdm7n4.js";import"./c7q67liujwt03fxw.js";function q(){const{environmentId:s}=M(),{eligible:i}=P();return i?n.jsx(k,{to:"/codex/onboarding"}):s?n.jsx(z,{environmentId:s}):n.jsx(j,{})}function z({environmentId:s}){const i=C(),o=w(),g=N(),m=A(),{data:e,isLoading:h,isError:v}=D(s),c=e?.secrets??{},x=O()?"workspace":"private",{mutate:E,isPending:_}=F({mutationFn:t=>I.updateEnvironment(s,t),onSuccess:async t=>{await B(m,s),L(m,s,t),o.success(i.formatMessage({id:"wham.editEnvironment.environmentUpdatedSuccessfully",defaultMessage:"Environment updated successfully"})),g(`/codex/settings/environment/${s}`)},onError:()=>{o.danger({id:"wham.editEnvironment.failedToUpdateEnvironment",defaultMessage:"Failed to update environment",description:"Toast to show when an environment is updated unsuccessfully"},{toastId:"wham_edit_environment_failed_to_update_environment"})}});function f(t){const a=U(t.secrets,c),S=t.envVars.reduce((d,p)=>(d[p.key]=p.value,d),{});E({label:t.label,repos:[t.repositoryId],machine_id:t.machine,setup:t.setupCommands,maintenance_setup:t.maintenanceSetupCommands,workspace_dir:t.workspaceDirectory,agent_network_access:t.agentNetworkAccess,description:t.description,share_settings:t.share_settings,secrets:a,env_vars:S,auto_setup_settings:t.autoSetupSettings,cache_settings:t.cacheSettings})}return n.jsx($,{flex:!0,hideBorder:!0,showSidebar:!1,maxWidth:"w-full",children:h?n.jsx("div",{className:"flex h-full items-center justify-center",children:n.jsx(y,{})}):v?n.jsx("div",{className:"flex h-full items-center justify-center",children:n.jsx(u,{id:"wham.editEnvironment.errorLoadingEnvironment",defaultMessage:"Error loading environment"})}):e?n.jsxs(n.Fragment,{children:[n.jsxs(W,{className:"sticky top-0 px-4",children:[n.jsx(r,{label:i.formatMessage({id:"wham.editEnvironment.environments",defaultMessage:"Environments"}),url:"/codex/settings/environments",className:"text-token-text-tertiary"}),n.jsx(l,{}),n.jsx(r,{label:e.label,url:`/codex/settings/environment/${s}`,className:"font-medium"}),n.jsx(l,{}),n.jsx(r,{label:i.formatMessage({id:"wham.editEnvironment.edit",defaultMessage:"edit"}),className:"text-token-text-tertiary"})]}),n.jsx(R,{initialEnvironmentId:s,existingEnvironment:e,initialValues:{label:e?.label,description:e?.description??"",share_settings:e?.share_settings??x,machine:e?.machine_id,repositoryId:e?.repos[0],workspaceDirectory:e?.workspace_dir??"",agentNetworkAccess:e?.agent_network_access,setupCommands:e?.setup?Array.isArray(e?.setup)?e.setup.join(`
`):e.setup:"",maintenanceSetupCommands:e?.maintenance_setup?Array.isArray(e?.maintenance_setup)?e.maintenance_setup.join(`
`):e.maintenance_setup:"",envVars:Object.entries(e?.env_vars??{}).map(([t,a])=>({key:t,value:a})),secrets:Object.keys(c).map(t=>({key:t,value:T,isEditing:!1})),autoSetupSettings:e?.auto_setup_settings,cacheSettings:e?.cache_settings},primaryButtonText:i.formatMessage({id:"wham.editEnvironment.saveEnvironment",defaultMessage:"Save environment"}),onSubmit:f,isPending:_})]}):n.jsx("div",{className:"flex h-full items-center justify-center",children:n.jsx(u,{id:"wham.editEnvironment.environmentNotFound",defaultMessage:"Environment not found"})})})}const Me=()=>[{title:"Codex"}],ke=b(function(){return n.jsx(q,{})});export{ke as default,Me as meta};
//# sourceMappingURL=mk1n9483tdqu24y5.js.map
