import{r as g,j as p,b as T}from"./gg0tb34p9fzo1omt.js";import{f9 as M,ay as l,az as d,d as C,m as x,q as k}from"./g670b8vtkhx0yc6d.js";import{CoTChunks as _}from"./boxnw5q9j0f8jknp.js";import{gA as m}from"./forbprkns1cohsbl.js";import"./mwnvv8c9o4042bbu.js";import"./cg8klfuw4d9cqove.js";import"./cf441rgiwd88s4mv.js";import"./cx1v46pslsfvescw.js";import"./kw9y0llxx8k2et57.js";import"./hb16nhh4rqym397l.js";import"./be6sa05e05n18ich.js";import"./pbl95wx6493wq92j.js";import"./c7q67liujwt03fxw.js";import"./el6s6dnz325xncpm.js";import"./h0k3jyicolebvgjn.js";import"./ksqri1osv1y7da34.js";const y=(e,t)=>{if(t<=1)return e.formatMessage({id:"ZxhUq1",defaultMessage:"a second"});if(t<3)return e.formatMessage({id:"4GD7tD",defaultMessage:"a couple of seconds"});if(t<4)return e.formatMessage({id:"jx5V1u",defaultMessage:"a few seconds"});if(t>=60){const o=Math.floor(t/60),n=t%60;return`${o}m ${n}s`}return e.formatMessage({id:"p4/pTg",defaultMessage:"{seconds} seconds"},{seconds:t})},E=e=>{let t=0;for(const o of e)t+=o.metadata?.finished_duration_sec??0;return t},R=(e,t,o)=>t.length>1?e.formatMessage({id:"sdDgmZ",defaultMessage:"Thought for {timing}"},{timing:y(e,o)}):M(t)?.metadata?.finished_text??"",I=(e,t,o=!1)=>{const n=[];let s={type:m.Thought,thought:{summary:"",content:""}};const i=()=>{s.thought.content.trim()&&(n.push(s),s={type:m.Thought,thought:{summary:s.thought.summary,content:""}})},u=e.split(/( {2}\n)|(\n\n)/).filter(a=>a!=null&&a.trim());if(!o&&u.length<2)return n;let c=!1;for(let a=0;a<u.length;a++){const r=u[a].trim();if(r.toLowerCase()==="none"){l.count(d.COT_SUMMARIZER,"num_none_chunks");continue}const f=r.match(/^\*\*(.*)\*\*$/);if(f)i(),s.thought.summary=f[1]??"";else if(r){if(r.startsWith("```")){if(c){s.thought.content+=s.thought.content?`
${r}`:r,i(),c=!1;continue}i(),c=!0}s.thought.content.trim()&&!r.startsWith("\\[")&&!r.startsWith("\\(")&&!c&&i(),s.thought.content+=s.thought.content?`
${r}`:r}}return s?.thought.content.trim()&&n.push(s),o&&t&&n.push({type:m.Recap,content:t}),n},S=(e,t,o)=>{const n=!o,s=g.useMemo(()=>I(e,t,n),[e,t,n]);return g.useEffect(()=>{n&&l.hist(d.COT_SUMMARIZER,"num_cot_chunks",void 0,s.length)},[n]),s},A=({isStreaming:e,finishedText:t,summaryText:o,isFinalAssistantTurn:n})=>{const s=S(o,t,e);return p.jsx(_,{isStreaming:e,isFinalAssistantTurn:n,chunks:s})},N=8,O=`

`,V=({messages:e,isStreaming:t,isFinalAssistantTurn:o})=>{const n=T(),s=C(),i=x(s,"1214379119"),u=E(e);let c="";return e.forEach(a=>{const h=k(a);c+=c?O+h:h}),i&&!t&&!c&&u<N?null:p.jsx(A,{finishedText:R(n,e,u),summaryText:c,isStreaming:t,isFinalAssistantTurn:o})};export{A as LegacyCoT,V as LegacyCoTMessage};
//# sourceMappingURL=h06rxblke1f4s377.js.map
