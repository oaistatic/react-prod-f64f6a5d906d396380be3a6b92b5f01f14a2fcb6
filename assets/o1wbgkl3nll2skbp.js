import{ch as E,be as D,cY as h,bU as F,mc as L,cG as I,cD as z,d as G,m as x,c6 as U,dX as v,bg as g,gG as V,kw as X}from"./g670b8vtkhx0yc6d.js";import{b as M,u as Y,h as P,a as N,j as e,M as n,O as $,ai as q,r as j,al as H}from"./gg0tb34p9fzo1omt.js";import{bP as Q,hN as Z}from"./forbprkns1cohsbl.js";import{R as J,I as b,S as K}from"./gg2pnagosqtjj3o6.js";import{u as ee}from"./in4vq4r5bpli843p.js";import{W as _,r as te,i as ae,j as se,d as ne}from"./nir0q9e2l94u37hi.js";import{E as ie}from"./kud4vpweue7x58m2.js";import{W as oe}from"./e3erq0emp0cqk1ou.js";import{P as re,a as le}from"./lptwpbjabrvjmhsj.js";import{W as me}from"./gltmx7p7ryx2z3jy.js";import"./cnl9n9geu2oxb8o4.js";import"./f4wsvwai0sxxe1lf.js";import"./cf441rgiwd88s4mv.js";import"./fz8lyjvdpywhlf94.js";import"./cs320738df36xnc1.js";import"./f51c6zie1stj9anw.js";import"./jpdmr6hprcjyd5ie.js";import"./me58wahxzwibdrxp.js";import"./pnx8yl9r7yj5moem.js";import"./felxwdrg3fgsr1mu.js";import"./eqymi4bdej7dbca6.js";import"./ds557awgotgdm7n4.js";import"./c7q67liujwt03fxw.js";import"./ogvupmk4xezkmrqf.js";import"./juuj7s9t3x7u9it2.js";function de({environmentId:s,onClose:t}){const i=M(),r=E(),l=Y(),m=P(),{mutate:c,isPending:f}=N({mutationFn:()=>_.deleteEnvironment(s),onSuccess:async()=>{te(l,s),await ae(l),r.success(i.formatMessage({id:"wham.deleteEnvironmentModal.environmentDeletedSuccessfully",defaultMessage:"Environment deleted successfully"})),t(),m("/codex/settings/environments")},onError:()=>{r.danger(i.formatMessage({id:"wham.deleteEnvironmentModal.failedToDeleteEnvironment",defaultMessage:"Failed to delete environment"}))}});return e.jsx(D,{testId:"modal-wham-delete-environment",isOpen:!0,type:"danger",title:e.jsx(n,{id:"wham.deleteEnvironmentModal.title",defaultMessage:"Delete environment"}),onClose:t,primaryButton:e.jsx(h.Button,{title:i.formatMessage({id:"wham.deleteEnvironmentModal.delete",defaultMessage:"Delete"}),color:"danger",loading:f,onClick:()=>{c()}}),secondaryButton:e.jsx(h.Button,{title:i.formatMessage({id:"wham.deleteEnvironmentModal.cancel",defaultMessage:"Cancel"}),color:"secondary",onClick:t}),children:e.jsx("div",{className:"text-sm",children:e.jsx(n,{id:"wham.deleteEnvironmentModal.message",defaultMessage:"Tasks that use it will remain, but users wonâ€™t be able to create follow-up tasks."})})})}function o({label:s,children:t,className:i}){return e.jsxs("div",{className:F("flex flex-col gap-1",i),children:[e.jsx("dt",{className:"text-token-text-primary text-sm font-medium",children:s}),e.jsx("dd",{className:"text-token-text-primary text-sm font-normal",children:t})]})}function ce({environmentId:s,onClose:t}){const i=M(),r=E(),{mutate:l,isPending:m}=N({mutationFn:()=>_.invalidateEnvironmentCache(s),onSuccess:()=>{r.success(i.formatMessage({id:"wham.resetCacheModal.cacheResetSuccessfully",defaultMessage:"Cache reset successfully"})),t()},onError:()=>{r.danger(i.formatMessage({id:"wham.resetCacheModal.failedToResetCache",defaultMessage:"Failed to reset cache"}))}});return e.jsx(D,{testId:"modal-wham-delete-environment",isOpen:!0,type:"danger",title:e.jsx(n,{id:"wham.resetEnvironmentCacheModal.title",defaultMessage:"Reset cache"}),onClose:t,primaryButton:e.jsx(h.Button,{title:i.formatMessage({id:"wham.resetEnvironmentCacheModal.delete",defaultMessage:"Reset"}),color:"danger",loading:m,onClick:()=>{l()}}),secondaryButton:e.jsx(h.Button,{title:i.formatMessage({id:"wham.resetEnvironmentCacheModal.cancel",defaultMessage:"Cancel"}),color:"secondary",onClick:t}),children:e.jsx("div",{className:"text-sm",children:e.jsx(n,{id:"wham.resetEnvironmentCacheModal.message",defaultMessage:"All currently cached containers will be invalidated. The cache will be cleared for all users."})})})}function ue(){const{environmentId:s}=$(),{eligible:t}=Q();return t?e.jsx(q,{to:"/codex/onboarding"}):s?e.jsx(he,{environmentId:s}):e.jsx(L,{})}function ge(s){return s==null||s.setup==null?!1:Array.isArray(s.setup)?s.setup.length>0&&s.setup.every(t=>t!==""):s.setup!==""}function he({environmentId:s}){const t=M(),i=P(),[r,l]=j.useState(!1),[m,c]=j.useState(!1),f=se(d=>d.setEnvironmentId),{data:a,isLoading:k,isError:y}=ne(s),w=I(),u=w&&a&&a.creator.email===w.email,C=z(),S=ee(),A=C?.name??t.formatMessage({id:"wham.environmentDetailsPage.workspace",defaultMessage:"Workspace"}),p=G(),O=x(p,"2134057841"),R=x(p,"1535847699"),B=x(p,"3899518838"),W=!ge(a)&&a?.auto_setup_settings==null,T=a?.auto_setup_settings?.use_auto_setup??W;return e.jsxs(me,{topPadding:!0,showSidebar:!1,children:[e.jsx("div",{className:"flex flex-col px-8 md:px-16",children:k?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(U,{})}):y?e.jsx(ie,{title:t.formatMessage({id:"wham.environmentDetailsPage.errorLoadingEnvironment",defaultMessage:"Error loading environment"}),description:t.formatMessage({id:"wham.environmentDetailsPage.errorLoadingEnvironmentDescription",defaultMessage:"Error loading environment description"})}):a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border-token-border-default flex flex-col justify-between gap-2 border-b pb-4",children:e.jsxs("div",{className:"flex flex-row items-center justify-between",children:[e.jsxs(J,{children:[e.jsx(b,{label:t.formatMessage({id:"wham.environmentDetailsPage.environments",defaultMessage:"Environments"}),url:"/codex/settings/environments",className:"text-token-text-tertiary"}),e.jsx(K,{}),e.jsx(b,{label:a.label,url:`/codex/settings/environment/${s}`,className:"text-token-text-primary font-medium"})]}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx(v,{label:u?void 0:t.formatMessage({id:"wham.environmentDetailsPage.deleteEnvironmentTooltip",defaultMessage:"You cannot delete an environment that you did not create"}),children:e.jsx(g,{color:"danger-outline",onClick:()=>l(!0),disabled:!u,"aria-label":t.formatMessage({id:"wham.environmentDetailsPage.deleteEnvironmentAriaLabel",defaultMessage:"Button to delete {environmentName}"},{environmentName:a.label}),children:e.jsx(n,{id:"wham.environmentDetailsPage.deleteEnvironment",defaultMessage:"Delete"})})}),e.jsx(v,{label:u?void 0:t.formatMessage({id:"wham.environmentDetailsPage.editEnvironmentTooltip",defaultMessage:"You cannot edit an environment that you did not create"}),children:e.jsx(g,{icon:Z,onClick:()=>{i(`/codex/settings/environment/${s}/edit`)},color:"secondary",disabled:!u,"aria-label":t.formatMessage({id:"wham.environmentDetailsPage.editEnvironmentAriaLabel",defaultMessage:"Button to edit {environmentName}"},{environmentName:a.label}),children:e.jsx(n,{id:"wham.environmentDetailsPage.editEnvironment",defaultMessage:"Edit"})})}),e.jsx(g,{size:"small",color:"secondary",onClick:()=>{f(s),oe.recordClickEnv(),i("/codex")},"aria-label":t.formatMessage({id:"wham.environmentDetailsPage.useEnvironmentAriaLabel",defaultMessage:"Button to use environment {environmentName} in a codex task"},{environmentName:a.label}),children:e.jsxs("div",{className:"flex items-center gap-0.5",children:[e.jsx(n,{id:"wham.turnInfoRow.useEnvironment",defaultMessage:"Use this"}),e.jsx(V,{className:"icon-sm"})]})})]})]})}),e.jsx("div",{className:"text-token-text-primary py-8 text-xl",children:a.label}),e.jsxs("div",{className:"grid gap-x-12 gap-y-6 md:grid-cols-2",children:[e.jsx(o,{label:t.formatMessage({id:"wham.environmentDetailsPage.creator",defaultMessage:"Creator"}),children:a.creator.email}),e.jsx(o,{label:t.formatMessage({id:"wham.environmentDetailsPage.image",defaultMessage:"Image"}),children:a.machine.label||e.jsx(n,{id:"wham.environmentDetailsPage.noImage",defaultMessage:"No image"})}),e.jsx(o,{label:t.formatMessage({id:"wham.environmentDetailsPage.description",defaultMessage:"Description"}),children:a.description??e.jsx(n,{id:"wham.environmentDetailsPage.noDescription",defaultMessage:"N/A"})}),O&&e.jsx(o,{label:t.formatMessage({id:"wham.environmentDetailsPage.agentNetworkAccess",defaultMessage:"Agent internet access"}),children:a.agent_network_access?.mode==="on"?a.agent_network_access.preset_allowlist===re?e.jsx(n,{id:"wham.environmentDetailsPage.agentNetworkAccess.unrestricted",defaultMessage:"On: unrestricted"}):a.agent_network_access.preset_allowlist===le?e.jsx(n,{id:"wham.environmentDetailsPage.agentNetworkAccess.codex",defaultMessage:"On: common dependencies"}):e.jsx(n,{id:"wham.environmentDetailsPage.agentNetworkAccess.custom",defaultMessage:"On: custom domains"}):a.agent_network_access==null||a.agent_network_access.mode==="off"?e.jsx(n,{id:"wham.environmentDetailsPage.agentNetworkAccess.off",defaultMessage:"Off"}):null}),B&&e.jsxs(e.Fragment,{children:[e.jsx(o,{label:t.formatMessage({id:"wham.environmentDetailsPage.postSetupCaching",defaultMessage:"Post setup caching"}),children:e.jsxs("div",{className:"flex items-center gap-2",children:[a.cache_settings?.post_setup_cache_enabled===!0?e.jsx(n,{id:"wham.environmentDetailsPage.postSetupCaching.on",defaultMessage:"On"}):e.jsx(n,{id:"wham.environmentDetailsPage.postSetupCaching.off",defaultMessage:"Off"}),a.cache_settings?.post_setup_cache_enabled&&e.jsx(v,{label:t.formatMessage({id:"wham.environmentDetailsPage.resetCacheTooltip",defaultMessage:"Invalidate any currently cached containers"}),children:e.jsx(g,{size:"small",onClick:()=>c(!0),color:"secondary","aria-label":t.formatMessage({id:"wham.environmentDetailsPage.resetCacheAriaLabel",defaultMessage:"Button to invalidate cache for {environmentName}"},{environmentName:a.label}),children:e.jsx(n,{id:"wham.environmentDetailsPage.resetCache",defaultMessage:"Reset cache"})})})]})}),a.cache_settings?.post_setup_cache_enabled&&e.jsx(o,{label:t.formatMessage({id:"wham.environmentDetailsPage.maintenanceSetupScript",defaultMessage:"Maintenance setup script"}),children:e.jsx("pre",{className:"mono text-xs leading-5 break-all whitespace-pre-wrap",children:(Array.isArray(a.maintenance_setup)?a.maintenance_setup:[a.maintenance_setup]).filter(Boolean).join(`
`)})})]}),e.jsx(o,{label:t.formatMessage({id:"wham.environmentDetailsPage.environmentVariables",defaultMessage:"Environment variables"}),children:e.jsx("pre",{className:"mono text-xs leading-5 break-all whitespace-pre-wrap",children:Object.keys(a.env_vars??{}).filter(d=>!d.startsWith("CODEX_ENV_")).join(`
`)})}),e.jsx(o,{label:t.formatMessage({id:"wham.environmentDetailsPage.secrets",defaultMessage:"Secrets"}),children:e.jsx("pre",{className:"mono text-xs leading-5 break-all whitespace-pre-wrap",children:Object.keys(a.secrets??{}).join(`
`)})}),e.jsx(o,{label:t.formatMessage({id:"wham.environmentDetailsPage.createdAt",defaultMessage:"Created at"}),children:a.created_at?e.jsx(H,{value:new Date(a.created_at*1e3),year:"numeric",month:"long",day:"numeric"}):e.jsx(n,{id:"wham.environmentDetailsPage.noCreationDate",defaultMessage:"No creation date"})}),e.jsx(o,{label:t.formatMessage({id:"wham.environmentDetailsPage.setupScript",defaultMessage:"Setup script"}),children:R&&T?e.jsx(n,{id:"wham.environmentDetailsPage.autoSetup.automatic",defaultMessage:"Automatic"}):e.jsx("pre",{className:"mono text-xs leading-5 break-all whitespace-pre-wrap",children:(Array.isArray(a.setup)?a.setup:[a.setup]).filter(Boolean).join(`
`)})}),e.jsx(o,{label:t.formatMessage({id:"wham.environmentDetailsPage.repository",defaultMessage:"Repository"}),children:a.repo_map?Object.values(a.repo_map).map(d=>d.repository_full_name):e.jsx(n,{id:"wham.environmentDetailsPage.noRepository",defaultMessage:"No repository"})}),e.jsx(o,{label:t.formatMessage({id:"wham.environmentDetailsPage.numTasks",defaultMessage:"No. of tasks"}),children:a.task_count??0}),S&&e.jsx(o,{label:t.formatMessage({id:"94ZVks",defaultMessage:"Share"}),children:a.share_settings==="workspace"?t.formatMessage({id:"wham.environmentDetailsPage.sharedWithWorkspace",defaultMessage:"Shared with {workspaceName}"},{workspaceName:A}):t.formatMessage({id:"wham.environmentDetailsPage.private",defaultMessage:"Private"})})]})]}):e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(n,{id:"wham.environmentDetailsPage.environmentNotFound",defaultMessage:"Environment not found"})})}),r&&e.jsx(de,{environmentId:s,onClose:()=>l(!1)}),m&&e.jsx(ce,{environmentId:s,onClose:()=>c(!1)})]})}const ze=()=>[{title:"Codex"}],Ge=X(function(){return e.jsx(ue,{})});export{Ge as default,ze as meta};
//# sourceMappingURL=o1wbgkl3nll2skbp.js.map
