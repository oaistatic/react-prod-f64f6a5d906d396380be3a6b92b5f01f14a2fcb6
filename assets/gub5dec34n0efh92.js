import{r as d,j as e,e as de,M as l,L as te,b as Z,u as qt,f as ve,h as mt,o as Kt,l as Jt,aq as Qt}from"./gg0tb34p9fzo1omt.js";import{P as f,bg as ae,p1 as Zt,H as y,F as Je,d as ue,m as Pe,bU as I,p2 as Qe,be as me,dn as Xt,cY as ot,p3 as Le,da as pt,db as gt,dc as ft,dd as ht,dg as yt,n as ea,ch as je,cD as ta,ky as Mt,S as it,ar as Ve,ad as ze,c6 as Re,eW as Me,dv as aa,o as sa,p4 as na,mT as ye,ha as xe,p5 as oa,p6 as xt,p7 as _t,p8 as bt,dX as Ce,p9 as Ze,b1 as q,pa as ia,oi as ra,oj as la,R as Ct,cF as Xe,bf as ca,G as da,b6 as Se,de as ua,gS as Pt,cl as ma,dj as pa,pb as ga,D as St,e0 as vt,gJ as fa,cO as ha,dh as ya,pc as Ma,gT as xa,ay as _a,az as ba}from"./g670b8vtkhx0yc6d.js";import{S as Ca}from"./eyn5f5xfm2iythcf.js";import{oI as Pa,oJ as Ge,oK as pe,p as $e,o as qe,n as Ke,oL as Sa,lo as va,oM as ja,oN as jt,oO as Q,oP as ka,l as wa,oQ as Fe,j4 as Ea,oR as Ne,oS as Ae,k as Ta,nv as kt,a3 as Na,a4 as Aa,bR as Ia,oT as Da,cz as Ua,cA as Oa,cJ as La,oU as Ra,oV as rt}from"./forbprkns1cohsbl.js";import{u as wt}from"./bckf7qgfy3ojc3v4.js";import{u as Et}from"./j8pmm8m4sd7eamqj.js";import{C as lt}from"./in9skfbx4r8neufs.js";import{S as Fa}from"./i76lgy5ukiiex68z.js";import{a as Ba,b as Ga,M as Ha}from"./pnx8yl9r7yj5moem.js";const Ya=t=>d.createElement("svg",{width:21,height:20,viewBox:"0 0 21 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},d.createElement("path",{d:"M10.2441 10.7759C12.7597 10.8965 14.8838 12.8648 14.8838 15.0601C14.8838 15.4273 14.586 15.7251 14.2188 15.7251H5.78125C5.41399 15.7251 5.11623 15.4273 5.11621 15.0601C5.11621 12.7959 7.37906 10.77 10 10.77L10.2441 10.7759Z"}),d.createElement("path",{d:"M0 14.436C0 11.5616 3.13043 10.5652 5.2998 11.4478C4.37179 12.4185 3.78619 13.6736 3.78613 15.0601L3.78809 15.1011H0.665039C0.298096 15.1011 0.000527744 14.8029 0 14.436Z"}),d.createElement("path",{d:"M14.7988 11.5532C16.969 10.4969 20.3301 11.4561 20.3301 14.436C20.3295 14.8029 20.032 15.1011 19.665 15.1011H16.2119L16.2139 15.0601C16.2138 13.7223 15.6689 12.5079 14.7988 11.5532Z"}),d.createElement("path",{d:"M3.4248 5.00146C4.85516 5.00146 6.01454 6.16098 6.01465 7.59131C6.01454 9.02164 4.85516 10.1812 3.4248 10.1812C1.99454 10.181 0.835068 9.02157 0.834961 7.59131C0.835066 6.16105 1.99454 5.00157 3.4248 5.00146Z"}),d.createElement("path",{d:"M16.5703 5.00146C18.0006 5.00157 19.1601 6.16105 19.1602 7.59131C19.16 9.02157 18.0006 10.181 16.5703 10.1812C15.14 10.1812 13.9806 9.02164 13.9805 7.59131C13.9806 6.16098 15.14 5.00146 16.5703 5.00146Z"}),d.createElement("path",{d:"M10 4.27002C11.6099 4.27002 12.915 5.57515 12.915 7.18506C12.915 8.79497 11.6099 10.1001 10 10.1001C8.39009 10.1001 7.08496 8.79497 7.08496 7.18506C7.08496 5.57515 8.39009 4.27002 10 4.27002Z"}));function Wa({value:t,onChange:s}){return e.jsx(Ca,{value:t,onChange:s,ariaLabel:be.toggleArialabel,leftItem:{ariaLabel:be.togglePersonalArialabel,label:be.togglePersonalLabel,value:"personal"},rightItem:{ariaLabel:be.toggleBusinessArialabel,label:be.toggleBusinessLabel,value:"business"}})}const be=de({toggleArialabel:{id:"U4v2Gf",defaultMessage:"Toggle for switching between Personal and Business plans"},togglePersonalArialabel:{id:"6Wikht",defaultMessage:"Toggle for switching to Personal plans"},toggleBusinessArialabel:{id:"uzlEV0",defaultMessage:"Toggle for switching to Business plans"},togglePersonalLabel:{id:"cGDsaD",defaultMessage:"Personal"},toggleBusinessLabel:{id:"sgisa2",defaultMessage:"Business"}}),et=()=>{f.logEvent("Account Portal: Click Get Help")};function Va(t){if(Zt(t))return"secondary";switch(t){case y.FREE:return"green";case y.GO:return"green";case y.PLUS:return"green";case y.TEAM:return"primary";case y.PRO:return"primary"}}function Ue({isCurrentPlan:t=!1,planType:s,disabled:a,loading:o=!1,onClick:n,children:r,testId:i,activeColor:c,...u}){return e.jsx(ae,{fullWidth:!0,size:"large",color:t?"secondary":c||Va(s),disabled:a,loading:o,onClick:n,"data-testid":i,className:a?"bg-token-sidebar-surface-tertiary text-token-text-primary hover:bg-token-sidebar-surface-tertiary dark:bg-token-text-tertiary border-none font-semibold":"font-semibold",...u,children:r})}function tt(t,s){const[a,o]=d.useState(!1);d.useEffect(()=>{if(!a){o(!0);return}t?f.logEventWithStatsig("Email Verify Popup Shown","chatgpt_email_verify_popup_shown",s):f.logEventWithStatsig("Email Verify Popup Hidden","chatgpt_email_verify_popup_hidden",s)},[t])}function Tt({ctx:t,shouldLogExposure:s}){return Je(t,"2273762597",{disableExposureLog:!s})}function za({ctx:t,shouldLogExposure:s}){return Tt({ctx:t,shouldLogExposure:s}).get("web_plus_intro_offer_coupon","none")}function $a({ctx:t,shouldLogExposure:s}){return Tt({ctx:t,shouldLogExposure:s}).get("is_plus_intro_offer_enabled",!1)}const qa=({billingDetails:t,isWebRedesign:s})=>{const a=ue(),o=Pe(a,"1627380539"),n=Pa({isWebRedesign:s,inGPT5Gate:o});return e.jsx(Ge,{planType:y.FREE,pricingPlan:n,callToActionButton:e.jsx(ae,{color:"secondary",disabled:!0,size:"large",className:I(s?"btn-secondary disabled:bg-token-bg-primary w-[100%]":"bg-token-sidebar-surface-tertiary text-token-text-primary hover:bg-token-sidebar-surface-tertiary dark:bg-token-text-tertiary dark:text-token-text-primary dark:hover:bg-token-text-tertiary w-[100%] border-none font-semibold"),children:e.jsx(l,{...n.callToAction.inactive})}),additionalLinks:[e.jsx(l,{...Ka.haveExistingPlan,values:{link:r=>e.jsx(te,{target:"_blank",to:Qe,onClick:et,className:I("underline",s&&"font-medium"),children:r},"row-plus-plan-help-link")}},"existing-plan-help")],billingDetails:t,isWebRedesign:s})},Ka=de({haveExistingPlan:{id:"FreeColumn.haveExistingPlan",defaultMessage:"Have an existing plan? <link>See billing help</link>"}});function Nt({isOpen:t,onClose:s,onContinue:a,analyticsParams:o}){d.useEffect(()=>{t&&f.logEventWithStatsig("Mobile Subscription Warning Modal Shown","chatgpt_mobile_subscription_warning_modal_shown",o)},[o,t]);const n=()=>{f.logEventWithStatsig("Mobile Subscription Warning Modal Continue Clicked","chatgpt_mobile_subscription_warning_modal_continue_clicked",o),a()},r=()=>{f.logEventWithStatsig("Mobile Subscription Warning Modal Close Clicked","chatgpt_mobile_subscription_warning_modal_close_clicked",o),s()};return e.jsx(me,{testId:"modal-mobile-subscription-warning",isOpen:t,onClose:r,type:"warning",icon:Xt,title:e.jsx(l,{...Ie.checkSubscriptionHeader}),primaryButton:e.jsx(ot.Button,{title:Ie.dismissModal.defaultMessage,color:"primary",onClick:r}),secondaryButton:e.jsx(ot.Button,{title:Ie.continueToNextStep.defaultMessage,color:"secondary",onClick:n}),children:e.jsx("span",{className:"gap-2 text-gray-600",children:Ie.checkSubscriptionBody.defaultMessage})})}const Ie=de({checkSubscriptionHeader:{id:"mobileSubscriptionWarningModal.checkSubscriptionHeader",defaultMessage:"Check your App Store subscription"},checkSubscriptionBody:{id:"mobileSubscriptionWarningModal.checkSubscriptionBody",defaultMessage:"Your subscription through the Apple App Store is currently on pause due to a payment issue. Please resolve that issue to resume using ChatGPT Plus and avoid duplicate charges."},dismissModal:{id:"mobileSubscriptionWarningModal.dismissModal",defaultMessage:"Cancel"},continueToNextStep:{id:"mobileSubscriptionWarningModal.continueToNextStep",defaultMessage:"I understand, continue anyways"}});function Es(t,s,a,o){let n,r;o===pt?(n=qe,r=gt):o===ft?(n=Ke,r=ht):(n=$e,r=yt);const i=n*s;let c;if("percentage"in a)c=i*(1-a.percentage/100);else if("value"in a)c=i-a.value;else throw new Error("Invalid discount type");return{formattedDiscountedCost:t.formatNumber(c,{style:"currency",currency:o,minimumFractionDigits:0,maximumFractionDigits:2}),currencySymbol:r}}function At(t,s,a,o){const n={...s};let r;if(o&&(o.period==="year"?o.num_periods===1?r=t.formatMessage({id:"pricingPlanConstants.promoCostSubtitleForSingleYear",defaultMessage:"for the first year"}):r=t.formatMessage({id:"pricingPlanConstants.promoCostSubtitleForPluralYears",defaultMessage:"for the first {num_years} years"},{num_years:o.num_periods}):o.num_periods===1?r=t.formatMessage({id:"pricingPlanConstants.promoCostSubtitleForSingleMonth",defaultMessage:"for the first month"}):r=t.formatMessage({id:"pricingPlanConstants.promoCostSubtitleForPluralMonths",defaultMessage:"for the first {num_months} months"},{num_months:o.num_periods})),n.costDuration={id:"promoCostDuration",defaultMessage:r,description:"Cost duration for promo plan"},"percentage"in a||"discount_type"in a&&a.discount_type===Le.PERCENTAGE){const i=("percentage"in a?a.percentage:a.amount)/100;n.costInDollars={id:"discountedCost",defaultMessage:pe((1-i)*$e).toString()},n.costInEuros={id:"discountedCostEuros",defaultMessage:pe((1-i)*qe).toString()},n.costInPounds={id:"discountedCostPounds",defaultMessage:pe((1-i)*Ke).toString()}}else if("value"in a||a.discount_type===Le.FIXED){const i="value"in a?a.value:a.amount;n.costInDollars={id:"discountedCost",defaultMessage:pe($e-i).toString()},n.costInEuros={id:"discountedCostEuros",defaultMessage:pe(qe-i).toString()},n.costInPounds={id:"discountedCostPounds",defaultMessage:pe(Ke-i).toString()}}return n}const at=ea(t=>({recentlyDowngraded:!1,recentlyUpgraded:!1,recentlyCanceled:!1,setRecentlyDowngraded:s=>t({recentlyDowngraded:s}),setRecentlyUpgraded:s=>t({recentlyUpgraded:s}),setRecentlyCanceled:s=>t({recentlyCanceled:s})}));function It(t){switch(t){case y.FREE:return"chatgptfreeplan";case y.GO:return"chatgptgoplan";case y.PLUS:return"chatgptplusplan";case y.PRO:return"chatgptpro";case y.TEAM:return"chatgptteamplan";default:throw new Error(`Invalid plan type: ${t}`)}}function Dt({isOpen:t,onClose:s,accountId:a,initialPlanType:o,updatedPlanType:n,billingDetails:r}){const i=Z(),c=je(),u=ta(),[m,p]=d.useState(!1),g=o===n,_=o===y.PLUS&&n===y.PRO||o===y.GO&&[y.PLUS,y.PRO].includes(n),j=It(n);d.useEffect(()=>{f.logTogglePlanManagementModal({isOpen:!0})},[]);const S=()=>{f.logTogglePlanManagementModal({isOpen:!1}),s()},M=Sa(a),H=va(a),R=ja(a),{data:k,isError:z,isLoading:T}=jt(a,void 0,j);!g&&z&&(u?.planType===y.TEAM?c.warning(i.formatMessage({id:"planManagement.errorUpgradingTeam",defaultMessage:"Updates to Pro aren't yet supported for users with Team subscriptions"}),{hasCloseButton:!0}):c.warning(i.formatMessage({id:"planManagement.errorFetchingPreview",defaultMessage:"There was a problem updating your subscription"}),{hasCloseButton:!0}),s());const P=C=>{const B=Mt(new Date,C);return new Intl.DateTimeFormat(i.locale,{year:"numeric",month:"short",day:"numeric"}).format(B)},w=u?.getDaysUntilPlanRenews(),x=w?P(w):"",{recentlyCanceled:A,setRecentlyUpgraded:N,setRecentlyDowngraded:b}=at(),D=u?.willRenewSubscription()||A,[F,se]=d.useState(!1),ne=qt();if(!u)return null;const K=async C=>{p(!0);try{if(g)await H.mutateAsync(a),c.success(x===""?i.formatMessage({id:"planManagement.successfullyRenewedSubscription2",defaultMessage:"Your subscription has been renewed."}):i.formatMessage({id:"planManagement.successfullyRenewedSubscription",defaultMessage:"Your subscription has been renewed. Your subscription will auto-renew on {renewalDate}."},{renewalDate:x}),{hasCloseButton:!0}),f.logEvent("Renew Plan Success",{planType:C}),it.logEvent("chatgpt_renew_plan_success",null,{planType:C});else{if(D||(await H.mutateAsync(a),se(!0)),await M.mutateAsync({accountId:a,updatedPlan:j,updatedPriceInterval:void 0,updatedSeats:void 0}),C!==n){const re=_?"Upgrade Plan Success":"Downgrade Plan Success",L=_?"chatgpt_upgrade_plan_success":"chatgpt_downgrade_plan_success";f.logEvent(re,{fromPlan:C,toPlan:n}),it.logEvent(L,null,{fromPlan:C,toPlan:n}),_?N(!0):b(!0)}const O=k?.renewal_date?new Date(k?.renewal_date).toLocaleDateString(i.locale,{year:"numeric",month:"long",day:"numeric"}):"N/A",$=_?i.formatMessage({id:"planManagement.successfullyUpdatedSubscription",defaultMessage:"You're now subscribed to ChatGPT Pro"}):i.formatMessage({id:"planManagement.updatedSubscriptionToPlus",defaultMessage:"Your subscription has been updated. Your subscription will change to Plus on {renewalDateFormatted}."},{renewalDateFormatted:O});localStorage.setItem(`subscriptionUpdateMessage_${u.id}`,$)}ne.invalidateQueries({queryKey:["account-status"]});const B=Ve.getItem(ze.CheckoutFrom);B&&lt[B]&&(Ve.removeItem(ze.CheckoutFrom),window.location.href=lt[B]),s()}catch(B){B?.detail?.error_type==="card_declined"?c.warning(i.formatMessage({id:"planManagement.cardDeclinedError",defaultMessage:"Payment error. Your card may be invalid or authentication may be needed."}),{hasCloseButton:!0}):c.warning(i.formatMessage({id:"planManagement.errorUpdatingSubscription",defaultMessage:"There was a problem updating your subscription"}),{hasCloseButton:!0}),F&&await R.mutateAsync(a),s()}finally{p(!1)}},[J,Y,U]=ns(r.currency);return e.jsx(me,{testId:"modal-plan-management",type:"success",isOpen:t,onClose:S,size:"custom",noPadding:!0,className:"max-w-xl",showCloseButton:!0,title:i.formatMessage({id:"planManagementModal.title",defaultMessage:"Confirm changes"}),removePopoverStyling:!0,children:T?e.jsx(Ut,{}):g&&u?e.jsx(ss,{account:u,renewalDate:x,handleUpdate:()=>K(o),isUpdating:m,onClose:S,plusCost:J,proCost:Y,currencySymbol:U}):z||!k?null:_?e.jsx(Qa,{accountId:a,handleUpdate:()=>K(o),isUpdating:m,onClose:S,currencySymbol:U}):e.jsx(as,{renewalDate:k.renewal_date,handleUpdate:()=>K(o),isUpdating:m,onClose:S,plusCost:J,currencySymbol:U})})}function Ut(){return e.jsx("div",{className:"flex items-center justify-center p-6",children:e.jsx(Re,{})})}function Ja({adjustmentMessage:t,proratedCreditMessage:s,proratedCreditInfoMessage:a}){return e.jsxs("div",{children:[e.jsxs("div",{className:"mt-4 flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:t}),e.jsx("span",{className:"font-semibold text-green-600",children:s})]}),e.jsx("span",{className:"text-token-text-secondary text-sm",children:a})]})}function Qa({accountId:t,handleUpdate:s,isUpdating:a,onClose:o,currencySymbol:n}){const r=Z(),{data:i,isError:c,isLoading:u}=jt(t,void 0,It(y.PRO));if(u)return e.jsx(Ut,{});if(c||!i)return null;const m=Za(i,r,n);return e.jsxs("div",{className:"p-6",children:[e.jsx(Xa,{data:i,currencySymbol:n}),m.filter(p=>p.value!==0).map((p,g)=>e.jsx(Ja,{adjustmentMessage:p.adjustmentMessage,proratedCreditMessage:p.proratedCreditMessage,proratedCreditInfoMessage:p.proratedCreditInfoMessage},g)),e.jsx("hr",{className:"mt-4 mb-4"}),e.jsx(es,{data:i,currencySymbol:n}),i.default_payment_method&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"mt-4 mb-4"}),e.jsx(ts,{defaultPaymentMethod:i.default_payment_method})]}),e.jsxs("div",{className:"mt-8 flex justify-end gap-2",children:[e.jsx(Me,{title:r.formatMessage({id:"planUpgradeModal.cancel",defaultMessage:"Cancel"}),color:"secondary",onClick:o}),e.jsx(Me,{title:r.formatMessage({id:"planUpgradeModal.payNow",defaultMessage:"Pay now"}),color:"primary",onClick:s,loading:a})]})]})}function Za(t,s,a){return[{adjustmentMessage:e.jsx(l,{id:"planUpgradeModal.adjustment",defaultMessage:"Adjustment"}),proratedCreditMessage:e.jsx(l,{id:"planUpgradeModal.proratedCredit",defaultMessage:"-{currencySign}{adjustment}",values:{currencySign:s.formatMessage(a.sign),adjustment:(-t.negative_line_item_total/100).toFixed(2)}}),proratedCreditInfoMessage:e.jsx(l,{id:"planUpgradeModal.proratedCreditInfo",defaultMessage:"Prorated credit for the remainder of your Plus subscription"}),value:t.negative_line_item_total},{adjustmentMessage:e.jsx(l,{id:"planUpgradeModal.discount",defaultMessage:"Adjustment"}),proratedCreditMessage:e.jsx(l,{id:"planUpgradeModal.discountAmount",defaultMessage:"-{currencySign}{discount}",values:{currencySign:s.formatMessage(a.sign),discount:(t.discount_amount/100).toFixed(2)}}),proratedCreditInfoMessage:e.jsx(l,{id:"planUpgradeModal.discountInfo",defaultMessage:"Account discount applied"}),value:t.discount_amount},{adjustmentMessage:e.jsx(l,{id:"planUpgradeModal.credits",defaultMessage:"Adjustments"}),proratedCreditMessage:e.jsx(l,{id:"planUpgradeModal.creditsAmount",defaultMessage:"-{currencySign}{credits}",values:{currencySign:s.formatMessage(a.sign),credits:(t.applied_balance/100).toFixed(2)}}),proratedCreditInfoMessage:e.jsx(l,{id:"planUpgradeModal.creditsInfo",defaultMessage:"Credits applied"}),value:t.applied_balance}]}function Xa({data:t,currencySymbol:s}){const a=Z();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(l,{id:"planUpgradeModal.subscription",defaultMessage:"ChatGPT Pro subscription"})}),e.jsx("span",{className:"font-semibold",children:e.jsx(l,{id:"planUpgradeModal.subscriptionCost",defaultMessage:"{currencySign}{totalCost}",values:{currencySign:a.formatMessage(s.sign),totalCost:(t.positive_line_item_total/100).toFixed(2)}})})]}),e.jsx("span",{className:"text-token-text-secondary text-sm",children:e.jsx(l,{id:"planUpgradeModal.billingCycle",defaultMessage:"Billed monthly, starting today"})})]})}function es({data:t,currencySymbol:s}){const a=Z();return e.jsxs(e.Fragment,{children:[t.amount_due.tax_amount>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mt-4 flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(l,{id:"planUpgradeModal.subTotal",defaultMessage:"Subtotal"})}),e.jsx("span",{children:e.jsx(l,{id:"planUpgradeModal.subtotalPrice",defaultMessage:"{currencySign}{totalCost}",values:{currencySign:a.formatMessage(s.sign),totalCost:(t.amount_due.amount_excluding_tax/100).toFixed(2)}})})]}),e.jsxs("div",{className:"mt-2 flex justify-between",children:[e.jsxs("span",{className:"font-semibold",children:[e.jsx(l,{id:"planUpgradeModal.tax",defaultMessage:"Tax"}),e.jsx("span",{className:"text-token-text-secondary font-normal",children:e.jsx(l,{id:"planUpgradeModal.taxPercent",defaultMessage:" {taxPercent}%",values:{taxPercent:(t.amount_due.tax_amount/t.amount_due.amount_excluding_tax*100).toFixed(0)}})})]}),e.jsx("span",{children:e.jsx(l,{id:"planUpgradeModal.taxAmount",defaultMessage:"{currencySign}{tax}",values:{currencySign:a.formatMessage(s.sign),tax:(t.amount_due.tax_amount/100).toFixed(2)}})})]})]}),e.jsxs("div",{className:"mt-2 flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(l,{id:"planUpgradeModal.totalDueToday",defaultMessage:"Total due today"})}),e.jsx("span",{className:"font-semibold",children:e.jsx(l,{id:"planUpgradeModal.totalDueTodayAmount",defaultMessage:"{currencySign}{totalCost}",values:{currencySign:a.formatMessage(s.sign),totalCost:(t.amount_due.amount/100).toFixed(2)}})})]})]})}function ts({defaultPaymentMethod:t}){return e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(l,{id:"planUpgradeModal.paymentMethod",defaultMessage:"Payment Method"})}),e.jsxs("span",{className:"text-token-text-secondary",children:[t.card_brand?.toUpperCase()," *",t.card_last4]})]})}function as({renewalDate:t,handleUpdate:s,isUpdating:a,onClose:o,plusCost:n,currencySymbol:r}){const i=Z(),c=t?new Date(t).toLocaleDateString(i.locale,{year:"numeric",month:"long",day:"numeric"}):"N/A";return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-token-text-secondary",children:e.jsx(l,{id:"planDowngradeModal.currentSubscription",defaultMessage:"Your current Pro subscription will remain active until {renewalDateFormatted}, when it will change to Plus.",values:{renewalDateFormatted:c}})}),e.jsxs("div",{className:"bg-token-main-surface-secondary mt-4 rounded-md p-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(l,{id:"planDowngradeModal.newPlan",defaultMessage:"ChatGPT Plus"})}),e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(l,{id:"planDowngradeModal.newPlanCost",defaultMessage:"{currencyCode} {currencySign}{plusCost}/month",values:{currencyCode:i.formatMessage(r.code),currencySign:i.formatMessage(r.sign),plusCost:i.formatMessage(n)}})})]}),e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(l,{id:"planDowngradeModal.billingStart",defaultMessage:"Billing will start on {renewalDateFormatted}",values:{renewalDateFormatted:c}})})]}),e.jsxs("div",{className:"mt-8 flex justify-end gap-2",children:[e.jsx(Me,{title:i.formatMessage({id:"planDowngradeModal.cancel",defaultMessage:"Cancel"}),color:"secondary",onClick:o}),e.jsx(Me,{title:i.formatMessage({id:"planDowngradeModal.confirm",defaultMessage:"Confirm"}),color:"primary",onClick:s,loading:a})]})]})})}function ss({account:t,renewalDate:s,handleUpdate:a,isUpdating:o,onClose:n,plusCost:r,proCost:i,currencySymbol:c}){const u=Z(),m=t.data.subscriptionStatus.planType,p=ka(m.toLowerCase()),g=p==="Pro"?i:r;return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-token-text-secondary",children:e.jsx(l,{id:"planRenewalModal.currentSubscription",defaultMessage:"Your current {planName} subscription will auto-renew on {renewalDate}.",values:{planName:p,renewalDate:s}})}),e.jsxs("div",{className:"bg-token-main-surface-secondary mt-4 rounded-md p-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(l,{id:"planRenewalModal.newPlan",defaultMessage:"ChatGPT {planName}",values:{planName:p}})}),e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(l,{id:"planRenewalModal.newPlanCost",defaultMessage:"{currencyCode} {currencySign}{planCost}/month",values:{currencyCode:u.formatMessage(c.code),currencySign:u.formatMessage(c.sign),planCost:u.formatMessage(g)}})})]}),e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(l,{id:"planRenewalModal.billingStart",defaultMessage:"Billing will auto-renew on {renewalDate}",values:{renewalDate:s}})})]}),e.jsxs("div",{className:"mt-8 flex justify-end gap-2",children:[e.jsx(Me,{title:u.formatMessage({id:"planRenewalModal.cancel",defaultMessage:"Cancel"}),color:"secondary",onClick:n}),e.jsx(Me,{title:u.formatMessage({id:"planRenewalModal.confirm",defaultMessage:"Confirm"}),color:"primary",onClick:a,loading:o})]})]})})}function ns(t){return t==pt?[Q.plus.plusCostInEuros,Q.pro.proCostInEuros,gt]:t==ft?[Q.plus.plusCostInPounds,Q.pro.proCostInPounds,ht]:[Q.plus.plusCost,Q.pro.proCost,yt]}const ge=y.PLUS,os=()=>ve({queryKey:["has-app-store-subscription-in-billing-retry"],queryFn:async()=>await Ct.safeGet("/subscriptions/has_app_store_subscription_in_billing_retry")});function Ot(t,s){const a=t.data.subscriptionStatus.planType,o=t.getNextPlanType();let n=t.getDaysUntilPlanChanges(),r=o===y.PLUS&&a===y.PRO||o===y.GO&&[y.PRO,y.PLUS].includes(a);return s&&!r&&(n=t.getDaysUntilPlanRenews(),r=!0),{daysUntilPlanChanges:n,isDowngradeScheduled:r}}function Oe(t,s){const a=Mt(new Date,t);return new Intl.DateTimeFormat(s,{year:"numeric",month:"short",day:"numeric"}).format(a)}function is(t,s,a){let o;switch(t){case"month":o=la(new Date,s);break;case"year":o=ra(new Date,s);break}return new Intl.DateTimeFormat(a,{year:"numeric",month:"short",day:"numeric"}).format(o)}function ct(t){return ia.includes(t)?t:"USD"}function rs(t,s,a,o){if(t==="plus-10-for-3-months")switch(a.currency){case"USD":{const n={value:10,currency_code:ct(a.currency)};return{plan_name:ye.PLUS,title:"",summary:s.formatMessage(o?Ne.headline:Ae.plusSummary),discount:n,duration:{num_periods:3,period:"month"},price_period:"recurring",promotion_type:"discount",promotion_type_label:null}}case"EUR":case"GBP":return{plan_name:ye.PLUS,title:"",summary:s.formatMessage(o?Ne.headline:Ae.plusSummary),discount:{percentage:52.18},duration:{num_periods:3,period:"month"},price_period:"recurring",promotion_type:"discount",promotion_type_label:null};case"INR":return null}else if(t==="plus-10-for-12-mos")switch(a.currency){case"USD":{const n={value:10,currency_code:ct(a.currency)};return{plan_name:ye.PLUS,title:"",summary:s.formatMessage(o?Ne.headline:Ae.plusSummary),discount:n,duration:{num_periods:12,period:"month"},price_period:"recurring",promotion_type:"discount",promotion_type_label:null}}case"EUR":case"GBP":return{plan_name:ye.PLUS,title:"",summary:s.formatMessage(o?Ne.headline:Ae.plusSummary),discount:{percentage:52.18},duration:{num_periods:12,period:"month"},price_period:"recurring",promotion_type:"discount",promotion_type_label:null};case"INR":return null}return null}const ls=({analyticsParams:t,className:s,currentAccount:a,planLoading:o,isPromoLoading:n,onUpgradeButtonClick:r,setPlanLoading:i,plusPricingPlan:c=null,shouldShowAdditionalLinks:u=!0,billingDetails:m,promoCode:p=null,promoMetadata:g=null,onClose:_,disableForMobile:j=!1,type:S,isWebRedesign:M})=>{const{data:H}=aa(),{data:R,refetch:k}=ve(Xe),{data:{value:z}={}}=os(),T=a.features,P=ue(),w=!sa(P),x=Z(),A=je(),N=Pe(P,"1627380539");let b=c||wa({isWebRedesign:M,inGPT5Gate:N});const D=za({ctx:P,shouldLogExposure:!1}),{data:F}=Et(D);g==null&&F?.coupon===D&&F?.state==="eligible"&&$a({ctx:P,shouldLogExposure:!0})&&(g=rs(D,x,m,M),p=D);const se=d.useRef(!1),[ne,K]=d.useState(!1),[J,Y]=d.useState(!1),[U,C]=d.useState(!1),{recentlyDowngraded:B}=at();let O=[];const $=a.isOrWasPaidCustomer(),re=a.hasPaidSubscription(),L=re&&a.isPlus(),le=re&&a.isPro(),h=a.getLastActiveSubscription(),E=Je(P,"3950229590"),{prepareCheckoutSession:X,navigateToCheckout:ce}=wt(),ee=na(H),oe=T.includes("disable_plus_upgrade_ui")&&!$,{daysUntilPlanChanges:st,isDowngradeScheduled:Lt}=Ot(a,B),V=d.useMemo(()=>({...t,promoCode:p,planType:ge,isUpgradeUiDisabled:oe}),[t,p,oe]),Rt=!!R?.email,_e=d.useRef(new Map),He=d.useRef(null);d.useEffect(()=>{if(!L&&E.get("enabled_prefetch_checkout_for_plus",!1)){const W={plan_name:ye.PLUS,billing_details:m,promo_code:p},G=JSON.stringify(W);if(!_e.current.has(G)){f.logEventWithStatsig("Account Pay: Prefetch Checkout Session","chatgpt_account_payment_modal_prefetch_checkout_session",V),_e.current.clear();const ie=E.get("skip_sentinel_checkout",!1),Te=X(W,{skipSentinelCheckout:ie});_e.current.set(G,Te)}}},[X,V,m,p,T,L,E]);const Ft=()=>{const W={plan_name:ye.PLUS,billing_details:m,promo_code:p},G=_e.current.get(JSON.stringify(W));if(G)return f.logEventWithStatsig("Account Pay: Using Prefetched Checkout Session","chatgpt_account_payment_modal_using_prefetched_checkout_session",V),G;f.logEventWithStatsig("Account Pay: Click to Fetch Checkout Session","chatgpt_account_payment_modal_click_to_fetch_checkout_session",V),_e.current.clear();const ie=E.get("skip_sentinel_checkout",!1);return X(W,{skipSentinelCheckout:ie})},Bt=async({skipEmailCheck:W})=>{if(!Rt&&!W){C(!0);return}i(y.PLUS),f.logEvent("Account Pay: Payment Checkout Clicked",V),q(P,"chatgpt_account_payment_modal_upgrade_button_click",ge),He.current=Date.now();try{const G=await Ft();let ie;He.current&&(ie=Date.now()-He.current),f.logEvent("Account Pay: Navigating to Payment Checkout",{...V,url:G.url??"",latency_ms:ie});const Te={url:String(G.url??"")};ie!==void 0&&(Te.latency_ms=ie.toString()),q(P,"chatgpt_account_payment_modal_navigating_to_checkout",ge,Te),await ce(G)}catch{A.warning(x.formatMessage(v.paymentErrorWarning),{hasCloseButton:!0})}i(null)},Gt=()=>{f.logEvent("Account Portal: Click iOS Manage Subscription",V)},Ht=()=>{f.logEvent("Account Portal: Click Android Manage Subscription",V)},Yt=L&&h.purchase_origin_platform===xe.MOBILE_IOS,Wt=L&&h.purchase_origin_platform===xe.MOBILE_ANDROID;ee&&!L&&O.push(e.jsx(te,{to:oa,target:"_blank",className:I(M?"px-1 font-medium":"px-2","underline"),children:e.jsx(l,{...v.limitsApply})},"row-plus-plan-usage-limits")),Yt&&O.push(e.jsx(te,{to:xt,target:"_blank",onClick:Gt,className:I(M?"px-1 font-medium":"px-2","underline"),children:x.formatMessage(Fe.manageSubscriptionIos.callToAction)},"row-plus-plan-manage-ios")),Wt&&O.push(e.jsx(te,{to:_t,target:"_blank",onClick:Ht,className:I(M?"px-1 font-medium":"px-2","underline"),children:x.formatMessage(Fe.manageSubscriptionAndroid.callToAction)},"row-plus-plan-manage-android")),L&&$&&O.push(e.jsx(te,{target:"_blank",to:Qe,onClick:et,className:I(M?"px-1 font-medium":"px-2","underline"),children:e.jsx(l,{...v.billingHelp})},"row-plus-plan-help-link"));const Ye=({skipAppStoreSubscriptionInBillingRetryCheck:W=!1,skipEmailCheck:G=!1}={})=>{if(z&&!W)return K(!0);if(r)return r(m,V);le?(f.logEvent("Account Pay: Payment Checkout Clicked",V),q(P,"chatgpt_account_payment_modal_upgrade_button_click",ge),Y(!0)):Bt({skipEmailCheck:G})},ke=(W,G)=>e.jsx(Ue,{planType:ge,isCurrentPlan:L&&!we,disabled:W,onClick:G,testId:"select-plan-button-plus-upgrade",activeColor:le?"secondary":M?"purple":Vt?"primary":void 0,children:o===y.PLUS&&!J?e.jsx(Re,{}):we&&L&&b.callToAction.promo?x.formatMessage(b.callToAction.promo):L?x.formatMessage(b.callToAction.active):nt&&w&&b.callToAction.inactiveUnauthenticated?x.formatMessage(b.callToAction.inactiveUnauthenticated):x.formatMessage(b.callToAction.inactive)});tt(U,{plan:V});const we=g!=null,Vt=g?.promotion_type==="student_discount",nt=g!=null&&"referrer_name"in g,zt=(!L||we)&&o==null;O=we?[]:O;let We=null;const Ee=a.getDaysUntilPlanDiscountExpires();if(g!=null?b=cs(x,b,g,m.currency):a.data.subscriptionStatus.discount&&(b.cost=At(x,b.cost,a.data.subscriptionStatus.discount),g==null&&(b.summary=Q.plus.plusSummaryWithDiscount,a.data.subscriptionStatus.discount.discount_type===Le.PERCENTAGE&&(We={discount:{percentage:a.data.subscriptionStatus.discount.amount,expires_at:Ee?Oe(Ee,x.locale):void 0}}),a.data.subscriptionStatus.discount.discount_type===Le.FIXED&&(We={discount:{value:a.data.subscriptionStatus.discount.amount,expires_at:Ee?Oe(Ee,x.locale):void 0}}))),n!=null&&n)return null;const $t=ds(a);return e.jsxs(e.Fragment,{children:[e.jsx(Ge,{planType:ge,elementId:bt,pricingPlan:b,callToActionButton:oe?e.jsx("div",{className:"relative w-full",children:e.jsx(Ce,{side:"bottom",sideOffset:20,label:x.formatMessage(v.highDemandDisabledText),children:ke(!0,()=>{})})}):j&&$t?e.jsx("div",{children:e.jsx(Ce,{side:"top",sideOffset:20,label:x.formatMessage({id:"I2JCGZ",defaultMessage:"Mobile subscriptions are currently not eligible for this promotion."}),onOpenChange:W=>{W&&!se.current&&(nt&&Ea.logMobileSubscriptionTooltipOpen(),se.current=!0)},children:e.jsx("div",{children:ke(!0,()=>{})})})}):e.jsxs("div",{children:[st&&Lt?e.jsx(Ce,{side:"top",sideOffset:20,label:e.jsx(l,{id:"8/N1rV",defaultMessage:"Your subscription will change to Plus on {date}.",values:{date:Oe(st,x.locale)}}),children:ke(!0,()=>{})}):ke(!zt,Ye),e.jsx(Nt,{isOpen:ne,onClose:()=>K(!1),onContinue:()=>Ye({skipAppStoreSubscriptionInBillingRetryCheck:!0}),analyticsParams:V}),J&&e.jsx(Dt,{isOpen:J,onClose:()=>Y(!1),accountId:a.id,initialPlanType:y.PRO,updatedPlanType:y.PLUS,billingDetails:m})]}),secondaryCallToActionButton:S==="promo"?e.jsx(ae,{size:"large",color:"secondary",onClick:_,children:e.jsx(l,{...v.notNow})}):null,additionalLinks:u?O:[],type:S,promoMetadata:g,activeDiscountMetadata:We,billingDetails:m,className:s,isWebRedesign:M}),e.jsx(me,{testId:"modal-add-email",isOpen:U,onClose:()=>C(!1),type:"success",className:"max-w-sm",children:e.jsx(Ze,{enterEmailTitle:x.formatMessage(v.addEmailTitle),enterEmailDescription:x.formatMessage(v.addEmailDescription),onVerified:()=>{k(),C(!1),Ye({skipEmailCheck:!0})},cancelFlowButton:e.jsx(ae,{className:"w-full rounded-md",color:"secondary",onClick:()=>C(!1),children:e.jsx(l,{...v.cancelAddEmail})})})})]})};function cs(t,s,a,o){const{costTitle:n,currencySymbol:r}=Ta(s,o),i=n?.defaultMessage?.toString()??"20",c=a.duration?.period??"month",u=a.duration?.num_periods??1,m=is(c,u,t.locale),p=At(t,s.cost,a.discount,a.duration??{num_periods:1,period:"month"}),g=r.code.defaultMessage?.toString()??"USD",_=t.formatNumber(parseFloat(i)||0,{style:"currency",currency:g,minimumFractionDigits:0,maximumFractionDigits:2});let j;switch(c){case"month":u===1?j=t.formatMessage(v.promoPlanDisclaimerForSingleMonth,{date:m,cost:_}):j=t.formatMessage(v.promoPlanDisclaimerForPluralMonths,{num_months:u,date:m,cost:_});break;case"year":u===1?j=t.formatMessage(v.promoPlanDisclaimerForSingleYear,{date:m,cost:_}):j=t.formatMessage(v.promoPlanDisclaimerForPluralYears,{num_years:u,date:m,cost:_});break;case"hour":throw new Error("Period 'hour' is not supported")}const S="<article>"+t.formatMessage(v.termsApply)+"</article> "+j;return s={...s,summary:{id:"promoSummary",defaultMessage:a.summary},disclaimer:{id:"promoDisclaimer",defaultMessage:S,article:"https://help.openai.com/en/articles/10492689-chatgpt-plus-promotions-referrals"},cost:p,callToAction:{...s.callToAction,promo:{id:"pricingPlanConstants.promo.callToAction",defaultMessage:"Apply to My Subscription",description:"Payment call to action for existing subscribers adding a discount to their plan"}}},s}function ds(t){const s=t.hasPaidSubscription(),a=t.getLastActiveSubscription(),o=s&&a.purchase_origin_platform===xe.MOBILE_IOS,n=s&&a.purchase_origin_platform===xe.MOBILE_ANDROID;return o||n}const v=de({promoPlanDisclaimerForPluralMonths:{id:"pricingPlanConstants.promoPlanDisclaimerForPluralMonths",defaultMessage:"Promo pricing applies for {num_months} months. Starting {date}, ChatGPT Plus will continue at {cost}/month. Cancel anytime."},promoPlanDisclaimerForSingleMonth:{id:"pricingPlanConstants.promoPlanDisclaimerForSingleMonth",defaultMessage:"Promo pricing applies for 1 month. Starting {date}, ChatGPT Plus will continue at {cost}/month. Cancel anytime."},promoPlanDisclaimerForPluralYears:{id:"pricingPlanConstants.promoPlanDisclaimerForPluralYears",defaultMessage:"Promo pricing applies for {num_years} years. Starting {date}, ChatGPT Plus will continue at {cost}/year. Cancel anytime."},promoPlanDisclaimerForSingleYear:{id:"pricingPlanConstants.promoPlanDisclaimerForSingleYear",defaultMessage:"Promo pricing applies for 1 year. Starting {date}, ChatGPT Plus will continue at {cost}/year. Cancel anytime."},termsApply:{id:"pricingPlanConstants.termsApply",defaultMessage:"Terms apply."},addEmailTitle:{id:"AccountPaymentModal.addEmailTitle",defaultMessage:"Email required"},addEmailDescription:{id:"AccountPaymentModal.addEmailDescription",defaultMessage:"You'll be able to login with this email. It will also be used for account updates (like password resets) and information about OpenAI services."},cancelAddEmail:{id:"AccountPaymentModal.cancelAddEmail",defaultMessage:"Cancel"},haveExistingPlan:{id:"AccountPaymentModal.haveExistingPlan",defaultMessage:"Have an existing plan?"},billingHelp:{id:"AccountPaymentModel.billingHelp",defaultMessage:"I need help with a billing issue"},paymentErrorWarning:{id:"AccountPaymentModal.paymentErrorWarning",defaultMessage:"The payments page encountered an error. Please try again. If the problem continues, please visit help.openai.com."},accountErrorWarning:{id:"AccountPaymentModal.accountErrorWarning",defaultMessage:"The account management page encountered an error. Please try again. If the problem continues, please visit help.openai.com."},limitsApply:{id:"xda4i3",defaultMessage:"Limits apply"},notNow:{id:"AccountPaymentModal.notNow",defaultMessage:"Not Now"},highDemandDisabledText:{id:"AccountPaymentModal.highDemandDisabledText",defaultMessage:"Due to high demand, we've temporarily paused upgrades."}}),dt="openai.com/team/fj3ilksf",ut="https://persistent.oaistatic.com/chatgpt/team_refer_admin_banner.png",us=({...t})=>{const s=Z(),a=ue(),o=je(),[n,r]=d.useState(!1);kt(()=>{f.logEvent("Teams: Admin Refer Modal Opened"),q(a,"chatgpt_teams_admin_refer_modal_opened")}),d.useEffect(()=>{if(n){const p=setTimeout(()=>{r(!1)},2e3);return()=>clearTimeout(p)}},[n]);const[i,c]=d.useState(!1);d.useEffect(()=>{const p=new Image;p.src=ut,p.onload=()=>c(!0)},[]);const u=async()=>{f.logEvent("Teams: Admin Refer Modal Copy Link Clicked"),q(a,"chatgpt_teams_admin_refer_modal_link_copied"),await Aa(dt),o.success(s.formatMessage(Q.team.teamCopyLinkSuccess)),r(!0)},m=()=>{f.logEvent("Teams: Admin Refer Modal Closed"),q(a,"chatgpt_teams_admin_refer_modal_closed"),t.onClose()};return i?e.jsxs(me,{isOpen:!0,onClose:m,showCloseButton:!1,className:"max-w-md",contentClassName:"p-0!",testId:"modal-team-refer-admin-modal",children:[e.jsx("div",{className:"absolute end-4 top-4 z-50",children:e.jsx(ca,{className:"text-token-text-secondary ring-0! outline-0! hover:bg-transparent focus:ring-0! focus:ring-offset-0! focus:outline-0! dark:hover:bg-transparent",onClick:m})}),e.jsx("img",{src:ut,className:"h-[230px] w-full object-cover object-top",alt:""}),e.jsxs("div",{className:"flex flex-col items-center p-8",children:[e.jsx("div",{className:"font text-xl font-medium",children:e.jsx(l,{...De.title})}),e.jsx("div",{className:"mt-2 w-full text-center text-base",children:e.jsx(l,{...De.description})}),e.jsx("div",{className:"mt-6 w-full justify-center rounded-3xl border-[1px] border-[#C2EAE3] bg-[#F4FCFB] p-5 text-center font-medium",children:dt}),e.jsx(ae,{className:"mt-3 w-full",icon:Na,color:n?"secondary":"primary",onClick:u,children:e.jsx(l,{...n?De.linkCopied:De.copyLink})})]})]}):null},De=de({title:{id:"pricing.team.referAdmin.title",defaultMessage:"Get your company to cover this"},description:{defaultMessage:"Want to use ChatGPT for work? Share this link so your company can set up a Team plan.",id:"pricing.team.referAdmin.description"},linkCopied:{defaultMessage:"Link copied!",id:"pricing.team.referAdmin.linkCopied"},copyLink:{defaultMessage:"Copy link",id:"pricing.team.referAdmin.copyLink"}}),fe=y.TEAM,ms=({analyticsParams:t,planLoading:s,billingDetails:a,isWebRedesign:o,shouldShowLocalizedFeatures:n})=>{const{data:r,refetch:i}=ve(Xe),c=Z(),u=ue(),m=Pe(u,"1627380539"),p=da(u),g=mt(),_=Ia(),[j,S]=d.useState(!1),M=p?.isTeam(),H=p?.isPlus(),R={...t,planType:fe},k=!!r?.email,z=!n&&Se(u,"4293611158").get("enabled",!1);let T=Da(n,z&&!n,o,m);const P=Ua(),{data:w}=Et(P??""),x=La,A=w?.coupon===Oa&&w?.state==="eligible";let N=null;A&&(T={...T,cost:{...T.cost,costInDollars:x.promoCost,costInPounds:x.promoCost,costInEuros:x.promoCost,costInINR:x.promoCostINR,costDuration:x.promoCostDuration},disclaimer:a.currency===ua?x.team1dollarPromoDisclaimerINR:x.team1dollarPromoDisclaimer},N={plan_name:"chatgptteamplan",title:"",summary:"",discount:{value:0,currency_code:"USD"},duration:{num_periods:1,period:"month"},price_period:"recurring",promotion_type:"discount",promotion_type_label:null});const b=F=>{if(!k&&!F){S(!0);return}f.logEvent("Account Pay: Payment Checkout Clicked",R),q(u,"chatgpt_account_payment_modal_upgrade_button_click",fe),pa.setPurchaseWorkspaceData({minimumSeats:_,billingDetails:a,promoData:w?.state==="eligible"?w:void 0}),ga(g)};tt(j,{plan:R});const D=Se(u,"2215056542").get("variant","control");return e.jsxs(e.Fragment,{children:[e.jsx(Ge,{planType:fe,isWebRedesign:o,className:`${o?"md:max-w-117":""}`,elementId:Pt,pricingPlan:T,promoData:w,promoMetadata:N,callToActionButton:e.jsxs("div",{className:"flex flex-col gap-2",children:[M&&e.jsx(Ue,{planType:fe,isCurrentPlan:!0,disabled:s!=null||M,onClick:()=>b(),testId:"select-plan-button-teams-upgrade",children:c.formatMessage(T.callToAction.active)}),e.jsx("div",{className:"w-full",children:e.jsx(Ue,{planType:fe,disabled:s!=null,onClick:()=>b(),testId:"select-plan-button-teams-create",children:M||H?c.formatMessage(T.callToAction.create):c.formatMessage(T.callToAction.inactive)})}),!M&&D!=="control"&&e.jsx(Ue,{icon:Fa,planType:fe,color:"secondary",disabled:s!=null,onClick:()=>ma(u,us),testId:"select-plan-button-teams-refer-admin",children:c.formatMessage(D==="variant-1"?Q.team.teamPlanReferManager:Q.team.teamPlanReferAdmin)})]}),billingDetails:a}),e.jsx(me,{testId:"modal-add-email",isOpen:j,onClose:()=>S(!1),type:"success",className:"max-w-sm",children:e.jsx(Ze,{enterEmailTitle:c.formatMessage(v.addEmailTitle),enterEmailDescription:c.formatMessage(v.addEmailDescription),onVerified:async()=>{S(!1),await i(),b(!0)}})})]})},he=y.PRO,ps=()=>ve({queryKey:["has-app-store-subscription-in-billing-retry"],queryFn:async()=>await Ct.safeGet("/subscriptions/has_app_store_subscription_in_billing_retry")}),gs=({analyticsParams:t,currentAccount:s,planLoading:a,onSubmit:o,setPlanLoading:n,billingDetails:r,isWebRedesign:i})=>{const{data:c,isError:u}=ps(),m=ue(),{data:p,refetch:g}=ve(Xe),_=Z(),j=je(),[S]=Kt(),M=S.get("checkout_from"),[H,R]=d.useState(!1),[k,z]=d.useState(!1),[T,P]=d.useState(!1),w=s.getLastActiveSubscription(),x=s.isOrWasPaidCustomer(),A=s.hasPaidSubscription(),N=A&&s.isPro(),b=!!p?.email,{prepareCheckoutSession:D,navigateToCheckout:F}=wt(),{recentlyDowngraded:se}=at(),{daysUntilPlanChanges:ne,isDowngradeScheduled:K}=Ot(s,se),J=Pe(m,"1627380539"),Y=Ra({isWebRedesign:i,inGPT5Gate:J}),U=[],C={...t,planType:he},B=A&&w.purchase_origin_platform===xe.MOBILE_IOS,O=A&&w.purchase_origin_platform===xe.MOBILE_ANDROID,$=async ee=>{if(!b&&!ee){P(!0);return}n(y.PRO),f.logEvent("Account Pay: Payment Checkout Clicked",C),q(m,"chatgpt_account_payment_modal_upgrade_button_click",he);try{const oe=await D({plan_name:"chatgptpro",billing_details:r});o?.(),f.logEvent("Account Pay: Navigating to Payment Checkout",{...C,url:oe.url??""}),q(m,"chatgpt_account_payment_modal_navigating_to_checkout",he,{url:oe.url??""}),M==="vza493q"&&Ve.setItem(ze.CheckoutFrom,M),await F(oe)}catch{j.warning(_.formatMessage(v.paymentErrorWarning),{hasCloseButton:!0})}n(null)},re=()=>{f.logEvent("Account Portal: Click iOS Manage Subscription",C)},L=()=>{f.logEvent("Account Portal: Click Android Manage Subscription",C)};N&&B&&U.push(e.jsx(te,{to:xt,target:"_blank",onClick:re,className:I(i?"px-1 font-medium":"px-2","underline"),children:_.formatMessage(Fe.manageSubscriptionIos.callToAction)},"row-plus-plan-manage-ios")),N&&O&&U.push(e.jsx(te,{to:_t,target:"_blank",onClick:L,className:I(i?"px-1 font-medium":"px-2","underline"),children:_.formatMessage(Fe.manageSubscriptionAndroid.callToAction)},"row-plus-plan-manage-android")),x&&U.push(e.jsx(te,{target:"_blank",to:Qe,onClick:et,className:I(i?"px-1 font-medium":"px-2","underline"),children:e.jsx(l,{...v.billingHelp})},"row-plus-plan-help-link"));const le=function(){R(!H)},h=function(){z(!k)},E=Pe(m,"1382475798"),X=async()=>{let ee=s.hasPaidSubscription()&&s.isPlus();E&&(ee=ee&&!s.isActiveSubscriptionGratis()),ee?(f.logEvent("Account Pay: Payment Checkout Clicked",C),q(m,"chatgpt_account_payment_modal_upgrade_button_click",he),z(!0)):await $()},ce=u||!c||!c.value?X:()=>{le()};return tt(T,{plan:C}),e.jsxs(e.Fragment,{children:[e.jsx(Ge,{planType:he,pricingPlan:Y,callToActionButton:e.jsxs("div",{children:[B||O?e.jsx(Ce,{side:"top",sideOffset:20,label:_.formatMessage(fs.switchToMobile),onOpenChange:ee=>{ee&&(f.logEvent("Account Pay: Show Mobile Subscription Tooltip",C),q(m,"chatgpt_account_payment_modal_show_mobile_subscription_tooltip",he))},children:e.jsx(ae,{fullWidth:!0,size:"large",color:"primary",disabled:!0,"data-testid":"select-plan-button-pro-upgrade",children:_.formatMessage(Y.callToAction.inactive)})}):K&&ne?e.jsx(Ce,{side:"top",sideOffset:20,label:e.jsx(l,{id:"jgTAPh",defaultMessage:"Your subscription will remain active until {date}, when it will change to Plus.",values:{date:Oe(ne,_.locale)}}),children:e.jsx(ae,{fullWidth:!0,size:"large",color:"primary",disabled:N||a!=null,"data-testid":"select-plan-button-pro-upgrade",className:N||a!=null?"bg-token-sidebar-surface-tertiary text-token-text-primary hover:bg-token-sidebar-surface-tertiary dark:bg-token-text-tertiary dark:text-token-text-primary dark:hover:bg-token-text-tertiary border-none font-semibold":"",children:a===y.PRO&&!k?e.jsx(Re,{}):N?_.formatMessage(Y.callToAction.active):_.formatMessage(Y.callToAction.inactive)})}):e.jsx(ae,{fullWidth:!0,size:"large",color:"primary",disabled:N||a!=null,onClick:ce,"data-testid":"select-plan-button-pro-upgrade",className:N||a!=null?"bg-token-sidebar-surface-tertiary text-token-text-primary hover:bg-token-sidebar-surface-tertiary dark:bg-token-text-tertiary dark:text-token-text-primary dark:hover:bg-token-text-tertiary border-none font-semibold":"",children:a===y.PRO&&!k?e.jsx(Re,{}):N?_.formatMessage(Y.callToAction.active):_.formatMessage(Y.callToAction.inactive)}),e.jsx(Nt,{isOpen:H,onClose:le,onContinue:$,analyticsParams:C}),k&&e.jsx(Dt,{isOpen:k,onClose:h,accountId:s.id,initialPlanType:y.PLUS,updatedPlanType:y.PRO,billingDetails:r})]}),additionalLinks:U,className:"bg-token-main-surface-primary",billingDetails:r,isWebRedesign:i}),e.jsx(me,{testId:"modal-add-email",isOpen:T,onClose:()=>P(!1),type:"success",className:"max-w-sm",children:e.jsx(Ze,{enterEmailTitle:_.formatMessage(v.addEmailTitle),enterEmailDescription:_.formatMessage(v.addEmailDescription),onVerified:()=>{g(),P(!1),$(!0)},cancelFlowButton:e.jsx(ae,{className:"w-full rounded-md",color:"secondary",onClick:()=>P(!1),children:e.jsx(l,{...v.cancelAddEmail})})})})]})},fs=de({switchToPersonalAccount:{id:"y5FjSF",defaultMessage:"Switch to a personal account to upgrade"},switchToMobile:{id:"gbjsg6",defaultMessage:"It looks like you already have an active mobile subscription. Switch to your mobile app to upgrade"}});function hs({analyticsParams:t,currentAccount:s,planLoading:a,selectedTab:o,setPlanLoading:n,shouldSplitBetweenPersonalAndBusiness:r,billingDetails:i,scrollExperimentVariant:c,onClose:u,shouldShowLocalizedFeatures:m,isWebRedesign:p}){const g=[],j=s.hasPaidSubscription()||c==="remove_free_column";r?o==="personal"?(j||g.push("free"),g.push("plus"),g.push("pro")):g.push("team"):(j||g.push("free"),s.isTeam()||(g.push("plus"),g.push("pro")),g.push("team")),g.length===0&&St.addError(new Error("Account payment modal missing columns"));const S=s.isFree()?rt.highlight:rt.standard;return g.map(M=>{switch(M){case"free":return e.jsx(qa,{billingDetails:i,isWebRedesign:p},M);case"plus":return e.jsx(ls,{analyticsParams:t,currentAccount:s,setPlanLoading:n,planLoading:a,billingDetails:i,onClose:u,isWebRedesign:p,type:S},M);case"team":return e.jsx(ms,{analyticsParams:t,billingDetails:i,currentAccount:s,planLoading:a,isWebRedesign:p,shouldShowLocalizedFeatures:m},M);case"pro":return e.jsx(gs,{analyticsParams:t,currentAccount:s,setPlanLoading:n,planLoading:a,billingDetails:i,isWebRedesign:p},M)}})}const ys=({defaultTab:t,enableSplitOnMobile:s})=>{const o=!vt(),n=ue();return o&&t==="personal"&&!s?Se(n,"95272720").get("variant","control"):null};function Ts({currentAccount:t,defaultTab:s="personal",onClose:a,subtitle:o,title:n}){const[r,i]=d.useState(null),c=Jt(),u=Qt(),m=vt(),p=ue(),g=!m&&Se(p,"2330365894").get("enabled",!1),S=fa().includes("de-DE")&&Se(p,"3839749267").get("enabled",!1),M=!S&&Je(p,"2675205028").get("show_web_redesign",!1),H=ys({defaultTab:s,enableSplitOnMobile:g});d.useEffect(()=>{const h=performance.now();return()=>{if(h){const E=performance.now()-h;f.logValueEventWithStatsig({segmentEventName:"Account Pay: Account Payment Modal Time Spent",statsigEventName:"chatgpt_web_account_payment_modal_time_spent",value:Math.round(E)})}}},[]);const R=m||g,k=d.useMemo(()=>({...t.subscriptionAnalyticsParams,referrer:document.referrer}),[t]),z=mt(),T=je(),P=d.useCallback(()=>{f.logEvent("Account Pay: Close Account Payment Modal",k),a()},[k,a]);d.useEffect(()=>{const h=localStorage.getItem(`subscriptionUpdateMessage_${t.id}`);if(h){localStorage.removeItem(`subscriptionUpdateMessage_${t.id}`),T.success(h,{hasCloseButton:!0});const E=setTimeout(()=>{P()},5e3);return()=>{clearTimeout(E)}}},[t.id,T,P]);const[w,x]=d.useState(s),{country:A,setCountry:N,userCountry:b}=Ba(),D=Ms({currentAccount:t,selectedTab:w}),F=Ga({country:D?A:Ma,currentAccount:t,location:"AccountPaymentModal",shouldUsePaidSubscriptionBillingCurrency:w==="personal"});kt(()=>{const h=c.state?.[xa],E=c.key;h&&z({hash:c.hash,search:c.search},{replace:!0,state:{}}),_a.count(ba.DEFAULT,"chatgpt_account_payment_modal_show",[{key:"location",value:h},{key:"locationKey",value:E},{key:"navigationType",value:u},{key:"initialTab",value:s},{key:"initialCountrySelectorCountry",value:A},{key:"selectedCountry",value:F.country??""},{key:"selectedCurrency",value:F.currency??""},{key:"userCountry",value:b??""},{key:"isCountrySelectorEnabled",value:String(D)}]),f.logEventWithStatsig("Account Pay: Account Payment Modal Show","chatgpt_account_payment_modal_show",{...k,initialTab:s,location:h,locationKey:E,navigationType:u,initialCountrySelectorCountry:A,selectedCountry:F.country??"",selectedCurrency:F.currency??"",userCountry:b??"",isCountrySelectorEnabled:D})});const se=d.useCallback(h=>{St.addAction("chatgpt_selected_country_changed_in_pricing_modal",{old_selected_country:A,new_selected_country:h}),f.logEventWithStatsig("Selected country changed in pricing modal","chatgpt_selected_country_changed_in_pricing_modal",{old_selected_country:A,new_selected_country:h}),N(h)},[A,N]),ne=h=>{x(h),f.logEventWithStatsig("Account Pay: Account Payment Modal Toggle Clicked","chatgpt_account_payment_modal_toggle_clicked",{selectedTab:h})},K=136,[J,Y]=d.useState(),U=d.useRef(null);d.useEffect(()=>{const h=()=>{if(U.current){const E=document.documentElement.clientHeight,X=U.current.getBoundingClientRect().height,ce=E-X;Y(Math.max(ce,K))}};return h(),window.addEventListener("resize",h),()=>window.removeEventListener("resize",h)},[w]);const C=hs({analyticsParams:k,currentAccount:t,planLoading:r,selectedTab:w,setPlanLoading:i,shouldSplitBetweenPersonalAndBusiness:R,billingDetails:F,scrollExperimentVariant:H,onClose:a,isWebRedesign:M,shouldShowLocalizedFeatures:S}),B=xs({defaultTitle:n,hasProSubscription:t.isPro()}),O=d.useRef(!1),$=d.useRef(!1);d.useEffect(()=>{const h=document.getElementById(bt);h?.scrollIntoView&&!$.current&&H==="scroll_to_plus"&&(h.scrollIntoView({behavior:"smooth"}),$.current=!0)},[H]),d.useEffect(()=>{if(g)return;const h=document.getElementById(Pt);if(!(!h||!h.scrollIntoView||O.current)){if(U.current&&!R&&s==="business")h.scrollIntoView({behavior:"smooth"}),f.logEvent("Account Pay: Account Payment Modal Scroll",{selectedTab:"business",scrollSource:"auto"}),O.current=!0;else if(!R){const E=new IntersectionObserver(X=>{X.some(ce=>ce.isIntersecting)&&(f.logEvent("Account Pay: Account Payment Modal Scroll",{selectedTab:"business",scrollSource:"manual"}),O.current=!0,E.disconnect())},{root:null,threshold:.5});return E.observe(h),()=>E.disconnect()}}},[t,s,g,R]);const le=M?"flex justify-center gap-6 flex-col md:flex-row px-4":"flex flex-col justify-center gap-4 px-3 py-3 md:min-h-[30rem] md:flex-row md:gap-0 md:py-0";return e.jsxs(me,{testId:"modal-account-payment",size:"fullscreen",isOpen:!0,onClose:P,type:"success",className:"flex flex-col",removePopoverStyling:!0,children:[e.jsxs("div",{ref:U,className:I(M&&"bg-token-bg-elevated-secondary"),children:[e.jsxs("div",{className:I("relative grid grid-cols-[1fr_auto_1fr] px-6 py-4 md:pt-[4.5rem]",M?"md:pb-6":"md:pb-10"),children:[e.jsx("div",{}),e.jsxs("div",{className:"my-1 flex flex-col items-center justify-center md:mt-0 md:mb-0",children:[e.jsx("div",{className:"text-2xl font-semibold md:text-3xl",children:e.jsx(l,{...B})}),o?e.jsx("div",{className:"text-token-text-secondary mt-3 mb-1",children:e.jsx(l,{...o})}):null]}),e.jsx("button",{className:"text-token-text-primary justify-self-end opacity-50 transition hover:opacity-75 md:absolute md:end-6 md:top-6",onClick:()=>{P()},children:e.jsx(ha,{className:I({"h-5 w-5":!m,"icon-lg":m})})})]}),t.isPersonalAccount()&&R?e.jsx("div",{className:I("mb-3 flex justify-center",M?"md:mb-6":"md:mb-10"),children:e.jsx("div",{className:"w-[fit-content]",children:e.jsx(Wa,{value:w,onChange:ne})})}):null,e.jsx("div",{className:le,children:C})]}),e.jsxs("div",{className:I("relative grid grid-cols-[1fr_auto_1fr]",M&&"bg-token-bg-elevated-secondary"),style:{height:`${J}px`},children:[e.jsx("div",{}),e.jsxs("span",{className:I("text-token-text-secondary mt-8 mb-12 flex flex-col items-center justify-start gap-2 text-sm md:mt-8 md:mb-8",M&&"md:mt-10"),children:[e.jsx(Ya,{}),e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx(l,{...Be.needMoreCapabilities}),e.jsx("div",{children:e.jsx(l,{...Be.seeChatGptEnterprise,values:{link:h=>e.jsx(te,{target:"_blank",to:ya,onClick:()=>{f.logEventWithStatsig("Account Pay: Click see enterprise link from Modal","chatgpt_account_payment_modal_enterprise_link_clicked")},className:I("mx-1 underline",M&&"font-medium"),children:h})}})})]})]}),e.jsx("span",{"data-testid":"country-selector-in-pricing-modal",className:I({hidden:!D},"text-token-text-primary justify-self-end opacity-50 transition hover:opacity-75 md:absolute md:end-4 md:bottom-4"),children:e.jsx(Ha,{onChange:se,value:A})})]})]})}function Ms({currentAccount:t,selectedTab:s}){return!!(!t.hasPaidSubscription()||(t.isPlus()||t.isPro())&&s==="business"||t.isTeam())}function xs({defaultTitle:t,hasProSubscription:s}){return t||(s?Be.proModalTitle:Be.modalTitle)}const Be=de({modalTitle:{id:"AccountPaymentModal.modalTitle",defaultMessage:"Upgrade your plan"},proModalTitle:{id:"AccountPaymentModal.proModalTitle",defaultMessage:"Choose your plan"},modalFooterCapabilities:{id:"AccountPaymentModal.modalFooterCapabilities",defaultMessage:"Need more capabilities? See <link> ChatGPT Enterprise </link>"},needMoreCapabilities:{id:"SdJWr7",defaultMessage:"Need more capabilities for your business?"},seeChatGptEnterprise:{id:"7C5fuF",defaultMessage:"See<link>ChatGPT Enterprise</link>"},promoNotEligibleMessage:{id:"AccountPaymentModal.promoNotEligibleMessage",defaultMessage:"Thanks for being a susbcriber. Since you already use ChatGPT Plus, you're not eligible for this offer."}});export{Ts as A,ls as P,es as T,ns as a,Ja as b,ts as c,Dt as d,Es as g,et as h};
//# sourceMappingURL=gub5dec34n0efh92.js.map
