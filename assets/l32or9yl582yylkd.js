import{rA as je}from"./g670b8vtkhx0yc6d.js";import{tp as Ge,tq as Ve,tr as b,ts as E,tt as x,tu as R,tv as ae,tw as Y,tx as ue,ty as Fe,tz as ke,tA as O,tB as Ke,tC as Xt,tD as Kt,tE as K}from"./forbprkns1cohsbl.js";import"./gg0tb34p9fzo1omt.js";var se=Ge("OpenTelemetry SDK Context Key SUPPRESS_TRACING");function Ye(t){return t.setValue(se,!0)}function jt(t){return t.getValue(se)===!0}var We="=",It=";",_t=",",Rt="baggage",ze=180,qe=4096,$e=8192,Qe=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,o=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(u){a={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return o};function Ze(t){return t.reduce(function(e,r){var n=""+e+(e!==""?_t:"")+r;return n.length>$e?e:n},"")}function Je(t){return t.getAllEntries().map(function(e){var r=Qe(e,2),n=r[0],i=r[1],o=encodeURIComponent(n)+"="+encodeURIComponent(i.value);return i.metadata!==void 0&&(o+=It+i.metadata.toString()),o})}function fe(t){var e=t.split(It);if(!(e.length<=0)){var r=e.shift();if(r){var n=r.indexOf(We);if(!(n<=0)){var i=decodeURIComponent(r.substring(0,n).trim()),o=decodeURIComponent(r.substring(n+1).trim()),a;return e.length>0&&(a=Ve(e.join(It))),{key:i,value:o,metadata:a}}}}}function ce(t){return typeof t!="string"||t.length===0?{}:t.split(_t).map(function(e){return fe(e)}).filter(function(e){return e!==void 0&&e.value.length>0}).reduce(function(e,r){return e[r.key]=r.value,e},{})}var tr=function(){function t(){}return t.prototype.inject=function(e,r,n){var i=b.getBaggage(e);if(!(!i||jt(e))){var o=Je(i).filter(function(u){return u.length<=qe}).slice(0,ze),a=Ze(o);a.length>0&&n.set(r,Rt,a)}},t.prototype.extract=function(e,r,n){var i=n.get(r,Rt),o=Array.isArray(i)?i.join(_t):i;if(!o)return e;var a={};if(o.length===0)return e;var u=o.split(_t);return u.forEach(function(s){var f=fe(s);if(f){var c={value:f.value};f.metadata&&(c.metadata=f.metadata),a[f.key]=c}}),Object.entries(a).length===0?e:b.setBaggage(e,b.createBaggage(a))},t.prototype.fields=function(){return[Rt]},t}(),_e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},er=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,o=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(u){a={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return o};function at(t){var e,r,n={};if(typeof t!="object"||t==null)return n;try{for(var i=_e(Object.entries(t)),o=i.next();!o.done;o=i.next()){var a=er(o.value,2),u=a[0],s=a[1];if(!rr(u)){E.warn("Invalid attribute key: "+u);continue}if(!de(s)){E.warn("Invalid attribute value set for key: "+u);continue}Array.isArray(s)?n[u]=s.slice():n[u]=s}}catch(f){e={error:f}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n}function rr(t){return typeof t=="string"&&t.length>0}function de(t){return t==null?!0:Array.isArray(t)?nr(t):le(t)}function nr(t){var e,r,n;try{for(var i=_e(t),o=i.next();!o.done;o=i.next()){var a=o.value;if(a!=null){if(!n){if(le(a)){n=typeof a;continue}return!1}if(typeof a!==n)return!1}}}catch(u){e={error:u}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return!0}function le(t){switch(typeof t){case"number":case"boolean":case"string":return!0}return!1}function ir(){return function(t){E.error(or(t))}}function or(t){return typeof t=="string"?t:JSON.stringify(ar(t))}function ar(t){for(var e={},r=t;r!==null;)Object.getOwnPropertyNames(r).forEach(function(n){if(!e[n]){var i=r[n];i&&(e[n]=String(i))}}),r=Object.getPrototypeOf(r);return e}var ur=ir();function dt(t){try{ur(t)}catch{}}var I;(function(t){t.AlwaysOff="always_off",t.AlwaysOn="always_on",t.ParentBasedAlwaysOff="parentbased_always_off",t.ParentBasedAlwaysOn="parentbased_always_on",t.ParentBasedTraceIdRatio="parentbased_traceidratio",t.TraceIdRatio="traceidratio"})(I||(I={}));var j=typeof globalThis=="object"?globalThis:typeof self=="object"?self:typeof window=="object"?window:typeof global=="object"?global:{},Yt={},sr=",",fr=["OTEL_SDK_DISABLED"];function cr(t){return fr.indexOf(t)>-1}var _r=["OTEL_BSP_EXPORT_TIMEOUT","OTEL_BSP_MAX_EXPORT_BATCH_SIZE","OTEL_BSP_MAX_QUEUE_SIZE","OTEL_BSP_SCHEDULE_DELAY","OTEL_BLRP_EXPORT_TIMEOUT","OTEL_BLRP_MAX_EXPORT_BATCH_SIZE","OTEL_BLRP_MAX_QUEUE_SIZE","OTEL_BLRP_SCHEDULE_DELAY","OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT","OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_EVENT_COUNT_LIMIT","OTEL_SPAN_LINK_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT","OTEL_EXPORTER_OTLP_TIMEOUT","OTEL_EXPORTER_OTLP_TRACES_TIMEOUT","OTEL_EXPORTER_OTLP_METRICS_TIMEOUT","OTEL_EXPORTER_OTLP_LOGS_TIMEOUT","OTEL_EXPORTER_JAEGER_AGENT_PORT"];function dr(t){return _r.indexOf(t)>-1}var lr=["OTEL_NO_PATCH_MODULES","OTEL_PROPAGATORS"];function pr(t){return lr.indexOf(t)>-1}var ut=1/0,st=128,Er=128,Tr=128,pe={OTEL_SDK_DISABLED:!1,CONTAINER_NAME:"",ECS_CONTAINER_METADATA_URI_V4:"",ECS_CONTAINER_METADATA_URI:"",HOSTNAME:"",KUBERNETES_SERVICE_HOST:"",NAMESPACE:"",OTEL_BSP_EXPORT_TIMEOUT:3e4,OTEL_BSP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BSP_MAX_QUEUE_SIZE:2048,OTEL_BSP_SCHEDULE_DELAY:5e3,OTEL_BLRP_EXPORT_TIMEOUT:3e4,OTEL_BLRP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BLRP_MAX_QUEUE_SIZE:2048,OTEL_BLRP_SCHEDULE_DELAY:5e3,OTEL_EXPORTER_JAEGER_AGENT_HOST:"",OTEL_EXPORTER_JAEGER_AGENT_PORT:6832,OTEL_EXPORTER_JAEGER_ENDPOINT:"",OTEL_EXPORTER_JAEGER_PASSWORD:"",OTEL_EXPORTER_JAEGER_USER:"",OTEL_EXPORTER_OTLP_ENDPOINT:"",OTEL_EXPORTER_OTLP_TRACES_ENDPOINT:"",OTEL_EXPORTER_OTLP_METRICS_ENDPOINT:"",OTEL_EXPORTER_OTLP_LOGS_ENDPOINT:"",OTEL_EXPORTER_OTLP_HEADERS:"",OTEL_EXPORTER_OTLP_TRACES_HEADERS:"",OTEL_EXPORTER_OTLP_METRICS_HEADERS:"",OTEL_EXPORTER_OTLP_LOGS_HEADERS:"",OTEL_EXPORTER_OTLP_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_TRACES_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_METRICS_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_LOGS_TIMEOUT:1e4,OTEL_EXPORTER_ZIPKIN_ENDPOINT:"http://localhost:9411/api/v2/spans",OTEL_LOG_LEVEL:x.INFO,OTEL_NO_PATCH_MODULES:[],OTEL_PROPAGATORS:["tracecontext","baggage"],OTEL_RESOURCE_ATTRIBUTES:"",OTEL_SERVICE_NAME:"",OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT:ut,OTEL_ATTRIBUTE_COUNT_LIMIT:st,OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT:ut,OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT:st,OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT:ut,OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT:st,OTEL_SPAN_EVENT_COUNT_LIMIT:128,OTEL_SPAN_LINK_COUNT_LIMIT:128,OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT:Er,OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT:Tr,OTEL_TRACES_EXPORTER:"",OTEL_TRACES_SAMPLER:I.ParentBasedAlwaysOn,OTEL_TRACES_SAMPLER_ARG:"",OTEL_LOGS_EXPORTER:"",OTEL_EXPORTER_OTLP_INSECURE:"",OTEL_EXPORTER_OTLP_TRACES_INSECURE:"",OTEL_EXPORTER_OTLP_METRICS_INSECURE:"",OTEL_EXPORTER_OTLP_LOGS_INSECURE:"",OTEL_EXPORTER_OTLP_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_LOGS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_COMPRESSION:"",OTEL_EXPORTER_OTLP_TRACES_COMPRESSION:"",OTEL_EXPORTER_OTLP_METRICS_COMPRESSION:"",OTEL_EXPORTER_OTLP_LOGS_COMPRESSION:"",OTEL_EXPORTER_OTLP_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_LOGS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_LOGS_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_TRACES_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_LOGS_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE:"cumulative"};function hr(t,e,r){if(!(typeof r[t]>"u")){var n=String(r[t]);e[t]=n.toLowerCase()==="true"}}function vr(t,e,r,n,i){if(n===void 0&&(n=-1/0),i===void 0&&(i=1/0),typeof r[t]<"u"){var o=Number(r[t]);isNaN(o)||(o<n?e[t]=n:o>i?e[t]=i:e[t]=o)}}function Or(t,e,r,n){n===void 0&&(n=sr);var i=r[t];typeof i=="string"&&(e[t]=i.split(n).map(function(o){return o.trim()}))}var Sr={ALL:x.ALL,VERBOSE:x.VERBOSE,DEBUG:x.DEBUG,INFO:x.INFO,WARN:x.WARN,ERROR:x.ERROR,NONE:x.NONE};function yr(t,e,r){var n=r[t];if(typeof n=="string"){var i=Sr[n.toUpperCase()];i!=null&&(e[t]=i)}}function Nt(t){var e={};for(var r in pe){var n=r;switch(n){case"OTEL_LOG_LEVEL":yr(n,e,t);break;default:if(cr(n))hr(n,e,t);else if(dr(n))vr(n,e,t);else if(pr(n))Or(n,e,t);else{var i=t[n];typeof i<"u"&&i!==null&&(e[n]=String(i))}}}return e}function mr(){return Nt(typeof process<"u"&&process&&Yt?Yt:j)}function y(){var t=Nt(j);return Object.assign({},pe,t)}function J(t){for(var e=t.length,r="",n=0;n<e;n+=2){var i=t.substring(n,n+2),o=parseInt(i,16);r+=String.fromCharCode(o)}return btoa(r)}var C=performance,Rr="1.17.1",S={EXCEPTION_TYPE:"exception.type",EXCEPTION_MESSAGE:"exception.message",EXCEPTION_STACKTRACE:"exception.stacktrace",HTTP_METHOD:"http.method",HTTP_URL:"http.url",HTTP_HOST:"http.host",HTTP_SCHEME:"http.scheme",HTTP_STATUS_CODE:"http.status_code",HTTP_USER_AGENT:"http.user_agent",HTTP_RESPONSE_CONTENT_LENGTH:"http.response_content_length",HTTP_RESPONSE_CONTENT_LENGTH_UNCOMPRESSED:"http.response_content_length_uncompressed"},P={PROCESS_RUNTIME_NAME:"process.runtime.name",SERVICE_NAME:"service.name",TELEMETRY_SDK_NAME:"telemetry.sdk.name",TELEMETRY_SDK_LANGUAGE:"telemetry.sdk.language",TELEMETRY_SDK_VERSION:"telemetry.sdk.version"},Ar={WEBJS:"webjs"},F,At=(F={},F[P.TELEMETRY_SDK_NAME]="opentelemetry",F[P.PROCESS_RUNTIME_NAME]="browser",F[P.TELEMETRY_SDK_LANGUAGE]=Ar.WEBJS,F[P.TELEMETRY_SDK_VERSION]=Rr,F);var gr=9,Lr=6,Pr=Math.pow(10,Lr),lt=Math.pow(10,gr);function M(t){var e=t/1e3,r=Math.trunc(e),n=Math.round(t%1e3*Pr);return[r,n]}function Gt(){var t=C.timeOrigin;if(typeof t!="number"){var e=C;t=e.timing&&e.timing.fetchStart}return t}function W(t){var e=M(Gt()),r=M(typeof t=="number"?t:C.now());return Ee(e,r)}function tt(t){if(Vt(t))return t;if(typeof t=="number")return t<Gt()?W(t):M(t);if(t instanceof Date)return M(t.getTime());throw TypeError("Invalid input type")}function Cr(t,e){var r=e[0]-t[0],n=e[1]-t[1];return n<0&&(r-=1,n+=lt),[r,n]}function U(t){return t[0]*lt+t[1]}function Vt(t){return Array.isArray(t)&&t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number"}function Wt(t){return Vt(t)||typeof t=="number"||t instanceof Date}function Ee(t,e){var r=[t[0]+e[0],t[1]+e[1]];return r[1]>=lt&&(r[1]-=lt,r[0]+=1),r}var X;(function(t){t[t.SUCCESS=0]="SUCCESS",t[t.FAILED=1]="FAILED"})(X||(X={}));var br=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Te=function(){function t(e){e===void 0&&(e={});var r;this._propagators=(r=e.propagators)!==null&&r!==void 0?r:[],this._fields=Array.from(new Set(this._propagators.map(function(n){return typeof n.fields=="function"?n.fields():[]}).reduce(function(n,i){return n.concat(i)},[])))}return t.prototype.inject=function(e,r,n){var i,o;try{for(var a=br(this._propagators),u=a.next();!u.done;u=a.next()){var s=u.value;try{s.inject(e,r,n)}catch(f){E.warn("Failed to inject with "+s.constructor.name+". Err: "+f.message)}}}catch(f){i={error:f}}finally{try{u&&!u.done&&(o=a.return)&&o.call(a)}finally{if(i)throw i.error}}},t.prototype.extract=function(e,r,n){return this._propagators.reduce(function(i,o){try{return o.extract(i,r,n)}catch(a){E.warn("Failed to inject with "+o.constructor.name+". Err: "+a.message)}return i},e)},t.prototype.fields=function(){return this._fields.slice()},t}(),wt="[_0-9a-z-*/]",Ir="[a-z]"+wt+"{0,255}",Nr="[a-z0-9]"+wt+"{0,240}@[a-z]"+wt+"{0,13}",wr=new RegExp("^(?:"+Ir+"|"+Nr+")$"),Mr=/^[ -~]{0,255}[!-~]$/,xr=/,|=/;function Dr(t){return wr.test(t)}function Ur(t){return Mr.test(t)&&!xr.test(t)}var zt=32,Br=512,qt=",",$t="=",Hr=function(){function t(e){this._internalState=new Map,e&&this._parse(e)}return t.prototype.set=function(e,r){var n=this._clone();return n._internalState.has(e)&&n._internalState.delete(e),n._internalState.set(e,r),n},t.prototype.unset=function(e){var r=this._clone();return r._internalState.delete(e),r},t.prototype.get=function(e){return this._internalState.get(e)},t.prototype.serialize=function(){var e=this;return this._keys().reduce(function(r,n){return r.push(n+$t+e.get(n)),r},[]).join(qt)},t.prototype._parse=function(e){e.length>Br||(this._internalState=e.split(qt).reverse().reduce(function(r,n){var i=n.trim(),o=i.indexOf($t);if(o!==-1){var a=i.slice(0,o),u=i.slice(o+1,n.length);Dr(a)&&Ur(u)&&r.set(a,u)}return r},new Map),this._internalState.size>zt&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,zt))))},t.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},t.prototype._clone=function(){var e=new t;return e._internalState=new Map(this._internalState),e},t}(),ft="traceparent",gt="tracestate",Xr="00",jr="(?!ff)[\\da-f]{2}",Gr="(?![0]{32})[\\da-f]{32}",Vr="(?![0]{16})[\\da-f]{16}",Fr="[\\da-f]{2}",kr=new RegExp("^\\s?("+jr+")-("+Gr+")-("+Vr+")-("+Fr+")(-.*)?\\s?$");function Kr(t){var e=kr.exec(t);return!e||e[1]==="00"&&e[5]?null:{traceId:e[2],spanId:e[3],traceFlags:parseInt(e[4],16)}}var he=function(){function t(){}return t.prototype.inject=function(e,r,n){var i=R.getSpanContext(e);if(!(!i||jt(e)||!ae(i))){var o=Xr+"-"+i.traceId+"-"+i.spanId+"-0"+Number(i.traceFlags||Y.NONE).toString(16);n.set(r,ft,o),i.traceState&&n.set(r,gt,i.traceState.serialize())}},t.prototype.extract=function(e,r,n){var i=n.get(r,ft);if(!i)return e;var o=Array.isArray(i)?i[0]:i;if(typeof o!="string")return e;var a=Kr(o);if(!a)return e;a.isRemote=!0;var u=n.get(r,gt);if(u){var s=Array.isArray(u)?u.join(","):u;a.traceState=new Hr(typeof s=="string"?s:void 0)}return R.setSpanContext(e,a)},t.prototype.fields=function(){return[ft,gt]},t}(),Yr="[object Object]",Wr="[object Null]",zr="[object Undefined]",qr=Function.prototype,ve=qr.toString,$r=ve.call(Object),Qr=Zr(Object.getPrototypeOf,Object),Oe=Object.prototype,Se=Oe.hasOwnProperty,B=Symbol?Symbol.toStringTag:void 0,ye=Oe.toString;function Zr(t,e){return function(r){return t(e(r))}}function Qt(t){if(!Jr(t)||tn(t)!==Yr)return!1;var e=Qr(t);if(e===null)return!0;var r=Se.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&ve.call(r)===$r}function Jr(t){return t!=null&&typeof t=="object"}function tn(t){return t==null?t===void 0?zr:Wr:B&&B in Object(t)?en(t):rn(t)}function en(t){var e=Se.call(t,B),r=t[B],n=!1;try{t[B]=void 0,n=!0}catch{}var i=ye.call(t);return n&&(e?t[B]=r:delete t[B]),i}function rn(t){return ye.call(t)}var nn=20;function on(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=t.shift(),n=new WeakMap;t.length>0;)r=me(r,t.shift(),0,n);return r}function Lt(t){return pt(t)?t.slice():t}function me(t,e,r,n){r===void 0&&(r=0);var i;if(!(r>nn)){if(r++,ct(t)||ct(e)||Re(e))i=Lt(e);else if(pt(t)){if(i=t.slice(),pt(e))for(var o=0,a=e.length;o<a;o++)i.push(Lt(e[o]));else if(Q(e))for(var u=Object.keys(e),o=0,a=u.length;o<a;o++){var s=u[o];i[s]=Lt(e[s])}}else if(Q(t))if(Q(e)){if(!an(t,e))return e;i=Object.assign({},t);for(var u=Object.keys(e),o=0,a=u.length;o<a;o++){var s=u[o],f=e[s];if(ct(f))typeof f>"u"?delete i[s]:i[s]=f;else{var c=i[s],_=f;if(Zt(t,s,n)||Zt(e,s,n))delete i[s];else{if(Q(c)&&Q(_)){var d=n.get(c)||[],p=n.get(_)||[];d.push({obj:t,key:s}),p.push({obj:e,key:s}),n.set(c,d),n.set(_,p)}i[s]=me(i[s],f,r,n)}}}}else i=e;return i}}function Zt(t,e,r){for(var n=r.get(t[e])||[],i=0,o=n.length;i<o;i++){var a=n[i];if(a.key===e&&a.obj===t)return!0}return!1}function pt(t){return Array.isArray(t)}function Re(t){return typeof t=="function"}function Q(t){return!ct(t)&&!pt(t)&&!Re(t)&&typeof t=="object"}function ct(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t>"u"||t instanceof Date||t instanceof RegExp||t===null}function an(t,e){return!(!Qt(t)||!Qt(e))}var un=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function Ae(t,e){return typeof e=="string"?t===e:!!t.match(e)}function ge(t,e){var r,n;if(!e)return!1;try{for(var i=un(e),o=i.next();!o.done;o=i.next()){var a=o.value;if(Ae(t,a))return!0}}catch(u){r={error:u}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return!1}var sn=function(){function t(){var e=this;this._promise=new Promise(function(r,n){e._resolve=r,e._reject=n})}return Object.defineProperty(t.prototype,"promise",{get:function(){return this._promise},enumerable:!1,configurable:!0}),t.prototype.resolve=function(e){this._resolve(e)},t.prototype.reject=function(e){this._reject(e)},t}(),fn=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,o=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(u){a={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return o},cn=function(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return t.concat(o||Array.prototype.slice.call(e))},Le=function(){function t(e,r){this._callback=e,this._that=r,this._isCalled=!1,this._deferred=new sn}return Object.defineProperty(t.prototype,"isCalled",{get:function(){return this._isCalled},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"promise",{get:function(){return this._deferred.promise},enumerable:!1,configurable:!0}),t.prototype.call=function(){for(var e,r=this,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];if(!this._isCalled){this._isCalled=!0;try{Promise.resolve((e=this._callback).call.apply(e,cn([this._that],fn(n),!1))).then(function(o){return r._deferred.resolve(o)},function(o){return r._deferred.reject(o)})}catch(o){this._deferred.reject(o)}}return this._deferred.promise},t}(),_n=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,o=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(u){a={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return o},Pe=1e4,dn=5,ln=1e3,pn=5e3,En=1.5;function Tn(t){t===void 0&&(t={});var e={};return Object.entries(t).forEach(function(r){var n=_n(r,2),i=n[0],o=n[1];typeof o<"u"?e[i]=String(o):E.warn('Header "'+i+'" has wrong value and will be ignored')}),e}function hn(t,e){return t.endsWith("/")||(t=t+"/"),t+e}function vn(t){try{var e=new URL(t);return e.pathname===""&&(e.pathname=e.pathname+"/"),e.toString()}catch{return E.warn("Could not parse export URL: '"+t+"'"),t}}function On(t){return typeof t=="number"?t<=0?Ce(t,Pe):t:Sn()}function Sn(){var t,e=Number((t=y().OTEL_EXPORTER_OTLP_TRACES_TIMEOUT)!==null&&t!==void 0?t:y().OTEL_EXPORTER_OTLP_TIMEOUT);return e<=0?Ce(e,Pe):e}function Ce(t,e){return E.warn("Timeout must be greater than 0",t),e}function yn(t){var e=[429,502,503,504];return e.includes(t)}function mn(t){if(t==null)return-1;var e=Number.parseInt(t,10);if(Number.isInteger(e))return e>0?e*1e3:-1;var r=new Date(t).getTime()-Date.now();return r>=0?r:0}var Rn=function(){function t(e){e===void 0&&(e={}),this._sendingPromises=[],this.url=this.getDefaultUrl(e),typeof e.hostname=="string"&&(this.hostname=e.hostname),this.shutdown=this.shutdown.bind(this),this._shutdownOnce=new Le(this._shutdown,this),this._concurrencyLimit=typeof e.concurrencyLimit=="number"?e.concurrencyLimit:1/0,this.timeoutMillis=On(e.timeoutMillis),this.onInit(e)}return t.prototype.export=function(e,r){if(this._shutdownOnce.isCalled){r({code:X.FAILED,error:new Error("Exporter has been shutdown")});return}if(this._sendingPromises.length>=this._concurrencyLimit){r({code:X.FAILED,error:new Error("Concurrent export limit reached")});return}this._export(e).then(function(){r({code:X.SUCCESS})}).catch(function(n){r({code:X.FAILED,error:n})})},t.prototype._export=function(e){var r=this;return new Promise(function(n,i){try{E.debug("items to be sent",e),r.send(e,n,i)}catch(o){i(o)}})},t.prototype.shutdown=function(){return this._shutdownOnce.call()},t.prototype.forceFlush=function(){return Promise.all(this._sendingPromises).then(function(){})},t.prototype._shutdown=function(){return E.debug("shutdown started"),this.onShutdown(),this.forceFlush()},t}(),An=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Z=function(t){An(e,t);function e(r,n,i){var o=t.call(this,r)||this;return o.name="OTLPExporterError",o.data=i,o.code=n,o}return e}(Error),Et=function(){return Et=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Et.apply(this,arguments)},gn=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,o=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(u){a={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return o};function Ln(t,e,r,n,i){if(navigator.sendBeacon(e,new Blob([t],r)))E.debug("sendBeacon - can send",t),n();else{var o=new Z("sendBeacon - cannot send "+t);i(o)}}function Pn(t,e,r,n,i,o){var a,u,s=!1,f=setTimeout(function(){if(clearTimeout(a),s=!0,u.readyState===XMLHttpRequest.DONE){var _=new Z("Request Timeout");o(_)}else u.abort()},n),c=function(_,d){_===void 0&&(_=dn),d===void 0&&(d=ln),u=new XMLHttpRequest,u.open("POST",e);var p={Accept:"application/json","Content-Type":"application/json"};Object.entries(Et(Et({},p),r)).forEach(function(T){var v=gn(T,2),g=v[0],h=v[1];u.setRequestHeader(g,h)}),u.send(t),u.onreadystatechange=function(){if(u.readyState===XMLHttpRequest.DONE&&s===!1)if(u.status>=200&&u.status<=299)E.debug("xhr success",t),i(),clearTimeout(f),clearTimeout(a);else if(u.status&&yn(u.status)&&_>0){var T=void 0;d=En*d,u.getResponseHeader("Retry-After")?T=mn(u.getResponseHeader("Retry-After")):T=Math.round(Math.random()*(pn-d)+d),a=setTimeout(function(){c(_-1,d)},T)}else{var v=new Z("Failed to export with XHR (status: "+u.status+")",u.status);o(v),clearTimeout(f),clearTimeout(a)}},u.onabort=function(){if(s){var T=new Z("Request Timeout");o(T)}clearTimeout(f),clearTimeout(a)},u.onerror=function(){if(s){var T=new Z("Request Timeout");o(T)}clearTimeout(f),clearTimeout(a)}};c()}var Cn=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),bn=function(t){Cn(e,t);function e(r){r===void 0&&(r={});var n=t.call(this,r)||this;return n._useXHR=!1,n._useXHR=!!r.headers||typeof navigator.sendBeacon!="function",n._useXHR?n._headers=Object.assign({},Tn(r.headers),ce(y().OTEL_EXPORTER_OTLP_HEADERS)):n._headers={},n}return e.prototype.onInit=function(){j.addEventListener("unload",this.shutdown)},e.prototype.onShutdown=function(){j.removeEventListener("unload",this.shutdown)},e.prototype.send=function(r,n,i){var o=this;if(this._shutdownOnce.isCalled){E.debug("Shutdown already started. Cannot send objects");return}var a=this.convert(r),u=JSON.stringify(a),s=new Promise(function(c,_){o._useXHR?Pn(u,o.url,o._headers,o.timeoutMillis,c,_):Ln(u,o.url,{type:"application/json"},c,_)}).then(n,i);this._sendingPromises.push(s);var f=function(){var c=o._sendingPromises.indexOf(s);o._sendingPromises.splice(c,1)};s.then(f,f)},e}(Rn),In=65536*65536,Mt=function(){function t(e,r){this.low=e,this.high=r}return t.fromU32=function(e){return new t(e%In|0,0)},t.prototype.multiply=function(e){var r=this.high>>>16,n=this.high&65535,i=this.low>>>16,o=this.low&65535,a=e.high>>>16,u=e.high&65535,s=e.low>>>16,f=e.low&65535,c=0,_=0,d=0,p=0;return p+=o*f,d+=p>>>16,p&=65535,d+=i*f,_+=d>>>16,d&=65535,d+=o*s,_+=d>>>16,d&=65535,_+=n*f,c+=_>>>16,_&=65535,_+=i*s,c+=_>>>16,_&=65535,_+=o*u,c+=_>>>16,_&=65535,c+=r*f+n*s+i*u+o*a,c&=65535,new t(d<<16|p,c<<16|_)},t.prototype.add=function(e){var r=this.high>>>16,n=this.high&65535,i=this.low>>>16,o=this.low&65535,a=e.high>>>16,u=e.high&65535,s=e.low>>>16,f=e.low&65535,c=0,_=0,d=0,p=0;return p+=o+f,d+=p>>>16,p&=65535,d+=i+s,_+=d>>>16,d&=65535,_+=n+u,c+=_>>>16,_&=65535,c+=r+a,c&=65535,new t(d<<16|p,c<<16|_)},t.fromString=function(e){for(var r=t.fromU32(0),n=0;n<e.length;n+=8){var i=Math.min(8,e.length-n),o=parseInt(e.substring(n,n+i));if(i<8){var a=t.fromU32(Math.pow(10,i));r=r.multiply(a).add(t.fromU32(o))}else r=r.multiply(t.fromU32(1e8)),r=r.add(t.fromU32(o))}return r},t}(),Nn=Mt.fromU32(1e9);function xt(t){return Mt.fromU32(t[0]).multiply(Nn).add(Mt.fromU32(t[1]))}var wn=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,o=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(u){a={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return o};function St(t){return Object.keys(t).map(function(e){return be(e,t[e])})}function be(t,e){return{key:t,value:Ie(e)}}function Ie(t){var e=typeof t;return e==="string"?{stringValue:t}:e==="number"?Number.isInteger(t)?{intValue:t}:{doubleValue:t}:e==="boolean"?{boolValue:t}:t instanceof Uint8Array?{bytesValue:t}:Array.isArray(t)?{arrayValue:{values:t.map(Ie)}}:e==="object"&&t!=null?{kvlistValue:{values:Object.entries(t).map(function(r){var n=wn(r,2),i=n[0],o=n[1];return be(i,o)})}}:{}}function Mn(t,e){var r,n=t.spanContext(),i=t.status,o=e?t.parentSpanId:t.parentSpanId!=null?J(t.parentSpanId):void 0;return{traceId:e?n.traceId:J(n.traceId),spanId:e?n.spanId:J(n.spanId),parentSpanId:o,traceState:(r=n.traceState)===null||r===void 0?void 0:r.serialize(),name:t.name,kind:t.kind==null?0:t.kind+1,startTimeUnixNano:xt(t.startTime),endTimeUnixNano:xt(t.endTime),attributes:St(t.attributes),droppedAttributesCount:t.droppedAttributesCount,events:t.events.map(Dn),droppedEventsCount:t.droppedEventsCount,status:{code:i.code,message:i.message},links:t.links.map(function(a){return xn(a,e)}),droppedLinksCount:t.droppedLinksCount}}function xn(t,e){var r;return{attributes:t.attributes?St(t.attributes):[],spanId:e?t.context.spanId:J(t.context.spanId),traceId:e?t.context.traceId:J(t.context.traceId),traceState:(r=t.context.traceState)===null||r===void 0?void 0:r.serialize(),droppedAttributesCount:t.droppedAttributesCount||0}}function Dn(t){return{attributes:t.attributes?St(t.attributes):[],name:t.name,timeUnixNano:xt(t.time),droppedAttributesCount:t.droppedAttributesCount||0}}var Un=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Bn=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,o=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(u){a={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return o};function Hn(t,e){return{resourceSpans:jn(t,e)}}function Xn(t){var e,r,n=new Map;try{for(var i=Un(t),o=i.next();!o.done;o=i.next()){var a=o.value,u=n.get(a.resource);u||(u=new Map,n.set(a.resource,u));var s=a.instrumentationLibrary.name+"@"+(a.instrumentationLibrary.version||"")+":"+(a.instrumentationLibrary.schemaUrl||""),f=u.get(s);f||(f=[],u.set(s,f)),f.push(a)}}catch(c){e={error:c}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n}function jn(t,e){for(var r=Xn(t),n=[],i=r.entries(),o=i.next();!o.done;){for(var a=Bn(o.value,2),u=a[0],s=a[1],f=[],c=s.values(),_=c.next();!_.done;){var d=_.value;if(d.length>0){var p=d[0].instrumentationLibrary,T=p.name,v=p.version,g=p.schemaUrl,h=d.map(function(L){return Mn(L,e)});f.push({scope:{name:T,version:v},spans:h,schemaUrl:g})}_=c.next()}var m={resource:{attributes:St(u.attributes),droppedAttributesCount:0},scopeSpans:f,schemaUrl:void 0};n.push(m),o=i.next()}return n}function Gn(){return"unknown_service"}var D=function(){return D=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},D.apply(this,arguments)},Vn=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(a){a(o)})}return new(r||(r=Promise))(function(o,a){function u(c){try{f(n.next(c))}catch(_){a(_)}}function s(c){try{f(n.throw(c))}catch(_){a(_)}}function f(c){c.done?o(c.value):i(c.value).then(u,s)}f((n=n.apply(t,e||[])).next())})},Fn=function(t,e){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,a;return a={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function u(f){return function(c){return s([f,c])}}function s(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(o=f[0]&2?i.return:f[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,f[1])).done)return o;switch(i=0,o&&(f=[f[0]&2,o.value]),f[0]){case 0:case 1:o=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!o||f[1]>o[0]&&f[1]<o[3])){r.label=f[1];break}if(f[0]===6&&r.label<o[1]){r.label=o[1],o=f;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(f);break}o[2]&&r.ops.pop(),r.trys.pop();continue}f=e.call(t,r)}catch(c){f=[6,c],i=0}finally{n=o=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}},kn=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,o=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(u){a={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return o},Dt=function(){function t(e,r){var n=this,i;this._attributes=e,this.asyncAttributesPending=r!=null,this._syncAttributes=(i=this._attributes)!==null&&i!==void 0?i:{},this._asyncAttributesPromise=r?.then(function(o){return n._attributes=Object.assign({},n._attributes,o),n.asyncAttributesPending=!1,o},function(o){return E.debug("a resource's async attributes promise rejected: %s",o),n.asyncAttributesPending=!1,{}})}return t.empty=function(){return t.EMPTY},t.default=function(){var e;return new t((e={},e[P.SERVICE_NAME]=Gn(),e[P.TELEMETRY_SDK_LANGUAGE]=At[P.TELEMETRY_SDK_LANGUAGE],e[P.TELEMETRY_SDK_NAME]=At[P.TELEMETRY_SDK_NAME],e[P.TELEMETRY_SDK_VERSION]=At[P.TELEMETRY_SDK_VERSION],e))},Object.defineProperty(t.prototype,"attributes",{get:function(){var e;return this.asyncAttributesPending&&E.error("Accessing resource attributes before async attributes settled"),(e=this._attributes)!==null&&e!==void 0?e:{}},enumerable:!1,configurable:!0}),t.prototype.waitForAsyncAttributes=function(){return Vn(this,void 0,void 0,function(){return Fn(this,function(e){switch(e.label){case 0:return this.asyncAttributesPending?[4,this._asyncAttributesPromise]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.merge=function(e){var r=this,n;if(!e)return this;var i=D(D({},this._syncAttributes),(n=e._syncAttributes)!==null&&n!==void 0?n:e.attributes);if(!this._asyncAttributesPromise&&!e._asyncAttributesPromise)return new t(i);var o=Promise.all([this._asyncAttributesPromise,e._asyncAttributesPromise]).then(function(a){var u,s=kn(a,2),f=s[0],c=s[1];return D(D(D(D({},r._syncAttributes),f),(u=e._syncAttributes)!==null&&u!==void 0?u:e.attributes),c)});return new t(i,o)},t.EMPTY=new t({}),t}(),Kn=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ne="v1/traces",Yn="http://localhost:4318/"+Ne,Wn=function(t){Kn(e,t);function e(r){r===void 0&&(r={});var n=t.call(this,r)||this;return n._headers=Object.assign(n._headers,ce(y().OTEL_EXPORTER_OTLP_TRACES_HEADERS)),n}return e.prototype.convert=function(r){return Hn(r,!0)},e.prototype.getDefaultUrl=function(r){return typeof r.url=="string"?r.url:y().OTEL_EXPORTER_OTLP_TRACES_ENDPOINT.length>0?vn(y().OTEL_EXPORTER_OTLP_TRACES_ENDPOINT):y().OTEL_EXPORTER_OTLP_ENDPOINT.length>0?hn(y().OTEL_EXPORTER_OTLP_ENDPOINT,Ne):Yn},e}(bn);function we(t){t===void 0&&(t=[]);for(var e=[],r=0,n=t.length;r<n;r++){var i=t[r];if(Array.isArray(i)){var o=we(i);e=e.concat(o.instrumentations)}else typeof i=="function"?e.push(new i):i.instrumentationName&&e.push(i)}return{instrumentations:e}}function zn(t,e,r){for(var n=0,i=t.length;n<i;n++){var o=t[n];e&&o.setTracerProvider(e),r&&o.setMeterProvider(r),o.getConfig().enabled||o.enable()}}function qn(t){t.forEach(function(e){return e.disable()})}function $n(t){var e=we(t.instrumentations).instrumentations,r=t.tracerProvider||R.getTracerProvider(),n=t.meterProvider||ue.getMeterProvider();return zn(e,r,n),function(){qn(e)}}var Pt,Jt;function Qn(){if(Jt)return Pt;Jt=1;function t(s){return typeof s=="function"}var e=console.error.bind(console);function r(s,f,c){var _=!!s[f]&&s.propertyIsEnumerable(f);Object.defineProperty(s,f,{configurable:!0,enumerable:_,writable:!0,value:c})}function n(s){s&&s.logger&&(t(s.logger)?e=s.logger:e("new logger isn't a function, not replacing"))}function i(s,f,c){if(!s||!s[f]){e("no original function "+f+" to wrap");return}if(!c){e("no wrapper function"),e(new Error().stack);return}if(!t(s[f])||!t(c)){e("original object and wrapper must be functions");return}var _=s[f],d=c(_,f);return r(d,"__original",_),r(d,"__unwrap",function(){s[f]===d&&r(s,f,_)}),r(d,"__wrapped",!0),r(s,f,d),d}function o(s,f,c){if(s)Array.isArray(s)||(s=[s]);else{e("must provide one or more modules to patch"),e(new Error().stack);return}if(!(f&&Array.isArray(f))){e("must provide one or more functions to wrap on modules");return}s.forEach(function(_){f.forEach(function(d){i(_,d,c)})})}function a(s,f){if(!s||!s[f]){e("no function to unwrap."),e(new Error().stack);return}if(!s[f].__unwrap)e("no original to unwrap to -- has "+f+" already been unwrapped?");else return s[f].__unwrap()}function u(s,f){if(s)Array.isArray(s)||(s=[s]);else{e("must provide one or more modules to patch"),e(new Error().stack);return}if(!(f&&Array.isArray(f))){e("must provide one or more functions to unwrap on modules");return}s.forEach(function(c){f.forEach(function(_){a(c,_)})})}return n.wrap=i,n.massWrap=o,n.unwrap=a,n.massUnwrap=u,Pt=n,Pt}var nt=Qn(),Ut=function(){return Ut=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},Ut.apply(this,arguments)},Zn=function(){function t(e,r,n){n===void 0&&(n={}),this.instrumentationName=e,this.instrumentationVersion=r,this._wrap=nt.wrap,this._unwrap=nt.unwrap,this._massWrap=nt.massWrap,this._massUnwrap=nt.massUnwrap,this._config=Ut({enabled:!0},n),this._diag=E.createComponentLogger({namespace:e}),this._tracer=R.getTracer(e,r),this._meter=ue.getMeter(e,r),this._updateMetricInstruments()}return Object.defineProperty(t.prototype,"meter",{get:function(){return this._meter},enumerable:!1,configurable:!0}),t.prototype.setMeterProvider=function(e){this._meter=e.getMeter(this.instrumentationName,this.instrumentationVersion),this._updateMetricInstruments()},t.prototype._updateMetricInstruments=function(){},t.prototype.getConfig=function(){return this._config},t.prototype.setConfig=function(e){e===void 0&&(e={}),this._config=Object.assign({},e)},t.prototype.setTracerProvider=function(e){this._tracer=e.getTracer(this.instrumentationName,this.instrumentationVersion)},Object.defineProperty(t.prototype,"tracer",{get:function(){return this._tracer},enumerable:!1,configurable:!0}),t}(),Jn=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ft=function(t){Jn(e,t);function e(r,n,i){i===void 0&&(i={});var o=t.call(this,r,n,i)||this;return o._config.enabled&&o.enable(),o}return e}(Zn);function Tt(t,e,r){var n,i;try{i=t()}catch(o){n=o}finally{return e(n,i),i}}function Bt(t){return typeof t=="function"&&typeof t.__original=="function"&&typeof t.__unwrap=="function"&&t.__wrapped===!0}var ti="exception",ei=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ri=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,o=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(u){a={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return o},ni=function(){function t(e,r,n,i,o,a,u,s,f){u===void 0&&(u=[]),this.attributes={},this.links=[],this.events=[],this._droppedAttributesCount=0,this._droppedEventsCount=0,this._droppedLinksCount=0,this.status={code:Fe.UNSET},this.endTime=[0,0],this._ended=!1,this._duration=[-1,-1],this.name=n,this._spanContext=i,this.parentSpanId=a,this.kind=o,this.links=u;var c=Date.now();this._performanceStartTime=C.now(),this._performanceOffset=c-(this._performanceStartTime+Gt()),this._startTimeProvided=s!=null,this.startTime=this._getTime(s??c),this.resource=e.resource,this.instrumentationLibrary=e.instrumentationLibrary,this._spanLimits=e.getSpanLimits(),this._spanProcessor=e.getActiveSpanProcessor(),this._spanProcessor.onStart(this,r),this._attributeValueLengthLimit=this._spanLimits.attributeValueLengthLimit||0}return t.prototype.spanContext=function(){return this._spanContext},t.prototype.setAttribute=function(e,r){return r==null||this._isSpanEnded()?this:e.length===0?(E.warn("Invalid attribute key: "+e),this):de(r)?Object.keys(this.attributes).length>=this._spanLimits.attributeCountLimit&&!Object.prototype.hasOwnProperty.call(this.attributes,e)?(this._droppedAttributesCount++,this):(this.attributes[e]=this._truncateToSize(r),this):(E.warn("Invalid attribute value set for key: "+e),this)},t.prototype.setAttributes=function(e){var r,n;try{for(var i=ei(Object.entries(e)),o=i.next();!o.done;o=i.next()){var a=ri(o.value,2),u=a[0],s=a[1];this.setAttribute(u,s)}}catch(f){r={error:f}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return this},t.prototype.addEvent=function(e,r,n){if(this._isSpanEnded())return this;if(this._spanLimits.eventCountLimit===0)return E.warn("No events allowed."),this._droppedEventsCount++,this;this.events.length>=this._spanLimits.eventCountLimit&&(E.warn("Dropping extra events."),this.events.shift(),this._droppedEventsCount++),Wt(r)&&(Wt(n)||(n=r),r=void 0);var i=at(r);return this.events.push({name:e,attributes:i,time:this._getTime(n),droppedAttributesCount:0}),this},t.prototype.setStatus=function(e){return this._isSpanEnded()?this:(this.status=e,this)},t.prototype.updateName=function(e){return this._isSpanEnded()?this:(this.name=e,this)},t.prototype.end=function(e){if(this._isSpanEnded()){E.error(this.name+" "+this._spanContext.traceId+"-"+this._spanContext.spanId+" - You can only call end() on a span once.");return}this._ended=!0,this.endTime=this._getTime(e),this._duration=Cr(this.startTime,this.endTime),this._duration[0]<0&&(E.warn("Inconsistent start and end time, startTime > endTime. Setting span duration to 0ms.",this.startTime,this.endTime),this.endTime=this.startTime.slice(),this._duration=[0,0]),this._spanProcessor.onEnd(this)},t.prototype._getTime=function(e){if(typeof e=="number"&&e<C.now())return W(e+this._performanceOffset);if(typeof e=="number")return M(e);if(e instanceof Date)return M(e.getTime());if(Vt(e))return e;if(this._startTimeProvided)return M(Date.now());var r=C.now()-this._performanceStartTime;return Ee(this.startTime,M(r))},t.prototype.isRecording=function(){return this._ended===!1},t.prototype.recordException=function(e,r){var n={};typeof e=="string"?n[S.EXCEPTION_MESSAGE]=e:e&&(e.code?n[S.EXCEPTION_TYPE]=e.code.toString():e.name&&(n[S.EXCEPTION_TYPE]=e.name),e.message&&(n[S.EXCEPTION_MESSAGE]=e.message),e.stack&&(n[S.EXCEPTION_STACKTRACE]=e.stack)),n[S.EXCEPTION_TYPE]||n[S.EXCEPTION_MESSAGE]?this.addEvent(ti,n,r):E.warn("Failed to record an exception "+e)},Object.defineProperty(t.prototype,"duration",{get:function(){return this._duration},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ended",{get:function(){return this._ended},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"droppedAttributesCount",{get:function(){return this._droppedAttributesCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"droppedEventsCount",{get:function(){return this._droppedEventsCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"droppedLinksCount",{get:function(){return this._droppedLinksCount},enumerable:!1,configurable:!0}),t.prototype._isSpanEnded=function(){return this._ended&&E.warn("Can not execute the operation on ended Span {traceId: "+this._spanContext.traceId+", spanId: "+this._spanContext.spanId+"}"),this._ended},t.prototype._truncateToLimitUtil=function(e,r){return e.length<=r?e:e.substr(0,r)},t.prototype._truncateToSize=function(e){var r=this,n=this._attributeValueLengthLimit;return n<=0?(E.warn("Attribute value limit must be positive, got "+n),e):typeof e=="string"?this._truncateToLimitUtil(e,n):Array.isArray(e)?e.map(function(i){return typeof i=="string"?r._truncateToLimitUtil(i,n):i}):e},t}(),z;(function(t){t[t.NOT_RECORD=0]="NOT_RECORD",t[t.RECORD=1]="RECORD",t[t.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"})(z||(z={}));var ht=function(){function t(){}return t.prototype.shouldSample=function(){return{decision:z.NOT_RECORD}},t.prototype.toString=function(){return"AlwaysOffSampler"},t}(),G=function(){function t(){}return t.prototype.shouldSample=function(){return{decision:z.RECORD_AND_SAMPLED}},t.prototype.toString=function(){return"AlwaysOnSampler"},t}(),Ct=function(){function t(e){var r,n,i,o;this._root=e.root,this._root||(dt(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new G),this._remoteParentSampled=(r=e.remoteParentSampled)!==null&&r!==void 0?r:new G,this._remoteParentNotSampled=(n=e.remoteParentNotSampled)!==null&&n!==void 0?n:new ht,this._localParentSampled=(i=e.localParentSampled)!==null&&i!==void 0?i:new G,this._localParentNotSampled=(o=e.localParentNotSampled)!==null&&o!==void 0?o:new ht}return t.prototype.shouldSample=function(e,r,n,i,o,a){var u=R.getSpanContext(e);return!u||!ae(u)?this._root.shouldSample(e,r,n,i,o,a):u.isRemote?u.traceFlags&Y.SAMPLED?this._remoteParentSampled.shouldSample(e,r,n,i,o,a):this._remoteParentNotSampled.shouldSample(e,r,n,i,o,a):u.traceFlags&Y.SAMPLED?this._localParentSampled.shouldSample(e,r,n,i,o,a):this._localParentNotSampled.shouldSample(e,r,n,i,o,a)},t.prototype.toString=function(){return"ParentBased{root="+this._root.toString()+", remoteParentSampled="+this._remoteParentSampled.toString()+", remoteParentNotSampled="+this._remoteParentNotSampled.toString()+", localParentSampled="+this._localParentSampled.toString()+", localParentNotSampled="+this._localParentNotSampled.toString()+"}"},t}(),te=function(){function t(e){e===void 0&&(e=0),this._ratio=e,this._ratio=this._normalize(e),this._upperBound=Math.floor(this._ratio*4294967295)}return t.prototype.shouldSample=function(e,r){return{decision:ke(r)&&this._accumulate(r)<this._upperBound?z.RECORD_AND_SAMPLED:z.NOT_RECORD}},t.prototype.toString=function(){return"TraceIdRatioBased{"+this._ratio+"}"},t.prototype._normalize=function(e){return typeof e!="number"||isNaN(e)?0:e>=1?1:e<=0?0:e},t.prototype._accumulate=function(e){for(var r=0,n=0;n<e.length/8;n++){var i=n*8,o=parseInt(e.slice(i,i+8),16);r=(r^o)>>>0}return r},t}(),ii=y(),oi=I.AlwaysOn,k=1;function Me(){return{sampler:xe(ii),forceFlushTimeoutMillis:3e4,generalLimits:{attributeValueLengthLimit:y().OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT,attributeCountLimit:y().OTEL_ATTRIBUTE_COUNT_LIMIT},spanLimits:{attributeValueLengthLimit:y().OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT,attributeCountLimit:y().OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT,linkCountLimit:y().OTEL_SPAN_LINK_COUNT_LIMIT,eventCountLimit:y().OTEL_SPAN_EVENT_COUNT_LIMIT,attributePerEventCountLimit:y().OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT,attributePerLinkCountLimit:y().OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT}}}function xe(t){switch(t===void 0&&(t=y()),t.OTEL_TRACES_SAMPLER){case I.AlwaysOn:return new G;case I.AlwaysOff:return new ht;case I.ParentBasedAlwaysOn:return new Ct({root:new G});case I.ParentBasedAlwaysOff:return new Ct({root:new ht});case I.TraceIdRatio:return new te(ee(t));case I.ParentBasedTraceIdRatio:return new Ct({root:new te(ee(t))});default:return E.error('OTEL_TRACES_SAMPLER value "'+t.OTEL_TRACES_SAMPLER+" invalid, defaulting to "+oi+'".'),new G}}function ee(t){if(t.OTEL_TRACES_SAMPLER_ARG===void 0||t.OTEL_TRACES_SAMPLER_ARG==="")return E.error("OTEL_TRACES_SAMPLER_ARG is blank, defaulting to "+k+"."),k;var e=Number(t.OTEL_TRACES_SAMPLER_ARG);return isNaN(e)?(E.error("OTEL_TRACES_SAMPLER_ARG="+t.OTEL_TRACES_SAMPLER_ARG+" was given, but it is invalid, defaulting to "+k+"."),k):e<0||e>1?(E.error("OTEL_TRACES_SAMPLER_ARG="+t.OTEL_TRACES_SAMPLER_ARG+" was given, but it is out of range ([0..1]), defaulting to "+k+"."),k):e}function ai(t){var e={sampler:xe()},r=Me(),n=Object.assign({},r,e,t);return n.generalLimits=Object.assign({},r.generalLimits,t.generalLimits||{}),n.spanLimits=Object.assign({},r.spanLimits,t.spanLimits||{}),n}function ui(t){var e,r,n,i,o,a,u,s,f,c,_,d,p=Object.assign({},t.spanLimits),T=mr();return p.attributeCountLimit=(a=(o=(i=(r=(e=t.spanLimits)===null||e===void 0?void 0:e.attributeCountLimit)!==null&&r!==void 0?r:(n=t.generalLimits)===null||n===void 0?void 0:n.attributeCountLimit)!==null&&i!==void 0?i:T.OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT)!==null&&o!==void 0?o:T.OTEL_ATTRIBUTE_COUNT_LIMIT)!==null&&a!==void 0?a:st,p.attributeValueLengthLimit=(d=(_=(c=(s=(u=t.spanLimits)===null||u===void 0?void 0:u.attributeValueLengthLimit)!==null&&s!==void 0?s:(f=t.generalLimits)===null||f===void 0?void 0:f.attributeValueLengthLimit)!==null&&c!==void 0?c:T.OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT)!==null&&_!==void 0?_:T.OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT)!==null&&d!==void 0?d:ut,Object.assign({},t,{spanLimits:p})}var si=function(){function t(e,r){this._exporter=e,this._isExporting=!1,this._finishedSpans=[],this._droppedSpansCount=0;var n=y();this._maxExportBatchSize=typeof r?.maxExportBatchSize=="number"?r.maxExportBatchSize:n.OTEL_BSP_MAX_EXPORT_BATCH_SIZE,this._maxQueueSize=typeof r?.maxQueueSize=="number"?r.maxQueueSize:n.OTEL_BSP_MAX_QUEUE_SIZE,this._scheduledDelayMillis=typeof r?.scheduledDelayMillis=="number"?r.scheduledDelayMillis:n.OTEL_BSP_SCHEDULE_DELAY,this._exportTimeoutMillis=typeof r?.exportTimeoutMillis=="number"?r.exportTimeoutMillis:n.OTEL_BSP_EXPORT_TIMEOUT,this._shutdownOnce=new Le(this._shutdown,this),this._maxExportBatchSize>this._maxQueueSize&&(E.warn("BatchSpanProcessor: maxExportBatchSize must be smaller or equal to maxQueueSize, setting maxExportBatchSize to match maxQueueSize"),this._maxExportBatchSize=this._maxQueueSize)}return t.prototype.forceFlush=function(){return this._shutdownOnce.isCalled?this._shutdownOnce.promise:this._flushAll()},t.prototype.onStart=function(e,r){},t.prototype.onEnd=function(e){this._shutdownOnce.isCalled||(e.spanContext().traceFlags&Y.SAMPLED)!==0&&this._addToBuffer(e)},t.prototype.shutdown=function(){return this._shutdownOnce.call()},t.prototype._shutdown=function(){var e=this;return Promise.resolve().then(function(){return e.onShutdown()}).then(function(){return e._flushAll()}).then(function(){return e._exporter.shutdown()})},t.prototype._addToBuffer=function(e){if(this._finishedSpans.length>=this._maxQueueSize){this._droppedSpansCount===0&&E.debug("maxQueueSize reached, dropping spans"),this._droppedSpansCount++;return}this._droppedSpansCount>0&&(E.warn("Dropped "+this._droppedSpansCount+" spans because maxQueueSize reached"),this._droppedSpansCount=0),this._finishedSpans.push(e),this._maybeStartTimer()},t.prototype._flushAll=function(){var e=this;return new Promise(function(r,n){for(var i=[],o=Math.ceil(e._finishedSpans.length/e._maxExportBatchSize),a=0,u=o;a<u;a++)i.push(e._flushOneBatch());Promise.all(i).then(function(){r()}).catch(n)})},t.prototype._flushOneBatch=function(){var e=this;return this._clearTimer(),this._finishedSpans.length===0?Promise.resolve():new Promise(function(r,n){var i=setTimeout(function(){n(new Error("Timeout"))},e._exportTimeoutMillis);O.with(Ye(O.active()),function(){var o=e._finishedSpans.splice(0,e._maxExportBatchSize),a=function(){return e._exporter.export(o,function(s){var f;clearTimeout(i),s.code===X.SUCCESS?r():n((f=s.error)!==null&&f!==void 0?f:new Error("BatchSpanProcessor: span export failed"))})},u=o.map(function(s){return s.resource}).filter(function(s){return s.asyncAttributesPending});u.length===0?a():Promise.all(u.map(function(s){var f;return(f=s.waitForAsyncAttributes)===null||f===void 0?void 0:f.call(s)})).then(a,function(s){dt(s),n(s)})})})},t.prototype._maybeStartTimer=function(){var e=this;if(!this._isExporting){var r=function(){e._isExporting=!0,e._flushOneBatch().then(function(){e._isExporting=!1,e._finishedSpans.length>0&&(e._clearTimer(),e._maybeStartTimer())}).catch(function(n){e._isExporting=!1,dt(n)})};if(this._finishedSpans.length>=this._maxExportBatchSize)return r();this._timer===void 0&&(this._timer=setTimeout(function(){return r()},this._scheduledDelayMillis),this._timer,void 0)}},t.prototype._clearTimer=function(){this._timer!==void 0&&(clearTimeout(this._timer),this._timer=void 0)},t}(),fi=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),De=function(t){fi(e,t);function e(r,n){var i=t.call(this,r,n)||this;return i.onInit(n),i}return e.prototype.onInit=function(r){var n=this;r?.disableAutoFlushOnDocumentHide!==!0&&typeof document<"u"&&(this._visibilityChangeListener=function(){document.visibilityState==="hidden"&&n.forceFlush()},this._pageHideListener=function(){n.forceFlush()},document.addEventListener("visibilitychange",this._visibilityChangeListener),document.addEventListener("pagehide",this._pageHideListener))},e.prototype.onShutdown=function(){typeof document<"u"&&(this._visibilityChangeListener&&document.removeEventListener("visibilitychange",this._visibilityChangeListener),this._pageHideListener&&document.removeEventListener("pagehide",this._pageHideListener))},e}(si),ci=8,_i=16,di=function(){function t(){this.generateTraceId=re(_i),this.generateSpanId=re(ci)}return t}(),it=Array(32);function re(t){return function(){for(var r=0;r<t*2;r++)it[r]=Math.floor(Math.random()*16)+48,it[r]>=58&&(it[r]+=39);return String.fromCharCode.apply(null,it.slice(0,t*2))}}var li=function(){function t(e,r,n){this._tracerProvider=n;var i=ai(r);this._sampler=i.sampler,this._generalLimits=i.generalLimits,this._spanLimits=i.spanLimits,this._idGenerator=r.idGenerator||new di,this.resource=n.resource,this.instrumentationLibrary=e}return t.prototype.startSpan=function(e,r,n){var i,o,a;r===void 0&&(r={}),n===void 0&&(n=O.active()),r.root&&(n=R.deleteSpan(n));var u=R.getSpan(n);if(jt(n)){E.debug("Instrumentation suppressed, returning Noop Span");var s=R.wrapSpanContext(Ke);return s}var f=u?.spanContext(),c=this._idGenerator.generateSpanId(),_,d,p;!f||!R.isSpanContextValid(f)?_=this._idGenerator.generateTraceId():(_=f.traceId,d=f.traceState,p=f.spanId);var T=(i=r.kind)!==null&&i!==void 0?i:Xt.INTERNAL,v=((o=r.links)!==null&&o!==void 0?o:[]).map(function($){return{context:$.context,attributes:at($.attributes)}}),g=at(r.attributes),h=this._sampler.shouldSample(n,_,e,T,g,v);d=(a=h.traceState)!==null&&a!==void 0?a:d;var m=h.decision===Kt.RECORD_AND_SAMPLED?Y.SAMPLED:Y.NONE,L={traceId:_,spanId:c,traceFlags:m,traceState:d};if(h.decision===Kt.NOT_RECORD){E.debug("Recording is off, propagating context in a non-recording span");var s=R.wrapSpanContext(L);return s}var rt=new ni(this,n,e,L,T,p,v,r.startTime),yt=at(Object.assign(g,h.attributes));return rt.setAttributes(yt),rt},t.prototype.startActiveSpan=function(e,r,n,i){var o,a,u;if(!(arguments.length<2)){arguments.length===2?u=r:arguments.length===3?(o=r,u=n):(o=r,a=n,u=i);var s=a??O.active(),f=this.startSpan(e,o,s),c=R.setSpan(s,f);return O.with(c,u,void 0,f)}},t.prototype.getGeneralLimits=function(){return this._generalLimits},t.prototype.getSpanLimits=function(){return this._spanLimits},t.prototype.getActiveSpanProcessor=function(){return this._tracerProvider.getActiveSpanProcessor()},t}(),ot=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},pi=function(){function t(e){this._spanProcessors=e}return t.prototype.forceFlush=function(){var e,r,n=[];try{for(var i=ot(this._spanProcessors),o=i.next();!o.done;o=i.next()){var a=o.value;n.push(a.forceFlush())}}catch(u){e={error:u}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return new Promise(function(u){Promise.all(n).then(function(){u()}).catch(function(s){dt(s||new Error("MultiSpanProcessor: forceFlush failed")),u()})})},t.prototype.onStart=function(e,r){var n,i;try{for(var o=ot(this._spanProcessors),a=o.next();!a.done;a=o.next()){var u=a.value;u.onStart(e,r)}}catch(s){n={error:s}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}},t.prototype.onEnd=function(e){var r,n;try{for(var i=ot(this._spanProcessors),o=i.next();!o.done;o=i.next()){var a=o.value;a.onEnd(e)}}catch(u){r={error:u}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},t.prototype.shutdown=function(){var e,r,n=[];try{for(var i=ot(this._spanProcessors),o=i.next();!o.done;o=i.next()){var a=o.value;n.push(a.shutdown())}}catch(u){e={error:u}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return new Promise(function(u,s){Promise.all(n).then(function(){u()},s)})},t}(),Ei=function(){function t(){}return t.prototype.onStart=function(e,r){},t.prototype.onEnd=function(e){},t.prototype.shutdown=function(){return Promise.resolve()},t.prototype.forceFlush=function(){return Promise.resolve()},t}(),H;(function(t){t[t.resolved=0]="resolved",t[t.timeout=1]="timeout",t[t.error=2]="error",t[t.unresolved=3]="unresolved"})(H||(H={}));var Ti=function(){function t(e){e===void 0&&(e={});var r;this._registeredSpanProcessors=[],this._tracers=new Map;var n=on({},Me(),ui(e));this.resource=(r=n.resource)!==null&&r!==void 0?r:Dt.empty(),this.resource=Dt.default().merge(this.resource),this._config=Object.assign({},n,{resource:this.resource});var i=this._buildExporterFromEnv();if(i!==void 0){var o=new De(i);this.activeSpanProcessor=o}else this.activeSpanProcessor=new Ei}return t.prototype.getTracer=function(e,r,n){var i=e+"@"+(r||"")+":"+(n?.schemaUrl||"");return this._tracers.has(i)||this._tracers.set(i,new li({name:e,version:r,schemaUrl:n?.schemaUrl},this._config,this)),this._tracers.get(i)},t.prototype.addSpanProcessor=function(e){this._registeredSpanProcessors.length===0&&this.activeSpanProcessor.shutdown().catch(function(r){return E.error("Error while trying to shutdown current span processor",r)}),this._registeredSpanProcessors.push(e),this.activeSpanProcessor=new pi(this._registeredSpanProcessors)},t.prototype.getActiveSpanProcessor=function(){return this.activeSpanProcessor},t.prototype.register=function(e){e===void 0&&(e={}),R.setGlobalTracerProvider(this),e.propagator===void 0&&(e.propagator=this._buildPropagatorFromEnv()),e.contextManager&&O.setGlobalContextManager(e.contextManager),e.propagator&&b.setGlobalPropagator(e.propagator)},t.prototype.forceFlush=function(){var e=this._config.forceFlushTimeoutMillis,r=this._registeredSpanProcessors.map(function(n){return new Promise(function(i){var o,a=setTimeout(function(){i(new Error("Span processor did not completed within timeout period of "+e+" ms")),o=H.timeout},e);n.forceFlush().then(function(){clearTimeout(a),o!==H.timeout&&(o=H.resolved,i(o))}).catch(function(u){clearTimeout(a),o=H.error,i(u)})})});return new Promise(function(n,i){Promise.all(r).then(function(o){var a=o.filter(function(u){return u!==H.resolved});a.length>0?i(a):n()}).catch(function(o){return i([o])})})},t.prototype.shutdown=function(){return this.activeSpanProcessor.shutdown()},t.prototype._getPropagator=function(e){var r;return(r=this.constructor._registeredPropagators.get(e))===null||r===void 0?void 0:r()},t.prototype._getSpanExporter=function(e){var r;return(r=this.constructor._registeredExporters.get(e))===null||r===void 0?void 0:r()},t.prototype._buildPropagatorFromEnv=function(){var e=this,r=Array.from(new Set(y().OTEL_PROPAGATORS)),n=r.map(function(o){var a=e._getPropagator(o);return a||E.warn('Propagator "'+o+'" requested through environment variable is unavailable.'),a}),i=n.reduce(function(o,a){return a&&o.push(a),o},[]);if(i.length!==0)return r.length===1?i[0]:new Te({propagators:i})},t.prototype._buildExporterFromEnv=function(){var e=y().OTEL_TRACES_EXPORTER;if(!(e==="none"||e==="")){var r=this._getSpanExporter(e);return r||E.error('Exporter "'+e+'" requested through environment variable is unavailable.'),r}},t._registeredPropagators=new Map([["tracecontext",function(){return new he}],["baggage",function(){return new tr}]]),t._registeredExporters=new Map,t}(),hi=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,o=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(u){a={error:u}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return o},vi=function(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return t.concat(o||Array.prototype.slice.call(e))},Oi=function(){function t(){this._enabled=!1,this._currentContext=K}return t.prototype._bindFunction=function(e,r){e===void 0&&(e=K);var n=this,i=function(){for(var o=this,a=[],u=0;u<arguments.length;u++)a[u]=arguments[u];return n.with(e,function(){return r.apply(o,a)})};return Object.defineProperty(i,"length",{enumerable:!1,configurable:!0,writable:!1,value:r.length}),i},t.prototype.active=function(){return this._currentContext},t.prototype.bind=function(e,r){return e===void 0&&(e=this.active()),typeof r=="function"?this._bindFunction(e,r):r},t.prototype.disable=function(){return this._currentContext=K,this._enabled=!1,this},t.prototype.enable=function(){return this._enabled?this:(this._enabled=!0,this._currentContext=K,this)},t.prototype.with=function(e,r,n){for(var i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var a=this._currentContext;this._currentContext=e||K;try{return r.call.apply(r,vi([n],hi(i),!1))}finally{this._currentContext=a}},t}(),Si=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),yi=function(t){Si(e,t);function e(r){r===void 0&&(r={});var n=t.call(this,r)||this;if(r.contextManager)throw"contextManager should be defined in register method not in constructor";if(r.propagator)throw"propagator should be defined in register method not in constructor";return n}return e.prototype.register=function(r){r===void 0&&(r={}),r.contextManager===void 0&&(r.contextManager=new Oi),r.contextManager&&r.contextManager.enable(),t.prototype.register.call(this,r)},e}(Ti),l;(function(t){t.CONNECT_END="connectEnd",t.CONNECT_START="connectStart",t.DECODED_BODY_SIZE="decodedBodySize",t.DOM_COMPLETE="domComplete",t.DOM_CONTENT_LOADED_EVENT_END="domContentLoadedEventEnd",t.DOM_CONTENT_LOADED_EVENT_START="domContentLoadedEventStart",t.DOM_INTERACTIVE="domInteractive",t.DOMAIN_LOOKUP_END="domainLookupEnd",t.DOMAIN_LOOKUP_START="domainLookupStart",t.ENCODED_BODY_SIZE="encodedBodySize",t.FETCH_START="fetchStart",t.LOAD_EVENT_END="loadEventEnd",t.LOAD_EVENT_START="loadEventStart",t.NAVIGATION_START="navigationStart",t.REDIRECT_END="redirectEnd",t.REDIRECT_START="redirectStart",t.REQUEST_START="requestStart",t.RESPONSE_END="responseEnd",t.RESPONSE_START="responseStart",t.SECURE_CONNECTION_START="secureConnectionStart",t.UNLOAD_EVENT_END="unloadEventEnd",t.UNLOAD_EVENT_START="unloadEventStart"})(l||(l={}));var bt;function mi(){return bt||(bt=document.createElement("a")),bt}function V(t,e){return e in t}function A(t,e,r){if(V(r,e)&&typeof r[e]=="number")return t.addEvent(e,r[e]),t}function q(t,e){A(t,l.FETCH_START,e),A(t,l.DOMAIN_LOOKUP_START,e),A(t,l.DOMAIN_LOOKUP_END,e),A(t,l.CONNECT_START,e),V(e,"name")&&e.name.startsWith("https:")&&A(t,l.SECURE_CONNECTION_START,e),A(t,l.CONNECT_END,e),A(t,l.REQUEST_START,e),A(t,l.RESPONSE_START,e),A(t,l.RESPONSE_END,e);var r=e[l.ENCODED_BODY_SIZE];r!==void 0&&t.setAttribute(S.HTTP_RESPONSE_CONTENT_LENGTH,r);var n=e[l.DECODED_BODY_SIZE];n!==void 0&&r!==n&&t.setAttribute(S.HTTP_RESPONSE_CONTENT_LENGTH_UNCOMPRESSED,n)}function Ri(t){return t.slice().sort(function(e,r){var n=e[l.FETCH_START],i=r[l.FETCH_START];return n>i?1:n<i?-1:0})}function Ue(t,e,r,n,i,o){i===void 0&&(i=new WeakSet);var a=w(t);t=a.toString();var u=gi(t,e,r,n,i,o);if(u.length===0)return{mainRequest:void 0};if(u.length===1)return{mainRequest:u[0]};var s=Ri(u);if(a.origin!==location.origin&&s.length>1){var f=s[0],c=Ai(s,f[l.RESPONSE_END],r),_=f[l.RESPONSE_END],d=c[l.FETCH_START];return d<_&&(c=f,f=void 0),{corsPreFlightRequest:f,mainRequest:c}}else return{mainRequest:u[0]}}function Ai(t,e,r){for(var n=U(r),i=U(tt(e)),o=t[1],a,u=t.length,s=1;s<u;s++){var f=t[s],c=U(tt(f[l.FETCH_START])),_=U(tt(f[l.RESPONSE_END])),d=n-_;c>=i&&(!a||d<a)&&(a=d,o=f)}return o}function gi(t,e,r,n,i,o){var a=U(e),u=U(r),s=n.filter(function(f){var c=U(tt(f[l.FETCH_START])),_=U(tt(f[l.RESPONSE_END]));return f.initiatorType.toLowerCase()===(o||"xmlhttprequest")&&f.name===t&&c>=a&&_<=u});return s.length>0&&(s=s.filter(function(f){return!i.has(f)})),s}function w(t){if(typeof URL=="function")return new URL(t,typeof document<"u"?document.baseURI:typeof location<"u"?location.href:void 0);var e=mi();return e.href=t,e}function Be(t,e){var r=e||[];(typeof r=="string"||r instanceof RegExp)&&(r=[r]);var n=w(t);return n.origin===location.origin?!0:r.some(function(i){return Ae(t,i)})}var et;(function(t){t.DOCUMENT_LOAD="documentLoad",t.DOCUMENT_FETCH="documentFetch",t.RESOURCE_FETCH="resourceFetch"})(et||(et={}));var Li="0.33.2",vt;(function(t){t.FIRST_PAINT="firstPaint",t.FIRST_CONTENTFUL_PAINT="firstContentfulPaint"})(vt||(vt={}));var Pi=function(){var t,e,r={},n=(e=(t=C).getEntriesByType)===null||e===void 0?void 0:e.call(t,"navigation")[0];if(n){var i=Object.values(l);i.forEach(function(u){if(V(n,u)){var s=n[u];typeof s=="number"&&(r[u]=s)}})}else{var o=C,a=o.timing;if(a){var i=Object.values(l);i.forEach(function(s){if(V(a,s)){var f=a[s];typeof f=="number"&&(r[s]=f)}})}}return r},ne={"first-paint":vt.FIRST_PAINT,"first-contentful-paint":vt.FIRST_CONTENTFUL_PAINT},Ci=function(t){var e,r,n=(r=(e=C).getEntriesByType)===null||r===void 0?void 0:r.call(e,"paint");n&&n.forEach(function(i){var o=i.name,a=i.startTime;V(ne,o)&&t.addEvent(ne[o],a)})},bi=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ii=function(t){bi(e,t);function e(r){r===void 0&&(r={});var n=t.call(this,"@opentelemetry/instrumentation-document-load",Li,r)||this;return n.component="document-load",n.version="1",n.moduleName=n.component,n}return e.prototype.init=function(){},e.prototype._onDocumentLoaded=function(){var r=this;window.setTimeout(function(){r._collectPerformance()})},e.prototype._addResourcesSpans=function(r){var n=this,i,o,a=(o=(i=C).getEntriesByType)===null||o===void 0?void 0:o.call(i,"resource");a&&a.forEach(function(u){n._initResourceSpan(u,r)})},e.prototype._collectPerformance=function(){var r=this,n=Array.from(document.getElementsByTagName("meta")).find(function(a){return a.getAttribute("name")===ft}),i=Pi(),o=n&&n.content||"";O.with(b.extract(K,{traceparent:o}),function(){var a,u=r._startSpan(et.DOCUMENT_LOAD,l.FETCH_START,i);u&&(O.with(R.setSpan(O.active(),u),function(){var s=r._startSpan(et.DOCUMENT_FETCH,l.FETCH_START,i);s&&(s.setAttribute(S.HTTP_URL,location.href),O.with(R.setSpan(O.active(),s),function(){var f;q(s,i),r._addCustomAttributesOnSpan(s,(f=r._getConfig().applyCustomAttributesOnSpan)===null||f===void 0?void 0:f.documentFetch),r._endSpan(s,l.RESPONSE_END,i)}))}),u.setAttribute(S.HTTP_URL,location.href),u.setAttribute(S.HTTP_USER_AGENT,navigator.userAgent),r._addResourcesSpans(u),A(u,l.FETCH_START,i),A(u,l.UNLOAD_EVENT_START,i),A(u,l.UNLOAD_EVENT_END,i),A(u,l.DOM_INTERACTIVE,i),A(u,l.DOM_CONTENT_LOADED_EVENT_START,i),A(u,l.DOM_CONTENT_LOADED_EVENT_END,i),A(u,l.DOM_COMPLETE,i),A(u,l.LOAD_EVENT_START,i),A(u,l.LOAD_EVENT_END,i),Ci(u),r._addCustomAttributesOnSpan(u,(a=r._getConfig().applyCustomAttributesOnSpan)===null||a===void 0?void 0:a.documentLoad),r._endSpan(u,l.LOAD_EVENT_END,i))})},e.prototype._endSpan=function(r,n,i){r&&(V(i,n)?r.end(i[n]):r.end())},e.prototype._initResourceSpan=function(r,n){var i,o=this._startSpan(et.RESOURCE_FETCH,l.FETCH_START,r,n);o&&(o.setAttribute(S.HTTP_URL,r.name),q(o,r),this._addCustomAttributesOnResourceSpan(o,r,(i=this._getConfig().applyCustomAttributesOnSpan)===null||i===void 0?void 0:i.resourceFetch),this._endSpan(o,l.RESPONSE_END,r))},e.prototype._startSpan=function(r,n,i,o){if(V(i,n)&&typeof i[n]=="number"){var a=this.tracer.startSpan(r,{startTime:i[n]},o?R.setSpan(O.active(),o):void 0);return a}},e.prototype._waitForPageLoad=function(){window.document.readyState==="complete"?this._onDocumentLoaded():(this._onDocumentLoaded=this._onDocumentLoaded.bind(this),window.addEventListener("load",this._onDocumentLoaded))},e.prototype._getConfig=function(){return this._config},e.prototype._addCustomAttributesOnSpan=function(r,n){var i=this;n&&Tt(function(){return n(r)},function(o){o&&i._diag.error("addCustomAttributesOnSpan",o)})},e.prototype._addCustomAttributesOnResourceSpan=function(r,n,i){var o=this;i&&Tt(function(){return i(r,n)},function(a){a&&o._diag.error("addCustomAttributesOnResourceSpan",a)})},e.prototype.enable=function(){window.removeEventListener("load",this._onDocumentLoaded),this._waitForPageLoad()},e.prototype.disable=function(){window.removeEventListener("load",this._onDocumentLoaded)},e}(Ft),Ot;(function(t){t.COMPONENT="component",t.HTTP_ERROR_NAME="http.error_name",t.HTTP_STATUS_TEXT="http.status_text"})(Ot||(Ot={}));var ie="0.44.0",Ni=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),wi=300,Mi=function(t){Ni(e,t);function e(r){var n=t.call(this,"@opentelemetry/instrumentation-fetch",ie,r)||this;return n.component="fetch",n.version=ie,n.moduleName=n.component,n._usedResources=new WeakSet,n._tasksCount=0,n}return e.prototype.init=function(){},e.prototype._getConfig=function(){return this._config},e.prototype._addChildSpan=function(r,n){var i=this.tracer.startSpan("CORS Preflight",{startTime:n[l.FETCH_START]},R.setSpan(O.active(),r));this._getConfig().ignoreNetworkEvents||q(i,n),i.end(n[l.RESPONSE_END])},e.prototype._addFinalSpanAttributes=function(r,n){var i=w(n.url);r.setAttribute(S.HTTP_STATUS_CODE,n.status),n.statusText!=null&&r.setAttribute(Ot.HTTP_STATUS_TEXT,n.statusText),r.setAttribute(S.HTTP_HOST,i.host),r.setAttribute(S.HTTP_SCHEME,i.protocol.replace(":","")),r.setAttribute(S.HTTP_USER_AGENT,navigator.userAgent)},e.prototype._addHeaders=function(r,n){if(!Be(n,this._getConfig().propagateTraceHeaderCorsUrls)){var i={};b.inject(O.active(),i),Object.keys(i).length>0&&this._diag.debug("headers inject skipped due to CORS policy");return}if(r instanceof Request)b.inject(O.active(),r.headers,{set:function(o,a,u){return o.set(a,typeof u=="string"?u:String(u))}});else if(r.headers instanceof Headers)b.inject(O.active(),r.headers,{set:function(o,a,u){return o.set(a,typeof u=="string"?u:String(u))}});else{var i={};b.inject(O.active(),i),r.headers=Object.assign({},i,r.headers||{})}},e.prototype._clearResources=function(){this._tasksCount===0&&this._getConfig().clearTimingResources&&(performance.clearResourceTimings(),this._usedResources=new WeakSet)},e.prototype._createSpan=function(r,n){var i;if(n===void 0&&(n={}),ge(r,this._getConfig().ignoreUrls)){this._diag.debug("ignoring span as url matches ignored url");return}var o=(n.method||"GET").toUpperCase(),a="HTTP "+o;return this.tracer.startSpan(a,{kind:Xt.CLIENT,attributes:(i={},i[Ot.COMPONENT]=this.moduleName,i[S.HTTP_METHOD]=o,i[S.HTTP_URL]=r,i)})},e.prototype._findResourceAndAddNetworkEvents=function(r,n,i){var o=n.entries;if(!o.length){if(!performance.getEntriesByType)return;o=performance.getEntriesByType("resource")}var a=Ue(n.spanUrl,n.startTime,i,o,this._usedResources,"fetch");if(a.mainRequest){var u=a.mainRequest;this._markResourceAsUsed(u);var s=a.corsPreFlightRequest;s&&(this._addChildSpan(r,s),this._markResourceAsUsed(s)),this._getConfig().ignoreNetworkEvents||q(r,u)}},e.prototype._markResourceAsUsed=function(r){this._usedResources.add(r)},e.prototype._endSpan=function(r,n,i){var o=this,a=M(Date.now()),u=W();this._addFinalSpanAttributes(r,i),setTimeout(function(){var s;(s=n.observer)===null||s===void 0||s.disconnect(),o._findResourceAndAddNetworkEvents(r,n,u),o._tasksCount--,o._clearResources(),r.end(a)},wi)},e.prototype._patchConstructor=function(){var r=this;return function(n){var i=r;return function(){for(var a=[],u=0;u<arguments.length;u++)a[u]=arguments[u];var s=this,f=w(a[0]instanceof Request?a[0].url:String(a[0])).href,c=a[0]instanceof Request?a[0]:a[1]||{},_=i._createSpan(f,c);if(!_)return n.apply(this,a);var d=i._prepareSpanData(f);function p(h,m){i._applyAttributesAfterFetch(h,c,m),i._endSpan(h,d,{status:m.status||0,statusText:m.message,url:f})}function T(h,m){i._applyAttributesAfterFetch(h,c,m),m.status>=200&&m.status<400?i._endSpan(h,d,m):i._endSpan(h,d,{status:m.status,statusText:m.statusText,url:f})}function v(h,m,L){try{var rt=L.clone(),yt=L.clone(),$=rt.body;if($){var He=$.getReader(),kt=function(){He.read().then(function(mt){var Xe=mt.done;Xe?T(h,yt):kt()},function(mt){p(h,mt)})};kt()}else T(h,L)}finally{m(L)}}function g(h,m,L){try{p(h,L)}finally{m(L)}}return new Promise(function(h,m){return O.with(R.setSpan(O.active(),_),function(){return i._addHeaders(c,f),i._tasksCount++,n.apply(s,c instanceof Request?[c]:[f,c]).then(v.bind(s,_,h),g.bind(s,_,m))})})}}},e.prototype._applyAttributesAfterFetch=function(r,n,i){var o=this,a=this._getConfig().applyCustomAttributesOnSpan;a&&Tt(function(){return a(r,n,i)},function(u){u&&o._diag.error("applyCustomAttributesOnSpan",u)})},e.prototype._prepareSpanData=function(r){var n=W(),i=[];if(typeof PerformanceObserver!="function")return{entries:i,startTime:n,spanUrl:r};var o=new PerformanceObserver(function(a){var u=a.getEntries();u.forEach(function(s){s.initiatorType==="fetch"&&s.name===r&&i.push(s)})});return o.observe({entryTypes:["resource"]}),{entries:i,observer:o,startTime:n,spanUrl:r}},e.prototype.enable=function(){Bt(fetch)&&(this._unwrap(j,"fetch"),this._diag.debug("removing previous patch for constructor")),this._wrap(j,"fetch",this._patchConstructor())},e.prototype.disable=function(){this._unwrap(j,"fetch"),this._usedResources=new WeakSet},e}(Ft),N;(function(t){t.METHOD_OPEN="open",t.METHOD_SEND="send",t.EVENT_ABORT="abort",t.EVENT_ERROR="error",t.EVENT_LOAD="loaded",t.EVENT_TIMEOUT="timeout"})(N||(N={}));var oe="0.44.0",Ht;(function(t){t.HTTP_STATUS_TEXT="http.status_text"})(Ht||(Ht={}));var xi=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Di=300,Ui=function(t){xi(e,t);function e(r){var n=t.call(this,"@opentelemetry/instrumentation-xml-http-request",oe,r)||this;return n.component="xml-http-request",n.version=oe,n.moduleName=n.component,n._tasksCount=0,n._xhrMem=new WeakMap,n._usedResources=new WeakSet,n}return e.prototype.init=function(){},e.prototype._getConfig=function(){return this._config},e.prototype._addHeaders=function(r,n){var i=w(n).href;if(!Be(i,this._getConfig().propagateTraceHeaderCorsUrls)){var o={};b.inject(O.active(),o),Object.keys(o).length>0&&this._diag.debug("headers inject skipped due to CORS policy");return}var a={};b.inject(O.active(),a),Object.keys(a).forEach(function(u){r.setRequestHeader(u,String(a[u]))})},e.prototype._addChildSpan=function(r,n){var i=this;O.with(R.setSpan(O.active(),r),function(){var o=i.tracer.startSpan("CORS Preflight",{startTime:n[l.FETCH_START]});q(o,n),o.end(n[l.RESPONSE_END])})},e.prototype._addFinalSpanAttributes=function(r,n,i){if(typeof i=="string"){var o=w(i);n.status!==void 0&&r.setAttribute(S.HTTP_STATUS_CODE,n.status),n.statusText!==void 0&&r.setAttribute(Ht.HTTP_STATUS_TEXT,n.statusText),r.setAttribute(S.HTTP_HOST,o.host),r.setAttribute(S.HTTP_SCHEME,o.protocol.replace(":","")),r.setAttribute(S.HTTP_USER_AGENT,navigator.userAgent)}},e.prototype._applyAttributesAfterXHR=function(r,n){var i=this,o=this._getConfig().applyCustomAttributesOnSpan;typeof o=="function"&&Tt(function(){return o(r,n)},function(a){a&&i._diag.error("applyCustomAttributesOnSpan",a)})},e.prototype._addResourceObserver=function(r,n){var i=this._xhrMem.get(r);!i||typeof PerformanceObserver!="function"||typeof PerformanceResourceTiming!="function"||(i.createdResources={observer:new PerformanceObserver(function(o){var a=o.getEntries(),u=w(n);a.forEach(function(s){s.initiatorType==="xmlhttprequest"&&s.name===u.href&&i.createdResources&&i.createdResources.entries.push(s)})}),entries:[]},i.createdResources.observer.observe({entryTypes:["resource"]}))},e.prototype._clearResources=function(){this._tasksCount===0&&this._getConfig().clearTimingResources&&(C.clearResourceTimings(),this._xhrMem=new WeakMap,this._usedResources=new WeakSet)},e.prototype._findResourceAndAddNetworkEvents=function(r,n,i,o,a){if(!(!i||!o||!a||!r.createdResources)){var u=r.createdResources.entries;(!u||!u.length)&&(u=C.getEntriesByType("resource"));var s=Ue(w(i).href,o,a,u,this._usedResources);if(s.mainRequest){var f=s.mainRequest;this._markResourceAsUsed(f);var c=s.corsPreFlightRequest;c&&(this._addChildSpan(n,c),this._markResourceAsUsed(c)),q(n,f)}}},e.prototype._cleanPreviousSpanInformation=function(r){var n=this._xhrMem.get(r);if(n){var i=n.callbackToRemoveEvents;i&&i(),this._xhrMem.delete(r)}},e.prototype._createSpan=function(r,n,i){var o;if(ge(n,this._getConfig().ignoreUrls)){this._diag.debug("ignoring span as url matches ignored url");return}var a=i.toUpperCase(),u=this.tracer.startSpan(a,{kind:Xt.CLIENT,attributes:(o={},o[S.HTTP_METHOD]=i,o[S.HTTP_URL]=w(n).toString(),o)});return u.addEvent(N.METHOD_OPEN),this._cleanPreviousSpanInformation(r),this._xhrMem.set(r,{span:u,spanUrl:n}),u},e.prototype._markResourceAsUsed=function(r){this._usedResources.add(r)},e.prototype._patchOpen=function(){var r=this;return function(n){var i=r;return function(){for(var a=[],u=0;u<arguments.length;u++)a[u]=arguments[u];var s=a[0],f=a[1];return i._createSpan(this,f,s),n.apply(this,a)}}},e.prototype._patchSend=function(){var r=this;function n(c,_,d,p){var T=_.callbackToRemoveEvents;typeof T=="function"&&T();var v=_.span,g=_.spanUrl,h=_.sendStartTime;v&&(r._findResourceAndAddNetworkEvents(_,v,g,h,d),v.addEvent(c,p),r._addFinalSpanAttributes(v,_,g),v.end(p),r._tasksCount--),r._clearResources()}function i(c,_){var d=r._xhrMem.get(_);if(d){d.status=_.status,d.statusText=_.statusText,r._xhrMem.delete(_),d.span&&r._applyAttributesAfterXHR(d.span,_);var p=W(),T=Date.now();setTimeout(function(){n(c,d,p,T)},Di)}}function o(){i(N.EVENT_ERROR,this)}function a(){i(N.EVENT_ABORT,this)}function u(){i(N.EVENT_TIMEOUT,this)}function s(){this.status<299?i(N.EVENT_LOAD,this):i(N.EVENT_ERROR,this)}function f(c){c.removeEventListener("abort",a),c.removeEventListener("error",o),c.removeEventListener("load",s),c.removeEventListener("timeout",u);var _=r._xhrMem.get(c);_&&(_.callbackToRemoveEvents=void 0)}return function(c){return function(){for(var d=this,p=[],T=0;T<arguments.length;T++)p[T]=arguments[T];var v=r._xhrMem.get(this);if(!v)return c.apply(this,p);var g=v.span,h=v.spanUrl;return g&&h&&O.with(R.setSpan(O.active(),g),function(){r._tasksCount++,v.sendStartTime=W(),g.addEvent(N.METHOD_SEND),d.addEventListener("abort",a),d.addEventListener("error",o),d.addEventListener("load",s),d.addEventListener("timeout",u),v.callbackToRemoveEvents=function(){f(d),v.createdResources&&v.createdResources.observer.disconnect()},r._addHeaders(d,h),r._addResourceObserver(d,h)}),c.apply(this,p)}}},e.prototype.enable=function(){this._diag.debug("applying patch to",this.moduleName,this.version),Bt(XMLHttpRequest.prototype.open)&&(this._unwrap(XMLHttpRequest.prototype,"open"),this._diag.debug("removing previous patch from method open")),Bt(XMLHttpRequest.prototype.send)&&(this._unwrap(XMLHttpRequest.prototype,"send"),this._diag.debug("removing previous patch from method send")),this._wrap(XMLHttpRequest.prototype,"open",this._patchOpen()),this._wrap(XMLHttpRequest.prototype,"send",this._patchSend())},e.prototype.disable=function(){this._diag.debug("removing patch from",this.moduleName,this.version),this._unwrap(XMLHttpRequest.prototype,"open"),this._unwrap(XMLHttpRequest.prototype,"send"),this._tasksCount=0,this._xhrMem=new WeakMap,this._usedResources=new WeakSet},e}(Ft);async function ji(){if(typeof window>"u")return;const t=new Dt({[P.SERVICE_NAME]:"chatgpt-web"}),e=new yi({resource:t,sampler:new G});e.addSpanProcessor(new De(new Wn({url:window.location.origin+"/backend-api/o11y/v1/traces"}))),e.register({propagator:new Te({propagators:[new he]})});const r=[],n=[new RegExp(".*/api/lat(/.*)?"),new RegExp(".*/ces(/.*)?"),...r],i=[new RegExp("https?://.*\\.openai\\.com/"),new RegExp("https?://.*\\.openai\\.org/"),new RegExp("http://localhost:8000/")],o=a=>{a.setAttribute("http.url",je(window.location.href))};$n({instrumentations:[new Ii({applyCustomAttributesOnSpan:{documentLoad:o,documentFetch:o}}),new Ui({propagateTraceHeaderCorsUrls:i,ignoreUrls:n}),new Mi({propagateTraceHeaderCorsUrls:i,ignoreUrls:n})]})}export{ji as initOpenTelemetry};
//# sourceMappingURL=l32or9yl582yylkd.js.map
