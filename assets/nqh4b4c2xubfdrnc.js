import{j as _n,g as Vr,r as Mn}from"./gg0tb34p9fzo1omt.js";import{n9 as Dl,sC as Pl,sD as xl,sE as Ul,pA as pu,mS as Fl}from"./forbprkns1cohsbl.js";import{D as mr,ic as Bl}from"./g670b8vtkhx0yc6d.js";import{w as Jl,p as bi,c as be,s as Se,a as re,h as Gi,e as ie,t as et,b as yr,m as Ct,d as Wi,f as Qn,g as Xi,i as Vl,j as ql,k as Hl,l as Eu,n as vt,o as $l,r as Nu,q as bl,u as Gl,v as Wl,x as Xl}from"./hp08qw6yu0x90xkd.js";function zl(n){return n.innerRadius}function Yl(n){return n.outerRadius}function Zl(n){return n.startAngle}function Kl(n){return n.endAngle}function Ql(n){return n&&n.padAngle}function _l(n,e,r,t,i,u,a,h){var d=r-n,f=t-e,o=a-i,l=h-u,s=l*d-o*f;if(!(s*s<ie))return s=(o*(e-u)-l*(n-i))/s,[n+s*d,e+s*f]}function Yr(n,e,r,t,i,u,a){var h=n-r,d=e-t,f=(a?u:-u)/yr(h*h+d*d),o=f*d,l=-f*h,s=n+o,c=e+l,g=r+o,v=t+l,p=(s+g)/2,N=(c+v)/2,w=g-s,E=v-c,y=w*w+E*E,R=i-u,I=s*v-g*c,S=(E<0?-1:1)*yr(Vl(0,R*R*y-I*I)),T=(I*E-w*S)/y,M=(-I*w-E*S)/y,V=(I*E+w*S)/y,G=(-I*w+E*S)/y,nn=T-p,X=M-N,Q=V-p,Nn=G-N;return nn*nn+X*X>Q*Q+Nn*Nn&&(T=V,M=G),{cx:T,cy:M,x01:-o,y01:-l,x11:T*(i/R-1),y11:M*(i/R-1)}}function jl(){var n=zl,e=Yl,r=re(0),t=null,i=Zl,u=Kl,a=Ql,h=null,d=Jl(f);function f(){var o,l,s=+n.apply(this,arguments),c=+e.apply(this,arguments),g=i.apply(this,arguments)-Gi,v=u.apply(this,arguments)-Gi,p=Wi(v-g),N=v>g;if(h||(h=o=d()),c<s&&(l=c,c=s,s=l),!(c>ie))h.moveTo(0,0);else if(p>et-ie)h.moveTo(c*be(g),c*Se(g)),h.arc(0,0,c,g,v,!N),s>ie&&(h.moveTo(s*be(v),s*Se(v)),h.arc(0,0,s,v,g,N));else{var w=g,E=v,y=g,R=v,I=p,S=p,T=a.apply(this,arguments)/2,M=T>ie&&(t?+t.apply(this,arguments):yr(s*s+c*c)),V=Ct(Wi(c-s)/2,+r.apply(this,arguments)),G=V,nn=V,X,Q;if(M>ie){var Nn=Xi(M/s*Se(T)),yn=Xi(M/c*Se(T));(I-=Nn*2)>ie?(Nn*=N?1:-1,y+=Nn,R-=Nn):(I=0,y=R=(g+v)/2),(S-=yn*2)>ie?(yn*=N?1:-1,w+=yn,E-=yn):(S=0,w=E=(g+v)/2)}var cn=c*be(w),ln=c*Se(w),kn=s*be(R),Dn=s*Se(R);if(V>ie){var Bn=c*be(E),Jn=c*Se(E),Z=s*be(y),on=s*Se(y),an;if(p<bi)if(an=_l(cn,ln,Z,on,Bn,Jn,kn,Dn)){var Rn=cn-an[0],Cn=ln-an[1],Vn=Bn-an[0],L=Jn-an[1],D=1/Se(ql((Rn*Vn+Cn*L)/(yr(Rn*Rn+Cn*Cn)*yr(Vn*Vn+L*L)))/2),P=yr(an[0]*an[0]+an[1]*an[1]);G=Ct(V,(s-P)/(D-1)),nn=Ct(V,(c-P)/(D+1))}else G=nn=0}S>ie?nn>ie?(X=Yr(Z,on,cn,ln,c,nn,N),Q=Yr(Bn,Jn,kn,Dn,c,nn,N),h.moveTo(X.cx+X.x01,X.cy+X.y01),nn<V?h.arc(X.cx,X.cy,nn,Qn(X.y01,X.x01),Qn(Q.y01,Q.x01),!N):(h.arc(X.cx,X.cy,nn,Qn(X.y01,X.x01),Qn(X.y11,X.x11),!N),h.arc(0,0,c,Qn(X.cy+X.y11,X.cx+X.x11),Qn(Q.cy+Q.y11,Q.cx+Q.x11),!N),h.arc(Q.cx,Q.cy,nn,Qn(Q.y11,Q.x11),Qn(Q.y01,Q.x01),!N))):(h.moveTo(cn,ln),h.arc(0,0,c,w,E,!N)):h.moveTo(cn,ln),!(s>ie)||!(I>ie)?h.lineTo(kn,Dn):G>ie?(X=Yr(kn,Dn,Bn,Jn,s,-G,N),Q=Yr(cn,ln,Z,on,s,-G,N),h.lineTo(X.cx+X.x01,X.cy+X.y01),G<V?h.arc(X.cx,X.cy,G,Qn(X.y01,X.x01),Qn(Q.y01,Q.x01),!N):(h.arc(X.cx,X.cy,G,Qn(X.y01,X.x01),Qn(X.y11,X.x11),!N),h.arc(0,0,s,Qn(X.cy+X.y11,X.cx+X.x11),Qn(Q.cy+Q.y11,Q.cx+Q.x11),N),h.arc(Q.cx,Q.cy,G,Qn(Q.y11,Q.x11),Qn(Q.y01,Q.x01),!N))):h.arc(0,0,s,R,y,N)}if(h.closePath(),o)return h=null,o+""||null}return f.centroid=function(){var o=(+n.apply(this,arguments)+ +e.apply(this,arguments))/2,l=(+i.apply(this,arguments)+ +u.apply(this,arguments))/2-bi/2;return[be(l)*o,Se(l)*o]},f.innerRadius=function(o){return arguments.length?(n=typeof o=="function"?o:re(+o),f):n},f.outerRadius=function(o){return arguments.length?(e=typeof o=="function"?o:re(+o),f):e},f.cornerRadius=function(o){return arguments.length?(r=typeof o=="function"?o:re(+o),f):r},f.padRadius=function(o){return arguments.length?(t=o==null?null:typeof o=="function"?o:re(+o),f):t},f.startAngle=function(o){return arguments.length?(i=typeof o=="function"?o:re(+o),f):i},f.endAngle=function(o){return arguments.length?(u=typeof o=="function"?o:re(+o),f):u},f.padAngle=function(o){return arguments.length?(a=typeof o=="function"?o:re(+o),f):a},f.context=function(o){return arguments.length?(h=o??null,f):h},f}function nf(n,e){return e<n?-1:e>n?1:e>=n?0:NaN}function ef(n){return n}function rf(){var n=ef,e=nf,r=null,t=re(0),i=re(et),u=re(0);function a(h){var d,f=(h=Hl(h)).length,o,l,s=0,c=new Array(f),g=new Array(f),v=+t.apply(this,arguments),p=Math.min(et,Math.max(-et,i.apply(this,arguments)-v)),N,w=Math.min(Math.abs(p)/f,u.apply(this,arguments)),E=w*(p<0?-1:1),y;for(d=0;d<f;++d)(y=g[c[d]=d]=+n(h[d],d,h))>0&&(s+=y);for(e!=null?c.sort(function(R,I){return e(g[R],g[I])}):r!=null&&c.sort(function(R,I){return r(h[R],h[I])}),d=0,l=s?(p-f*E)/s:0;d<f;++d,v=N)o=c[d],y=g[o],N=v+(y>0?y*l:0)+E,g[o]={data:h[o],index:d,value:y,startAngle:v,endAngle:N,padAngle:w};return g}return a.value=function(h){return arguments.length?(n=typeof h=="function"?h:re(+h),a):n},a.sortValues=function(h){return arguments.length?(e=h,r=null,a):e},a.sort=function(h){return arguments.length?(r=h,e=null,a):r},a.startAngle=function(h){return arguments.length?(t=typeof h=="function"?h:re(+h),a):t},a.endAngle=function(h){return arguments.length?(i=typeof h=="function"?h:re(+h),a):i},a.padAngle=function(h){return arguments.length?(u=typeof h=="function"?h:re(+h),a):u},a}function wu(n,e){let r,t;for(const i of n)i!=null&&(r===void 0?i>=i&&(r=t=i):(r>i&&(r=i),t<i&&(t=i)));return[r,t]}function tf(n,e){let r=0;for(let t of n)(t=+t)&&(r+=t);return r}const of=["pptx","xlsx"],yu=n=>{const e=n.split(".").pop();return!e||!of.includes(e)?null:e},pg=n=>!!yu(n);function uf(){let n=0,e=0;for(let t=0;t<28;t+=7){let i=this.buf[this.pos++];if(n|=(i&127)<<t,(i&128)==0)return this.assertBounds(),[n,e]}let r=this.buf[this.pos++];if(n|=(r&15)<<28,e=(r&112)>>4,(r&128)==0)return this.assertBounds(),[n,e];for(let t=3;t<=31;t+=7){let i=this.buf[this.pos++];if(e|=(i&127)<<t,(i&128)==0)return this.assertBounds(),[n,e]}throw new Error("invalid varint")}function Lt(n,e,r){for(let u=0;u<28;u=u+7){const a=n>>>u,h=!(!(a>>>7)&&e==0),d=(h?a|128:a)&255;if(r.push(d),!h)return}const t=n>>>28&15|(e&7)<<4,i=e>>3!=0;if(r.push((i?t|128:t)&255),!!i){for(let u=3;u<31;u=u+7){const a=e>>>u,h=!!(a>>>7),d=(h?a|128:a)&255;if(r.push(d),!h)return}r.push(e>>>31&1)}}const rt=4294967296;function zi(n){const e=n[0]==="-";e&&(n=n.slice(1));const r=1e6;let t=0,i=0;function u(a,h){const d=Number(n.slice(a,h));i*=r,t=t*r+d,t>=rt&&(i=i+(t/rt|0),t=t%rt)}return u(-24,-18),u(-18,-12),u(-12,-6),u(-6),e?Au(t,i):pi(t,i)}function lf(n,e){let r=pi(n,e);const t=r.hi&2147483648;t&&(r=Au(r.lo,r.hi));const i=mu(r.lo,r.hi);return t?"-"+i:i}function mu(n,e){if({lo:n,hi:e}=ff(n,e),e<=2097151)return String(rt*e+n);const r=n&16777215,t=(n>>>24|e<<8)&16777215,i=e>>16&65535;let u=r+t*6777216+i*6710656,a=t+i*8147497,h=i*2;const d=1e7;return u>=d&&(a+=Math.floor(u/d),u%=d),a>=d&&(h+=Math.floor(a/d),a%=d),h.toString()+Yi(a)+Yi(u)}function ff(n,e){return{lo:n>>>0,hi:e>>>0}}function pi(n,e){return{lo:n|0,hi:e|0}}function Au(n,e){return e=~e,n?n=~n+1:e+=1,pi(n,e)}const Yi=n=>{const e=String(n);return"0000000".slice(e.length)+e};function Zi(n,e){if(n>=0){for(;n>127;)e.push(n&127|128),n=n>>>7;e.push(n)}else{for(let r=0;r<9;r++)e.push(n&127|128),n=n>>7;e.push(1)}}function sf(){let n=this.buf[this.pos++],e=n&127;if((n&128)==0)return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<7,(n&128)==0)return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<14,(n&128)==0)return this.assertBounds(),e;if(n=this.buf[this.pos++],e|=(n&127)<<21,(n&128)==0)return this.assertBounds(),e;n=this.buf[this.pos++],e|=(n&15)<<28;for(let r=5;(n&128)!==0&&r<10;r++)n=this.buf[this.pos++];if((n&128)!=0)throw new Error("invalid varint");return this.assertBounds(),e>>>0}var Ki={};const ke=cf();function cf(){const n=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof n.getBigInt64=="function"&&typeof n.getBigUint64=="function"&&typeof n.setBigInt64=="function"&&typeof n.setBigUint64=="function"&&(typeof process!="object"||typeof Ki!="object"||Ki.BUF_BIGINT_DISABLE!=="1")){const r=BigInt("-9223372036854775808"),t=BigInt("9223372036854775807"),i=BigInt("0"),u=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(a){const h=typeof a=="bigint"?a:BigInt(a);if(h>t||h<r)throw new Error(`invalid int64: ${a}`);return h},uParse(a){const h=typeof a=="bigint"?a:BigInt(a);if(h>u||h<i)throw new Error(`invalid uint64: ${a}`);return h},enc(a){return n.setBigInt64(0,this.parse(a),!0),{lo:n.getInt32(0,!0),hi:n.getInt32(4,!0)}},uEnc(a){return n.setBigInt64(0,this.uParse(a),!0),{lo:n.getInt32(0,!0),hi:n.getInt32(4,!0)}},dec(a,h){return n.setInt32(0,a,!0),n.setInt32(4,h,!0),n.getBigInt64(0,!0)},uDec(a,h){return n.setInt32(0,a,!0),n.setInt32(4,h,!0),n.getBigUint64(0,!0)}}}return{zero:"0",supported:!1,parse(r){return typeof r!="string"&&(r=r.toString()),Qi(r),r},uParse(r){return typeof r!="string"&&(r=r.toString()),_i(r),r},enc(r){return typeof r!="string"&&(r=r.toString()),Qi(r),zi(r)},uEnc(r){return typeof r!="string"&&(r=r.toString()),_i(r),zi(r)},dec(r,t){return lf(r,t)},uDec(r,t){return mu(r,t)}}}function Qi(n){if(!/^-?[0-9]+$/.test(n))throw new Error("invalid int64: "+n)}function _i(n){if(!/^[0-9]+$/.test(n))throw new Error("invalid uint64: "+n)}const Dt=Symbol.for("@bufbuild/protobuf/text-encoding");function Ru(){if(globalThis[Dt]==null){const n=new globalThis.TextEncoder,e=new globalThis.TextDecoder;globalThis[Dt]={encodeUtf8(r){return n.encode(r)},decodeUtf8(r){return e.decode(r)},checkUtf8(r){try{return encodeURIComponent(r),!0}catch{return!1}}}}return globalThis[Dt]}var Fe;(function(n){n[n.Varint=0]="Varint",n[n.Bit64=1]="Bit64",n[n.LengthDelimited=2]="LengthDelimited",n[n.StartGroup=3]="StartGroup",n[n.EndGroup=4]="EndGroup",n[n.Bit32=5]="Bit32"})(Fe||(Fe={}));const af=34028234663852886e22,hf=-34028234663852886e22,df=4294967295,gf=2147483647,vf=-2147483648;class mn{constructor(e=Ru().encodeUtf8){this.encodeUtf8=e,this.stack=[],this.chunks=[],this.buf=[]}finish(){this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]);let e=0;for(let i=0;i<this.chunks.length;i++)e+=this.chunks[i].length;let r=new Uint8Array(e),t=0;for(let i=0;i<this.chunks.length;i++)r.set(this.chunks[i],t),t+=this.chunks[i].length;return this.chunks=[],r}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),r=this.stack.pop();if(!r)throw new Error("invalid state, fork stack empty");return this.chunks=r.chunks,this.buf=r.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,r){return this.uint32((e<<3|r)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(ji(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return Pt(e),Zi(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let r=this.encodeUtf8(e);return this.uint32(r.byteLength),this.raw(r)}float(e){pf(e);let r=new Uint8Array(4);return new DataView(r.buffer).setFloat32(0,e,!0),this.raw(r)}double(e){let r=new Uint8Array(8);return new DataView(r.buffer).setFloat64(0,e,!0),this.raw(r)}fixed32(e){ji(e);let r=new Uint8Array(4);return new DataView(r.buffer).setUint32(0,e,!0),this.raw(r)}sfixed32(e){Pt(e);let r=new Uint8Array(4);return new DataView(r.buffer).setInt32(0,e,!0),this.raw(r)}sint32(e){return Pt(e),e=(e<<1^e>>31)>>>0,Zi(e,this.buf),this}sfixed64(e){let r=new Uint8Array(8),t=new DataView(r.buffer),i=ke.enc(e);return t.setInt32(0,i.lo,!0),t.setInt32(4,i.hi,!0),this.raw(r)}fixed64(e){let r=new Uint8Array(8),t=new DataView(r.buffer),i=ke.uEnc(e);return t.setInt32(0,i.lo,!0),t.setInt32(4,i.hi,!0),this.raw(r)}int64(e){let r=ke.enc(e);return Lt(r.lo,r.hi,this.buf),this}sint64(e){const r=ke.enc(e),t=r.hi>>31,i=r.lo<<1^t,u=(r.hi<<1|r.lo>>>31)^t;return Lt(i,u,this.buf),this}uint64(e){const r=ke.uEnc(e);return Lt(r.lo,r.hi,this.buf),this}}class rn{constructor(e,r=Ru().decodeUtf8){this.decodeUtf8=r,this.varint64=uf,this.uint32=sf,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength)}tag(){let e=this.uint32(),r=e>>>3,t=e&7;if(r<=0||t<0||t>5)throw new Error("illegal tag: field no "+r+" wire type "+t);return[r,t]}skip(e,r){let t=this.pos;switch(e){case Fe.Varint:for(;this.buf[this.pos++]&128;);break;case Fe.Bit64:this.pos+=4;case Fe.Bit32:this.pos+=4;break;case Fe.LengthDelimited:let i=this.uint32();this.pos+=i;break;case Fe.StartGroup:for(;;){const[u,a]=this.tag();if(a===Fe.EndGroup){if(r!==void 0&&u!==r)throw new Error("invalid end group tag");break}this.skip(a,u)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(t,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return ke.dec(...this.varint64())}uint64(){return ke.uDec(...this.varint64())}sint64(){let[e,r]=this.varint64(),t=-(e&1);return e=(e>>>1|(r&1)<<31)^t,r=r>>>1^t,ke.dec(e,r)}bool(){let[e,r]=this.varint64();return e!==0||r!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return ke.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return ke.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),r=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(r,r+e)}string(){return this.decodeUtf8(this.bytes())}}function Pt(n){if(typeof n=="string")n=Number(n);else if(typeof n!="number")throw new Error("invalid int32: "+typeof n);if(!Number.isInteger(n)||n>gf||n<vf)throw new Error("invalid int32: "+n)}function ji(n){if(typeof n=="string")n=Number(n);else if(typeof n!="number")throw new Error("invalid uint32: "+typeof n);if(!Number.isInteger(n)||n>df||n<0)throw new Error("invalid uint32: "+n)}function pf(n){if(typeof n=="string"){const e=n;if(n=Number(n),Number.isNaN(n)&&e!=="NaN")throw new Error("invalid float32: "+e)}else if(typeof n!="number")throw new Error("invalid float32: "+typeof n);if(Number.isFinite(n)&&(n>af||n<hf))throw new Error("invalid float32: "+n)}var si=(n=>(n[n.COLOR_UNSET=0]="COLOR_UNSET",n[n.COLOR_RGB=1]="COLOR_RGB",n[n.COLOR_SCHEME=2]="COLOR_SCHEME",n[n.COLOR_SYSTEM=3]="COLOR_SYSTEM",n[n.UNRECOGNIZED=-1]="UNRECOGNIZED",n))(si||{});function Ef(n){switch(n){case 0:case"COLOR_UNSET":return 0;case 1:case"COLOR_RGB":return 1;case 2:case"COLOR_SCHEME":return 2;case 3:case"COLOR_SYSTEM":return 3;case-1:case"UNRECOGNIZED":default:return-1}}function Nf(n){switch(n){case 0:return"COLOR_UNSET";case 1:return"COLOR_RGB";case 2:return"COLOR_SCHEME";case 3:return"COLOR_SYSTEM";case-1:default:return"UNRECOGNIZED"}}function wf(n){switch(n){case 0:case"NONE":return 0;case 1:case"SOLID":return 1;case 2:case"GRADIENT":return 2;case 3:case"PATTERN":return 3;case 4:case"PICTURE":return 4;case 5:case"VIDEO":return 5;case-1:case"UNRECOGNIZED":default:return-1}}function yf(n){switch(n){case 0:return"NONE";case 1:return"SOLID";case 2:return"GRADIENT";case 3:return"PATTERN";case 4:return"PICTURE";case 5:return"VIDEO";case-1:default:return"UNRECOGNIZED"}}var ut=(n=>(n[n.ALIGNMENT_UNSET=0]="ALIGNMENT_UNSET",n[n.LEFT=1]="LEFT",n[n.CENTER=2]="CENTER",n[n.RIGHT=3]="RIGHT",n[n.UNRECOGNIZED=-1]="UNRECOGNIZED",n))(ut||{});function mf(n){switch(n){case 0:case"ALIGNMENT_UNSET":return 0;case 1:case"LEFT":return 1;case 2:case"CENTER":return 2;case 3:case"RIGHT":return 3;case-1:case"UNRECOGNIZED":default:return-1}}function Af(n){switch(n){case 0:return"ALIGNMENT_UNSET";case 1:return"LEFT";case 2:return"CENTER";case 3:return"RIGHT";case-1:default:return"UNRECOGNIZED"}}var Pr=(n=>(n[n.ANCHOR_UNSET=0]="ANCHOR_UNSET",n[n.TOP=1]="TOP",n[n.MIDDLE=2]="MIDDLE",n[n.BOTTOM=3]="BOTTOM",n[n.UNRECOGNIZED=-1]="UNRECOGNIZED",n))(Pr||{});function Rf(n){switch(n){case 0:case"ANCHOR_UNSET":return 0;case 1:case"TOP":return 1;case 2:case"MIDDLE":return 2;case 3:case"BOTTOM":return 3;case-1:case"UNRECOGNIZED":default:return-1}}function Tf(n){switch(n){case 0:return"ANCHOR_UNSET";case 1:return"TOP";case 2:return"MIDDLE";case 3:return"BOTTOM";case-1:default:return"UNRECOGNIZED"}}var Tu=(n=>(n[n.ROTATION_UNSET=0]="ROTATION_UNSET",n[n.HORIZONTAL=1]="HORIZONTAL",n[n.VERTICAL=2]="VERTICAL",n[n.VERTICAL_270=3]="VERTICAL_270",n[n.WORD_ART_VERTICAL=4]="WORD_ART_VERTICAL",n[n.EA_VERTICAL=5]="EA_VERTICAL",n[n.UNRECOGNIZED=-1]="UNRECOGNIZED",n))(Tu||{});function If(n){switch(n){case 0:case"ROTATION_UNSET":return 0;case 1:case"HORIZONTAL":return 1;case 2:case"VERTICAL":return 2;case 3:case"VERTICAL_270":return 3;case 4:case"WORD_ART_VERTICAL":return 4;case 5:case"EA_VERTICAL":return 5;case-1:case"UNRECOGNIZED":default:return-1}}function Of(n){switch(n){case 0:return"ROTATION_UNSET";case 1:return"HORIZONTAL";case 2:return"VERTICAL";case 3:return"VERTICAL_270";case 4:return"WORD_ART_VERTICAL";case 5:return"EA_VERTICAL";case-1:default:return"UNRECOGNIZED"}}function Sf(n){switch(n){case 0:case"LINE_STYLE_UNSET":return 0;case 1:case"SOLID":return 1;case 2:case"DASHED":return 2;case 3:case"DOTTED":return 3;case 4:case"DASH_DOT":return 4;case 5:case"DASH_DOT_DOT":return 5;case-1:case"UNRECOGNIZED":default:return-1}}function kf(n){switch(n){case 0:return"LINE_STYLE_UNSET";case 1:return"SOLID";case 2:return"DASHED";case 3:return"DOTTED";case 4:return"DASH_DOT";case 5:return"DASH_DOT_DOT";case-1:default:return"UNRECOGNIZED"}}function no(){return{xEmu:0,yEmu:0,widthEmu:0,heightEmu:0}}const Ee={encode(n,e=new mn){return n.xEmu!==0&&e.uint32(8).int64(n.xEmu),n.yEmu!==0&&e.uint32(16).int64(n.yEmu),n.widthEmu!==0&&e.uint32(24).int64(n.widthEmu),n.heightEmu!==0&&e.uint32(32).int64(n.heightEmu),e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=no();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 1:{if(u!==8)break;i.xEmu=Zr(r.int64());continue}case 2:{if(u!==16)break;i.yEmu=Zr(r.int64());continue}case 3:{if(u!==24)break;i.widthEmu=Zr(r.int64());continue}case 4:{if(u!==32)break;i.heightEmu=Zr(r.int64());continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{xEmu:wn(n.xEmu)?globalThis.Number(n.xEmu):0,yEmu:wn(n.yEmu)?globalThis.Number(n.yEmu):0,widthEmu:wn(n.widthEmu)?globalThis.Number(n.widthEmu):0,heightEmu:wn(n.heightEmu)?globalThis.Number(n.heightEmu):0}},toJSON(n){const e={};return n.xEmu!==0&&(e.xEmu=Math.round(n.xEmu)),n.yEmu!==0&&(e.yEmu=Math.round(n.yEmu)),n.widthEmu!==0&&(e.widthEmu=Math.round(n.widthEmu)),n.heightEmu!==0&&(e.heightEmu=Math.round(n.heightEmu)),e},create(n){return Ee.fromPartial(n??{})},fromPartial(n){const e=no();return e.xEmu=n.xEmu??0,e.yEmu=n.yEmu??0,e.widthEmu=n.widthEmu??0,e.heightEmu=n.heightEmu??0,e}};function eo(){return{tint:0,shade:0,lumMod:0,lumOff:0,satMod:0,alpha:0}}const er={encode(n,e=new mn){return n.tint!==0&&e.uint32(8).int32(n.tint),n.shade!==0&&e.uint32(16).int32(n.shade),n.lumMod!==0&&e.uint32(24).int32(n.lumMod),n.lumOff!==0&&e.uint32(32).int32(n.lumOff),n.satMod!==0&&e.uint32(40).int32(n.satMod),n.alpha!==0&&e.uint32(48).int32(n.alpha),e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=eo();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 1:{if(u!==8)break;i.tint=r.int32();continue}case 2:{if(u!==16)break;i.shade=r.int32();continue}case 3:{if(u!==24)break;i.lumMod=r.int32();continue}case 4:{if(u!==32)break;i.lumOff=r.int32();continue}case 5:{if(u!==40)break;i.satMod=r.int32();continue}case 6:{if(u!==48)break;i.alpha=r.int32();continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{tint:wn(n.tint)?globalThis.Number(n.tint):0,shade:wn(n.shade)?globalThis.Number(n.shade):0,lumMod:wn(n.lumMod)?globalThis.Number(n.lumMod):0,lumOff:wn(n.lumOff)?globalThis.Number(n.lumOff):0,satMod:wn(n.satMod)?globalThis.Number(n.satMod):0,alpha:wn(n.alpha)?globalThis.Number(n.alpha):0}},toJSON(n){const e={};return n.tint!==0&&(e.tint=Math.round(n.tint)),n.shade!==0&&(e.shade=Math.round(n.shade)),n.lumMod!==0&&(e.lumMod=Math.round(n.lumMod)),n.lumOff!==0&&(e.lumOff=Math.round(n.lumOff)),n.satMod!==0&&(e.satMod=Math.round(n.satMod)),n.alpha!==0&&(e.alpha=Math.round(n.alpha)),e},create(n){return er.fromPartial(n??{})},fromPartial(n){const e=eo();return e.tint=n.tint??0,e.shade=n.shade??0,e.lumMod=n.lumMod??0,e.lumOff=n.lumOff??0,e.satMod=n.satMod??0,e.alpha=n.alpha??0,e}};function ro(){return{type:0,value:"",transform:void 0,lastColor:""}}const On={encode(n,e=new mn){return n.type!==0&&e.uint32(8).int32(n.type),n.value!==""&&e.uint32(18).string(n.value),n.transform!==void 0&&er.encode(n.transform,e.uint32(26).fork()).join(),n.lastColor!==""&&e.uint32(34).string(n.lastColor),e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=ro();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 1:{if(u!==8)break;i.type=r.int32();continue}case 2:{if(u!==18)break;i.value=r.string();continue}case 3:{if(u!==26)break;i.transform=er.decode(r,r.uint32());continue}case 4:{if(u!==34)break;i.lastColor=r.string();continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{type:wn(n.type)?Ef(n.type):0,value:wn(n.value)?globalThis.String(n.value):"",transform:wn(n.transform)?er.fromJSON(n.transform):void 0,lastColor:wn(n.lastColor)?globalThis.String(n.lastColor):""}},toJSON(n){const e={};return n.type!==0&&(e.type=Nf(n.type)),n.value!==""&&(e.value=n.value),n.transform!==void 0&&(e.transform=er.toJSON(n.transform)),n.lastColor!==""&&(e.lastColor=n.lastColor),e},create(n){return On.fromPartial(n??{})},fromPartial(n){const e=ro();return e.type=n.type??0,e.value=n.value??"",e.transform=n.transform!==void 0&&n.transform!==null?er.fromPartial(n.transform):void 0,e.lastColor=n.lastColor??"",e}};function to(){return{ref:void 0,fill:void 0}}const Ne={encode(n,e=new mn){return n.ref!==void 0&&rr.encode(n.ref,e.uint32(18).fork()).join(),n.fill!==void 0&&vn.encode(n.fill,e.uint32(26).fork()).join(),e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=to();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 2:{if(u!==18)break;i.ref=rr.decode(r,r.uint32());continue}case 3:{if(u!==26)break;i.fill=vn.decode(r,r.uint32());continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{ref:wn(n.ref)?rr.fromJSON(n.ref):void 0,fill:wn(n.fill)?vn.fromJSON(n.fill):void 0}},toJSON(n){const e={};return n.ref!==void 0&&(e.ref=rr.toJSON(n.ref)),n.fill!==void 0&&(e.fill=vn.toJSON(n.fill)),e},create(n){return Ne.fromPartial(n??{})},fromPartial(n){const e=to();return e.ref=n.ref!==void 0&&n.ref!==null?rr.fromPartial(n.ref):void 0,e.fill=n.fill!==void 0&&n.fill!==null?vn.fromPartial(n.fill):void 0,e}};function io(){return{index:0,schemeColor:""}}const rr={encode(n,e=new mn){return n.index!==0&&e.uint32(8).int32(n.index),n.schemeColor!==""&&e.uint32(18).string(n.schemeColor),e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=io();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 1:{if(u!==8)break;i.index=r.int32();continue}case 2:{if(u!==18)break;i.schemeColor=r.string();continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{index:wn(n.index)?globalThis.Number(n.index):0,schemeColor:wn(n.schemeColor)?globalThis.String(n.schemeColor):""}},toJSON(n){const e={};return n.index!==0&&(e.index=Math.round(n.index)),n.schemeColor!==""&&(e.schemeColor=n.schemeColor),e},create(n){return rr.fromPartial(n??{})},fromPartial(n){const e=io();return e.index=n.index??0,e.schemeColor=n.schemeColor??"",e}};function oo(){return{type:0,color:void 0,gradientStops:[],relId:""}}const vn={encode(n,e=new mn){n.type!==0&&e.uint32(8).int32(n.type),n.color!==void 0&&On.encode(n.color,e.uint32(18).fork()).join();for(const r of n.gradientStops)tr.encode(r,e.uint32(26).fork()).join();return n.relId!==""&&e.uint32(34).string(n.relId),e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=oo();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 1:{if(u!==8)break;i.type=r.int32();continue}case 2:{if(u!==18)break;i.color=On.decode(r,r.uint32());continue}case 3:{if(u!==26)break;i.gradientStops.push(tr.decode(r,r.uint32()));continue}case 4:{if(u!==34)break;i.relId=r.string();continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{type:wn(n.type)?wf(n.type):0,color:wn(n.color)?On.fromJSON(n.color):void 0,gradientStops:globalThis.Array.isArray(n?.gradientStops)?n.gradientStops.map(e=>tr.fromJSON(e)):[],relId:wn(n.relId)?globalThis.String(n.relId):""}},toJSON(n){const e={};return n.type!==0&&(e.type=yf(n.type)),n.color!==void 0&&(e.color=On.toJSON(n.color)),n.gradientStops?.length&&(e.gradientStops=n.gradientStops.map(r=>tr.toJSON(r))),n.relId!==""&&(e.relId=n.relId),e},create(n){return vn.fromPartial(n??{})},fromPartial(n){const e=oo();return e.type=n.type??0,e.color=n.color!==void 0&&n.color!==null?On.fromPartial(n.color):void 0,e.gradientStops=n.gradientStops?.map(r=>tr.fromPartial(r))||[],e.relId=n.relId??"",e}};function uo(){return{position:0,color:void 0}}const tr={encode(n,e=new mn){return n.position!==0&&e.uint32(8).int32(n.position),n.color!==void 0&&On.encode(n.color,e.uint32(18).fork()).join(),e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=uo();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 1:{if(u!==8)break;i.position=r.int32();continue}case 2:{if(u!==18)break;i.color=On.decode(r,r.uint32());continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{position:wn(n.position)?globalThis.Number(n.position):0,color:wn(n.color)?On.fromJSON(n.color):void 0}},toJSON(n){const e={};return n.position!==0&&(e.position=Math.round(n.position)),n.color!==void 0&&(e.color=On.toJSON(n.color)),e},create(n){return tr.fromPartial(n??{})},fromPartial(n){const e=uo();return e.position=n.position??0,e.color=n.color!==void 0&&n.color!==null?On.fromPartial(n.color):void 0,e}};function lo(){return{anchor:0,vertical:0,bold:!1,italic:!1,color:void 0,fontSize:0,fill:void 0,alignment:0,underline:""}}const Sn={encode(n,e=new mn){return n.anchor!==0&&e.uint32(8).int32(n.anchor),n.vertical!==0&&e.uint32(16).int32(n.vertical),n.bold!==!1&&e.uint32(32).bool(n.bold),n.italic!==!1&&e.uint32(40).bool(n.italic),n.color!==void 0&&On.encode(n.color,e.uint32(26).fork()).join(),n.fontSize!==0&&e.uint32(48).int32(n.fontSize),n.fill!==void 0&&vn.encode(n.fill,e.uint32(58).fork()).join(),n.alignment!==0&&e.uint32(64).int32(n.alignment),n.underline!==""&&e.uint32(74).string(n.underline),e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=lo();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 1:{if(u!==8)break;i.anchor=r.int32();continue}case 2:{if(u!==16)break;i.vertical=r.int32();continue}case 4:{if(u!==32)break;i.bold=r.bool();continue}case 5:{if(u!==40)break;i.italic=r.bool();continue}case 3:{if(u!==26)break;i.color=On.decode(r,r.uint32());continue}case 6:{if(u!==48)break;i.fontSize=r.int32();continue}case 7:{if(u!==58)break;i.fill=vn.decode(r,r.uint32());continue}case 8:{if(u!==64)break;i.alignment=r.int32();continue}case 9:{if(u!==74)break;i.underline=r.string();continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{anchor:wn(n.anchor)?Rf(n.anchor):0,vertical:wn(n.vertical)?If(n.vertical):0,bold:wn(n.bold)?globalThis.Boolean(n.bold):!1,italic:wn(n.italic)?globalThis.Boolean(n.italic):!1,color:wn(n.color)?On.fromJSON(n.color):void 0,fontSize:wn(n.fontSize)?globalThis.Number(n.fontSize):0,fill:wn(n.fill)?vn.fromJSON(n.fill):void 0,alignment:wn(n.alignment)?mf(n.alignment):0,underline:wn(n.underline)?globalThis.String(n.underline):""}},toJSON(n){const e={};return n.anchor!==0&&(e.anchor=Tf(n.anchor)),n.vertical!==0&&(e.vertical=Of(n.vertical)),n.bold!==!1&&(e.bold=n.bold),n.italic!==!1&&(e.italic=n.italic),n.color!==void 0&&(e.color=On.toJSON(n.color)),n.fontSize!==0&&(e.fontSize=Math.round(n.fontSize)),n.fill!==void 0&&(e.fill=vn.toJSON(n.fill)),n.alignment!==0&&(e.alignment=Af(n.alignment)),n.underline!==""&&(e.underline=n.underline),e},create(n){return Sn.fromPartial(n??{})},fromPartial(n){const e=lo();return e.anchor=n.anchor??0,e.vertical=n.vertical??0,e.bold=n.bold??!1,e.italic=n.italic??!1,e.color=n.color!==void 0&&n.color!==null?On.fromPartial(n.color):void 0,e.fontSize=n.fontSize??0,e.fill=n.fill!==void 0&&n.fill!==null?vn.fromPartial(n.fill):void 0,e.alignment=n.alignment??0,e.underline=n.underline??"",e}};function fo(){return{level:0,textStyle:void 0}}const Un={encode(n,e=new mn){return n.level!==0&&e.uint32(16).int32(n.level),n.textStyle!==void 0&&Sn.encode(n.textStyle,e.uint32(26).fork()).join(),e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=fo();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 2:{if(u!==16)break;i.level=r.int32();continue}case 3:{if(u!==26)break;i.textStyle=Sn.decode(r,r.uint32());continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{level:wn(n.level)?globalThis.Number(n.level):0,textStyle:wn(n.textStyle)?Sn.fromJSON(n.textStyle):void 0}},toJSON(n){const e={};return n.level!==0&&(e.level=Math.round(n.level)),n.textStyle!==void 0&&(e.textStyle=Sn.toJSON(n.textStyle)),e},create(n){return Un.fromPartial(n??{})},fromPartial(n){const e=fo();return e.level=n.level??0,e.textStyle=n.textStyle!==void 0&&n.textStyle!==null?Sn.fromPartial(n.textStyle):void 0,e}};function so(){return{style:0,widthEmu:0,fill:void 0}}const zn={encode(n,e=new mn){return n.style!==0&&e.uint32(8).int32(n.style),n.widthEmu!==0&&e.uint32(16).int32(n.widthEmu),n.fill!==void 0&&vn.encode(n.fill,e.uint32(26).fork()).join(),e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=so();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 1:{if(u!==8)break;i.style=r.int32();continue}case 2:{if(u!==16)break;i.widthEmu=r.int32();continue}case 3:{if(u!==26)break;i.fill=vn.decode(r,r.uint32());continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{style:wn(n.style)?Sf(n.style):0,widthEmu:wn(n.widthEmu)?globalThis.Number(n.widthEmu):0,fill:wn(n.fill)?vn.fromJSON(n.fill):void 0}},toJSON(n){const e={};return n.style!==0&&(e.style=kf(n.style)),n.widthEmu!==0&&(e.widthEmu=Math.round(n.widthEmu)),n.fill!==void 0&&(e.fill=vn.toJSON(n.fill)),e},create(n){return zn.fromPartial(n??{})},fromPartial(n){const e=so();return e.style=n.style??0,e.widthEmu=n.widthEmu??0,e.fill=n.fill!==void 0&&n.fill!==null?vn.fromPartial(n.fill):void 0,e}};function Zr(n){const e=globalThis.Number(n.toString());if(e>globalThis.Number.MAX_SAFE_INTEGER)throw new globalThis.Error("Value is larger than Number.MAX_SAFE_INTEGER");if(e<globalThis.Number.MIN_SAFE_INTEGER)throw new globalThis.Error("Value is smaller than Number.MIN_SAFE_INTEGER");return e}function wn(n){return n!=null}var Iu=(n=>(n[n.BAR_DIRECTION_UNKNOWN=0]="BAR_DIRECTION_UNKNOWN",n[n.BAR_DIRECTION_COLUMN=1]="BAR_DIRECTION_COLUMN",n[n.BAR_DIRECTION_BAR=2]="BAR_DIRECTION_BAR",n[n.UNRECOGNIZED=-1]="UNRECOGNIZED",n))(Iu||{});function Mf(n){switch(n){case 0:case"BAR_DIRECTION_UNKNOWN":return 0;case 1:case"BAR_DIRECTION_COLUMN":return 1;case 2:case"BAR_DIRECTION_BAR":return 2;case-1:case"UNRECOGNIZED":default:return-1}}function Cf(n){switch(n){case 0:return"BAR_DIRECTION_UNKNOWN";case 1:return"BAR_DIRECTION_COLUMN";case 2:return"BAR_DIRECTION_BAR";case-1:default:return"UNRECOGNIZED"}}var Yn=(n=>(n[n.UNKNOWN=0]="UNKNOWN",n[n.AREA_3D=1]="AREA_3D",n[n.AREA=2]="AREA",n[n.BAR_3D=3]="BAR_3D",n[n.BAR=4]="BAR",n[n.BUBBLE=5]="BUBBLE",n[n.DOUGHNUT=8]="DOUGHNUT",n[n.LINE_3D=12]="LINE_3D",n[n.LINE=13]="LINE",n[n.OF_PIE=14]="OF_PIE",n[n.PIE_3D=15]="PIE_3D",n[n.PIE=16]="PIE",n[n.RADAR=17]="RADAR",n[n.SCATTER=18]="SCATTER",n[n.STOCK=20]="STOCK",n[n.SURFACE_3D=21]="SURFACE_3D",n[n.SURFACE=22]="SURFACE",n[n.UNRECOGNIZED=-1]="UNRECOGNIZED",n))(Yn||{});function Lf(n){switch(n){case 0:case"UNKNOWN":return 0;case 1:case"AREA_3D":return 1;case 2:case"AREA":return 2;case 3:case"BAR_3D":return 3;case 4:case"BAR":return 4;case 5:case"BUBBLE":return 5;case 8:case"DOUGHNUT":return 8;case 12:case"LINE_3D":return 12;case 13:case"LINE":return 13;case 14:case"OF_PIE":return 14;case 15:case"PIE_3D":return 15;case 16:case"PIE":return 16;case 17:case"RADAR":return 17;case 18:case"SCATTER":return 18;case 20:case"STOCK":return 20;case 21:case"SURFACE_3D":return 21;case 22:case"SURFACE":return 22;case-1:case"UNRECOGNIZED":default:return-1}}function Df(n){switch(n){case 0:return"UNKNOWN";case 1:return"AREA_3D";case 2:return"AREA";case 3:return"BAR_3D";case 4:return"BAR";case 5:return"BUBBLE";case 8:return"DOUGHNUT";case 12:return"LINE_3D";case 13:return"LINE";case 14:return"OF_PIE";case 15:return"PIE_3D";case 16:return"PIE";case 17:return"RADAR";case 18:return"SCATTER";case 20:return"STOCK";case 21:return"SURFACE_3D";case 22:return"SURFACE";case-1:default:return"UNRECOGNIZED"}}function co(){return{title:"",categories:[],series:[],bbox:void 0,type:0,styleIndex:0,id:"",xAxis:void 0,yAxis:void 0,barDirection:0}}const ir={encode(n,e=new mn){n.title!==""&&e.uint32(10).string(n.title);for(const r of n.categories)e.uint32(18).string(r);for(const r of n.series)or.encode(r,e.uint32(26).fork()).join();return n.bbox!==void 0&&Ee.encode(n.bbox,e.uint32(34).fork()).join(),n.type!==0&&e.uint32(40).int32(n.type),n.styleIndex!==0&&e.uint32(48).int32(n.styleIndex),n.id!==""&&e.uint32(58).string(n.id),n.xAxis!==void 0&&ve.encode(n.xAxis,e.uint32(66).fork()).join(),n.yAxis!==void 0&&ve.encode(n.yAxis,e.uint32(74).fork()).join(),n.barDirection!==0&&e.uint32(80).int32(n.barDirection),e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=co();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 1:{if(u!==10)break;i.title=r.string();continue}case 2:{if(u!==18)break;i.categories.push(r.string());continue}case 3:{if(u!==26)break;i.series.push(or.decode(r,r.uint32()));continue}case 4:{if(u!==34)break;i.bbox=Ee.decode(r,r.uint32());continue}case 5:{if(u!==40)break;i.type=r.int32();continue}case 6:{if(u!==48)break;i.styleIndex=r.int32();continue}case 7:{if(u!==58)break;i.id=r.string();continue}case 8:{if(u!==66)break;i.xAxis=ve.decode(r,r.uint32());continue}case 9:{if(u!==74)break;i.yAxis=ve.decode(r,r.uint32());continue}case 10:{if(u!==80)break;i.barDirection=r.int32();continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{title:Zn(n.title)?globalThis.String(n.title):"",categories:globalThis.Array.isArray(n?.categories)?n.categories.map(e=>globalThis.String(e)):[],series:globalThis.Array.isArray(n?.series)?n.series.map(e=>or.fromJSON(e)):[],bbox:Zn(n.bbox)?Ee.fromJSON(n.bbox):void 0,type:Zn(n.type)?Lf(n.type):0,styleIndex:Zn(n.styleIndex)?globalThis.Number(n.styleIndex):0,id:Zn(n.id)?globalThis.String(n.id):"",xAxis:Zn(n.xAxis)?ve.fromJSON(n.xAxis):void 0,yAxis:Zn(n.yAxis)?ve.fromJSON(n.yAxis):void 0,barDirection:Zn(n.barDirection)?Mf(n.barDirection):0}},toJSON(n){const e={};return n.title!==""&&(e.title=n.title),n.categories?.length&&(e.categories=n.categories),n.series?.length&&(e.series=n.series.map(r=>or.toJSON(r))),n.bbox!==void 0&&(e.bbox=Ee.toJSON(n.bbox)),n.type!==0&&(e.type=Df(n.type)),n.styleIndex!==0&&(e.styleIndex=Math.round(n.styleIndex)),n.id!==""&&(e.id=n.id),n.xAxis!==void 0&&(e.xAxis=ve.toJSON(n.xAxis)),n.yAxis!==void 0&&(e.yAxis=ve.toJSON(n.yAxis)),n.barDirection!==0&&(e.barDirection=Cf(n.barDirection)),e},create(n){return ir.fromPartial(n??{})},fromPartial(n){const e=co();return e.title=n.title??"",e.categories=n.categories?.map(r=>r)||[],e.series=n.series?.map(r=>or.fromPartial(r))||[],e.bbox=n.bbox!==void 0&&n.bbox!==null?Ee.fromPartial(n.bbox):void 0,e.type=n.type??0,e.styleIndex=n.styleIndex??0,e.id=n.id??"",e.xAxis=n.xAxis!==void 0&&n.xAxis!==null?ve.fromPartial(n.xAxis):void 0,e.yAxis=n.yAxis!==void 0&&n.yAxis!==null?ve.fromPartial(n.yAxis):void 0,e.barDirection=n.barDirection??0,e}};function ao(){return{name:"",values:[],formula:"",stringCache:"",categories:[],categoryFormula:"",fill:void 0}}const or={encode(n,e=new mn){n.name!==""&&e.uint32(10).string(n.name),e.uint32(18).fork();for(const r of n.values)e.double(r);e.join(),n.formula!==""&&e.uint32(26).string(n.formula),n.stringCache!==""&&e.uint32(34).string(n.stringCache);for(const r of n.categories)e.uint32(42).string(r);return n.categoryFormula!==""&&e.uint32(50).string(n.categoryFormula),n.fill!==void 0&&vn.encode(n.fill,e.uint32(58).fork()).join(),e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=ao();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 1:{if(u!==10)break;i.name=r.string();continue}case 2:{if(u===17){i.values.push(r.double());continue}if(u===18){const a=r.uint32()+r.pos;for(;r.pos<a;)i.values.push(r.double());continue}break}case 3:{if(u!==26)break;i.formula=r.string();continue}case 4:{if(u!==34)break;i.stringCache=r.string();continue}case 5:{if(u!==42)break;i.categories.push(r.string());continue}case 6:{if(u!==50)break;i.categoryFormula=r.string();continue}case 7:{if(u!==58)break;i.fill=vn.decode(r,r.uint32());continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{name:Zn(n.name)?globalThis.String(n.name):"",values:globalThis.Array.isArray(n?.values)?n.values.map(e=>globalThis.Number(e)):[],formula:Zn(n.formula)?globalThis.String(n.formula):"",stringCache:Zn(n.stringCache)?globalThis.String(n.stringCache):"",categories:globalThis.Array.isArray(n?.categories)?n.categories.map(e=>globalThis.String(e)):[],categoryFormula:Zn(n.categoryFormula)?globalThis.String(n.categoryFormula):"",fill:Zn(n.fill)?vn.fromJSON(n.fill):void 0}},toJSON(n){const e={};return n.name!==""&&(e.name=n.name),n.values?.length&&(e.values=n.values),n.formula!==""&&(e.formula=n.formula),n.stringCache!==""&&(e.stringCache=n.stringCache),n.categories?.length&&(e.categories=n.categories),n.categoryFormula!==""&&(e.categoryFormula=n.categoryFormula),n.fill!==void 0&&(e.fill=vn.toJSON(n.fill)),e},create(n){return or.fromPartial(n??{})},fromPartial(n){const e=ao();return e.name=n.name??"",e.values=n.values?.map(r=>r)||[],e.formula=n.formula??"",e.stringCache=n.stringCache??"",e.categories=n.categories?.map(r=>r)||[],e.categoryFormula=n.categoryFormula??"",e.fill=n.fill!==void 0&&n.fill!==null?vn.fromPartial(n.fill):void 0,e}};function ho(){return{textStyle:void 0,line:void 0,min:0,max:0}}const ve={encode(n,e=new mn){return n.textStyle!==void 0&&Sn.encode(n.textStyle,e.uint32(10).fork()).join(),n.line!==void 0&&zn.encode(n.line,e.uint32(18).fork()).join(),n.min!==0&&e.uint32(25).double(n.min),n.max!==0&&e.uint32(33).double(n.max),e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=ho();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 1:{if(u!==10)break;i.textStyle=Sn.decode(r,r.uint32());continue}case 2:{if(u!==18)break;i.line=zn.decode(r,r.uint32());continue}case 3:{if(u!==25)break;i.min=r.double();continue}case 4:{if(u!==33)break;i.max=r.double();continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{textStyle:Zn(n.textStyle)?Sn.fromJSON(n.textStyle):void 0,line:Zn(n.line)?zn.fromJSON(n.line):void 0,min:Zn(n.min)?globalThis.Number(n.min):0,max:Zn(n.max)?globalThis.Number(n.max):0}},toJSON(n){const e={};return n.textStyle!==void 0&&(e.textStyle=Sn.toJSON(n.textStyle)),n.line!==void 0&&(e.line=zn.toJSON(n.line)),n.min!==0&&(e.min=n.min),n.max!==0&&(e.max=n.max),e},create(n){return ve.fromPartial(n??{})},fromPartial(n){const e=ho();return e.textStyle=n.textStyle!==void 0&&n.textStyle!==null?Sn.fromPartial(n.textStyle):void 0,e.line=n.line!==void 0&&n.line!==null?zn.fromPartial(n.line):void 0,e.min=n.min??0,e.max=n.max??0,e}};function Zn(n){return n!=null}var ci=(n=>(n[n.TYPE_UNSET=0]="TYPE_UNSET",n[n.TEXT=1]="TEXT",n[n.TEXT_GROUP=2]="TEXT_GROUP",n[n.IMAGE=3]="IMAGE",n[n.CHART=4]="CHART",n[n.SHAPE=5]="SHAPE",n[n.CHART_REFERENCE=6]="CHART_REFERENCE",n[n.IMAGE_REFERENCE=7]="IMAGE_REFERENCE",n[n.VIDEO_REFERENCE=8]="VIDEO_REFERENCE",n[n.TABLE=9]="TABLE",n[n.UNRECOGNIZED=-1]="UNRECOGNIZED",n))(ci||{});function Pf(n){switch(n){case 0:case"TYPE_UNSET":return 0;case 1:case"TEXT":return 1;case 2:case"TEXT_GROUP":return 2;case 3:case"IMAGE":return 3;case 4:case"CHART":return 4;case 5:case"SHAPE":return 5;case 6:case"CHART_REFERENCE":return 6;case 7:case"IMAGE_REFERENCE":return 7;case 8:case"VIDEO_REFERENCE":return 8;case 9:case"TABLE":return 9;case-1:case"UNRECOGNIZED":default:return-1}}function xf(n){switch(n){case 0:return"TYPE_UNSET";case 1:return"TEXT";case 2:return"TEXT_GROUP";case 3:return"IMAGE";case 4:return"CHART";case 5:return"SHAPE";case 6:return"CHART_REFERENCE";case 7:return"IMAGE_REFERENCE";case 8:return"VIDEO_REFERENCE";case 9:return"TABLE";case-1:default:return"UNRECOGNIZED"}}var Ou=(n=>(n[n.EFFECT_TYPE_UNSET=0]="EFFECT_TYPE_UNSET",n[n.OUTER_SHADOW=1]="OUTER_SHADOW",n[n.UNRECOGNIZED=-1]="UNRECOGNIZED",n))(Ou||{});function Uf(n){switch(n){case 0:case"EFFECT_TYPE_UNSET":return 0;case 1:case"OUTER_SHADOW":return 1;case-1:case"UNRECOGNIZED":default:return-1}}function Ff(n){switch(n){case 0:return"EFFECT_TYPE_UNSET";case 1:return"OUTER_SHADOW";case-1:default:return"UNRECOGNIZED"}}var tt=(n=>(n[n.UNKNOWN=0]="UNKNOWN",n[n.RECTANGLE=1]="RECTANGLE",n[n.ELLIPSE=2]="ELLIPSE",n[n.ROUND_RECT=3]="ROUND_RECT",n[n.POLYGON=4]="POLYGON",n[n.LINE=5]="LINE",n[n.ARROW=6]="ARROW",n[n.DIAMOND=7]="DIAMOND",n[n.TRAPEZOID=8]="TRAPEZOID",n[n.STAR=9]="STAR",n[n.HEART=10]="HEART",n[n.PENTAGON=11]="PENTAGON",n[n.CIRCLE=12]="CIRCLE",n[n.OVAL=13]="OVAL",n[n.WEDGE=14]="WEDGE",n[n.RHOMBUS=15]="RHOMBUS",n[n.TRIANGLE=16]="TRIANGLE",n[n.DOWN_ARROW=17]="DOWN_ARROW",n[n.UP_ARROW=18]="UP_ARROW",n[n.LEFT_ARROW=19]="LEFT_ARROW",n[n.RIGHT_ARROW=20]="RIGHT_ARROW",n[n.UNRECOGNIZED=-1]="UNRECOGNIZED",n))(tt||{});function Bf(n){switch(n){case 0:case"UNKNOWN":return 0;case 1:case"RECTANGLE":return 1;case 2:case"ELLIPSE":return 2;case 3:case"ROUND_RECT":return 3;case 4:case"POLYGON":return 4;case 5:case"LINE":return 5;case 6:case"ARROW":return 6;case 7:case"DIAMOND":return 7;case 8:case"TRAPEZOID":return 8;case 9:case"STAR":return 9;case 10:case"HEART":return 10;case 11:case"PENTAGON":return 11;case 12:case"CIRCLE":return 12;case 13:case"OVAL":return 13;case 14:case"WEDGE":return 14;case 15:case"RHOMBUS":return 15;case 16:case"TRIANGLE":return 16;case 17:case"DOWN_ARROW":return 17;case 18:case"UP_ARROW":return 18;case 19:case"LEFT_ARROW":return 19;case 20:case"RIGHT_ARROW":return 20;case-1:case"UNRECOGNIZED":default:return-1}}function Jf(n){switch(n){case 0:return"UNKNOWN";case 1:return"RECTANGLE";case 2:return"ELLIPSE";case 3:return"ROUND_RECT";case 4:return"POLYGON";case 5:return"LINE";case 6:return"ARROW";case 7:return"DIAMOND";case 8:return"TRAPEZOID";case 9:return"STAR";case 10:return"HEART";case 11:return"PENTAGON";case 12:return"CIRCLE";case 13:return"OVAL";case 14:return"WEDGE";case 15:return"RHOMBUS";case 16:return"TRIANGLE";case 17:return"DOWN_ARROW";case 18:return"UP_ARROW";case 19:return"LEFT_ARROW";case 20:return"RIGHT_ARROW";case-1:default:return"UNRECOGNIZED"}}function go(){return{slides:[],theme:void 0,layouts:[],charts:[]}}const Vf={encode(n,e=new mn){for(const r of n.slides)pe.encode(r,e.uint32(10).fork()).join();n.theme!==void 0&&ur.encode(n.theme,e.uint32(18).fork()).join();for(const r of n.layouts)sr.encode(r,e.uint32(26).fork()).join();for(const r of n.charts)ir.encode(r,e.uint32(74).fork()).join();return e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=go();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 1:{if(u!==10)break;i.slides.push(pe.decode(r,r.uint32()));continue}case 2:{if(u!==18)break;i.theme=ur.decode(r,r.uint32());continue}case 3:{if(u!==26)break;i.layouts.push(sr.decode(r,r.uint32()));continue}case 9:{if(u!==74)break;i.charts.push(ir.decode(r,r.uint32()));continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{slides:globalThis.Array.isArray(n?.slides)?n.slides.map(e=>pe.fromJSON(e)):[],theme:_(n.theme)?ur.fromJSON(n.theme):void 0,layouts:globalThis.Array.isArray(n?.layouts)?n.layouts.map(e=>sr.fromJSON(e)):[],charts:globalThis.Array.isArray(n?.charts)?n.charts.map(e=>ir.fromJSON(e)):[]}},toJSON(n){const e={};return n.slides?.length&&(e.slides=n.slides.map(r=>pe.toJSON(r))),n.theme!==void 0&&(e.theme=ur.toJSON(n.theme)),n.layouts?.length&&(e.layouts=n.layouts.map(r=>sr.toJSON(r))),n.charts?.length&&(e.charts=n.charts.map(r=>ir.toJSON(r))),e},create(n){return Vf.fromPartial(n??{})},fromPartial(n){const e=go();return e.slides=n.slides?.map(r=>pe.fromPartial(r))||[],e.theme=n.theme!==void 0&&n.theme!==null?ur.fromPartial(n.theme):void 0,e.layouts=n.layouts?.map(r=>sr.fromPartial(r))||[],e.charts=n.charts?.map(r=>ir.fromPartial(r))||[],e}};function vo(){return{colorScheme:void 0,backgroundFillStyleList:[],lineStyleList:[],effectStyleList:[]}}const ur={encode(n,e=new mn){n.colorScheme!==void 0&&lr.encode(n.colorScheme,e.uint32(10).fork()).join();for(const r of n.backgroundFillStyleList)vn.encode(r,e.uint32(18).fork()).join();for(const r of n.lineStyleList)zn.encode(r,e.uint32(26).fork()).join();for(const r of n.effectStyleList)vr.encode(r,e.uint32(34).fork()).join();return e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=vo();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 1:{if(u!==10)break;i.colorScheme=lr.decode(r,r.uint32());continue}case 2:{if(u!==18)break;i.backgroundFillStyleList.push(vn.decode(r,r.uint32()));continue}case 3:{if(u!==26)break;i.lineStyleList.push(zn.decode(r,r.uint32()));continue}case 4:{if(u!==34)break;i.effectStyleList.push(vr.decode(r,r.uint32()));continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{colorScheme:_(n.colorScheme)?lr.fromJSON(n.colorScheme):void 0,backgroundFillStyleList:globalThis.Array.isArray(n?.backgroundFillStyleList)?n.backgroundFillStyleList.map(e=>vn.fromJSON(e)):[],lineStyleList:globalThis.Array.isArray(n?.lineStyleList)?n.lineStyleList.map(e=>zn.fromJSON(e)):[],effectStyleList:globalThis.Array.isArray(n?.effectStyleList)?n.effectStyleList.map(e=>vr.fromJSON(e)):[]}},toJSON(n){const e={};return n.colorScheme!==void 0&&(e.colorScheme=lr.toJSON(n.colorScheme)),n.backgroundFillStyleList?.length&&(e.backgroundFillStyleList=n.backgroundFillStyleList.map(r=>vn.toJSON(r))),n.lineStyleList?.length&&(e.lineStyleList=n.lineStyleList.map(r=>zn.toJSON(r))),n.effectStyleList?.length&&(e.effectStyleList=n.effectStyleList.map(r=>vr.toJSON(r))),e},create(n){return ur.fromPartial(n??{})},fromPartial(n){const e=vo();return e.colorScheme=n.colorScheme!==void 0&&n.colorScheme!==null?lr.fromPartial(n.colorScheme):void 0,e.backgroundFillStyleList=n.backgroundFillStyleList?.map(r=>vn.fromPartial(r))||[],e.lineStyleList=n.lineStyleList?.map(r=>zn.fromPartial(r))||[],e.effectStyleList=n.effectStyleList?.map(r=>vr.fromPartial(r))||[],e}};function po(){return{name:"",colors:[]}}const lr={encode(n,e=new mn){n.name!==""&&e.uint32(10).string(n.name);for(const r of n.colors)fr.encode(r,e.uint32(18).fork()).join();return e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=po();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 1:{if(u!==10)break;i.name=r.string();continue}case 2:{if(u!==18)break;i.colors.push(fr.decode(r,r.uint32()));continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{name:_(n.name)?globalThis.String(n.name):"",colors:globalThis.Array.isArray(n?.colors)?n.colors.map(e=>fr.fromJSON(e)):[]}},toJSON(n){const e={};return n.name!==""&&(e.name=n.name),n.colors?.length&&(e.colors=n.colors.map(r=>fr.toJSON(r))),e},create(n){return lr.fromPartial(n??{})},fromPartial(n){const e=po();return e.name=n.name??"",e.colors=n.colors?.map(r=>fr.fromPartial(r))||[],e}};function Eo(){return{name:"",color:void 0}}const fr={encode(n,e=new mn){return n.name!==""&&e.uint32(10).string(n.name),n.color!==void 0&&On.encode(n.color,e.uint32(18).fork()).join(),e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=Eo();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 1:{if(u!==10)break;i.name=r.string();continue}case 2:{if(u!==18)break;i.color=On.decode(r,r.uint32());continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{name:_(n.name)?globalThis.String(n.name):"",color:_(n.color)?On.fromJSON(n.color):void 0}},toJSON(n){const e={};return n.name!==""&&(e.name=n.name),n.color!==void 0&&(e.color=On.toJSON(n.color)),e},create(n){return fr.fromPartial(n??{})},fromPartial(n){const e=Eo();return e.name=n.name??"",e.color=n.color!==void 0&&n.color!==null?On.fromPartial(n.color):void 0,e}};function No(){return{id:"",innerXml:"",outerXml:"",name:"",type:"",background:void 0,elements:[],bodyLevelStyles:[],titleLevelStyles:[],otherLevelStyles:[],parentLayoutId:""}}const sr={encode(n,e=new mn){n.id!==""&&e.uint32(10).string(n.id),n.innerXml!==""&&e.uint32(50).string(n.innerXml),n.outerXml!==""&&e.uint32(58).string(n.outerXml),n.name!==""&&e.uint32(66).string(n.name),n.type!==""&&e.uint32(74).string(n.type),n.background!==void 0&&Ne.encode(n.background,e.uint32(82).fork()).join();for(const r of n.elements)jn.encode(r,e.uint32(90).fork()).join();for(const r of n.bodyLevelStyles)Un.encode(r,e.uint32(98).fork()).join();for(const r of n.titleLevelStyles)Un.encode(r,e.uint32(106).fork()).join();for(const r of n.otherLevelStyles)Un.encode(r,e.uint32(114).fork()).join();return n.parentLayoutId!==""&&e.uint32(122).string(n.parentLayoutId),e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=No();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 1:{if(u!==10)break;i.id=r.string();continue}case 6:{if(u!==50)break;i.innerXml=r.string();continue}case 7:{if(u!==58)break;i.outerXml=r.string();continue}case 8:{if(u!==66)break;i.name=r.string();continue}case 9:{if(u!==74)break;i.type=r.string();continue}case 10:{if(u!==82)break;i.background=Ne.decode(r,r.uint32());continue}case 11:{if(u!==90)break;i.elements.push(jn.decode(r,r.uint32()));continue}case 12:{if(u!==98)break;i.bodyLevelStyles.push(Un.decode(r,r.uint32()));continue}case 13:{if(u!==106)break;i.titleLevelStyles.push(Un.decode(r,r.uint32()));continue}case 14:{if(u!==114)break;i.otherLevelStyles.push(Un.decode(r,r.uint32()));continue}case 15:{if(u!==122)break;i.parentLayoutId=r.string();continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{id:_(n.id)?globalThis.String(n.id):"",innerXml:_(n.innerXml)?globalThis.String(n.innerXml):"",outerXml:_(n.outerXml)?globalThis.String(n.outerXml):"",name:_(n.name)?globalThis.String(n.name):"",type:_(n.type)?globalThis.String(n.type):"",background:_(n.background)?Ne.fromJSON(n.background):void 0,elements:globalThis.Array.isArray(n?.elements)?n.elements.map(e=>jn.fromJSON(e)):[],bodyLevelStyles:globalThis.Array.isArray(n?.bodyLevelStyles)?n.bodyLevelStyles.map(e=>Un.fromJSON(e)):[],titleLevelStyles:globalThis.Array.isArray(n?.titleLevelStyles)?n.titleLevelStyles.map(e=>Un.fromJSON(e)):[],otherLevelStyles:globalThis.Array.isArray(n?.otherLevelStyles)?n.otherLevelStyles.map(e=>Un.fromJSON(e)):[],parentLayoutId:_(n.parentLayoutId)?globalThis.String(n.parentLayoutId):""}},toJSON(n){const e={};return n.id!==""&&(e.id=n.id),n.innerXml!==""&&(e.innerXml=n.innerXml),n.outerXml!==""&&(e.outerXml=n.outerXml),n.name!==""&&(e.name=n.name),n.type!==""&&(e.type=n.type),n.background!==void 0&&(e.background=Ne.toJSON(n.background)),n.elements?.length&&(e.elements=n.elements.map(r=>jn.toJSON(r))),n.bodyLevelStyles?.length&&(e.bodyLevelStyles=n.bodyLevelStyles.map(r=>Un.toJSON(r))),n.titleLevelStyles?.length&&(e.titleLevelStyles=n.titleLevelStyles.map(r=>Un.toJSON(r))),n.otherLevelStyles?.length&&(e.otherLevelStyles=n.otherLevelStyles.map(r=>Un.toJSON(r))),n.parentLayoutId!==""&&(e.parentLayoutId=n.parentLayoutId),e},create(n){return sr.fromPartial(n??{})},fromPartial(n){const e=No();return e.id=n.id??"",e.innerXml=n.innerXml??"",e.outerXml=n.outerXml??"",e.name=n.name??"",e.type=n.type??"",e.background=n.background!==void 0&&n.background!==null?Ne.fromPartial(n.background):void 0,e.elements=n.elements?.map(r=>jn.fromPartial(r))||[],e.bodyLevelStyles=n.bodyLevelStyles?.map(r=>Un.fromPartial(r))||[],e.titleLevelStyles=n.titleLevelStyles?.map(r=>Un.fromPartial(r))||[],e.otherLevelStyles=n.otherLevelStyles?.map(r=>Un.fromPartial(r))||[],e.parentLayoutId=n.parentLayoutId??"",e}};function wo(){return{index:0,useLayoutId:"",elements:[],widthEmu:0,heightEmu:0,innerXml:"",outerXml:"",background:void 0,id:"",notesSlide:void 0}}const pe={encode(n,e=new mn){n.index!==0&&e.uint32(8).int32(n.index),n.useLayoutId!==""&&e.uint32(18).string(n.useLayoutId);for(const r of n.elements)jn.encode(r,e.uint32(26).fork()).join();return n.widthEmu!==0&&e.uint32(40).int64(n.widthEmu),n.heightEmu!==0&&e.uint32(48).int64(n.heightEmu),n.innerXml!==""&&e.uint32(58).string(n.innerXml),n.outerXml!==""&&e.uint32(66).string(n.outerXml),n.background!==void 0&&Ne.encode(n.background,e.uint32(82).fork()).join(),n.id!==""&&e.uint32(90).string(n.id),n.notesSlide!==void 0&&pe.encode(n.notesSlide,e.uint32(98).fork()).join(),e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=wo();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 1:{if(u!==8)break;i.index=r.int32();continue}case 2:{if(u!==18)break;i.useLayoutId=r.string();continue}case 3:{if(u!==26)break;i.elements.push(jn.decode(r,r.uint32()));continue}case 5:{if(u!==40)break;i.widthEmu=Fo(r.int64());continue}case 6:{if(u!==48)break;i.heightEmu=Fo(r.int64());continue}case 7:{if(u!==58)break;i.innerXml=r.string();continue}case 8:{if(u!==66)break;i.outerXml=r.string();continue}case 10:{if(u!==82)break;i.background=Ne.decode(r,r.uint32());continue}case 11:{if(u!==90)break;i.id=r.string();continue}case 12:{if(u!==98)break;i.notesSlide=pe.decode(r,r.uint32());continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{index:_(n.index)?globalThis.Number(n.index):0,useLayoutId:_(n.useLayoutId)?globalThis.String(n.useLayoutId):"",elements:globalThis.Array.isArray(n?.elements)?n.elements.map(e=>jn.fromJSON(e)):[],widthEmu:_(n.widthEmu)?globalThis.Number(n.widthEmu):0,heightEmu:_(n.heightEmu)?globalThis.Number(n.heightEmu):0,innerXml:_(n.innerXml)?globalThis.String(n.innerXml):"",outerXml:_(n.outerXml)?globalThis.String(n.outerXml):"",background:_(n.background)?Ne.fromJSON(n.background):void 0,id:_(n.id)?globalThis.String(n.id):"",notesSlide:_(n.notesSlide)?pe.fromJSON(n.notesSlide):void 0}},toJSON(n){const e={};return n.index!==0&&(e.index=Math.round(n.index)),n.useLayoutId!==""&&(e.useLayoutId=n.useLayoutId),n.elements?.length&&(e.elements=n.elements.map(r=>jn.toJSON(r))),n.widthEmu!==0&&(e.widthEmu=Math.round(n.widthEmu)),n.heightEmu!==0&&(e.heightEmu=Math.round(n.heightEmu)),n.innerXml!==""&&(e.innerXml=n.innerXml),n.outerXml!==""&&(e.outerXml=n.outerXml),n.background!==void 0&&(e.background=Ne.toJSON(n.background)),n.id!==""&&(e.id=n.id),n.notesSlide!==void 0&&(e.notesSlide=pe.toJSON(n.notesSlide)),e},create(n){return pe.fromPartial(n??{})},fromPartial(n){const e=wo();return e.index=n.index??0,e.useLayoutId=n.useLayoutId??"",e.elements=n.elements?.map(r=>jn.fromPartial(r))||[],e.widthEmu=n.widthEmu??0,e.heightEmu=n.heightEmu??0,e.innerXml=n.innerXml??"",e.outerXml=n.outerXml??"",e.background=n.background!==void 0&&n.background!==null?Ne.fromPartial(n.background):void 0,e.id=n.id??"",e.notesSlide=n.notesSlide!==void 0&&n.notesSlide!==null?pe.fromPartial(n.notesSlide):void 0,e}};function yo(){return{bbox:void 0,zIndex:0,innerXml:"",outerXml:"",shape:void 0,image:void 0,chartReference:void 0,video:void 0,table:void 0,paragraphs:[],name:"",type:0,placeholderIndex:0,placeholderType:"",textStyle:void 0,effects:[],children:[],levelsStyles:[],fill:void 0,lineReference:void 0,fillReference:void 0,effectReference:void 0,fontReference:void 0,hyperlink:void 0}}const jn={encode(n,e=new mn){n.bbox!==void 0&&Ee.encode(n.bbox,e.uint32(10).fork()).join(),n.zIndex!==0&&e.uint32(16).int32(n.zIndex),n.innerXml!==""&&e.uint32(58).string(n.innerXml),n.outerXml!==""&&e.uint32(66).string(n.outerXml),n.shape!==void 0&&Er.encode(n.shape,e.uint32(34).fork()).join(),n.image!==void 0&&Nr.encode(n.image,e.uint32(42).fork()).join(),n.chartReference!==void 0&&cr.encode(n.chartReference,e.uint32(146).fork()).join(),n.video!==void 0&&wr.encode(n.video,e.uint32(162).fork()).join(),n.table!==void 0&&ar.encode(n.table,e.uint32(170).fork()).join();for(const r of n.paragraphs)we.encode(r,e.uint32(50).fork()).join();n.name!==""&&e.uint32(82).string(n.name),n.type!==0&&e.uint32(88).int32(n.type),n.placeholderIndex!==0&&e.uint32(96).int32(n.placeholderIndex),n.placeholderType!==""&&e.uint32(106).string(n.placeholderType),n.textStyle!==void 0&&Sn.encode(n.textStyle,e.uint32(114).fork()).join();for(const r of n.effects)me.encode(r,e.uint32(122).fork()).join();for(const r of n.children)jn.encode(r,e.uint32(138).fork()).join();for(const r of n.levelsStyles)Un.encode(r,e.uint32(130).fork()).join();return n.fill!==void 0&&vn.encode(n.fill,e.uint32(154).fork()).join(),n.lineReference!==void 0&&Xn.encode(n.lineReference,e.uint32(178).fork()).join(),n.fillReference!==void 0&&Xn.encode(n.fillReference,e.uint32(186).fork()).join(),n.effectReference!==void 0&&Xn.encode(n.effectReference,e.uint32(194).fork()).join(),n.fontReference!==void 0&&Xn.encode(n.fontReference,e.uint32(202).fork()).join(),n.hyperlink!==void 0&&ye.encode(n.hyperlink,e.uint32(210).fork()).join(),e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=yo();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 1:{if(u!==10)break;i.bbox=Ee.decode(r,r.uint32());continue}case 2:{if(u!==16)break;i.zIndex=r.int32();continue}case 7:{if(u!==58)break;i.innerXml=r.string();continue}case 8:{if(u!==66)break;i.outerXml=r.string();continue}case 4:{if(u!==34)break;i.shape=Er.decode(r,r.uint32());continue}case 5:{if(u!==42)break;i.image=Nr.decode(r,r.uint32());continue}case 18:{if(u!==146)break;i.chartReference=cr.decode(r,r.uint32());continue}case 20:{if(u!==162)break;i.video=wr.decode(r,r.uint32());continue}case 21:{if(u!==170)break;i.table=ar.decode(r,r.uint32());continue}case 6:{if(u!==50)break;i.paragraphs.push(we.decode(r,r.uint32()));continue}case 10:{if(u!==82)break;i.name=r.string();continue}case 11:{if(u!==88)break;i.type=r.int32();continue}case 12:{if(u!==96)break;i.placeholderIndex=r.int32();continue}case 13:{if(u!==106)break;i.placeholderType=r.string();continue}case 14:{if(u!==114)break;i.textStyle=Sn.decode(r,r.uint32());continue}case 15:{if(u!==122)break;i.effects.push(me.decode(r,r.uint32()));continue}case 17:{if(u!==138)break;i.children.push(jn.decode(r,r.uint32()));continue}case 16:{if(u!==130)break;i.levelsStyles.push(Un.decode(r,r.uint32()));continue}case 19:{if(u!==154)break;i.fill=vn.decode(r,r.uint32());continue}case 22:{if(u!==178)break;i.lineReference=Xn.decode(r,r.uint32());continue}case 23:{if(u!==186)break;i.fillReference=Xn.decode(r,r.uint32());continue}case 24:{if(u!==194)break;i.effectReference=Xn.decode(r,r.uint32());continue}case 25:{if(u!==202)break;i.fontReference=Xn.decode(r,r.uint32());continue}case 26:{if(u!==210)break;i.hyperlink=ye.decode(r,r.uint32());continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{bbox:_(n.bbox)?Ee.fromJSON(n.bbox):void 0,zIndex:_(n.zIndex)?globalThis.Number(n.zIndex):0,innerXml:_(n.innerXml)?globalThis.String(n.innerXml):"",outerXml:_(n.outerXml)?globalThis.String(n.outerXml):"",shape:_(n.shape)?Er.fromJSON(n.shape):void 0,image:_(n.image)?Nr.fromJSON(n.image):void 0,chartReference:_(n.chartReference)?cr.fromJSON(n.chartReference):void 0,video:_(n.video)?wr.fromJSON(n.video):void 0,table:_(n.table)?ar.fromJSON(n.table):void 0,paragraphs:globalThis.Array.isArray(n?.paragraphs)?n.paragraphs.map(e=>we.fromJSON(e)):[],name:_(n.name)?globalThis.String(n.name):"",type:_(n.type)?Pf(n.type):0,placeholderIndex:_(n.placeholderIndex)?globalThis.Number(n.placeholderIndex):0,placeholderType:_(n.placeholderType)?globalThis.String(n.placeholderType):"",textStyle:_(n.textStyle)?Sn.fromJSON(n.textStyle):void 0,effects:globalThis.Array.isArray(n?.effects)?n.effects.map(e=>me.fromJSON(e)):[],children:globalThis.Array.isArray(n?.children)?n.children.map(e=>jn.fromJSON(e)):[],levelsStyles:globalThis.Array.isArray(n?.levelsStyles)?n.levelsStyles.map(e=>Un.fromJSON(e)):[],fill:_(n.fill)?vn.fromJSON(n.fill):void 0,lineReference:_(n.lineReference)?Xn.fromJSON(n.lineReference):void 0,fillReference:_(n.fillReference)?Xn.fromJSON(n.fillReference):void 0,effectReference:_(n.effectReference)?Xn.fromJSON(n.effectReference):void 0,fontReference:_(n.fontReference)?Xn.fromJSON(n.fontReference):void 0,hyperlink:_(n.hyperlink)?ye.fromJSON(n.hyperlink):void 0}},toJSON(n){const e={};return n.bbox!==void 0&&(e.bbox=Ee.toJSON(n.bbox)),n.zIndex!==0&&(e.zIndex=Math.round(n.zIndex)),n.innerXml!==""&&(e.innerXml=n.innerXml),n.outerXml!==""&&(e.outerXml=n.outerXml),n.shape!==void 0&&(e.shape=Er.toJSON(n.shape)),n.image!==void 0&&(e.image=Nr.toJSON(n.image)),n.chartReference!==void 0&&(e.chartReference=cr.toJSON(n.chartReference)),n.video!==void 0&&(e.video=wr.toJSON(n.video)),n.table!==void 0&&(e.table=ar.toJSON(n.table)),n.paragraphs?.length&&(e.paragraphs=n.paragraphs.map(r=>we.toJSON(r))),n.name!==""&&(e.name=n.name),n.type!==0&&(e.type=xf(n.type)),n.placeholderIndex!==0&&(e.placeholderIndex=Math.round(n.placeholderIndex)),n.placeholderType!==""&&(e.placeholderType=n.placeholderType),n.textStyle!==void 0&&(e.textStyle=Sn.toJSON(n.textStyle)),n.effects?.length&&(e.effects=n.effects.map(r=>me.toJSON(r))),n.children?.length&&(e.children=n.children.map(r=>jn.toJSON(r))),n.levelsStyles?.length&&(e.levelsStyles=n.levelsStyles.map(r=>Un.toJSON(r))),n.fill!==void 0&&(e.fill=vn.toJSON(n.fill)),n.lineReference!==void 0&&(e.lineReference=Xn.toJSON(n.lineReference)),n.fillReference!==void 0&&(e.fillReference=Xn.toJSON(n.fillReference)),n.effectReference!==void 0&&(e.effectReference=Xn.toJSON(n.effectReference)),n.fontReference!==void 0&&(e.fontReference=Xn.toJSON(n.fontReference)),n.hyperlink!==void 0&&(e.hyperlink=ye.toJSON(n.hyperlink)),e},create(n){return jn.fromPartial(n??{})},fromPartial(n){const e=yo();return e.bbox=n.bbox!==void 0&&n.bbox!==null?Ee.fromPartial(n.bbox):void 0,e.zIndex=n.zIndex??0,e.innerXml=n.innerXml??"",e.outerXml=n.outerXml??"",e.shape=n.shape!==void 0&&n.shape!==null?Er.fromPartial(n.shape):void 0,e.image=n.image!==void 0&&n.image!==null?Nr.fromPartial(n.image):void 0,e.chartReference=n.chartReference!==void 0&&n.chartReference!==null?cr.fromPartial(n.chartReference):void 0,e.video=n.video!==void 0&&n.video!==null?wr.fromPartial(n.video):void 0,e.table=n.table!==void 0&&n.table!==null?ar.fromPartial(n.table):void 0,e.paragraphs=n.paragraphs?.map(r=>we.fromPartial(r))||[],e.name=n.name??"",e.type=n.type??0,e.placeholderIndex=n.placeholderIndex??0,e.placeholderType=n.placeholderType??"",e.textStyle=n.textStyle!==void 0&&n.textStyle!==null?Sn.fromPartial(n.textStyle):void 0,e.effects=n.effects?.map(r=>me.fromPartial(r))||[],e.children=n.children?.map(r=>jn.fromPartial(r))||[],e.levelsStyles=n.levelsStyles?.map(r=>Un.fromPartial(r))||[],e.fill=n.fill!==void 0&&n.fill!==null?vn.fromPartial(n.fill):void 0,e.lineReference=n.lineReference!==void 0&&n.lineReference!==null?Xn.fromPartial(n.lineReference):void 0,e.fillReference=n.fillReference!==void 0&&n.fillReference!==null?Xn.fromPartial(n.fillReference):void 0,e.effectReference=n.effectReference!==void 0&&n.effectReference!==null?Xn.fromPartial(n.effectReference):void 0,e.fontReference=n.fontReference!==void 0&&n.fontReference!==null?Xn.fromPartial(n.fontReference):void 0,e.hyperlink=n.hyperlink!==void 0&&n.hyperlink!==null?ye.fromPartial(n.hyperlink):void 0,e}};function mo(){return{index:"",color:void 0}}const Xn={encode(n,e=new mn){return n.index!==""&&e.uint32(10).string(n.index),n.color!==void 0&&On.encode(n.color,e.uint32(18).fork()).join(),e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=mo();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 1:{if(u!==10)break;i.index=r.string();continue}case 2:{if(u!==18)break;i.color=On.decode(r,r.uint32());continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{index:_(n.index)?globalThis.String(n.index):"",color:_(n.color)?On.fromJSON(n.color):void 0}},toJSON(n){const e={};return n.index!==""&&(e.index=n.index),n.color!==void 0&&(e.color=On.toJSON(n.color)),e},create(n){return Xn.fromPartial(n??{})},fromPartial(n){const e=mo();return e.index=n.index??"",e.color=n.color!==void 0&&n.color!==null?On.fromPartial(n.color):void 0,e}};function Ao(){return{id:""}}const cr={encode(n,e=new mn){return n.id!==""&&e.uint32(10).string(n.id),e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=Ao();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 1:{if(u!==10)break;i.id=r.string();continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{id:_(n.id)?globalThis.String(n.id):""}},toJSON(n){const e={};return n.id!==""&&(e.id=n.id),e},create(n){return cr.fromPartial(n??{})},fromPartial(n){const e=Ao();return e.id=n.id??"",e}};function Ro(){return{rows:[],columnWidths:[]}}const ar={encode(n,e=new mn){for(const r of n.rows)dr.encode(r,e.uint32(10).fork()).join();e.uint32(18).fork();for(const r of n.columnWidths)e.int32(r);return e.join(),e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=Ro();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 1:{if(u!==10)break;i.rows.push(dr.decode(r,r.uint32()));continue}case 2:{if(u===16){i.columnWidths.push(r.int32());continue}if(u===18){const a=r.uint32()+r.pos;for(;r.pos<a;)i.columnWidths.push(r.int32());continue}break}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{rows:globalThis.Array.isArray(n?.rows)?n.rows.map(e=>dr.fromJSON(e)):[],columnWidths:globalThis.Array.isArray(n?.columnWidths)?n.columnWidths.map(e=>globalThis.Number(e)):[]}},toJSON(n){const e={};return n.rows?.length&&(e.rows=n.rows.map(r=>dr.toJSON(r))),n.columnWidths?.length&&(e.columnWidths=n.columnWidths.map(r=>Math.round(r))),e},create(n){return ar.fromPartial(n??{})},fromPartial(n){const e=Ro();return e.rows=n.rows?.map(r=>dr.fromPartial(r))||[],e.columnWidths=n.columnWidths?.map(r=>r)||[],e}};function To(){return{text:"",textStyle:void 0,paragraphs:[],levelsStyles:[],fill:void 0,lines:[]}}const hr={encode(n,e=new mn){n.text!==""&&e.uint32(10).string(n.text),n.textStyle!==void 0&&Sn.encode(n.textStyle,e.uint32(18).fork()).join();for(const r of n.paragraphs)we.encode(r,e.uint32(26).fork()).join();for(const r of n.levelsStyles)Un.encode(r,e.uint32(34).fork()).join();n.fill!==void 0&&vn.encode(n.fill,e.uint32(42).fork()).join();for(const r of n.lines)zn.encode(r,e.uint32(50).fork()).join();return e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=To();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 1:{if(u!==10)break;i.text=r.string();continue}case 2:{if(u!==18)break;i.textStyle=Sn.decode(r,r.uint32());continue}case 3:{if(u!==26)break;i.paragraphs.push(we.decode(r,r.uint32()));continue}case 4:{if(u!==34)break;i.levelsStyles.push(Un.decode(r,r.uint32()));continue}case 5:{if(u!==42)break;i.fill=vn.decode(r,r.uint32());continue}case 6:{if(u!==50)break;i.lines.push(zn.decode(r,r.uint32()));continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{text:_(n.text)?globalThis.String(n.text):"",textStyle:_(n.textStyle)?Sn.fromJSON(n.textStyle):void 0,paragraphs:globalThis.Array.isArray(n?.paragraphs)?n.paragraphs.map(e=>we.fromJSON(e)):[],levelsStyles:globalThis.Array.isArray(n?.levelsStyles)?n.levelsStyles.map(e=>Un.fromJSON(e)):[],fill:_(n.fill)?vn.fromJSON(n.fill):void 0,lines:globalThis.Array.isArray(n?.lines)?n.lines.map(e=>zn.fromJSON(e)):[]}},toJSON(n){const e={};return n.text!==""&&(e.text=n.text),n.textStyle!==void 0&&(e.textStyle=Sn.toJSON(n.textStyle)),n.paragraphs?.length&&(e.paragraphs=n.paragraphs.map(r=>we.toJSON(r))),n.levelsStyles?.length&&(e.levelsStyles=n.levelsStyles.map(r=>Un.toJSON(r))),n.fill!==void 0&&(e.fill=vn.toJSON(n.fill)),n.lines?.length&&(e.lines=n.lines.map(r=>zn.toJSON(r))),e},create(n){return hr.fromPartial(n??{})},fromPartial(n){const e=To();return e.text=n.text??"",e.textStyle=n.textStyle!==void 0&&n.textStyle!==null?Sn.fromPartial(n.textStyle):void 0,e.paragraphs=n.paragraphs?.map(r=>we.fromPartial(r))||[],e.levelsStyles=n.levelsStyles?.map(r=>Un.fromPartial(r))||[],e.fill=n.fill!==void 0&&n.fill!==null?vn.fromPartial(n.fill):void 0,e.lines=n.lines?.map(r=>zn.fromPartial(r))||[],e}};function Io(){return{cells:[],heightEmu:0}}const dr={encode(n,e=new mn){for(const r of n.cells)hr.encode(r,e.uint32(10).fork()).join();return n.heightEmu!==0&&e.uint32(16).int32(n.heightEmu),e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=Io();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 1:{if(u!==10)break;i.cells.push(hr.decode(r,r.uint32()));continue}case 2:{if(u!==16)break;i.heightEmu=r.int32();continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{cells:globalThis.Array.isArray(n?.cells)?n.cells.map(e=>hr.fromJSON(e)):[],heightEmu:_(n.heightEmu)?globalThis.Number(n.heightEmu):0}},toJSON(n){const e={};return n.cells?.length&&(e.cells=n.cells.map(r=>hr.toJSON(r))),n.heightEmu!==0&&(e.heightEmu=Math.round(n.heightEmu)),e},create(n){return dr.fromPartial(n??{})},fromPartial(n){const e=Io();return e.cells=n.cells?.map(r=>hr.fromPartial(r))||[],e.heightEmu=n.heightEmu??0,e}};function Oo(){return{runs:[],textStyle:void 0}}const we={encode(n,e=new mn){for(const r of n.runs)gr.encode(r,e.uint32(10).fork()).join();return n.textStyle!==void 0&&Sn.encode(n.textStyle,e.uint32(18).fork()).join(),e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=Oo();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 1:{if(u!==10)break;i.runs.push(gr.decode(r,r.uint32()));continue}case 2:{if(u!==18)break;i.textStyle=Sn.decode(r,r.uint32());continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{runs:globalThis.Array.isArray(n?.runs)?n.runs.map(e=>gr.fromJSON(e)):[],textStyle:_(n.textStyle)?Sn.fromJSON(n.textStyle):void 0}},toJSON(n){const e={};return n.runs?.length&&(e.runs=n.runs.map(r=>gr.toJSON(r))),n.textStyle!==void 0&&(e.textStyle=Sn.toJSON(n.textStyle)),e},create(n){return we.fromPartial(n??{})},fromPartial(n){const e=Oo();return e.runs=n.runs?.map(r=>gr.fromPartial(r))||[],e.textStyle=n.textStyle!==void 0&&n.textStyle!==null?Sn.fromPartial(n.textStyle):void 0,e}};function So(){return{text:"",textStyle:void 0,hyperlink:void 0}}const gr={encode(n,e=new mn){return n.text!==""&&e.uint32(10).string(n.text),n.textStyle!==void 0&&Sn.encode(n.textStyle,e.uint32(18).fork()).join(),n.hyperlink!==void 0&&ye.encode(n.hyperlink,e.uint32(26).fork()).join(),e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=So();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 1:{if(u!==10)break;i.text=r.string();continue}case 2:{if(u!==18)break;i.textStyle=Sn.decode(r,r.uint32());continue}case 3:{if(u!==26)break;i.hyperlink=ye.decode(r,r.uint32());continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{text:_(n.text)?globalThis.String(n.text):"",textStyle:_(n.textStyle)?Sn.fromJSON(n.textStyle):void 0,hyperlink:_(n.hyperlink)?ye.fromJSON(n.hyperlink):void 0}},toJSON(n){const e={};return n.text!==""&&(e.text=n.text),n.textStyle!==void 0&&(e.textStyle=Sn.toJSON(n.textStyle)),n.hyperlink!==void 0&&(e.hyperlink=ye.toJSON(n.hyperlink)),e},create(n){return gr.fromPartial(n??{})},fromPartial(n){const e=So();return e.text=n.text??"",e.textStyle=n.textStyle!==void 0&&n.textStyle!==null?Sn.fromPartial(n.textStyle):void 0,e.hyperlink=n.hyperlink!==void 0&&n.hyperlink!==null?ye.fromPartial(n.hyperlink):void 0,e}};function ko(){return{uri:"",isExternal:!1,action:""}}const ye={encode(n,e=new mn){return n.uri!==""&&e.uint32(10).string(n.uri),n.isExternal!==!1&&e.uint32(16).bool(n.isExternal),n.action!==""&&e.uint32(26).string(n.action),e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=ko();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 1:{if(u!==10)break;i.uri=r.string();continue}case 2:{if(u!==16)break;i.isExternal=r.bool();continue}case 3:{if(u!==26)break;i.action=r.string();continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{uri:_(n.uri)?globalThis.String(n.uri):"",isExternal:_(n.isExternal)?globalThis.Boolean(n.isExternal):!1,action:_(n.action)?globalThis.String(n.action):""}},toJSON(n){const e={};return n.uri!==""&&(e.uri=n.uri),n.isExternal!==!1&&(e.isExternal=n.isExternal),n.action!==""&&(e.action=n.action),e},create(n){return ye.fromPartial(n??{})},fromPartial(n){const e=ko();return e.uri=n.uri??"",e.isExternal=n.isExternal??!1,e.action=n.action??"",e}};function Mo(){return{effects:[]}}const vr={encode(n,e=new mn){for(const r of n.effects)me.encode(r,e.uint32(10).fork()).join();return e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=Mo();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 1:{if(u!==10)break;i.effects.push(me.decode(r,r.uint32()));continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{effects:globalThis.Array.isArray(n?.effects)?n.effects.map(e=>me.fromJSON(e)):[]}},toJSON(n){const e={};return n.effects?.length&&(e.effects=n.effects.map(r=>me.toJSON(r))),e},create(n){return vr.fromPartial(n??{})},fromPartial(n){const e=Mo();return e.effects=n.effects?.map(r=>me.fromPartial(r))||[],e}};function Co(){return{type:0,shadow:void 0}}const me={encode(n,e=new mn){return n.type!==0&&e.uint32(8).int32(n.type),n.shadow!==void 0&&pr.encode(n.shadow,e.uint32(18).fork()).join(),e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=Co();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 1:{if(u!==8)break;i.type=r.int32();continue}case 2:{if(u!==18)break;i.shadow=pr.decode(r,r.uint32());continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{type:_(n.type)?Uf(n.type):0,shadow:_(n.shadow)?pr.fromJSON(n.shadow):void 0}},toJSON(n){const e={};return n.type!==0&&(e.type=Ff(n.type)),n.shadow!==void 0&&(e.shadow=pr.toJSON(n.shadow)),e},create(n){return me.fromPartial(n??{})},fromPartial(n){const e=Co();return e.type=n.type??0,e.shadow=n.shadow!==void 0&&n.shadow!==null?pr.fromPartial(n.shadow):void 0,e}};function Lo(){return{color:void 0,blurRadius:0,distance:0,direction:0}}const pr={encode(n,e=new mn){return n.color!==void 0&&On.encode(n.color,e.uint32(18).fork()).join(),n.blurRadius!==0&&e.uint32(24).int32(n.blurRadius),n.distance!==0&&e.uint32(32).int32(n.distance),n.direction!==0&&e.uint32(40).int32(n.direction),e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=Lo();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 2:{if(u!==18)break;i.color=On.decode(r,r.uint32());continue}case 3:{if(u!==24)break;i.blurRadius=r.int32();continue}case 4:{if(u!==32)break;i.distance=r.int32();continue}case 5:{if(u!==40)break;i.direction=r.int32();continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{color:_(n.color)?On.fromJSON(n.color):void 0,blurRadius:_(n.blurRadius)?globalThis.Number(n.blurRadius):0,distance:_(n.distance)?globalThis.Number(n.distance):0,direction:_(n.direction)?globalThis.Number(n.direction):0}},toJSON(n){const e={};return n.color!==void 0&&(e.color=On.toJSON(n.color)),n.blurRadius!==0&&(e.blurRadius=Math.round(n.blurRadius)),n.distance!==0&&(e.distance=Math.round(n.distance)),n.direction!==0&&(e.direction=Math.round(n.direction)),e},create(n){return pr.fromPartial(n??{})},fromPartial(n){const e=Lo();return e.color=n.color!==void 0&&n.color!==null?On.fromPartial(n.color):void 0,e.blurRadius=n.blurRadius??0,e.distance=n.distance??0,e.direction=n.direction??0,e}};function Do(){return{geometry:0,fill:void 0,line:void 0}}const Er={encode(n,e=new mn){return n.geometry!==0&&e.uint32(8).int32(n.geometry),n.fill!==void 0&&vn.encode(n.fill,e.uint32(42).fork()).join(),n.line!==void 0&&zn.encode(n.line,e.uint32(50).fork()).join(),e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=Do();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 1:{if(u!==8)break;i.geometry=r.int32();continue}case 5:{if(u!==42)break;i.fill=vn.decode(r,r.uint32());continue}case 6:{if(u!==50)break;i.line=zn.decode(r,r.uint32());continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{geometry:_(n.geometry)?Bf(n.geometry):0,fill:_(n.fill)?vn.fromJSON(n.fill):void 0,line:_(n.line)?zn.fromJSON(n.line):void 0}},toJSON(n){const e={};return n.geometry!==0&&(e.geometry=Jf(n.geometry)),n.fill!==void 0&&(e.fill=vn.toJSON(n.fill)),n.line!==void 0&&(e.line=zn.toJSON(n.line)),e},create(n){return Er.fromPartial(n??{})},fromPartial(n){const e=Do();return e.geometry=n.geometry??0,e.fill=n.fill!==void 0&&n.fill!==null?vn.fromPartial(n.fill):void 0,e.line=n.line!==void 0&&n.line!==null?zn.fromPartial(n.line):void 0,e}};function Po(){return{geometry:"",cropLeft:0,cropTop:0,cropRight:0,cropBottom:0}}const Ae={encode(n,e=new mn){return n.geometry!==""&&e.uint32(10).string(n.geometry),n.cropLeft!==0&&e.uint32(16).uint32(n.cropLeft),n.cropTop!==0&&e.uint32(24).uint32(n.cropTop),n.cropRight!==0&&e.uint32(32).uint32(n.cropRight),n.cropBottom!==0&&e.uint32(40).uint32(n.cropBottom),e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=Po();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 1:{if(u!==10)break;i.geometry=r.string();continue}case 2:{if(u!==16)break;i.cropLeft=r.uint32();continue}case 3:{if(u!==24)break;i.cropTop=r.uint32();continue}case 4:{if(u!==32)break;i.cropRight=r.uint32();continue}case 5:{if(u!==40)break;i.cropBottom=r.uint32();continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{geometry:_(n.geometry)?globalThis.String(n.geometry):"",cropLeft:_(n.cropLeft)?globalThis.Number(n.cropLeft):0,cropTop:_(n.cropTop)?globalThis.Number(n.cropTop):0,cropRight:_(n.cropRight)?globalThis.Number(n.cropRight):0,cropBottom:_(n.cropBottom)?globalThis.Number(n.cropBottom):0}},toJSON(n){const e={};return n.geometry!==""&&(e.geometry=n.geometry),n.cropLeft!==0&&(e.cropLeft=Math.round(n.cropLeft)),n.cropTop!==0&&(e.cropTop=Math.round(n.cropTop)),n.cropRight!==0&&(e.cropRight=Math.round(n.cropRight)),n.cropBottom!==0&&(e.cropBottom=Math.round(n.cropBottom)),e},create(n){return Ae.fromPartial(n??{})},fromPartial(n){const e=Po();return e.geometry=n.geometry??"",e.cropLeft=n.cropLeft??0,e.cropTop=n.cropTop??0,e.cropRight=n.cropRight??0,e.cropBottom=n.cropBottom??0,e}};function xo(){return{contentType:"",data:new Uint8Array(0),mask:void 0,alt:""}}const Nr={encode(n,e=new mn){return n.contentType!==""&&e.uint32(10).string(n.contentType),n.data.length!==0&&e.uint32(18).bytes(n.data),n.mask!==void 0&&Ae.encode(n.mask,e.uint32(26).fork()).join(),n.alt!==""&&e.uint32(34).string(n.alt),e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=xo();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 1:{if(u!==10)break;i.contentType=r.string();continue}case 2:{if(u!==18)break;i.data=r.bytes();continue}case 3:{if(u!==26)break;i.mask=Ae.decode(r,r.uint32());continue}case 4:{if(u!==34)break;i.alt=r.string();continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{contentType:_(n.contentType)?globalThis.String(n.contentType):"",data:_(n.data)?Su(n.data):new Uint8Array(0),mask:_(n.mask)?Ae.fromJSON(n.mask):void 0,alt:_(n.alt)?globalThis.String(n.alt):""}},toJSON(n){const e={};return n.contentType!==""&&(e.contentType=n.contentType),n.data.length!==0&&(e.data=ku(n.data)),n.mask!==void 0&&(e.mask=Ae.toJSON(n.mask)),n.alt!==""&&(e.alt=n.alt),e},create(n){return Nr.fromPartial(n??{})},fromPartial(n){const e=xo();return e.contentType=n.contentType??"",e.data=n.data??new Uint8Array(0),e.mask=n.mask!==void 0&&n.mask!==null?Ae.fromPartial(n.mask):void 0,e.alt=n.alt??"",e}};function Uo(){return{contentType:"",data:new Uint8Array(0),mask:void 0,alt:""}}const wr={encode(n,e=new mn){return n.contentType!==""&&e.uint32(10).string(n.contentType),n.data.length!==0&&e.uint32(18).bytes(n.data),n.mask!==void 0&&Ae.encode(n.mask,e.uint32(26).fork()).join(),n.alt!==""&&e.uint32(34).string(n.alt),e},decode(n,e){const r=n instanceof rn?n:new rn(n);let t=e===void 0?r.len:r.pos+e;const i=Uo();for(;r.pos<t;){const u=r.uint32();switch(u>>>3){case 1:{if(u!==10)break;i.contentType=r.string();continue}case 2:{if(u!==18)break;i.data=r.bytes();continue}case 3:{if(u!==26)break;i.mask=Ae.decode(r,r.uint32());continue}case 4:{if(u!==34)break;i.alt=r.string();continue}}if((u&7)===4||u===0)break;r.skip(u&7)}return i},fromJSON(n){return{contentType:_(n.contentType)?globalThis.String(n.contentType):"",data:_(n.data)?Su(n.data):new Uint8Array(0),mask:_(n.mask)?Ae.fromJSON(n.mask):void 0,alt:_(n.alt)?globalThis.String(n.alt):""}},toJSON(n){const e={};return n.contentType!==""&&(e.contentType=n.contentType),n.data.length!==0&&(e.data=ku(n.data)),n.mask!==void 0&&(e.mask=Ae.toJSON(n.mask)),n.alt!==""&&(e.alt=n.alt),e},create(n){return wr.fromPartial(n??{})},fromPartial(n){const e=Uo();return e.contentType=n.contentType??"",e.data=n.data??new Uint8Array(0),e.mask=n.mask!==void 0&&n.mask!==null?Ae.fromPartial(n.mask):void 0,e.alt=n.alt??"",e}};function Su(n){if(globalThis.Buffer)return Uint8Array.from(globalThis.Buffer.from(n,"base64"));{const e=globalThis.atob(n),r=new Uint8Array(e.length);for(let t=0;t<e.length;++t)r[t]=e.charCodeAt(t);return r}}function ku(n){if(globalThis.Buffer)return globalThis.Buffer.from(n).toString("base64");{const e=[];return n.forEach(r=>{e.push(globalThis.String.fromCharCode(r))}),globalThis.btoa(e.join(""))}}function Fo(n){const e=globalThis.Number(n.toString());if(e>globalThis.Number.MAX_SAFE_INTEGER)throw new globalThis.Error("Value is larger than Number.MAX_SAFE_INTEGER");if(e<globalThis.Number.MIN_SAFE_INTEGER)throw new globalThis.Error("Value is smaller than Number.MIN_SAFE_INTEGER");return e}function _(n){return n!=null}const qf={pptx:Pl,xlsx:Dl},Eg=({fileName:n})=>{if(!n)return null;const e=yu(n),r=e?qf[e]:null;return r?_n.jsx(r,{className:"m-0 size-5"}):null};var xt,Bo;function Hf(){if(Bo)return xt;Bo=1;var n=xl(),e=Ul(),r=e(function(t,i,u,a){n(t,i,u,a)});return xt=r,xt}var $f=Hf();const bf=Vr($f);function Gf(n){switch(n){case"title":case"ctrTitle":return"titleStyle";case"body":case void 0:case"obj":case"content":case"subTitle":case"":return"bodyStyle";default:return"otherStyle"}}const In=1/9525;function Wf(n){return n.xEmu!==0||n.yEmu!==0||n.widthEmu!==0||n.heightEmu!==0}const Mu=(n,...e)=>bf({},n,...e,(r,t)=>r||t);function Xf(n,e,r){const i=Gf(n.placeholderType),u=r.useLayoutId,a=e.layouts.find(g=>g.id===u),h=n.placeholderIndex??0,d=n.textStyle??{anchor:Pr.ANCHOR_UNSET,vertical:Tu.ROTATION_UNSET,bold:!1,italic:!1,color:void 0,fontSize:18,fill:void 0,alignment:ut.ALIGNMENT_UNSET,underline:"none"},f=n.levelsStyles[0]?.textStyle;let o,l,s;const c=a?.elements.find(g=>g.placeholderType===n.placeholderType&&(g.placeholderIndex??0)===h);if(c?.textStyle&&(o=c.textStyle),c?.levelsStyles){const v=c.levelsStyles[0];v&&(l=v.textStyle)}if(a?.parentLayoutId!==u){const g=e.layouts.find(v=>v.type==="master");if(i==="titleStyle"&&g?.titleLevelStyles){const p=g.titleLevelStyles[0];p&&(s=p.textStyle)}else if(i==="bodyStyle"&&g?.bodyLevelStyles){const p=g.bodyLevelStyles[0];p&&(s=p.textStyle)}else if(i==="otherStyle"&&g?.otherLevelStyles){const p=g.otherLevelStyles[0];p&&(s=p.textStyle)}}return Mu(d,f,o,l,s)}function je(n,e,r){return Math.min(Math.max(n,e),r)}function zf(n){const e=n/255;return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Yf(n){return n<=.0031308?n*12.92:1.055*Math.pow(n,1/2.4)-.055}function Zf(n){const e=n.replace("#",""),r=parseInt(e.slice(0,2),16),t=parseInt(e.slice(2,4),16),i=parseInt(e.slice(4,6),16);return{r,g:t,b:i}}function Jo(n,e,r){n/=255,e/=255,r/=255;const t=Math.max(n,e,r),i=Math.min(n,e,r);let u=0,a=0;const h=(t+i)/2;if(t!==i){const d=t-i;switch(a=h>.5?d/(2-t-i):d/(t+i),t){case n:u=(e-r)/d+(e<r?6:0);break;case e:u=(r-n)/d+2;break;case r:u=(n-e)/d+4;break}u/=6}return{h:u,s:a,l:h}}function Vo(n,e,r){let t,i,u;if(e===0)t=i=u=r;else{const a=(f,o,l)=>(l<0&&(l+=1),l>1&&(l-=1),l<.16666666666666666?f+(o-f)*6*l:l<.5?o:l<.6666666666666666?f+(o-f)*(.6666666666666666-l)*6:f),h=r<.5?r*(1+e):r+e-r*e,d=2*r-h;t=a(d,h,n+1/3),i=a(d,h,n),u=a(d,h,n-1/3)}return[Math.round(t*255),Math.round(i*255),Math.round(u*255)]}function Kf(n,e){if(!n)return"rgba(0,0,0,1)";const r=n.type===si.COLOR_RGB?`#${n.value}`:n.type===si.COLOR_SCHEME&&e.colorMap[n.value]||"#000000";let{r:t,g:i,b:u}=Zf(r),a=1;const h=n.transform;if(h){if(h.alpha&&(a=je(h.alpha/1e5,0,1)),h.satMod){const d=Jo(t,i,u);d.s=je(d.s*(h.satMod/1e5),0,1),[t,i,u]=Vo(d.h,d.s,d.l)}if(h.lumMod||h.lumOff){const d=Jo(t,i,u);h.lumMod&&(d.l*=h.lumMod/1e5),h.lumOff&&(d.l+=h.lumOff/1e5),d.l=je(d.l,0,1),[t,i,u]=Vo(d.h,d.s,d.l)}if(h.tint){const d=h.tint/1e5;[t,i,u]=[t,i,u].map(zf),t=t*d+1*(1-d),i=i*d+1*(1-d),u=u*d+1*(1-d),[t,i,u]=[t,i,u].map(f=>Math.round(Yf(f)*255))}h.shade&&(t*=1-h.shade/1e5,i*=1-h.shade/1e5,u*=1-h.shade/1e5)}return t=je(Math.round(t),0,255),i=je(Math.round(i),0,255),u=je(Math.round(u),0,255),`rgba(${t},${i},${u},${a})`}function xr(n,e){return n?Kf(n,e):"transparent"}function qr(n,e,r){const t=r.useLayoutId;if(n.bbox&&Wf(n.bbox)&&e){const{xEmu:i,yEmu:u,widthEmu:a,heightEmu:h}=n.bbox;return{x:(i??0)*In,y:(u??0)*In,width:(a??0)*In,height:(h??0)*In}}if(n.placeholderIndex!==void 0){const i=n.placeholderIndex??0,u=e.layouts.find(h=>h.id===t),a=u?.elements.find(h=>(h.placeholderIndex??0)===i);if(a?.bbox){const{xEmu:h,yEmu:d,widthEmu:f,heightEmu:o}=a.bbox;return{x:(h??0)*In,y:(d??0)*In,width:(f??0)*In,height:(o??0)*In}}if(u?.parentLayoutId!==t){const d=e.layouts.find(f=>f.type==="master")?.elements.find(f=>(f.placeholderIndex??0)===i);if(d?.bbox){const{xEmu:f,yEmu:o,widthEmu:l,heightEmu:s}=d.bbox;return{x:(f??0)*In,y:(o??0)*In,width:(l??0)*In,height:(s??0)*In}}}}return{x:0,y:0,width:0,height:0}}const Kr=18,Ut=1.33,qo=.1*96,Ho=.05*96;function Cu(n){return n/100*(96/72)}function Lu(n,e,r,t,i,u){if(!n.paragraphs)return;let{x:a,y:h,width:d,height:f}=qr(n,r,i);a+=qo,h+=Ho,d-=qo*2,f-=Ho*2;const o=Xf(n,r,i);function l(p,N,w,E,y,R){N.length!==0&&(p.push({segments:N.slice(),widthPx:w,heightPx:E,align:y,maxPx:R}),N.length=0)}const s=[];for(const p of n.paragraphs){const N=p.textStyle,w=[];let E=0,y="left",R=0;for(const S of p.runs){const T=Mu({},S.textStyle,N,o),M=T?.fontSize?Cu(T.fontSize):Kr*(96/72),G=`${T?.bold?"bold ":""}${T?.italic?"italic ":""}${M}px Calibri, Carlito, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif`;e.font=G;const nn=xr(T?.fill?.color,t);y=T?.alignment===ut.CENTER?"center":T?.alignment===ut.RIGHT?"right":"left",R=Math.max(R,M);const X=S.text.split(`
`);for(let Q=0;Q<X.length;Q++){const Nn=X[Q].split(/\s+/);for(let yn=0;yn<Nn.length;yn++){const cn=Nn[yn];if(!cn)continue;let ln=cn;e.font=G;let kn=e.measureText(ln).width;if(E+kn>d&&w.length){const Dn=R||Kr*1.3333333333333333;l(s,w,E,Dn*Ut,y,Dn),E=0,R=0}else w.length&&(ln=" "+cn,kn=e.measureText(ln).width);w.push({text:ln,widthPx:kn,font:G,fill:nn,px:M,run:S}),E+=kn,R=Math.max(R,M)}if(Q<X.length-1){const yn=R||Kr*1.3333333333333333;l(s,w,E,yn*Ut,y,yn),E=0,R=0}}}const I=R||Kr*(96/72);l(s,w,E,I*Ut,y,I)}if(!s.length)return;const c=o?.anchor??Pr.TOP,g=s.reduce((p,N)=>p+N.heightPx,0);let v=c===Pr.BOTTOM?h+(f-g):c===Pr.MIDDLE?h+(f-g)/2:h;v=Math.max(v,h),e.textBaseline="top";for(const p of s){let N=p.align==="center"?a+(d-p.widthPx)/2:p.align==="right"?a+d-p.widthPx:a;for(const w of p.segments){e.font=w.font,e.fillStyle=w.fill;const E=p.maxPx-w.px;u&&w.run?.hyperlink?.uri&&u.push({x:N,y:v+(p.maxPx-w.px),width:w.widthPx,height:w.px,url:w.run.hyperlink.uri}),e.fillText(w.text,N,v+E),N+=w.widthPx}v+=p.heightPx}}function Du(n){for(var e=n.length/6|0,r=new Array(e),t=0;t<e;)r[t]="#"+n.slice(t*6,++t*6);return r}const Qf=Du("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),_f=Du("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab");function Pu(n,e,r){if(n.measureText(e).width<=r)return e;const t="";let i=0,u=e.length;for(;i<u;){const a=Math.ceil((i+u)/2);n.measureText(e.slice(0,a)+t).width<=r?i=a:u=a-1}return e.slice(0,i)+t}const Be="Segoe UI, Helvetica, Arial, sans-serif",xu=10,jf=11,Ue=10,Ur="#666",Ve=_f,Uu=.6,Ge={top:32,right:16,bottom:40,left:48},$o=16,ns=$l({decimal:".",thousands:",",grouping:[3],currency:["","$"],percent:" %"});function es(n,e,r,t){const i=qr(n,r,t),u=as(n.chartReference,r);u&&Fu(e,u,i)}function rs(n,e,r,t={}){Fu(n,e,r,t)}function ts(n){return{x:n.x+Ge.left,y:n.y+Ge.top,width:n.width-Ge.left-Ge.right,height:n.height-Ge.top-Ge.bottom}}function Fu(n,e,r,t={}){n.save(),e.title&&e.title.trim()&&(n.font=`bold ${$o}px ${Be}`,n.fillStyle=Ur,n.textAlign="center",n.textBaseline="top",n.fillText(e.title.trim(),r.x+r.width/2,r.y+(Ge.top-$o)/2));let i=ts(r);if((e.type===Yn.BAR||e.type===Yn.BAR_3D)&&e.barDirection===Iu.BAR_DIRECTION_BAR){const h=e.categories.length>0?e.categories:e.series[0]?.categories??[];i=vs(n,i,h,e.yAxis);const d=hs(e,i);gs(n,e,d,i),t.skipLegend||bo(n,e,r),ds(n,e,d),n.restore();return}const a=is(e,i);switch(os(e.type)||us(n,e,a,i),t.skipLegend||bo(n,e,r),e.type){case Yn.BAR:case Yn.BAR_3D:ls(n,e,a);break;case Yn.LINE:case Yn.LINE_3D:fs(n,e,a);break;case Yn.AREA:case Yn.AREA_3D:ss(n,e,a);break;case Yn.PIE:case Yn.PIE_3D:case Yn.DOUGHNUT:cs(n,e,i);break}n.restore()}function Ei(n){return typeof n.bandwidth=="function"}function is(n,e){const r=n.categories.length>0?n.categories:n.series[0]?.categories??[],t=n.series.flatMap(f=>f.values),i=wu(t),[u,a]=i[0]===void 0?[0,0]:i,h=n.type===Yn.LINE||n.type===Yn.LINE_3D?bl().domain(r).range([e.x,e.x+e.width]).padding(.5):vt().domain(r).range([e.x,e.x+e.width]).paddingInner(Uu),d=Eu().domain([Math.min(0,u),a]).nice().range([e.y+e.height,e.y]);return{x:h,y:d}}function Ar(n,e){if(Ei(n)){const r=n(e);return r!==void 0?r+n.bandwidth()/2:void 0}return n(e)}function os(n){return n===Yn.PIE||n===Yn.PIE_3D||n===Yn.DOUGHNUT}function us(n,e,r,t){const{x:i,y:u}=r,a=e.categories.length>0?e.categories:e.series[0]?.categories??[];n.save(),n.font=`${xu}px ${Be}`,n.fillStyle=Ur,n.strokeStyle=Ur,n.lineWidth=1;const{color:h,fontSize:d}=Fr(e.xAxis),f=u(0);n.beginPath(),n.moveTo(t.x,f),n.lineTo(t.x+t.width,f),n.stroke(),n.strokeStyle=h,n.lineWidth=1,n.font=`${d}px ${Be}`,n.textAlign="center",n.textBaseline="top",n.fillStyle=h,a.forEach(s=>{const c=Ar(i,s);if(c===void 0)return;n.beginPath(),n.moveTo(c,f),n.lineTo(c,f+4),n.stroke();const g=Ei(i)?i.step():t.width/Math.max(1,a.length);n.fillText(Pu(n,s,g),c,f+6)});const{color:o,fontSize:l}=Fr(e.yAxis);n.textAlign="right",n.textBaseline="middle",n.fillStyle=o,u.ticks(5).forEach(s=>{const c=u(s);n.strokeStyle=o,n.beginPath(),n.moveTo(t.x,c),n.lineTo(t.x+t.width,c),n.stroke(),n.strokeStyle=o,n.beginPath(),n.moveTo(t.x-4,c),n.lineTo(t.x,c),n.stroke(),n.font=`${l}px ${Be}`,n.fillText(Gl("~s")(s),t.x-6,c)}),n.restore()}function bo(n,e,r){if(e.series.length===0)return;n.save(),n.font=`${jf}px ${Be}`;const t=e.series.map(o=>o.name||"Series"),i=t.map(o=>n.measureText(o).width),u=Math.max(...i,0),a=Ue+6+u+16,h=t.length*(Ue+4)+16-4,d=r.x+r.width-a,f=r.y+8;n.fillStyle="transparent",n.strokeStyle="transparent",n.lineWidth=1,n.beginPath(),n.rect(d,f,a,h),n.fill(),n.stroke(),e.series.forEach((o,l)=>{const s=o.name||"Series",c=f+8+l*(Ue+4)+Ue/2;n.fillStyle=Ni(o,l),n.beginPath(),n.rect(d+8,c-Ue/2,Ue,Ue),n.fill(),n.strokeStyle="#000",n.stroke(),n.fillStyle=Ur,n.textAlign="left",n.textBaseline="middle",n.fillText(s,d+8+Ue+6,c)}),n.restore()}function Ni(n,e){return n.fill?.color?.value?`#${n.fill.color.value}`:Ve[e%Ve.length]}function Fr(n){const e=n?.line?.fill?.color?.value?`#${n.line.fill.color.value}`:Ur,r=n?.textStyle?.fontSize?Cu(n.textStyle.fontSize):xu;return{color:e,fontSize:r}}function ls(n,e,r){if(!Ei(r.x))return;const t=r.x,i=r.y,u=e.categories.length>0?e.categories:e.series[0]?.categories??[],a=e.series.length,h=vt().domain(Nu(a)).range([0,t.bandwidth()]).padding(.05);u.forEach((d,f)=>{const o=t(d);o!==void 0&&e.series.forEach((l,s)=>{const c=l.values[f]??0,g=o+(h(s)??0),v=i(Math.max(0,c)),p=Math.abs(i(c)-i(0)),N=Ni(l,s);n.fillStyle=N,n.beginPath(),n.rect(g,v,h.bandwidth(),p),n.fill()})})}function fs(n,e,r){const t=r.x,i=r.y,u=e.categories.length>0?e.categories:e.series[0]?.categories??[];e.series.forEach((a,h)=>{n.strokeStyle=Ve[h%Ve.length],n.lineWidth=2,n.beginPath(),a.values.forEach((d,f)=>{const o=Ar(t,u[f]),l=i(d);o!==void 0&&(f===0?n.moveTo(o,l):n.lineTo(o,l))}),n.stroke(),n.fillStyle=n.strokeStyle,a.values.forEach((d,f)=>{const o=Ar(t,u[f]),l=i(d);o!==void 0&&(n.beginPath(),n.arc(o,l,3,0,Math.PI*2),n.fill())})})}function ss(n,e,r){const t=r.x,i=r.y,u=e.categories.length>0?e.categories:e.series[0]?.categories??[];e.series.forEach((a,h)=>{const d=Ve[h%Ve.length],f=(()=>{const s=Wl(d);return s?(s.opacity=.35,s.formatRgb()):d})();n.fillStyle=f,n.strokeStyle=d,n.lineWidth=1,n.beginPath(),a.values.forEach((s,c)=>{const g=Ar(t,u[c]),v=i(s);g!==void 0&&(c===0?n.moveTo(g,v):n.lineTo(g,v))});const o=Ar(t,u[u.length-1]),l=Ar(t,u[0]);o===void 0||l===void 0||(n.lineTo(o,i(0)),n.lineTo(l,i(0)),n.closePath(),n.fill(),n.stroke())})}function cs(n,e,r){const t=e.series[0];if(!t)return;const i=t.values;if(tf(i)===0)return;const a=r.x+r.width/2,h=r.y+r.height/2,d=Math.min(r.width,r.height)/2,f=jl().innerRadius(e.type===Yn.DOUGHNUT?d*.55:0).outerRadius(d).context(n),o=rf().sort(null);n.save(),n.translate(a,h),o(i).forEach((l,s)=>{n.fillStyle=Ve[s%Ve.length],n.beginPath(),f(l),n.fill(),n.strokeStyle="#fff",n.lineWidth=1,n.stroke()}),n.restore()}function as(n,e){const r=n?.id;return r?e.charts.find(t=>t.id===r)??null:null}function hs(n,e){const r=n.categories.length>0?n.categories:n.series[0]?.categories??[],[t,i]=wu(n.series.flatMap(l=>l.values)),u=n.yAxis?.min,a=n.yAxis?.max,h=u!==void 0?u:Math.min(0,t),d=a!==void 0?a:i,f=Eu().domain([h,d]).range([e.x,e.x+e.width]);(u===void 0||a===void 0)&&f.nice();const o=vt().domain([...r].reverse()).range([e.y,e.y+e.height]).paddingInner(Uu);return{x:f,y:o}}function ds(n,e,r){const{x:t,y:i}=r,[u,a]=t.domain(),h=u>0?u:a<0?a:0,d=e.categories.length?e.categories:e.series[0]?.categories??[],f=e.series.length,o=vt().domain(Nu(f)).range([0,i.bandwidth()]).padding(.05);d.forEach((l,s)=>{const c=i(l);c!==void 0&&e.series.forEach((g,v)=>{const p=g.values[s]??0,N=c+(o(v)??0),w=t(Math.min(h,p)),E=t(Math.max(h,p)),y=Math.abs(E-w);n.fillStyle=Ni(g,v),n.fillRect(w,N,y,o.bandwidth())})})}function gs(n,e,r,t,i=!0){const{x:u,y:a}=r,h=e.categories.length>0?e.categories:e.series[0]?.categories??[];n.save(),n.lineWidth=1;const{color:d,fontSize:f}=Fr(e.yAxis);n.font=`${f}px ${Be}`,n.fillStyle=d,n.strokeStyle=d,n.textAlign="right",n.textBaseline="middle";const o=Math.min(140,Math.max(0,t.x-10));h.forEach(v=>{const p=(a(v)??0)+a.bandwidth()/2;n.beginPath(),n.moveTo(t.x-4,p),n.lineTo(t.x,p),n.stroke();const N=Pu(n,v,o);n.fillText(N,t.x-6,p)});const{color:l,fontSize:s}=Fr(e.xAxis);n.font=`${s}px ${Be}`,n.fillStyle=l,n.strokeStyle=l,n.textAlign="center",n.textBaseline="top";const c=t.y+t.height;n.beginPath(),n.moveTo(t.x,c),n.lineTo(t.x+t.width,c),n.stroke();const g=ns.format(".2~f");u.ticks(5).forEach(v=>{const p=u(v);n.beginPath(),n.moveTo(p,c),n.lineTo(p,c+4),n.stroke(),i&&(n.save(),n.beginPath(),n.moveTo(p,t.y),n.lineTo(p,c),n.stroke(),n.restore()),n.fillText(g(v),p,c+6)}),n.restore()}function vs(n,e,r,t,i=180,u=100){const{fontSize:a}=Fr(t);n.save(),n.font=`${a}px ${Be}`;const h=Math.max(...r.map(o=>n.measureText(o).width));n.restore();const d=Math.min(i,h+u);if(d<=e.x)return e;const f=d-e.x;return{x:e.x+f,y:e.y,width:Math.max(0,e.width-f),height:e.height}}function ps(n,e,r,t,i){if(!n.table||!n.bbox)return;const u=n.table.columnWidths.reduce((c,g)=>c+g,0),a=n.table.rows.reduce((c,g)=>c+(g.heightEmu>0?g.heightEmu:0),0),h=n.table.rows.filter(c=>c.heightEmu===0).length,d=h>0?Math.max((n.bbox.heightEmu-a)/h,1):0,f=a+h*d;if(u===0||f===0)return;const o=n.bbox.widthEmu/u,l=n.bbox.heightEmu/f;let s=n.bbox.yEmu;for(const c of n.table.rows){const v=(c.heightEmu===0?d:c.heightEmu)*l;let p=n.bbox.xEmu;for(let N=0;N<c.cells.length;N++){const w=c.cells[N],E=n.table.columnWidths[N]*o,y={bbox:{xEmu:p,yEmu:s,widthEmu:E,heightEmu:v},paragraphs:w.paragraphs,textStyle:w.textStyle,levelsStyles:w.levelsStyles},R=w.fill,I=R?.color?.value?`#${R.color.value}`:"transparent";e.fillStyle=I,e.fillRect(p*In,s*In,E*In,v*In),Lu(y,e,r,t,i),e.strokeStyle="#cccccc",e.strokeRect(p*In,s*In,E*In,v*In),p+=E}s+=v}}const Ft=new Map;let Qr=null;function Es(n,e,r,t){if(/\bwidth\s*=|\bheight\s*=/.test(n))return new Blob([n],{type:"image/svg+xml"});const i=n.replace(/<svg\b([^>]*)>/,`<svg$1 width="${r}" height="${t}">`);return new Blob([i],{type:"image/svg+xml"})}async function Bu(n){if(!n.image)throw new Error("no image on element");const e=`${n.image.data.byteLength}_${n.image.contentType}`,r=Ft.get(e);if(!r)if(n.image.contentType==="image/svg+xml"){const t=Math.round((n.bbox?.widthEmu??1)*In),i=Math.round((n.bbox?.heightEmu??1)*In),u=window.devicePixelRatio||1,a=Es(new TextDecoder().decode(n.image.data),n.image.contentType,t,i),h=URL.createObjectURL(a),d=new Image;d.src=h,await d.decode();const f=createImageBitmap(d,{resizeWidth:t*u,resizeHeight:i*u});return URL.revokeObjectURL(h),Ft.set(e,f),f}else{const t=new Blob([n.image.data],{type:n.image.contentType}),i=createImageBitmap(t);return Ft.set(e,i),i}return r}async function Ns(n,e,r,t){if(!n.image)return;const{x:i,y:u,width:a,height:h}=qr(n,r,t),d=await Bu(n);if(!d)return;let f=0,o=0,l=d.width,s=d.height;const c=n.image.mask;if(c){const g=N=>N/1e5,v=d.width,p=d.height;f+=g(c.cropLeft)*v,o+=g(c.cropTop)*p,l-=(g(c.cropLeft)+g(c.cropRight))*v,s-=(g(c.cropTop)+g(c.cropBottom))*p}e.drawImage(d,f,o,l,s,i,u,a,h)}function ws(n){if(Qr)return Qr;if(!n)return{colorMap:{},lineStyleMap:{},effectMap:{}};const e={};if(n.colorScheme){for(const i of n.colorScheme.colors)i.color&&(e[i.name]=i.color.lastColor?`#${i.color.lastColor}`:`#${i.color.value}`);e.bg1=e.lt1,e.bg2=e.lt2}const r={};for(const[i,u]of n.lineStyleList.entries())r[i+1]=u;const t={};for(const[i,u]of n.effectStyleList.entries())t[i+1]=u;return Qr={colorMap:e,lineStyleMap:r,effectMap:t},Qr}function ys(n,e,r){let t=n.background;if(t?.fill?.color)return xr(t.fill.color,r);if(t||(t=e.layouts.find(i=>i.id===n.useLayoutId)?.background),t?.ref?.index){const i=t.ref.index-1001,a=e.theme?.backgroundFillStyleList[i]?.color;if(a){const h={...a,value:t.ref.schemeColor};return xr(h,r)}}return r.colorMap.bg1}async function Ju(n,e,r,t){const i=ws(e.theme),u=n.widthEmu*In,a=n.heightEmu*In;r.save();const h=ys(n,e,i);r.fillStyle=h??"transparent",r.fillRect(0,0,u,a);const d=[...n.elements].sort((f,o)=>f.zIndex-o.zIndex);await Promise.all(d.filter(f=>f.image).map(f=>Bu(f)));for(const f of d)if(f.image&&await Ns(f,r,e,n),f.type===ci.CHART_REFERENCE&&es(f,r,e,n),f.type===ci.TABLE&&ps(f,r,e,i,n),f.shape&&ms(f,r,e,n,i),f.paragraphs&&f.paragraphs.length>0&&Lu(f,r,e,i,n,t),t&&f.hyperlink){const{x:o,y:l,width:s,height:c}=qr(f,e,n);t.push({x:o,y:l,width:s,height:c,url:f.hyperlink.uri,action:f.hyperlink.action})}r.restore()}function ms(n,e,r,t,i){if(!n.shape)return;const{fill:u,line:a,geometry:h}=n.shape,{x:d,y:f,width:o,height:l}=qr(n,r,t);let s=a?.widthEmu?a.widthEmu*In:0;if(e.save(),e.fillStyle=xr(u?.color,i)??"transparent",n.lineReference){const c=i.lineStyleMap[n.lineReference.index];e.strokeStyle="solid",s||=c?.widthEmu?c.widthEmu*In:s}switch(n.effectReference&&i.effectMap[n.effectReference.index].effects.forEach(g=>{if(g.type===Ou.OUTER_SHADOW){const v=g.shadow?.color?xr(g.shadow.color,i):"transparent";e.shadowColor=v??"transparent",e.shadowBlur=g.shadow?.blurRadius?g.shadow.blurRadius*In:0,e.shadowOffsetX=g.shadow?.distance?g.shadow.distance*In:0,e.shadowOffsetY=g.shadow?.distance?g.shadow.distance*In:0}}),e.beginPath(),h){case tt.RECTANGLE:case tt.ROUND_RECT:{l===0?(e.moveTo(d,f),e.lineTo(d+o,f)):o===0?(e.moveTo(d,f),e.lineTo(d,f+l)):e.rect(d,f,o,l);break}case tt.ELLIPSE:{const c=o/2,g=l/2;e.ellipse(d+c,f+g,c,g,0,0,Math.PI*2);break}default:e.restore();return}e.fill(),e.restore(),e.strokeStyle=s&&a?.fill?.color?.value?`#${a.fill.color.value}`:"transparent",e.lineWidth=s,s&&e.stroke(),e.restore()}function Ng({startIndex:n,walnutId:e,onExit:r}){const{presentationMap:t}=pu(),i=t[e],{presentation:u}=i,[a,h]=Mn.useState(n),d=Mn.useRef(null),f=Mn.useRef(null);Mn.useEffect(()=>{const g=f.current;if(!g)return;g.requestFullscreen?.().catch(p=>{mr.addError(p)});const v=()=>{document.fullscreenElement||r()};return document.addEventListener("fullscreenchange",v),()=>{document.removeEventListener("fullscreenchange",v),document.fullscreenElement&&document.exitFullscreen().catch(p=>{mr.addError(p)})}},[r]);const o=u?u.slides[a]:void 0;Mn.useEffect(()=>{if(!u||!o||!d.current)return;const g=d.current.getContext("2d");if(!g)return;const v=o.widthEmu*In,p=o.heightEmu*In,N=window.devicePixelRatio||1;d.current.width=v*N,d.current.height=p*N,g.resetTransform(),g.scale(N,N),Ju(o,u,g)},[o,u]);const l=Mn.useCallback(()=>{u&&h(g=>Math.min(g+1,u.slides.length-1))},[u]),s=Mn.useCallback(()=>h(g=>Math.max(g-1,0)),[]),c=Mn.useCallback(g=>{switch(g.key){case"ArrowRight":case"ArrowDown":case" ":case"Enter":l();break;case"ArrowLeft":case"ArrowUp":s();break;case"Escape":document.fullscreenElement?document.exitFullscreen().catch(v=>{mr.addError(v)}):r();break}},[l,s,r]);return Mn.useEffect(()=>(window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)),[c]),_n.jsx("div",{ref:f,className:"fixed inset-0 flex items-center justify-center p-6",onClick:l,children:_n.jsx("canvas",{ref:d,className:"max-h-full max-w-full bg-white"})})}const wi=80,yi=15,ce=40,ae=20;function Vu(n){return n==null||n===0?wi:Math.round(n*7)}function lt(n){const e=n==null||n===0?yi:n;return Math.round(e*96/72)}function ai(n){let e="";for(n+=1;n;){const r=(n-1)%26;e=String.fromCharCode(65+r)+e,n=Math.floor((n-r)/26)}return e}function hi(n){const e=n.match(/[A-Z]+/);if(!e)return 0;let r=0;for(const t of e[0])r=r*26+(t.charCodeAt(0)-64);return r-1}function As(n){const e=n.match(/\d+/);return e?parseInt(e[0],10)-1:0}function nr(n){const e=n.replace(/^0x/i,"");if(e.length===8){const t=parseInt(e.slice(2,4),16),i=parseInt(e.slice(4,6),16),u=parseInt(e.slice(6,8),16);return`rgba(${t}, ${i}, ${u}, ${1 .toFixed(3)})`}return e.length===6?`#${e}`:"#ffffff"}var it={exports:{}},Rs=it.exports,Go;function Ts(){return Go||(Go=1,function(n,e){(function(r,t){n.exports=t()})(Rs,function(){var r=function(t,i){var u=Array.prototype.concat,a=Array.prototype.slice,h=Object.prototype.toString;function d(w,E){var y=w>E?w:E;return t.pow(10,17-~~(t.log(y>0?y:-y)*t.LOG10E))}var f=Array.isArray||function(E){return h.call(E)==="[object Array]"};function o(w){return h.call(w)==="[object Function]"}function l(w){return typeof w=="number"?w-w===0:!1}function s(w){return u.apply([],w)}function c(){return new c._init(arguments)}c.fn=c.prototype,c._init=function(E){if(f(E[0]))if(f(E[0][0])){o(E[1])&&(E[0]=c.map(E[0],E[1]));for(var y=0;y<E[0].length;y++)this[y]=E[0][y];this.length=E[0].length}else this[0]=o(E[1])?c.map(E[0],E[1]):E[0],this.length=1;else if(l(E[0]))this[0]=c.seq.apply(null,E),this.length=1;else{if(E[0]instanceof c)return c(E[0].toArray());this[0]=[],this.length=1}return this},c._init.prototype=c.prototype,c._init.constructor=c,c.utils={calcRdx:d,isArray:f,isFunction:o,isNumber:l,toVector:s},c._random_fn=t.random,c.setRandom=function(E){if(typeof E!="function")throw new TypeError("fn is not a function");c._random_fn=E},c.extend=function(E){var y,R;if(arguments.length===1){for(R in E)c[R]=E[R];return this}for(y=1;y<arguments.length;y++)for(R in arguments[y])E[R]=arguments[y][R];return E},c.rows=function(E){return E.length||1},c.cols=function(E){return E[0].length||1},c.dimensions=function(E){return{rows:c.rows(E),cols:c.cols(E)}},c.row=function(E,y){return f(y)?y.map(function(R){return c.row(E,R)}):E[y]},c.rowa=function(E,y){return c.row(E,y)},c.col=function(E,y){if(f(y)){var R=c.arange(E.length).map(function(){return new Array(y.length)});return y.forEach(function(T,M){c.arange(E.length).forEach(function(V){R[V][M]=E[V][T]})}),R}for(var I=new Array(E.length),S=0;S<E.length;S++)I[S]=[E[S][y]];return I},c.cola=function(E,y){return c.col(E,y).map(function(R){return R[0]})},c.diag=function(E){for(var y=c.rows(E),R=new Array(y),I=0;I<y;I++)R[I]=[E[I][I]];return R},c.antidiag=function(E){for(var y=c.rows(E)-1,R=new Array(y),I=0;y>=0;y--,I++)R[I]=[E[I][y]];return R},c.transpose=function(E){var y=[],R,I,S,T,M;for(f(E[0])||(E=[E]),I=E.length,S=E[0].length,M=0;M<S;M++){for(R=new Array(I),T=0;T<I;T++)R[T]=E[T][M];y.push(R)}return y.length===1?y[0]:y},c.map=function(E,y,R){var I,S,T,M,V;for(f(E[0])||(E=[E]),S=E.length,T=E[0].length,M=R?E:new Array(S),I=0;I<S;I++)for(M[I]||(M[I]=new Array(T)),V=0;V<T;V++)M[I][V]=y(E[I][V],I,V);return M.length===1?M[0]:M},c.cumreduce=function(E,y,R){var I,S,T,M,V;for(f(E[0])||(E=[E]),S=E.length,T=E[0].length,M=R?E:new Array(S),I=0;I<S;I++)for(M[I]||(M[I]=new Array(T)),T>0&&(M[I][0]=E[I][0]),V=1;V<T;V++)M[I][V]=y(M[I][V-1],E[I][V]);return M.length===1?M[0]:M},c.alter=function(E,y){return c.map(E,y,!0)},c.create=function(E,y,R){var I=new Array(E),S,T;for(o(y)&&(R=y,y=E),S=0;S<E;S++)for(I[S]=new Array(y),T=0;T<y;T++)I[S][T]=R(S,T);return I};function g(){return 0}c.zeros=function(E,y){return l(y)||(y=E),c.create(E,y,g)};function v(){return 1}c.ones=function(E,y){return l(y)||(y=E),c.create(E,y,v)},c.rand=function(E,y){return l(y)||(y=E),c.create(E,y,c._random_fn)};function p(w,E){return w===E?1:0}c.identity=function(E,y){return l(y)||(y=E),c.create(E,y,p)},c.symmetric=function(E){var y=E.length,R,I;if(E.length!==E[0].length)return!1;for(R=0;R<y;R++)for(I=0;I<y;I++)if(E[I][R]!==E[R][I])return!1;return!0},c.clear=function(E){return c.alter(E,g)},c.seq=function(E,y,R,I){o(I)||(I=!1);var S=[],T=d(E,y),M=(y*T-E*T)/((R-1)*T),V=E,G;for(G=0;V<=y&&G<R;G++,V=(E*T+M*T*G)/T)S.push(I?I(V,G):V);return S},c.arange=function(E,y,R){var I=[],S;if(R=R||1,y===i&&(y=E,E=0),E===y||R===0)return[];if(E<y&&R<0)return[];if(E>y&&R>0)return[];if(R>0)for(S=E;S<y;S+=R)I.push(S);else for(S=E;S>y;S+=R)I.push(S);return I},c.slice=function(){function w(y,R,I,S){var T,M=[],V=y.length;if(R===i&&I===i&&S===i)return c.copy(y);if(R=R||0,I=I||y.length,R=R>=0?R:V+R,I=I>=0?I:V+I,S=S||1,R===I||S===0)return[];if(R<I&&S<0)return[];if(R>I&&S>0)return[];if(S>0)for(T=R;T<I;T+=S)M.push(y[T]);else for(T=R;T>I;T+=S)M.push(y[T]);return M}function E(y,R){var I,S;if(R=R||{},l(R.row)){if(l(R.col))return y[R.row][R.col];var T=c.rowa(y,R.row);return I=R.col||{},w(T,I.start,I.end,I.step)}if(l(R.col)){var M=c.cola(y,R.col);return S=R.row||{},w(M,S.start,S.end,S.step)}S=R.row||{},I=R.col||{};var V=w(y,S.start,S.end,S.step);return V.map(function(G){return w(G,I.start,I.end,I.step)})}return E}(),c.sliceAssign=function(E,y,R){var I,S;if(l(y.row)){if(l(y.col))return E[y.row][y.col]=R;y.col=y.col||{},y.col.start=y.col.start||0,y.col.end=y.col.end||E[0].length,y.col.step=y.col.step||1,I=c.arange(y.col.start,t.min(E.length,y.col.end),y.col.step);var T=y.row;return I.forEach(function(V,G){E[T][V]=R[G]}),E}if(l(y.col)){y.row=y.row||{},y.row.start=y.row.start||0,y.row.end=y.row.end||E.length,y.row.step=y.row.step||1,S=c.arange(y.row.start,t.min(E[0].length,y.row.end),y.row.step);var M=y.col;return S.forEach(function(V,G){E[V][M]=R[G]}),E}return R[0].length===i&&(R=[R]),y.row.start=y.row.start||0,y.row.end=y.row.end||E.length,y.row.step=y.row.step||1,y.col.start=y.col.start||0,y.col.end=y.col.end||E[0].length,y.col.step=y.col.step||1,S=c.arange(y.row.start,t.min(E.length,y.row.end),y.row.step),I=c.arange(y.col.start,t.min(E[0].length,y.col.end),y.col.step),S.forEach(function(V,G){I.forEach(function(nn,X){E[V][nn]=R[G][X]})}),E},c.diagonal=function(E){var y=c.zeros(E.length,E.length);return E.forEach(function(R,I){y[I][I]=R}),y},c.copy=function(E){return E.map(function(y){return l(y)?y:y.map(function(R){return R})})};var N=c.prototype;return N.length=0,N.push=Array.prototype.push,N.sort=Array.prototype.sort,N.splice=Array.prototype.splice,N.slice=Array.prototype.slice,N.toArray=function(){return this.length>1?a.call(this):a.call(this)[0]},N.map=function(E,y){return c(c.map(this,E,y))},N.cumreduce=function(E,y){return c(c.cumreduce(this,E,y))},N.alter=function(E){return c.alter(this,E),this},function(w){for(var E=0;E<w.length;E++)(function(y){N[y]=function(R){var I=this,S;return R?(setTimeout(function(){R.call(I,N[y].call(I))}),this):(S=c[y](this),f(S)?c(S):S)}})(w[E])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(w){for(var E=0;E<w.length;E++)(function(y){N[y]=function(R,I){var S=this;return I?(setTimeout(function(){I.call(S,N[y].call(S,R))}),this):c(c[y](this,R))}})(w[E])}("row col".split(" ")),function(w){for(var E=0;E<w.length;E++)(function(y){N[y]=function(){return c(c[y].apply(null,arguments))}})(w[E])}("create zeros ones rand identity".split(" ")),c}(Math);return function(t,i){var u=t.utils.isFunction;function a(f,o){return f-o}function h(f,o,l){return i.max(o,i.min(f,l))}t.sum=function(o){for(var l=0,s=o.length;--s>=0;)l+=o[s];return l},t.sumsqrd=function(o){for(var l=0,s=o.length;--s>=0;)l+=o[s]*o[s];return l},t.sumsqerr=function(o){for(var l=t.mean(o),s=0,c=o.length,g;--c>=0;)g=o[c]-l,s+=g*g;return s},t.sumrow=function(o){for(var l=0,s=o.length;--s>=0;)l+=o[s];return l},t.product=function(o){for(var l=1,s=o.length;--s>=0;)l*=o[s];return l},t.min=function(o){for(var l=o[0],s=0;++s<o.length;)o[s]<l&&(l=o[s]);return l},t.max=function(o){for(var l=o[0],s=0;++s<o.length;)o[s]>l&&(l=o[s]);return l},t.unique=function(o){for(var l={},s=[],c=0;c<o.length;c++)l[o[c]]||(l[o[c]]=!0,s.push(o[c]));return s},t.mean=function(o){return t.sum(o)/o.length},t.meansqerr=function(o){return t.sumsqerr(o)/o.length},t.geomean=function(o){var l=o.map(i.log),s=t.mean(l);return i.exp(s)},t.median=function(o){var l=o.length,s=o.slice().sort(a);return l&1?s[l/2|0]:(s[l/2-1]+s[l/2])/2},t.cumsum=function(o){return t.cumreduce(o,function(l,s){return l+s})},t.cumprod=function(o){return t.cumreduce(o,function(l,s){return l*s})},t.diff=function(o){var l=[],s=o.length,c;for(c=1;c<s;c++)l.push(o[c]-o[c-1]);return l},t.rank=function(f){var o,l=[],s={};for(o=0;o<f.length;o++){var c=f[o];s[c]?s[c]++:(s[c]=1,l.push(c))}var g=l.sort(a),v={},p=1;for(o=0;o<g.length;o++){var c=g[o],N=s[c],w=p,E=p+N-1,y=(w+E)/2;v[c]=y,p+=N}return f.map(function(R){return v[R]})},t.mode=function(o){var l=o.length,s=o.slice().sort(a),c=1,g=0,v=0,p=[],N;for(N=0;N<l;N++)s[N]===s[N+1]?c++:(c>g?(p=[s[N]],g=c,v=0):c===g&&(p.push(s[N]),v++),c=1);return v===0?p[0]:p},t.range=function(o){return t.max(o)-t.min(o)},t.variance=function(o,l){return t.sumsqerr(o)/(o.length-(l?1:0))},t.pooledvariance=function(o){var l=o.reduce(function(c,g){return c+t.sumsqerr(g)},0),s=o.reduce(function(c,g){return c+g.length},0);return l/(s-o.length)},t.deviation=function(f){for(var o=t.mean(f),l=f.length,s=new Array(l),c=0;c<l;c++)s[c]=f[c]-o;return s},t.stdev=function(o,l){return i.sqrt(t.variance(o,l))},t.pooledstdev=function(o){return i.sqrt(t.pooledvariance(o))},t.meandev=function(o){for(var l=t.mean(o),s=[],c=o.length-1;c>=0;c--)s.push(i.abs(o[c]-l));return t.mean(s)},t.meddev=function(o){for(var l=t.median(o),s=[],c=o.length-1;c>=0;c--)s.push(i.abs(o[c]-l));return t.median(s)},t.coeffvar=function(o){return t.stdev(o)/t.mean(o)},t.quartiles=function(o){var l=o.length,s=o.slice().sort(a);return[s[i.round(l/4)-1],s[i.round(l/2)-1],s[i.round(l*3/4)-1]]},t.quantiles=function(o,l,s,c){var g=o.slice().sort(a),v=[l.length],p=o.length,N,w,E,y,R,I;for(typeof s>"u"&&(s=3/8),typeof c>"u"&&(c=3/8),N=0;N<l.length;N++)w=l[N],E=s+w*(1-s-c),y=p*w+E,R=i.floor(h(y,1,p-1)),I=h(y-R,0,1),v[N]=(1-I)*g[R-1]+I*g[R];return v},t.percentile=function(o,l,s){var c=o.slice().sort(a),g=l*(c.length+(s?1:-1))+(s?0:1),v=parseInt(g),p=g-v;return v+1<c.length?c[v-1]+p*(c[v]-c[v-1]):c[v-1]},t.percentileOfScore=function(o,l,s){var c=0,g=o.length,v=!1,p,N;for(s==="strict"&&(v=!0),N=0;N<g;N++)p=o[N],(v&&p<l||!v&&p<=l)&&c++;return c/g},t.histogram=function(o,l){l=l||4;var s=t.min(o),c=(t.max(o)-s)/l,g=o.length,v=[],p;for(p=0;p<l;p++)v[p]=0;for(p=0;p<g;p++)v[i.min(i.floor((o[p]-s)/c),l-1)]+=1;return v},t.covariance=function(o,l){var s=t.mean(o),c=t.mean(l),g=o.length,v=new Array(g),p;for(p=0;p<g;p++)v[p]=(o[p]-s)*(l[p]-c);return t.sum(v)/(g-1)},t.corrcoeff=function(o,l){return t.covariance(o,l)/t.stdev(o,1)/t.stdev(l,1)},t.spearmancoeff=function(f,o){return f=t.rank(f),o=t.rank(o),t.corrcoeff(f,o)},t.stanMoment=function(o,l){for(var s=t.mean(o),c=t.stdev(o),g=o.length,v=0,p=0;p<g;p++)v+=i.pow((o[p]-s)/c,l);return v/o.length},t.skewness=function(o){return t.stanMoment(o,3)},t.kurtosis=function(o){return t.stanMoment(o,4)-3};var d=t.prototype;(function(f){for(var o=0;o<f.length;o++)(function(l){d[l]=function(s,c){var g=[],v=0,p=this;if(u(s)&&(c=s,s=!1),c)return setTimeout(function(){c.call(p,d[l].call(p,s))}),this;if(this.length>1){for(p=s===!0?this:this.transpose();v<p.length;v++)g[v]=t[l](p[v]);return g}return t[l](this[0],s)}})(f[o])})("cumsum cumprod".split(" ")),function(f){for(var o=0;o<f.length;o++)(function(l){d[l]=function(s,c){var g=[],v=0,p=this;if(u(s)&&(c=s,s=!1),c)return setTimeout(function(){c.call(p,d[l].call(p,s))}),this;if(this.length>1){for(l!=="sumrow"&&(p=s===!0?this:this.transpose());v<p.length;v++)g[v]=t[l](p[v]);return s===!0?t[l](t.utils.toVector(g)):g}return t[l](this[0],s)}})(f[o])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(f){for(var o=0;o<f.length;o++)(function(l){d[l]=function(){var s=[],c=0,g=this,v=Array.prototype.slice.call(arguments),p;if(u(v[v.length-1])){p=v[v.length-1];var N=v.slice(0,v.length-1);return setTimeout(function(){p.call(g,d[l].apply(g,N))}),this}else{p=void 0;var w=function(y){return t[l].apply(g,[y].concat(v))}}if(this.length>1){for(g=g.transpose();c<g.length;c++)s[c]=w(g[c]);return s}return w(this[0])}})(f[o])}("quantiles percentileOfScore".split(" "))}(r,Math),function(t,i){t.gammaln=function(a){var h=0,d=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],f=1.000000000190015,o,l,s;for(s=(l=o=a)+5.5,s-=(o+.5)*i.log(s);h<6;h++)f+=d[h]/++l;return i.log(2.5066282746310007*f/o)-s},t.loggam=function(a){var h,d,f,o,l,s,c,g=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(h=a,c=0,a==1||a==2)return 0;for(a<=7&&(c=i.floor(7-a),h=a+c),d=1/(h*h),f=2*i.PI,l=g[9],s=8;s>=0;s--)l*=d,l+=g[s];if(o=l/h+.5*i.log(f)+(h-.5)*i.log(h)-h,a<=7)for(s=1;s<=c;s++)o-=i.log(h-1),h-=1;return o},t.gammafn=function(a){var h=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],d=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],f=!1,o=0,l=0,s=0,c=a,g,v,p,N;if(a>171.6243769536076)return 1/0;if(c<=0)if(N=c%1+36e-17,N)f=(c&1?-1:1)*i.PI/i.sin(i.PI*N),c=1-c;else return 1/0;for(p=c,c<1?v=c++:v=(c-=o=(c|0)-1)-1,g=0;g<8;++g)s=(s+h[g])*v,l=l*v+d[g];if(N=s/l+1,p<c)N/=p;else if(p>c)for(g=0;g<o;++g)N*=c,c++;return f&&(N=f/N),N},t.gammap=function(a,h){return t.lowRegGamma(a,h)*t.gammafn(a)},t.lowRegGamma=function(a,h){var d=t.gammaln(a),f=a,o=1/a,l=o,s=h+1-a,c=1/1e-30,g=1/s,v=g,p=1,N=-~(i.log(a>=1?a:1/a)*8.5+a*.4+17),w;if(h<0||a<=0)return NaN;if(h<a+1){for(;p<=N;p++)o+=l*=h/++f;return o*i.exp(-h+a*i.log(h)-d)}for(;p<=N;p++)w=-p*(p-a),s+=2,g=w*g+s,c=s+w/c,g=1/g,v*=g*c;return 1-v*i.exp(-h+a*i.log(h)-d)},t.factorialln=function(a){return a<0?NaN:t.gammaln(a+1)},t.factorial=function(a){return a<0?NaN:t.gammafn(a+1)},t.combination=function(a,h){return a>170||h>170?i.exp(t.combinationln(a,h)):t.factorial(a)/t.factorial(h)/t.factorial(a-h)},t.combinationln=function(a,h){return t.factorialln(a)-t.factorialln(h)-t.factorialln(a-h)},t.permutation=function(a,h){return t.factorial(a)/t.factorial(a-h)},t.betafn=function(a,h){if(!(a<=0||h<=0))return a+h>170?i.exp(t.betaln(a,h)):t.gammafn(a)*t.gammafn(h)/t.gammafn(a+h)},t.betaln=function(a,h){return t.gammaln(a)+t.gammaln(h)-t.gammaln(a+h)},t.betacf=function(a,h,d){var f=1e-30,o=1,l=h+d,s=h+1,c=h-1,g=1,v=1-l*a/s,p,N,w,E;for(i.abs(v)<f&&(v=f),v=1/v,E=v;o<=100&&(p=2*o,N=o*(d-o)*a/((c+p)*(h+p)),v=1+N*v,i.abs(v)<f&&(v=f),g=1+N/g,i.abs(g)<f&&(g=f),v=1/v,E*=v*g,N=-(h+o)*(l+o)*a/((h+p)*(s+p)),v=1+N*v,i.abs(v)<f&&(v=f),g=1+N/g,i.abs(g)<f&&(g=f),v=1/v,w=v*g,E*=w,!(i.abs(w-1)<3e-7));o++);return E},t.gammapinv=function(a,h){var d=0,f=h-1,o=1e-8,l=t.gammaln(h),s,c,g,v,p,N,w;if(a>=1)return i.max(100,h+100*i.sqrt(h));if(a<=0)return 0;for(h>1?(N=i.log(f),w=i.exp(f*(N-1)-l),p=a<.5?a:1-a,g=i.sqrt(-2*i.log(p)),s=(2.30753+g*.27061)/(1+g*(.99229+g*.04481))-g,a<.5&&(s=-s),s=i.max(.001,h*i.pow(1-1/(9*h)-s/(3*i.sqrt(h)),3))):(g=1-h*(.253+h*.12),a<g?s=i.pow(a/g,1/h):s=1-i.log(1-(a-g)/(1-g)));d<12;d++){if(s<=0)return 0;if(c=t.lowRegGamma(h,s)-a,h>1?g=w*i.exp(-(s-f)+f*(i.log(s)-N)):g=i.exp(-s+f*i.log(s)-l),v=c/g,s-=g=v/(1-.5*i.min(1,v*((h-1)/s-1))),s<=0&&(s=.5*(s+g)),i.abs(g)<o*s)break}return s},t.erf=function(a){var h=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],d=h.length-1,f=!1,o=0,l=0,s,c,g,v;for(a<0&&(a=-a,f=!0),s=2/(2+a),c=4*s-2;d>0;d--)g=o,o=c*o-l+h[d],l=g;return v=s*i.exp(-a*a+.5*(h[0]+c*o)-l),f?v-1:1-v},t.erfc=function(a){return 1-t.erf(a)},t.erfcinv=function(a){var h=0,d,f,o,l;if(a>=2)return-100;if(a<=0)return 100;for(l=a<1?a:2-a,o=i.sqrt(-2*i.log(l/2)),d=-.70711*((2.30753+o*.27061)/(1+o*(.99229+o*.04481))-o);h<2;h++)f=t.erfc(d)-l,d+=f/(1.1283791670955126*i.exp(-d*d)-d*f);return a<1?d:-d},t.ibetainv=function(a,h,d){var f=1e-8,o=h-1,l=d-1,s=0,c,g,v,p,N,w,E,y,R,I,S;if(a<=0)return 0;if(a>=1)return 1;for(h>=1&&d>=1?(v=a<.5?a:1-a,p=i.sqrt(-2*i.log(v)),E=(2.30753+p*.27061)/(1+p*(.99229+p*.04481))-p,a<.5&&(E=-E),y=(E*E-3)/6,R=2/(1/(2*h-1)+1/(2*d-1)),I=E*i.sqrt(y+R)/R-(1/(2*d-1)-1/(2*h-1))*(y+5/6-2/(3*R)),E=h/(h+d*i.exp(2*I))):(c=i.log(h/(h+d)),g=i.log(d/(h+d)),p=i.exp(h*c)/h,N=i.exp(d*g)/d,I=p+N,a<p/I?E=i.pow(h*I*a,1/h):E=1-i.pow(d*I*(1-a),1/d)),S=-t.gammaln(h)-t.gammaln(d)+t.gammaln(h+d);s<10;s++){if(E===0||E===1)return E;if(w=t.ibeta(E,h,d)-a,p=i.exp(o*i.log(E)+l*i.log(1-E)+S),N=w/p,E-=p=N/(1-.5*i.min(1,N*(o/E-l/(1-E)))),E<=0&&(E=.5*(E+p)),E>=1&&(E=.5*(E+p+1)),i.abs(p)<f*E&&s>0)break}return E},t.ibeta=function(a,h,d){var f=a===0||a===1?0:i.exp(t.gammaln(h+d)-t.gammaln(h)-t.gammaln(d)+h*i.log(a)+d*i.log(1-a));return a<0||a>1?!1:a<(h+1)/(h+d+2)?f*t.betacf(a,h,d)/h:1-f*t.betacf(1-a,d,h)/d},t.randn=function(a,h){var d,f,o,l,s;if(h||(h=a),a)return t.create(a,h,function(){return t.randn()});do d=t._random_fn(),f=1.7156*(t._random_fn()-.5),o=d-.449871,l=i.abs(f)+.386595,s=o*o+l*(.196*l-.25472*o);while(s>.27597&&(s>.27846||f*f>-4*i.log(d)*d*d));return f/d},t.randg=function(a,h,d){var f=a,o,l,s,c,g,v;if(d||(d=h),a||(a=1),h)return v=t.zeros(h,d),v.alter(function(){return t.randg(a)}),v;a<1&&(a+=1),o=a-1/3,l=1/i.sqrt(9*o);do{do g=t.randn(),c=1+l*g;while(c<=0);c=c*c*c,s=t._random_fn()}while(s>1-.331*i.pow(g,4)&&i.log(s)>.5*g*g+o*(1-c+i.log(c)));if(a==f)return o*c;do s=t._random_fn();while(s===0);return i.pow(s,1/f)*o*c},function(u){for(var a=0;a<u.length;a++)(function(h){t.fn[h]=function(){return t(t.map(this,function(d){return t[h](d)}))}})(u[a])}("gammaln gammafn factorial factorialln".split(" ")),function(u){for(var a=0;a<u.length;a++)(function(h){t.fn[h]=function(){return t(t[h].apply(null,arguments))}})(u[a])}("randn".split(" "))}(r,Math),function(t,i){(function(f){for(var o=0;o<f.length;o++)(function(l){t[l]=function s(c,g,v){return this instanceof s?(this._a=c,this._b=g,this._c=v,this):new s(c,g,v)},t.fn[l]=function(s,c,g){var v=t[l](s,c,g);return v.data=this,v},t[l].prototype.sample=function(s){var c=this._a,g=this._b,v=this._c;return s?t.alter(s,function(){return t[l].sample(c,g,v)}):t[l].sample(c,g,v)},function(s){for(var c=0;c<s.length;c++)(function(g){t[l].prototype[g]=function(v){var p=this._a,N=this._b,w=this._c;return!v&&v!==0&&(v=this.data),typeof v!="number"?t.fn.map.call(v,function(E){return t[l][g](E,p,N,w)}):t[l][g](v,p,N,w)}})(s[c])}("pdf cdf inv".split(" ")),function(s){for(var c=0;c<s.length;c++)(function(g){t[l].prototype[g]=function(){return t[l][g](this._a,this._b,this._c)}})(s[c])}("mean median mode variance".split(" "))})(f[o])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),t.extend(t.beta,{pdf:function(o,l,s){return o>1||o<0?0:l==1&&s==1?1:l<512&&s<512?i.pow(o,l-1)*i.pow(1-o,s-1)/t.betafn(l,s):i.exp((l-1)*i.log(o)+(s-1)*i.log(1-o)-t.betaln(l,s))},cdf:function(o,l,s){return o>1||o<0?(o>1)*1:t.ibeta(o,l,s)},inv:function(o,l,s){return t.ibetainv(o,l,s)},mean:function(o,l){return o/(o+l)},median:function(o,l){return t.ibetainv(.5,o,l)},mode:function(o,l){return(o-1)/(o+l-2)},sample:function(o,l){var s=t.randg(o);return s/(s+t.randg(l))},variance:function(o,l){return o*l/(i.pow(o+l,2)*(o+l+1))}}),t.extend(t.centralF,{pdf:function(o,l,s){var c,g,v;return o<0?0:l<=2?o===0&&l<2?1/0:o===0&&l===2?1:1/t.betafn(l/2,s/2)*i.pow(l/s,l/2)*i.pow(o,l/2-1)*i.pow(1+l/s*o,-(l+s)/2):(c=l*o/(s+o*l),g=s/(s+o*l),v=l*g/2,v*t.binomial.pdf((l-2)/2,(l+s-2)/2,c))},cdf:function(o,l,s){return o<0?0:t.ibeta(l*o/(l*o+s),l/2,s/2)},inv:function(o,l,s){return s/(l*(1/t.ibetainv(o,l/2,s/2)-1))},mean:function(o,l){return l>2?l/(l-2):void 0},mode:function(o,l){return o>2?l*(o-2)/(o*(l+2)):void 0},sample:function(o,l){var s=t.randg(o/2)*2,c=t.randg(l/2)*2;return s/o/(c/l)},variance:function(o,l){if(!(l<=4))return 2*l*l*(o+l-2)/(o*(l-2)*(l-2)*(l-4))}}),t.extend(t.cauchy,{pdf:function(o,l,s){return s<0?0:s/(i.pow(o-l,2)+i.pow(s,2))/i.PI},cdf:function(o,l,s){return i.atan((o-l)/s)/i.PI+.5},inv:function(f,o,l){return o+l*i.tan(i.PI*(f-.5))},median:function(o){return o},mode:function(o){return o},sample:function(o,l){return t.randn()*i.sqrt(1/(2*t.randg(.5)))*l+o}}),t.extend(t.chisquare,{pdf:function(o,l){return o<0?0:o===0&&l===2?.5:i.exp((l/2-1)*i.log(o)-o/2-l/2*i.log(2)-t.gammaln(l/2))},cdf:function(o,l){return o<0?0:t.lowRegGamma(l/2,o/2)},inv:function(f,o){return 2*t.gammapinv(f,.5*o)},mean:function(f){return f},median:function(o){return o*i.pow(1-2/(9*o),3)},mode:function(o){return o-2>0?o-2:0},sample:function(o){return t.randg(o/2)*2},variance:function(o){return 2*o}}),t.extend(t.exponential,{pdf:function(o,l){return o<0?0:l*i.exp(-l*o)},cdf:function(o,l){return o<0?0:1-i.exp(-l*o)},inv:function(f,o){return-i.log(1-f)/o},mean:function(f){return 1/f},median:function(f){return 1/f*i.log(2)},mode:function(){return 0},sample:function(o){return-1/o*i.log(t._random_fn())},variance:function(f){return i.pow(f,-2)}}),t.extend(t.gamma,{pdf:function(o,l,s){return o<0?0:o===0&&l===1?1/s:i.exp((l-1)*i.log(o)-o/s-t.gammaln(l)-l*i.log(s))},cdf:function(o,l,s){return o<0?0:t.lowRegGamma(l,o/s)},inv:function(f,o,l){return t.gammapinv(f,o)*l},mean:function(f,o){return f*o},mode:function(o,l){if(o>1)return(o-1)*l},sample:function(o,l){return t.randg(o)*l},variance:function(o,l){return o*l*l}}),t.extend(t.invgamma,{pdf:function(o,l,s){return o<=0?0:i.exp(-(l+1)*i.log(o)-s/o-t.gammaln(l)+l*i.log(s))},cdf:function(o,l,s){return o<=0?0:1-t.lowRegGamma(l,s/o)},inv:function(f,o,l){return l/t.gammapinv(1-f,o)},mean:function(f,o){return f>1?o/(f-1):void 0},mode:function(o,l){return l/(o+1)},sample:function(o,l){return l/t.randg(o)},variance:function(o,l){if(!(o<=2))return l*l/((o-1)*(o-1)*(o-2))}}),t.extend(t.kumaraswamy,{pdf:function(o,l,s){return o===0&&l===1?s:o===1&&s===1?l:i.exp(i.log(l)+i.log(s)+(l-1)*i.log(o)+(s-1)*i.log(1-i.pow(o,l)))},cdf:function(o,l,s){return o<0?0:o>1?1:1-i.pow(1-i.pow(o,l),s)},inv:function(o,l,s){return i.pow(1-i.pow(1-o,1/s),1/l)},mean:function(f,o){return o*t.gammafn(1+1/f)*t.gammafn(o)/t.gammafn(1+1/f+o)},median:function(o,l){return i.pow(1-i.pow(2,-1/l),1/o)},mode:function(o,l){if(o>=1&&l>=1&&o!==1&&l!==1)return i.pow((o-1)/(o*l-1),1/o)},variance:function(){throw new Error("variance not yet implemented")}}),t.extend(t.lognormal,{pdf:function(o,l,s){return o<=0?0:i.exp(-i.log(o)-.5*i.log(2*i.PI)-i.log(s)-i.pow(i.log(o)-l,2)/(2*s*s))},cdf:function(o,l,s){return o<0?0:.5+.5*t.erf((i.log(o)-l)/i.sqrt(2*s*s))},inv:function(f,o,l){return i.exp(-1.4142135623730951*l*t.erfcinv(2*f)+o)},mean:function(o,l){return i.exp(o+l*l/2)},median:function(o){return i.exp(o)},mode:function(o,l){return i.exp(o-l*l)},sample:function(o,l){return i.exp(t.randn()*l+o)},variance:function(o,l){return(i.exp(l*l)-1)*i.exp(2*o+l*l)}}),t.extend(t.noncentralt,{pdf:function(o,l,s){var c=1e-14;return i.abs(s)<c?t.studentt.pdf(o,l):i.abs(o)<c?i.exp(t.gammaln((l+1)/2)-s*s/2-.5*i.log(i.PI*l)-t.gammaln(l/2)):l/o*(t.noncentralt.cdf(o*i.sqrt(1+2/l),l+2,s)-t.noncentralt.cdf(o,l,s))},cdf:function(o,l,s){var c=1e-14,g=200;if(i.abs(s)<c)return t.studentt.cdf(o,l);var v=!1;o<0&&(v=!0,s=-s);for(var p=t.normal.cdf(-s,0,1),N=c+1,w=N,E=o*o/(o*o+l),y=0,R=i.exp(-s*s/2),I=i.exp(-s*s/2-.5*i.log(2)-t.gammaln(3/2))*s;y<g||w>c||N>c;)w=N,y>0&&(R*=s*s/(2*y),I*=s*s/(2*(y+1/2))),N=R*t.beta.cdf(E,y+.5,l/2)+I*t.beta.cdf(E,y+1,l/2),p+=.5*N,y++;return v?1-p:p}}),t.extend(t.normal,{pdf:function(o,l,s){return i.exp(-.5*i.log(2*i.PI)-i.log(s)-i.pow(o-l,2)/(2*s*s))},cdf:function(o,l,s){return .5*(1+t.erf((o-l)/i.sqrt(2*s*s)))},inv:function(f,o,l){return-1.4142135623730951*l*t.erfcinv(2*f)+o},mean:function(f){return f},median:function(o){return o},mode:function(f){return f},sample:function(o,l){return t.randn()*l+o},variance:function(f,o){return o*o}}),t.extend(t.pareto,{pdf:function(o,l,s){return o<l?0:s*i.pow(l,s)/i.pow(o,s+1)},cdf:function(o,l,s){return o<l?0:1-i.pow(l/o,s)},inv:function(o,l,s){return l/i.pow(1-o,1/s)},mean:function(o,l){if(!(l<=1))return l*i.pow(o,l)/(l-1)},median:function(o,l){return o*(l*i.SQRT2)},mode:function(o){return o},variance:function(f,o){if(!(o<=2))return f*f*o/(i.pow(o-1,2)*(o-2))}}),t.extend(t.studentt,{pdf:function(o,l){return l=l>1e100?1e100:l,1/(i.sqrt(l)*t.betafn(.5,l/2))*i.pow(1+o*o/l,-((l+1)/2))},cdf:function(o,l){var s=l/2;return t.ibeta((o+i.sqrt(o*o+l))/(2*i.sqrt(o*o+l)),s,s)},inv:function(f,o){var l=t.ibetainv(2*i.min(f,1-f),.5*o,.5);return l=i.sqrt(o*(1-l)/l),f>.5?l:-l},mean:function(o){return o>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(o){return t.randn()*i.sqrt(o/(2*t.randg(o/2)))},variance:function(o){return o>2?o/(o-2):o>1?1/0:void 0}}),t.extend(t.weibull,{pdf:function(o,l,s){return o<0||l<0||s<0?0:s/l*i.pow(o/l,s-1)*i.exp(-i.pow(o/l,s))},cdf:function(o,l,s){return o<0?0:1-i.exp(-i.pow(o/l,s))},inv:function(f,o,l){return o*i.pow(-i.log(1-f),1/l)},mean:function(f,o){return f*t.gammafn(1+1/o)},median:function(o,l){return o*i.pow(i.log(2),1/l)},mode:function(o,l){return l<=1?0:o*i.pow((l-1)/l,1/l)},sample:function(o,l){return o*i.pow(-i.log(t._random_fn()),1/l)},variance:function(o,l){return o*o*t.gammafn(1+2/l)-i.pow(t.weibull.mean(o,l),2)}}),t.extend(t.uniform,{pdf:function(o,l,s){return o<l||o>s?0:1/(s-l)},cdf:function(o,l,s){return o<l?0:o<s?(o-l)/(s-l):1},inv:function(f,o,l){return o+f*(l-o)},mean:function(o,l){return .5*(o+l)},median:function(o,l){return t.mean(o,l)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(o,l){return o/2+l/2+(l/2-o/2)*(2*t._random_fn()-1)},variance:function(o,l){return i.pow(l-o,2)/12}});function u(f,o,l,s){for(var c=0,g=1,v=1,p=1,N=0,w=0,E;i.abs((v-w)/v)>s;)w=v,E=-(o+N)*(o+l+N)*f/(o+2*N)/(o+2*N+1),c=v+E*c,g=p+E*g,N=N+1,E=N*(l-N)*f/(o+2*N-1)/(o+2*N),v=c+E*v,p=g+E*p,c=c/p,g=g/p,v=v/p,p=1;return v/o}t.extend(t.binomial,{pdf:function(o,l,s){return s===0||s===1?l*s===o?1:0:t.combination(l,o)*i.pow(s,o)*i.pow(1-s,l-o)},cdf:function(o,l,s){var c,g=1e-10;if(o<0)return 0;if(o>=l)return 1;if(s<0||s>1||l<=0)return NaN;o=i.floor(o);var v=s,p=o+1,N=l-o,w=p+N,E=i.exp(t.gammaln(w)-t.gammaln(N)-t.gammaln(p)+p*i.log(v)+N*i.log(1-v));return v<(p+1)/(w+2)?c=E*u(v,p,N,g):c=1-E*u(1-v,N,p,g),i.round((1-c)*(1/g))/(1/g)}}),t.extend(t.negbin,{pdf:function(o,l,s){return o!==o>>>0?!1:o<0?0:t.combination(o+l-1,l-1)*i.pow(1-s,o)*i.pow(s,l)},cdf:function(o,l,s){var c=0,g=0;if(o<0)return 0;for(;g<=o;g++)c+=t.negbin.pdf(g,l,s);return c}}),t.extend(t.hypgeom,{pdf:function(o,l,s,c){if(o!==o|0)return!1;if(o<0||o<s-(l-c))return 0;if(o>c||o>s)return 0;if(s*2>l)return c*2>l?t.hypgeom.pdf(l-s-c+o,l,l-s,l-c):t.hypgeom.pdf(c-o,l,l-s,c);if(c*2>l)return t.hypgeom.pdf(s-o,l,s,l-c);if(s<c)return t.hypgeom.pdf(o,l,c,s);for(var g=1,v=0,p=0;p<o;p++){for(;g>1&&v<c;)g*=1-s/(l-v),v++;g*=(c-p)*(s-p)/((p+1)*(l-s-c+p+1))}for(;v<c;v++)g*=1-s/(l-v);return i.min(1,i.max(0,g))},cdf:function(o,l,s,c){if(o<0||o<s-(l-c))return 0;if(o>=c||o>=s)return 1;if(s*2>l)return c*2>l?t.hypgeom.cdf(l-s-c+o,l,l-s,l-c):1-t.hypgeom.cdf(c-o-1,l,l-s,c);if(c*2>l)return 1-t.hypgeom.cdf(s-o-1,l,s,l-c);if(s<c)return t.hypgeom.cdf(o,l,c,s);for(var g=1,v=1,p=0,N=0;N<o;N++){for(;g>1&&p<c;){var w=1-s/(l-p);v*=w,g*=w,p++}v*=(c-N)*(s-N)/((N+1)*(l-s-c+N+1)),g+=v}for(;p<c;p++)g*=1-s/(l-p);return i.min(1,i.max(0,g))}}),t.extend(t.poisson,{pdf:function(o,l){return l<0||o%1!==0||o<0?0:i.pow(l,o)*i.exp(-l)/t.factorial(o)},cdf:function(o,l){var s=[],c=0;if(o<0)return 0;for(;c<=o;c++)s.push(t.poisson.pdf(c,l));return t.sum(s)},mean:function(f){return f},variance:function(f){return f},sampleSmall:function(o){var l=1,s=0,c=i.exp(-o);do s++,l*=t._random_fn();while(l>c);return s-1},sampleLarge:function(o){var l=o,s,c,g,v,p,N,w,E,y,R;for(v=i.sqrt(l),p=i.log(l),w=.931+2.53*v,N=-.059+.02483*w,E=1.1239+1.1328/(w-3.4),y=.9277-3.6224/(w-2);;){if(c=i.random()-.5,g=i.random(),R=.5-i.abs(c),s=i.floor((2*N/R+w)*c+l+.43),R>=.07&&g<=y)return s;if(!(s<0||R<.013&&g>R)&&i.log(g)+i.log(E)-i.log(N/(R*R)+w)<=-l+s*p-t.loggam(s+1))return s}},sample:function(o){return o<10?this.sampleSmall(o):this.sampleLarge(o)}}),t.extend(t.triangular,{pdf:function(o,l,s,c){return s<=l||c<l||c>s?NaN:o<l||o>s?0:o<c?2*(o-l)/((s-l)*(c-l)):o===c?2/(s-l):2*(s-o)/((s-l)*(s-c))},cdf:function(o,l,s,c){return s<=l||c<l||c>s?NaN:o<=l?0:o>=s?1:o<=c?i.pow(o-l,2)/((s-l)*(c-l)):1-i.pow(s-o,2)/((s-l)*(s-c))},inv:function(o,l,s,c){return s<=l||c<l||c>s?NaN:o<=(c-l)/(s-l)?l+(s-l)*i.sqrt(o*((c-l)/(s-l))):l+(s-l)*(1-i.sqrt((1-o)*(1-(c-l)/(s-l))))},mean:function(o,l,s){return(o+l+s)/3},median:function(o,l,s){if(s<=(o+l)/2)return l-i.sqrt((l-o)*(l-s))/i.sqrt(2);if(s>(o+l)/2)return o+i.sqrt((l-o)*(s-o))/i.sqrt(2)},mode:function(o,l,s){return s},sample:function(o,l,s){var c=t._random_fn();return c<(s-o)/(l-o)?o+i.sqrt(c*(l-o)*(s-o)):l-i.sqrt((1-c)*(l-o)*(l-s))},variance:function(o,l,s){return(o*o+l*l+s*s-o*l-o*s-l*s)/18}}),t.extend(t.arcsine,{pdf:function(o,l,s){return s<=l?NaN:o<=l||o>=s?0:2/i.PI*i.pow(i.pow(s-l,2)-i.pow(2*o-l-s,2),-.5)},cdf:function(o,l,s){return o<l?0:o<s?2/i.PI*i.asin(i.sqrt((o-l)/(s-l))):1},inv:function(f,o,l){return o+(.5-.5*i.cos(i.PI*f))*(l-o)},mean:function(o,l){return l<=o?NaN:(o+l)/2},median:function(o,l){return l<=o?NaN:(o+l)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(o,l){return(o+l)/2+(l-o)/2*i.sin(2*i.PI*t.uniform.sample(0,1))},variance:function(o,l){return l<=o?NaN:i.pow(l-o,2)/8}});function a(f){return f/i.abs(f)}t.extend(t.laplace,{pdf:function(o,l,s){return s<=0?0:i.exp(-i.abs(o-l)/s)/(2*s)},cdf:function(o,l,s){return s<=0?0:o<l?.5*i.exp((o-l)/s):1-.5*i.exp(-(o-l)/s)},mean:function(f){return f},median:function(f){return f},mode:function(f){return f},variance:function(f,o){return 2*o*o},sample:function(o,l){var s=t._random_fn()-.5;return o-l*a(s)*i.log(1-2*i.abs(s))}});function h(f,o,l){var s=12,c=6,g=-30,v=-50,p=60,N=8,w=3,E=2,y=3,R=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],I=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],S=f*.5;if(S>=N)return 1;var T=2*t.normal.cdf(S,0,1,1,0)-1;T>=i.exp(v/l)?T=i.pow(T,l):T=0;var M;f>w?M=E:M=y;for(var V=S,G=(N-S)/M,nn=V+G,X=0,Q=l-1,Nn=1;Nn<=M;Nn++){for(var yn=0,cn=.5*(nn+V),ln=.5*(nn-V),kn=1;kn<=s;kn++){var Dn,Bn;c<kn?(Dn=s-kn+1,Bn=R[Dn-1]):(Dn=kn,Bn=-R[Dn-1]);var Jn=ln*Bn,Z=cn+Jn,on=Z*Z;if(on>p)break;var an=2*t.normal.cdf(Z,0,1,1,0),Rn=2*t.normal.cdf(Z,f,1,1,0),Cn=an*.5-Rn*.5;Cn>=i.exp(g/Q)&&(Cn=I[Dn-1]*i.exp(-(.5*on))*i.pow(Cn,Q),yn+=Cn)}yn*=2*ln*l/i.sqrt(2*i.PI),X+=yn,V=nn,nn+=G}return T+=X,T<=i.exp(g/o)?0:(T=i.pow(T,o),T>=1?1:T)}function d(f,o,l){var s=.322232421088,c=.099348462606,g=-1,v=.588581570495,p=-.342242088547,N=.531103462366,w=-.204231210125,E=.10353775285,y=-453642210148e-16,R=.0038560700634,I=.8832,S=.2368,T=1.208,M=1.4142,V=120,G=.5-.5*f,nn=i.sqrt(i.log(1/(G*G))),X=nn+((((nn*y+w)*nn+p)*nn+g)*nn+s)/((((nn*R+E)*nn+N)*nn+v)*nn+c);l<V&&(X+=(X*X*X+X)/l/4);var Q=I-S*X;return l<V&&(Q+=-1.214/l+T*X/l),X*(Q*i.log(o-1)+M)}t.extend(t.tukey,{cdf:function(o,l,s){var c=1,g=l,v=16,p=8,N=-30,w=1e-14,E=100,y=800,R=5e3,I=25e3,S=1,T=.5,M=.25,V=.125,G=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],nn=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(o<=0)return 0;if(s<2||c<1||g<2)return NaN;if(!Number.isFinite(o))return 1;if(s>I)return h(o,c,g);var X=s*.5,Q=X*i.log(s)-s*i.log(2)-t.gammaln(X),Nn=X-1,yn=s*.25,cn;s<=E?cn=S:s<=y?cn=T:s<=R?cn=M:cn=V,Q+=i.log(cn);for(var ln=0,kn=1;kn<=50;kn++){for(var Dn=0,Bn=(2*kn-1)*cn,Jn=1;Jn<=v;Jn++){var Z,on;p<Jn?(Z=Jn-p-1,on=Q+Nn*i.log(Bn+G[Z]*cn)-(G[Z]*cn+Bn)*yn):(Z=Jn-1,on=Q+Nn*i.log(Bn-G[Z]*cn)+(G[Z]*cn-Bn)*yn);var an;if(on>=N){p<Jn?an=o*i.sqrt((G[Z]*cn+Bn)*.5):an=o*i.sqrt((-(G[Z]*cn)+Bn)*.5);var Rn=h(an,c,g),Cn=Rn*nn[Z]*i.exp(on);Dn+=Cn}}if(kn*cn>=1&&Dn<=w)break;ln+=Dn}if(Dn>w)throw new Error("tukey.cdf failed to converge");return ln>1&&(ln=1),ln},inv:function(f,o,l){var s=1,c=o,g=1e-4,v=50;if(l<2||s<1||c<2)return NaN;if(f<0||f>1)return NaN;if(f===0)return 0;if(f===1)return 1/0;var p=d(f,c,l),N=t.tukey.cdf(p,o,l)-f,w;N>0?w=i.max(0,p-1):w=p+1;for(var E=t.tukey.cdf(w,o,l)-f,y,R=1;R<v;R++){y=w-E*(w-p)/(E-N),N=E,p=w,y<0&&(y=0,E=-f),E=t.tukey.cdf(y,o,l)-f,w=y;var I=i.abs(w-p);if(I<g)return y}throw new Error("tukey.inv failed to converge")}})}(r,Math),function(t,i){var u=Array.prototype.push,a=t.utils.isArray;function h(d){return a(d)||d instanceof t}t.extend({add:function(f,o){return h(o)?(h(o[0])||(o=[o]),t.map(f,function(l,s,c){return l+o[s][c]})):t.map(f,function(l){return l+o})},subtract:function(f,o){return h(o)?(h(o[0])||(o=[o]),t.map(f,function(l,s,c){return l-o[s][c]||0})):t.map(f,function(l){return l-o})},divide:function(f,o){return h(o)?(h(o[0])||(o=[o]),t.multiply(f,t.inv(o))):t.map(f,function(l){return l/o})},multiply:function(f,o){var l,s,c,g,v,p,N,w;if(f.length===void 0&&o.length===void 0)return f*o;if(v=f.length,p=f[0].length,N=t.zeros(v,c=h(o)?o[0].length:p),w=0,h(o)){for(;w<c;w++)for(l=0;l<v;l++){for(g=0,s=0;s<p;s++)g+=f[l][s]*o[s][w];N[l][w]=g}return v===1&&w===1?N[0][0]:N}return t.map(f,function(E){return E*o})},outer:function(f,o){return t.multiply(f.map(function(l){return[l]}),[o])},dot:function(f,o){h(f[0])||(f=[f]),h(o[0])||(o=[o]);for(var l=f[0].length===1&&f.length!==1?t.transpose(f):f,s=o[0].length===1&&o.length!==1?t.transpose(o):o,c=[],g=0,v=l.length,p=l[0].length,N,w;g<v;g++){for(c[g]=[],N=0,w=0;w<p;w++)N+=l[g][w]*s[g][w];c[g]=N}return c.length===1?c[0]:c},pow:function(f,o){return t.map(f,function(l){return i.pow(l,o)})},exp:function(f){return t.map(f,function(o){return i.exp(o)})},log:function(f){return t.map(f,function(o){return i.log(o)})},abs:function(f){return t.map(f,function(o){return i.abs(o)})},norm:function(f,o){var l=0,s=0;for(isNaN(o)&&(o=2),h(f[0])&&(f=f[0]);s<f.length;s++)l+=i.pow(i.abs(f[s]),o);return i.pow(l,1/o)},angle:function(f,o){return i.acos(t.dot(f,o)/(t.norm(f)*t.norm(o)))},aug:function(f,o){var l=[],s;for(s=0;s<f.length;s++)l.push(f[s].slice());for(s=0;s<l.length;s++)u.apply(l[s],o[s]);return l},inv:function(f){for(var o=f.length,l=f[0].length,s=t.identity(o,l),c=t.gauss_jordan(f,s),g=[],v=0,p;v<o;v++)for(g[v]=[],p=l;p<c[0].length;p++)g[v][p-l]=c[v][p];return g},det:function d(f){if(f.length===2)return f[0][0]*f[1][1]-f[0][1]*f[1][0];for(var o=0,l=0;l<f.length;l++){for(var s=[],c=1;c<f.length;c++){s[c-1]=[];for(var g=0;g<f.length;g++)g<l?s[c-1][g]=f[c][g]:g>l&&(s[c-1][g-1]=f[c][g])}var v=l%2?-1:1;o+=d(s)*f[0][l]*v}return o},gauss_elimination:function(f,o){var l=0,s=0,c=f.length,g=f[0].length,v=1,p=0,N=[],w,E,y,R;for(f=t.aug(f,o),w=f[0].length,l=0;l<c;l++){for(E=f[l][l],s=l,R=l+1;R<g;R++)E<i.abs(f[R][l])&&(E=f[R][l],s=R);if(s!=l)for(R=0;R<w;R++)y=f[l][R],f[l][R]=f[s][R],f[s][R]=y;for(s=l+1;s<c;s++)for(v=f[s][l]/f[l][l],R=l;R<w;R++)f[s][R]=f[s][R]-v*f[l][R]}for(l=c-1;l>=0;l--){for(p=0,s=l+1;s<=c-1;s++)p=p+N[s]*f[l][s];N[l]=(f[l][w-1]-p)/f[l][l]}return N},gauss_jordan:function(f,o){var l=t.aug(f,o),s=l.length,c=l[0].length,g=0,v,p,N;for(p=0;p<s;p++){var w=p;for(N=p+1;N<s;N++)i.abs(l[N][p])>i.abs(l[w][p])&&(w=N);var E=l[p];for(l[p]=l[w],l[w]=E,N=p+1;N<s;N++)for(g=l[N][p]/l[p][p],v=p;v<c;v++)l[N][v]-=l[p][v]*g}for(p=s-1;p>=0;p--){for(g=l[p][p],N=0;N<p;N++)for(v=c-1;v>p-1;v--)l[N][v]-=l[p][v]*l[N][p]/g;for(l[p][p]/=g,v=s;v<c;v++)l[p][v]/=g}return l},triaUpSolve:function(f,o){var l=f[0].length,s=t.zeros(1,l)[0],c,g=!1;return o[0].length!=null&&(o=o.map(function(v){return v[0]}),g=!0),t.arange(l-1,-1,-1).forEach(function(v){c=t.arange(v+1,l).map(function(p){return s[p]*f[v][p]}),s[v]=(o[v]-t.sum(c))/f[v][v]}),g?s.map(function(v){return[v]}):s},triaLowSolve:function(f,o){var l=f[0].length,s=t.zeros(1,l)[0],c,g=!1;return o[0].length!=null&&(o=o.map(function(v){return v[0]}),g=!0),t.arange(l).forEach(function(v){c=t.arange(v).map(function(p){return f[v][p]*s[p]}),s[v]=(o[v]-t.sum(c))/f[v][v]}),g?s.map(function(v){return[v]}):s},lu:function(f){var o=f.length,l=t.identity(o),s=t.zeros(f.length,f[0].length),c;return t.arange(o).forEach(function(g){s[0][g]=f[0][g]}),t.arange(1,o).forEach(function(g){t.arange(g).forEach(function(v){c=t.arange(v).map(function(p){return l[g][p]*s[p][v]}),l[g][v]=(f[g][v]-t.sum(c))/s[v][v]}),t.arange(g,o).forEach(function(v){c=t.arange(g).map(function(p){return l[g][p]*s[p][v]}),s[g][v]=f[c.length][v]-t.sum(c)})}),[l,s]},cholesky:function(f){var o=f.length,l=t.zeros(f.length,f[0].length),s;return t.arange(o).forEach(function(c){s=t.arange(c).map(function(g){return i.pow(l[c][g],2)}),l[c][c]=i.sqrt(f[c][c]-t.sum(s)),t.arange(c+1,o).forEach(function(g){s=t.arange(c).map(function(v){return l[c][v]*l[g][v]}),l[g][c]=(f[c][g]-t.sum(s))/l[c][c]})}),l},gauss_jacobi:function(f,o,l,s){for(var c=0,g=0,v=f.length,p=[],N=[],w=[],E,y,R,I;c<v;c++)for(p[c]=[],N[c]=[],w[c]=[],g=0;g<v;g++)c>g?(p[c][g]=f[c][g],N[c][g]=w[c][g]=0):c<g?(N[c][g]=f[c][g],p[c][g]=w[c][g]=0):(w[c][g]=f[c][g],p[c][g]=N[c][g]=0);for(R=t.multiply(t.multiply(t.inv(w),t.add(p,N)),-1),y=t.multiply(t.inv(w),o),E=l,I=t.add(t.multiply(R,l),y),c=2;i.abs(t.norm(t.subtract(I,E)))>s;)E=I,I=t.add(t.multiply(R,E),y),c++;return I},gauss_seidel:function(f,o,l,s){for(var c=0,g=f.length,v=[],p=[],N=[],w,E,y,R,I;c<g;c++)for(v[c]=[],p[c]=[],N[c]=[],w=0;w<g;w++)c>w?(v[c][w]=f[c][w],p[c][w]=N[c][w]=0):c<w?(p[c][w]=f[c][w],v[c][w]=N[c][w]=0):(N[c][w]=f[c][w],v[c][w]=p[c][w]=0);for(R=t.multiply(t.multiply(t.inv(t.add(N,v)),p),-1),y=t.multiply(t.inv(t.add(N,v)),o),E=l,I=t.add(t.multiply(R,l),y),c=2;i.abs(t.norm(t.subtract(I,E)))>s;)E=I,I=t.add(t.multiply(R,E),y),c=c+1;return I},SOR:function(f,o,l,s,c){for(var g=0,v=f.length,p=[],N=[],w=[],E,y,R,I,S;g<v;g++)for(p[g]=[],N[g]=[],w[g]=[],E=0;E<v;E++)g>E?(p[g][E]=f[g][E],N[g][E]=w[g][E]=0):g<E?(N[g][E]=f[g][E],p[g][E]=w[g][E]=0):(w[g][E]=f[g][E],p[g][E]=N[g][E]=0);for(I=t.multiply(t.inv(t.add(w,t.multiply(p,c))),t.subtract(t.multiply(w,1-c),t.multiply(N,c))),R=t.multiply(t.multiply(t.inv(t.add(w,t.multiply(p,c))),o),c),y=l,S=t.add(t.multiply(I,l),R),g=2;i.abs(t.norm(t.subtract(S,y)))>s;)y=S,S=t.add(t.multiply(I,y),R),g++;return S},householder:function(f){for(var o=f.length,l=f[0].length,s=0,c=[],g=[],v,p,N,w,E;s<o-1;s++){for(v=0,w=s+1;w<l;w++)v+=f[w][s]*f[w][s];for(E=f[s+1][s]>0?-1:1,v=E*i.sqrt(v),p=i.sqrt((v*v-f[s+1][s]*v)/2),c=t.zeros(o,1),c[s+1][0]=(f[s+1][s]-v)/(2*p),N=s+2;N<o;N++)c[N][0]=f[N][s]/(2*p);g=t.subtract(t.identity(o,l),t.multiply(t.multiply(c,t.transpose(c)),2)),f=t.multiply(g,t.multiply(f,g))}return f},QR:function(){var d=t.sum,f=t.arange;function o(l){var s=l.length,c=l[0].length,g=t.zeros(c,c);l=t.copy(l);var v,p,N;for(p=0;p<c;p++){for(g[p][p]=i.sqrt(d(f(s).map(function(w){return l[w][p]*l[w][p]}))),v=0;v<s;v++)l[v][p]=l[v][p]/g[p][p];for(N=p+1;N<c;N++)for(g[p][N]=d(f(s).map(function(w){return l[w][p]*l[w][N]})),v=0;v<s;v++)l[v][N]=l[v][N]-l[v][p]*g[p][N]}return[l,g]}return o}(),lstsq:function(){function d(o){o=t.copy(o);var l=o.length,s=t.identity(l);return t.arange(l-1,-1,-1).forEach(function(c){t.sliceAssign(s,{row:c},t.divide(t.slice(s,{row:c}),o[c][c])),t.sliceAssign(o,{row:c},t.divide(t.slice(o,{row:c}),o[c][c])),t.arange(c).forEach(function(g){var v=t.multiply(o[g][c],-1),p=t.slice(o,{row:g}),N=t.multiply(t.slice(o,{row:c}),v);t.sliceAssign(o,{row:g},t.add(p,N));var w=t.slice(s,{row:g}),E=t.multiply(t.slice(s,{row:c}),v);t.sliceAssign(s,{row:g},t.add(w,E))})}),s}function f(o,l){var s=!1;l[0].length===void 0&&(l=l.map(function(I){return[I]}),s=!0);var c=t.QR(o),g=c[0],v=c[1],p=o[0].length,N=t.slice(g,{col:{end:p}}),w=t.slice(v,{row:{end:p}}),E=d(w),y=t.transpose(N);y[0].length===void 0&&(y=[y]);var R=t.multiply(t.multiply(E,y),l);return R.length===void 0&&(R=[[R]]),s?R.map(function(I){return I[0]}):R}return f}(),jacobi:function(f){for(var o=1,l=f.length,s=t.identity(l,l),c=[],g,v,p,N,w,E,y,R;o===1;){for(E=f[0][1],N=0,w=1,v=0;v<l;v++)for(p=0;p<l;p++)v!=p&&E<i.abs(f[v][p])&&(E=i.abs(f[v][p]),N=v,w=p);for(f[N][N]===f[w][w]?y=f[N][w]>0?i.PI/4:-i.PI/4:y=i.atan(2*f[N][w]/(f[N][N]-f[w][w]))/2,R=t.identity(l,l),R[N][N]=i.cos(y),R[N][w]=-i.sin(y),R[w][N]=i.sin(y),R[w][w]=i.cos(y),s=t.multiply(s,R),g=t.multiply(t.multiply(t.inv(R),f),R),f=g,o=0,v=1;v<l;v++)for(p=1;p<l;p++)v!=p&&i.abs(f[v][p])>.001&&(o=1)}for(v=0;v<l;v++)c.push(f[v][v]);return[s,c]},rungekutta:function(f,o,l,s,c,g){var v,p,N,w,E;if(g===2)for(;s<=l;)v=o*f(s,c),p=o*f(s+o,c+v),N=c+(v+p)/2,c=N,s=s+o;if(g===4)for(;s<=l;)v=o*f(s,c),p=o*f(s+o/2,c+v/2),w=o*f(s+o/2,c+p/2),E=o*f(s+o,c+w),N=c+(v+2*p+2*w+E)/6,c=N,s=s+o;return c},romberg:function(f,o,l,s){for(var c=0,g=(l-o)/2,v=[],p=[],N=[],w,E,y,R,I;c<s/2;){for(I=f(o),y=o,R=0;y<=l;y=y+g,R++)v[R]=y;for(w=v.length,y=1;y<w-1;y++)I+=(y%2!==0?4:2)*f(v[y]);I=g/3*(I+f(l)),N[c]=I,g/=2,c++}for(E=N.length,w=1;E!==1;){for(y=0;y<E-1;y++)p[y]=(i.pow(4,w)*N[y+1]-N[y])/(i.pow(4,w)-1);E=p.length,N=p,p=[],w++}return N},richardson:function(f,o,l,s){function c(S,T){for(var M=0,V=S.length,G;M<V;M++)S[M]===T&&(G=M);return G}for(var g=i.abs(l-f[c(f,l)+1]),v=0,p=[],N=[],w,E,y,R,I;s>=g;)w=c(f,l+s),E=c(f,l),p[v]=(o[w]-2*o[E]+o[2*E-w])/(s*s),s/=2,v++;for(R=p.length,y=1;R!=1;){for(I=0;I<R-1;I++)N[I]=(i.pow(4,y)*p[I+1]-p[I])/(i.pow(4,y)-1);R=N.length,p=N,N=[],y++}return p},simpson:function(f,o,l,s){for(var c=(l-o)/s,g=f(o),v=[],p=o,N=0,w=1,E;p<=l;p=p+c,N++)v[N]=p;for(E=v.length;w<E-1;w++)g+=(w%2!==0?4:2)*f(v[w]);return c/3*(g+f(l))},hermite:function(f,o,l,s){for(var c=f.length,g=0,v=0,p=[],N=[],w=[],E=[],y;v<c;v++){for(p[v]=1,y=0;y<c;y++)v!=y&&(p[v]*=(s-f[y])/(f[v]-f[y]));for(N[v]=0,y=0;y<c;y++)v!=y&&(N[v]+=1/(f[v]-f[y]));w[v]=(1-2*(s-f[v])*N[v])*(p[v]*p[v]),E[v]=(s-f[v])*(p[v]*p[v]),g+=w[v]*o[v]+E[v]*l[v]}return g},lagrange:function(f,o,l){for(var s=0,c=0,g,v,p=f.length;c<p;c++){for(v=o[c],g=0;g<p;g++)c!=g&&(v*=(l-f[g])/(f[c]-f[g]));s+=v}return s},cubic_spline:function(f,o,l){for(var s=f.length,c=0,g,v=[],p=[],N=[],w=[],E=[],y=[],R=[];c<s-1;c++)E[c]=f[c+1]-f[c];for(N[0]=0,c=1;c<s-1;c++)N[c]=3/E[c]*(o[c+1]-o[c])-3/E[c-1]*(o[c]-o[c-1]);for(c=1;c<s-1;c++)v[c]=[],p[c]=[],v[c][c-1]=E[c-1],v[c][c]=2*(E[c-1]+E[c]),v[c][c+1]=E[c],p[c][0]=N[c];for(w=t.multiply(t.inv(v),p),g=0;g<s-1;g++)y[g]=(o[g+1]-o[g])/E[g]-E[g]*(w[g+1][0]+2*w[g][0])/3,R[g]=(w[g+1][0]-w[g][0])/(3*E[g]);for(g=0;g<s&&!(f[g]>l);g++);return g-=1,o[g]+(l-f[g])*y[g]+t.sq(l-f[g])*w[g]+(l-f[g])*t.sq(l-f[g])*R[g]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(f){var o=f.length,l=f[0].length,s=0,c,g,v=[],p=[],N=[],w=[],E=[],y=[],R=[],I=[],S=[],T=[];for(s=0;s<o;s++)v[s]=t.sum(f[s])/l;for(s=0;s<l;s++)for(R[s]=[],c=0;c<o;c++)R[s][c]=f[c][s]-v[c];for(R=t.transpose(R),s=0;s<o;s++)for(I[s]=[],c=0;c<o;c++)I[s][c]=t.dot([R[s]],[R[c]])/(l-1);for(N=t.jacobi(I),S=N[0],p=N[1],T=t.transpose(S),s=0;s<p.length;s++)for(c=s;c<p.length;c++)p[s]<p[c]&&(g=p[s],p[s]=p[c],p[c]=g,w=T[s],T[s]=T[c],T[c]=w);for(y=t.transpose(R),s=0;s<o;s++)for(E[s]=[],c=0;c<y.length;c++)E[s][c]=t.dot([T[s]],[y[c]]);return[f,p,T,E]}}),function(d){for(var f=0;f<d.length;f++)(function(o){t.fn[o]=function(l,s){var c=this;return s?(setTimeout(function(){s.call(c,t.fn[o].call(c,l))},15),this):typeof t[o](this,l)=="number"?t[o](this,l):t(t[o](this,l))}})(d[f])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(r,Math),function(t,i){var u=[].slice,a=t.utils.isNumber,h=t.utils.isArray;t.extend({zscore:function(){var o=u.call(arguments);return a(o[1])?(o[0]-o[1])/o[2]:(o[0]-t.mean(o[1]))/t.stdev(o[1],o[2])},ztest:function(){var o=u.call(arguments),l;return h(o[1])?(l=t.zscore(o[0],o[1],o[3]),o[2]===1?t.normal.cdf(-i.abs(l),0,1):t.normal.cdf(-i.abs(l),0,1)*2):o.length>2?(l=t.zscore(o[0],o[1],o[2]),o[3]===1?t.normal.cdf(-i.abs(l),0,1):t.normal.cdf(-i.abs(l),0,1)*2):(l=o[0],o[1]===1?t.normal.cdf(-i.abs(l),0,1):t.normal.cdf(-i.abs(l),0,1)*2)}}),t.extend(t.fn,{zscore:function(o,l){return(o-this.mean())/this.stdev(l)},ztest:function(o,l,s){var c=i.abs(this.zscore(o,s));return l===1?t.normal.cdf(-c,0,1):t.normal.cdf(-c,0,1)*2}}),t.extend({tscore:function(){var o=u.call(arguments);return o.length===4?(o[0]-o[1])/(o[2]/i.sqrt(o[3])):(o[0]-t.mean(o[1]))/(t.stdev(o[1],!0)/i.sqrt(o[1].length))},ttest:function(){var o=u.call(arguments),l;return o.length===5?(l=i.abs(t.tscore(o[0],o[1],o[2],o[3])),o[4]===1?t.studentt.cdf(-l,o[3]-1):t.studentt.cdf(-l,o[3]-1)*2):a(o[1])?(l=i.abs(o[0]),o[2]==1?t.studentt.cdf(-l,o[1]-1):t.studentt.cdf(-l,o[1]-1)*2):(l=i.abs(t.tscore(o[0],o[1])),o[2]==1?t.studentt.cdf(-l,o[1].length-1):t.studentt.cdf(-l,o[1].length-1)*2)}}),t.extend(t.fn,{tscore:function(o){return(o-this.mean())/(this.stdev(!0)/i.sqrt(this.cols()))},ttest:function(o,l){return l===1?1-t.studentt.cdf(i.abs(this.tscore(o)),this.cols()-1):t.studentt.cdf(-i.abs(this.tscore(o)),this.cols()-1)*2}}),t.extend({anovafscore:function(){var o=u.call(arguments),l,s,c,g,v,p,N,w;if(o.length===1){for(v=new Array(o[0].length),N=0;N<o[0].length;N++)v[N]=o[0][N];o=v}for(s=new Array,N=0;N<o.length;N++)s=s.concat(o[N]);for(c=t.mean(s),l=0,N=0;N<o.length;N++)l=l+o[N].length*i.pow(t.mean(o[N])-c,2);for(l/=o.length-1,p=0,N=0;N<o.length;N++)for(g=t.mean(o[N]),w=0;w<o[N].length;w++)p+=i.pow(o[N][w]-g,2);return p/=s.length-o.length,l/p},anovaftest:function(){var o=u.call(arguments),l,s,c,g;if(a(o[0]))return 1-t.centralF.cdf(o[0],o[1],o[2]);var v=t.anovafscore(o);for(l=o.length-1,c=0,g=0;g<o.length;g++)c=c+o[g].length;return s=c-l-1,1-t.centralF.cdf(v,l,s)},ftest:function(o,l,s){return 1-t.centralF.cdf(o,l,s)}}),t.extend(t.fn,{anovafscore:function(){return t.anovafscore(this.toArray())},anovaftes:function(){var o=0,l;for(l=0;l<this.length;l++)o=o+this[l].length;return t.ftest(this.anovafscore(),this.length-1,o-this.length)}}),t.extend({qscore:function(){var o=u.call(arguments),l,s,c,g,v;return a(o[0])?(l=o[0],s=o[1],c=o[2],g=o[3],v=o[4]):(l=t.mean(o[0]),s=t.mean(o[1]),c=o[0].length,g=o[1].length,v=o[2]),i.abs(l-s)/(v*i.sqrt((1/c+1/g)/2))},qtest:function(){var o=u.call(arguments),l;o.length===3?(l=o[0],o=o.slice(1)):o.length===7?(l=t.qscore(o[0],o[1],o[2],o[3],o[4]),o=o.slice(5)):(l=t.qscore(o[0],o[1],o[2]),o=o.slice(3));var s=o[0],c=o[1];return 1-t.tukey.cdf(l,c,s-c)},tukeyhsd:function(o){for(var l=t.pooledstdev(o),s=o.map(function(w){return t.mean(w)}),c=o.reduce(function(w,E){return w+E.length},0),g=[],v=0;v<o.length;++v)for(var p=v+1;p<o.length;++p){var N=t.qtest(s[v],s[p],o[v].length,o[p].length,l,c,o.length);g.push([[v,p],N])}return g}}),t.extend({normalci:function(){var o=u.call(arguments),l=new Array(2),s;return o.length===4?s=i.abs(t.normal.inv(o[1]/2,0,1)*o[2]/i.sqrt(o[3])):s=i.abs(t.normal.inv(o[1]/2,0,1)*t.stdev(o[2])/i.sqrt(o[2].length)),l[0]=o[0]-s,l[1]=o[0]+s,l},tci:function(){var o=u.call(arguments),l=new Array(2),s;return o.length===4?s=i.abs(t.studentt.inv(o[1]/2,o[3]-1)*o[2]/i.sqrt(o[3])):s=i.abs(t.studentt.inv(o[1]/2,o[2].length-1)*t.stdev(o[2],!0)/i.sqrt(o[2].length)),l[0]=o[0]-s,l[1]=o[0]+s,l},significant:function(o,l){return o<l}}),t.extend(t.fn,{normalci:function(o,l){return t.normalci(o,l,this.toArray())},tci:function(o,l){return t.tci(o,l,this.toArray())}});function d(f,o,l,s){if(f>1||l>1||f<=0||l<=0)throw new Error("Proportions should be greater than 0 and less than 1");var c=(f*o+l*s)/(o+s),g=i.sqrt(c*(1-c)*(1/o+1/s));return(f-l)/g}t.extend(t.fn,{oneSidedDifferenceOfProportions:function(o,l,s,c){var g=d(o,l,s,c);return t.ztest(g,1)},twoSidedDifferenceOfProportions:function(o,l,s,c){var g=d(o,l,s,c);return t.ztest(g,2)}})}(r,Math),r.models=function(){function t(d){var f=d[0].length,o=r.arange(f).map(function(l){var s=r.arange(f).filter(function(c){return c!==l});return i(r.col(d,l).map(function(c){return c[0]}),r.col(d,s))});return o}function i(d,f){var o=d.length,l=f[0].length-1,s=o-l-1,c=r.lstsq(f,d),g=r.multiply(f,c.map(function(R){return[R]})).map(function(R){return R[0]}),v=r.subtract(d,g),p=r.mean(d),N=r.sum(g.map(function(R){return Math.pow(R-p,2)})),w=r.sum(d.map(function(R,I){return Math.pow(R-g[I],2)})),E=N+w,y=N/E;return{exog:f,endog:d,nobs:o,df_model:l,df_resid:s,coef:c,predict:g,resid:v,ybar:p,SST:E,SSE:N,SSR:w,R2:y}}function u(d){var f=t(d.exog),o=Math.sqrt(d.SSR/d.df_resid),l=f.map(function(p){var N=p.SST,w=p.R2;return o/Math.sqrt(N*(1-w))}),s=d.coef.map(function(p,N){return(p-0)/l[N]}),c=s.map(function(p){var N=r.studentt.cdf(p,d.df_resid);return(N>.5?1-N:N)*2}),g=r.studentt.inv(.975,d.df_resid),v=d.coef.map(function(p,N){var w=g*l[N];return[p-w,p+w]});return{se:l,t:s,p:c,sigmaHat:o,interval95:v}}function a(d){var f=d.R2/d.df_model/((1-d.R2)/d.df_resid),o=function(s,c,g){return r.beta.cdf(s/(g/c+s),c/2,g/2)},l=1-o(f,d.df_model,d.df_resid);return{F_statistic:f,pvalue:l}}function h(d,f){var o=i(d,f),l=u(o),s=a(o),c=1-(1-o.R2)*((o.nobs-1)/o.df_resid);return o.t=l,o.f=s,o.adjust_R2=c,o}return{ols:h}}(),r.extend({buildxmatrix:function(){for(var i=new Array(arguments.length),u=0;u<arguments.length;u++){var a=[1];i[u]=a.concat(arguments[u])}return r(i)},builddxmatrix:function(){for(var i=new Array(arguments[0].length),u=0;u<arguments[0].length;u++){var a=[1];i[u]=a.concat(arguments[0][u])}return r(i)},buildjxmatrix:function(i){for(var u=new Array(i.length),a=0;a<i.length;a++)u[a]=i[a];return r.builddxmatrix(u)},buildymatrix:function(i){return r(i).transpose()},buildjymatrix:function(i){return i.transpose()},matrixmult:function(i,u){var a,h,d,f,o;if(i.cols()==u.rows()){if(u.rows()>1){for(f=[],a=0;a<i.rows();a++)for(f[a]=[],h=0;h<u.cols();h++){for(o=0,d=0;d<i.cols();d++)o+=i.toArray()[a][d]*u.toArray()[d][h];f[a][h]=o}return r(f)}for(f=[],a=0;a<i.rows();a++)for(f[a]=[],h=0;h<u.cols();h++){for(o=0,d=0;d<i.cols();d++)o+=i.toArray()[a][d]*u.toArray()[h];f[a][h]=o}return r(f)}},regress:function(i,u){var a=r.xtranspxinv(i),h=i.transpose(),d=r.matrixmult(r(a),h);return r.matrixmult(d,u)},regresst:function(i,u,a){var h=r.regress(i,u),d={};d.anova={};var f=r.jMatYBar(i,h);d.yBar=f;var o=u.mean();d.anova.residuals=r.residuals(u,f),d.anova.ssr=r.ssr(f,o),d.anova.msr=d.anova.ssr/(i[0].length-1),d.anova.sse=r.sse(u,f),d.anova.mse=d.anova.sse/(u.length-(i[0].length-1)-1),d.anova.sst=r.sst(u,o),d.anova.mst=d.anova.sst/(u.length-1),d.anova.r2=1-d.anova.sse/d.anova.sst,d.anova.r2<0&&(d.anova.r2=0),d.anova.fratio=d.anova.msr/d.anova.mse,d.anova.pvalue=r.anovaftest(d.anova.fratio,i[0].length-1,u.length-(i[0].length-1)-1),d.anova.rmse=Math.sqrt(d.anova.mse),d.anova.r2adj=1-d.anova.mse/d.anova.mst,d.anova.r2adj<0&&(d.anova.r2adj=0),d.stats=new Array(i[0].length);for(var l=r.xtranspxinv(i),s,c,g,v=0;v<h.length;v++)s=Math.sqrt(d.anova.mse*Math.abs(l[v][v])),c=Math.abs(h[v]/s),g=r.ttest(c,u.length-i[0].length-1,a),d.stats[v]=[h[v],s,c,g];return d.regress=h,d},xtranspx:function(i){return r.matrixmult(i.transpose(),i)},xtranspxinv:function(i){var u=r.matrixmult(i.transpose(),i),a=r.inv(u);return a},jMatYBar:function(i,u){var a=r.matrixmult(i,u);return new r(a)},residuals:function(i,u){return r.matrixsubtract(i,u)},ssr:function(i,u){for(var a=0,h=0;h<i.length;h++)a+=Math.pow(i[h]-u,2);return a},sse:function(i,u){for(var a=0,h=0;h<i.length;h++)a+=Math.pow(i[h]-u[h],2);return a},sst:function(i,u){for(var a=0,h=0;h<i.length;h++)a+=Math.pow(i[h]-u,2);return a},matrixsubtract:function(i,u){for(var a=new Array(i.length),h=0;h<i.length;h++){a[h]=new Array(i[h].length);for(var d=0;d<i[h].length;d++)a[h][d]=i[h][d]-u[h][d]}return r(a)}}),r.jStat=r,r})}(it)),it.exports}var Is=Ts();const K=Vr(Is);var Bt={},Wo;function Os(){return Wo||(Wo=1,function(n){(function(e){e(typeof DO_NOT_EXPORT_BESSEL>"u"?n:{})})(function(e){e.version="1.0.2";var r=Math;function t(o,l){for(var s=0,c=0;s<o.length;++s)c=l*c+o[s];return c}function i(o,l,s,c,g){if(l===0)return s;if(l===1)return c;for(var v=2/o,p=c,N=1;N<l;++N)p=c*N*v+g*s,s=c,c=p;return p}function u(o,l,s,c,g){return function(p,N){if(c){if(p===0)return c==1?-1/0:1/0;if(p<0)return NaN}if(N===0)return o(p);if(N===1)return l(p);if(N<0)return NaN;N|=0;var w=o(p),E=l(p);return i(p,N,w,E,g)}}var a=function(){var o=.636619772,l=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),s=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),c=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),g=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function v(R){var I=0,S=0,T=0,M=R*R;if(R<8)S=t(l,M),T=t(s,M),I=S/T;else{var V=R-.785398164;M=64/M,S=t(c,M),T=t(g,M),I=r.sqrt(o/R)*(r.cos(V)*S-r.sin(V)*T*8/R)}return I}var p=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),N=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),w=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),E=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function y(R){var I=0,S=0,T=0,M=R*R,V=r.abs(R)-2.356194491;return Math.abs(R)<8?(S=R*t(p,M),T=t(N,M),I=S/T):(M=64/M,S=t(w,M),T=t(E,M),I=r.sqrt(o/r.abs(R))*(r.cos(V)*S-r.sin(V)*T*8/r.abs(R)),R<0&&(I=-I)),I}return function R(I,S){if(S=Math.round(S),!isFinite(I))return isNaN(I)?I:0;if(S<0)return(S%2?-1:1)*R(I,-S);if(I<0)return(S%2?-1:1)*R(-I,S);if(S===0)return v(I);if(S===1)return y(I);if(I===0)return 0;var T=0;if(I>S)T=i(I,S,v(I),y(I),-1);else{for(var M=2*r.floor((S+r.floor(r.sqrt(40*S)))/2),V=!1,G=0,nn=0,X=1,Q=0,Nn=2/I,yn=M;yn>0;yn--)Q=yn*Nn*X-G,G=X,X=Q,r.abs(X)>1e10&&(X*=1e-10,G*=1e-10,T*=1e-10,nn*=1e-10),V&&(nn+=X),V=!V,yn==S&&(T=G);nn=2*nn-X,T/=nn}return T}}(),h=function(){var o=.636619772,l=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),s=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),c=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),g=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse();function v(R){var I=0,S=0,T=0,M=R*R,V=R-.785398164;return R<8?(S=t(l,M),T=t(s,M),I=S/T+o*a(R,0)*r.log(R)):(M=64/M,S=t(c,M),T=t(g,M),I=r.sqrt(o/R)*(r.sin(V)*S+r.cos(V)*T*8/R)),I}var p=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),N=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),w=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),E=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function y(R){var I=0,S=0,T=0,M=R*R,V=R-2.356194491;return R<8?(S=R*t(p,M),T=t(N,M),I=S/T+o*(a(R,1)*r.log(R)-1/R)):(M=64/M,S=t(w,M),T=t(E,M),I=r.sqrt(o/R)*(r.sin(V)*S+r.cos(V)*T*8/R)),I}return u(v,y,"BESSELY",1,-1)}(),d=function(){var o=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),l=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function s(p){return p<=3.75?t(o,p*p/(3.75*3.75)):r.exp(r.abs(p))/r.sqrt(r.abs(p))*t(l,3.75/r.abs(p))}var c=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),g=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function v(p){return p<3.75?p*t(c,p*p/(3.75*3.75)):(p<0?-1:1)*r.exp(r.abs(p))/r.sqrt(r.abs(p))*t(g,3.75/r.abs(p))}return function p(N,w){if(w=Math.round(w),w===0)return s(N);if(w===1)return v(N);if(w<0)return NaN;if(r.abs(N)===0)return 0;if(N==1/0)return 1/0;var E=0,y,R=2/r.abs(N),I=0,S=1,T=0,M=2*r.round((w+r.round(r.sqrt(40*w)))/2);for(y=M;y>0;y--)T=y*R*S+I,I=S,S=T,r.abs(S)>1e10&&(S*=1e-10,I*=1e-10,E*=1e-10),y==w&&(E=I);return E*=p(N,0)/S,N<0&&w%2?-E:E}}(),f=function(){var o=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),l=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function s(p){return p<=2?-r.log(p/2)*d(p,0)+t(o,p*p/4):r.exp(-p)/r.sqrt(p)*t(l,2/p)}var c=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),g=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function v(p){return p<=2?r.log(p/2)*d(p,1)+1/p*t(c,p*p/4):r.exp(-p)/r.sqrt(p)*t(g,2/p)}return u(s,v,"BESSELK",2,1)}();e.besselj=a,e.bessely=h,e.besseli=d,e.besselk=f})}(Bt)),Bt}var Ss=Os();const pt=Vr(Ss),mi=new Error("#NULL!"),Kn=new Error("#DIV/0!"),k=new Error("#VALUE!"),Tr=new Error("#REF!"),Et=new Error("#NAME?"),J=new Error("#NUM!"),un=new Error("#N/A"),Ai=new Error("#ERROR!"),qu=new Error("#GETTING_DATA");var ks=Object.freeze({__proto__:null,data:qu,div0:Kn,error:Ai,na:un,name:Et,nil:mi,num:J,ref:Tr,value:k});let Pe=!1;function Ms(){Pe=!0}function Cs(){Pe=!1}function Hu(n){n<60&&(n+=1);const r=Math.floor(n-25569)*86400,t=new Date(r*1e3),i=n-Math.floor(n)+1e-7;let u=Math.floor(86400*i);const a=u%60;u-=a;const h=Math.floor(u/(60*60)),d=Math.floor(u/60)%60;let f=t.getUTCDate(),o=t.getUTCMonth();return n>=60&&n<61&&(f=29,o=1),new Date(t.getUTCFullYear(),o,f,h,d,a)}function Le(n){const e=new Date(1900,0,1),r=n>-22038912e5?2:1;return Math.ceil((n-e)/864e5)+r}var Ls=Object.freeze({__proto__:null,dateToSerial:Le,get returnSerial(){return Pe},serialToDate:Hu,useDate:Cs,useSerial:Ms});const Ds="=",Ps=[">",">=","<","<=","=","<>"],$u="operator",bu="literal",xs=[$u,bu],ot=$u,$e=bu;function Me(n,e){if(xs.indexOf(e)===-1)throw new Error("Unsupported token type: "+e);return{value:n,type:e}}function Us(n){return typeof n!="string"||/^\d+(\.\d+)?$/.test(n)&&(n=n.indexOf(".")===-1?parseInt(n,10):parseFloat(n)),n}function Fs(n){const e=n.length,r=[];let t=0,i="",u="";for(;t<e;){const a=n.charAt(t);switch(a){case">":case"<":case"=":u=u+a,i.length>0&&(r.push(i),i="");break;default:u.length>0&&(r.push(u),u=""),i=i+a;break}t++}return i.length>0&&r.push(i),u.length>0&&r.push(u),r}function Bs(n){let e="";const r=[];for(let t=0;t<n.length;t++){const i=n[t];t===0&&Ps.indexOf(i)>=0?r.push(Me(i,ot)):e+=i}return e.length>0&&r.push(Me(Us(e),$e)),r.length>0&&r[0].type!==ot&&r.unshift(Me(Ds,ot)),r}function Js(n){const e=[];let r;for(let t=0;t<n.length;t++){const i=n[t];switch(i.type){case ot:r=i.value;break;case $e:e.push(i.value);break}}return Vs(e,r)}function Vs(n,e){let r=!1;switch(e){case">":r=n[0]>n[1];break;case">=":r=n[0]>=n[1];break;case"<":r=n[0]<n[1];break;case"<=":r=n[0]<=n[1];break;case"=":r=n[0]==n[1];break;case"<>":r=n[0]!=n[1];break}return r}function Ir(n){return Bs(Fs(n))}const Or=Js;function Nt(n){const e=[];return ne(n,r=>{e.push(r)}),e}function ne(n,e){let r=-1;const t=n.length;for(;++r<t&&e(n[r],r,n)!==!1;);return n}function Ri(n){let e=n.length,r;for(;e--;)if(r=n[e],typeof r!="number"){if(r===!0){n[e]=1;continue}if(r===!1){n[e]=0;continue}if(typeof r=="string"){const t=A(r);n[e]=t instanceof Error?0:t}}return n}function Gu(n,e){if(!n)return k;(!n.every(i=>Array.isArray(i))||n.length===0)&&(n=[[...n]]),n.map((i,u)=>{i.map((a,h)=>{a||(n[u][h]=0)})});const r=n.reduce((i,u,a)=>u.length>n[i].length?a:i,0),t=n[r].length;return n.map(i=>[...i,...Array(t-i.length).fill(0)])}function b(){let n;if(arguments.length===1){const e=arguments[0];n=Hs(e)?Nt.apply(null,arguments):[e]}else n=Array.from(arguments);for(;!$s(n);)n=di(n);return n}function di(n){return!n||!n.reduce?[n]:n.reduce((e,r)=>{const t=Array.isArray(e),i=Array.isArray(r);return t&&i?e.concat(r):t?(e.push(r),e):i?[e].concat(r):[e,r]})}function qs(n,e){return e=e||1,!n||typeof n.slice!="function"?n:n.slice(0,n.length-e)}function Hs(n){return n!=null&&typeof n.length=="number"&&typeof n!="string"}function $s(n){if(!n)return!1;for(let e=0;e<n.length;++e)if(Array.isArray(n[e]))return!1;return!0}function Fn(n,e){return e=e||1,!n||typeof n.slice!="function"?n:n.slice(e)}function ft(n){return n?n[0].map((e,r)=>n.map(t=>t[r])):k}function he(n,e){let r=null;return ne(n,(t,i)=>{if(t[0]===e)return r=i,!1}),r??k}function gn(){for(let n=0;n<arguments.length;n++)if(arguments[n]instanceof Error)return arguments[n]}function $(){let n=arguments.length;for(;n--;)if(arguments[n]instanceof Error)return!0;return!1}function Wu(n){return Math.round(n*1e14)/1e14}function xe(){return b.apply(null,arguments).filter(e=>typeof e=="number")}function Ti(n){if(typeof n=="boolean"||n instanceof Error)return n;if(typeof n=="number")return n!==0;if(typeof n=="string"){const e=n.toUpperCase();if(e==="TRUE")return!0;if(e==="FALSE")return!1}return n instanceof Date&&!isNaN(n)?!0:k}function pn(n){if(!isNaN(n)){if(n instanceof Date)return new Date(n);const e=parseFloat(n);return e<0||e>=2958466?J:Hu(e)}return typeof n=="string"&&(n=/(\d{4})-(\d\d?)-(\d\d?)$/.test(n)?new Date(n+"T00:00:00.000"):new Date(n),!isNaN(n))?n:k}function Xu(n){let e=n.length,r;for(;e--;){if(r=pn(n[e]),r===k)return r;n[e]=r}return n}function A(n){return n instanceof Error?n:n==null?0:(typeof n=="boolean"&&(n=+n),!isNaN(n)&&n!==""?parseFloat(n):k)}function j(n){let e;if(!n||(e=n.length)===0)return k;let r;for(;e--;){if(n[e]instanceof Error)return n[e];if(r=A(n[e]),r instanceof Error)return r;n[e]=r}return n}function $n(n){return n instanceof Error?n:n==null?"":n.toString()}function wt(){let n=arguments.length;for(;n--;)if(typeof arguments[n]=="string")return!0;return!1}function yt(){const n=Nt(arguments),e=j(b(n.shift()));if(e instanceof Error)return e;const r=n,t=r.length/2;for(let u=0;u<t;u++)r[u*2]=b(r[u*2]);let i=[];for(let u=0;u<e.length;u++){let a=!1;for(let h=0;h<t;h++){const d=r[h*2][u],f=r[h*2+1],o=f===void 0||f==="*";let l=!1;if(o)l=!0;else{const s=Ir(f+""),c=[Me(d,$e)].concat(s);l=Or(c)}if(!l){a=!1;break}a=!0}a&&i.push(e[u])}return i}function Qe(n){return n!=null}const zu={};zu.TYPE=n=>{switch(n){case mi:return 1;case Kn:return 2;case k:return 3;case Tr:return 4;case Et:return 5;case J:return 6;case un:return 7;case qu:return 8}return un};function bs(n){return n===null}function Yu(n){return[k,Tr,Kn,J,Et,mi].indexOf(n)>=0||typeof n=="number"&&(isNaN(n)||!isFinite(n))}function mt(n){return Yu(n)||n===un}function Gs(n){return!(Math.floor(Math.abs(n))&1)}function Zu(n){return n===!0||n===!1}function Ws(n){return n===un}function Xs(n){return typeof n!="string"}function At(n){return typeof n=="number"&&!isNaN(n)&&isFinite(n)}function zs(n){return!!(Math.floor(Math.abs(n))&1)}function Ku(n){return typeof n=="string"}function Ys(n){return At(n)?n:n instanceof Date?n.getTime():n===!0?1:n===!1?0:mt(n)?n:0}function Zs(){return un}function Ks(n){if(At(n))return 1;if(Ku(n))return 2;if(Zu(n))return 4;if(mt(n))return 16;if(Array.isArray(n))return 64}function Qs(){if(arguments.length<2)return un;const n=arguments[0];return n<1||n>254||arguments.length<n+1?k:arguments[n]}function _s(n,e){if(arguments.length!==2)return un;if(e<0)return J;if(!(n instanceof Array)||typeof e!="number")return k;if(n.length!==0)return K.col(n,e)}function js(n){return arguments.length!==1?un:n instanceof Array?n.length===0?0:K.cols(n):k}function nc(n,e,r,t){return Qu(n,ft(e),r,t)}function ec(n,e,r){const t=gn(n,e,r);if(t)return t;if(!Array.isArray(n))return k;const i=n.length>0&&!Array.isArray(n[0]);return i&&!r?(r=e,e=1):(r=r||1,e=e||1),r<0||e<0?k:i&&e===1&&r<=n.length?n[r-1]:e<=n.length&&r<=n[e-1].length?n[e-1][r-1]:Tr}function rc(n,e,r){e=b(e),r=r?b(r):e;const t=typeof n=="number";let i=un;for(let u=0;u<e.length;u++){if(e[u]===n)return r[u];if(t&&e[u]<=n||typeof e[u]=="string"&&e[u].localeCompare(n)<0)i=r[u];else if(t&&e[u]>n)return i}return i}function tc(n,e,r){if(!n&&n!==0||!e||(arguments.length===2&&(r=1),e=b(e),!(e instanceof Array))||r!==-1&&r!==0&&r!==1)return un;let t,i;for(let u=0;u<e.length;u++)if(r===1){if(e[u]===n)return u+1;e[u]<n&&(i?e[u]>i&&(t=u+1,i=e[u]):(t=u+1,i=e[u]))}else if(r===0){if(typeof n=="string"&&typeof e[u]=="string"){const a=n.toLowerCase().replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\").replace(/\+/g,"\\+").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\[/g,"\\[").replace(/\]/g,"\\]");if(new RegExp("^"+a+"$").test(e[u].toLowerCase()))return u+1}else if(e[u]===n)return u+1}else if(r===-1){if(e[u]===n)return u+1;e[u]>n&&(i?e[u]<i&&(t=u+1,i=e[u]):(t=u+1,i=e[u]))}return t||un}function ic(n){return arguments.length!==1?un:n instanceof Array?n.length===0?0:K.rows(n):k}function oc(n,e=1,r=1,t=!1){if(!n||!Array.isArray(n))return un;if(n.length===0)return 0;if(e=A(e),!e||e<1||(r=A(r),r!==1&&r!==-1))return k;if(t=Ti(t),typeof t!="boolean")return Et;const i=h=>h.sort((d,f)=>(d=$n(d[e-1]),f=$n(f[e-1]),r===1?d<f?r*-1:r:d>f?r:r*-1)),u=Gu(n),a=t?ft(u):u;return e>=1&&e<=a[0].length?t?ft(i(a)):i(a):k}function uc(n){if(!n)return un;const e=Gu(n);return ft(e)}function Ii(){const n=[];for(let e=0;e<arguments.length;++e){let r=!1;const t=arguments[e];for(let i=0;i<n.length&&(r=n[i]===t,!r);++i);r||n.push(t)}return n}function Qu(n,e,r,t){if(!e||!r)return un;t=!(t===0||t===!1);let i=un,u=!1;const a=typeof n=="number",h=typeof n=="string"?n.toLowerCase():n;for(let d=0;d<e.length;d++){const f=e[d],o=typeof f[0]=="string"?f[0].toLowerCase():f[0];if(o===h){i=r<f.length+1?f[r-1]:Tr;break}else!u&&(a&&t&&o<=n||t&&typeof o=="string"&&o.localeCompare(n)<0)&&(i=r<f.length+1?f[r-1]:Tr);a&&o>n&&(u=!0)}return i}function _u(n){return n=A(n),n===0?k:n instanceof Error?n:String.fromCharCode(n)}function lc(n){if($(n))return n;n=n||"";const e=/[\0-\x1F]/g;return n.replace(e,"")}function ju(n){if($(n))return n;n=n||"";let e=n.charCodeAt(0);return isNaN(e)&&(e=k),e}function nl(){const n=b(arguments),e=gn.apply(void 0,n);if(e)return e;let r=0;for(;(r=n.indexOf(!0))>-1;)n[r]="TRUE";let t=0;for(;(t=n.indexOf(!1))>-1;)n[t]="FALSE";return n.join("")}const fc=nl;function sc(n,e=2){if(n=A(n),isNaN(n))return k;n=hl(n,e);const r={style:"currency",currency:"USD",minimumFractionDigits:e>=0?e:0,maximumFractionDigits:e>=0?e:0},t=n.toLocaleString("en-US",r);return n<0?"$("+t.slice(2)+")":t}function cc(n,e){if(arguments.length!==2)return un;const r=gn(n,e);return r||(n=$n(n),e=$n(e),n===e)}function ac(n,e,r){if(arguments.length<2)return un;n=$n(n),e=$n(e),r=r===void 0?0:r;const t=e.indexOf(n,r-1);return t===-1?k:t+1}function el(n,e=2,r=!1){if(n=A(n),isNaN(n)||(e=A(e),isNaN(e)))return k;if(e<0){const t=Math.pow(10,-e);n=Math.round(n/t)*t}else n=n.toFixed(e);if(r)n=n.toString().replace(/,/g,"");else{const t=n.toString().split(".");t[0]=t[0].replace(/\B(?=(\d{3})+$)/g,","),n=t.join(".")}return n}function hc(n,e){const r=gn(n,e);return r||(n=$n(n),e=e===void 0?1:e,e=A(e),e instanceof Error||typeof n!="string"?k:n.substring(0,e))}function dc(n){return arguments.length===0?Ai:n instanceof Error?n:Array.isArray(n)?k:$n(n).length}function gc(n){return arguments.length!==1?k:(n=$n(n),$(n)?n:n.toLowerCase())}function vc(n,e,r){if(e==null)return k;if(e=A(e),r=A(r),$(e,r)||typeof n!="string")return r;const t=e-1,i=t+r;return n.substring(t,i)}function pc(n,e,r){return n=Qe(n)?n:"",typeof n=="number"?n:typeof n!="string"?un:(e=typeof e>"u"?".":e,r=typeof r>"u"?",":r,Number(n.replace(e,".").replace(r,"")))}function Ec(n){return $(n)?n:isNaN(n)&&typeof n=="number"?k:(n=$n(n),n.replace(/\w\S*/g,e=>e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()))}function Nc(n,e,r,t){return e=A(e),r=A(r),$(e,r)||typeof n!="string"||typeof t!="string"?k:n.substr(0,e-1)+t+n.substr(e-1+r)}function se(n,e){const r=gn(n,e);return r||(n=$n(n),e=A(e),e instanceof Error?e:new Array(e+1).join(n))}function wc(n,e){const r=gn(n,e);return r||(n=$n(n),e=e===void 0?1:e,e=A(e),e instanceof Error?e:n.substring(n.length-e))}function yc(n,e,r){let t;return typeof n!="string"||typeof e!="string"?k:(r=r===void 0?0:r,t=e.toLowerCase().indexOf(n.toLowerCase(),r-1)+1,t===0?k:t)}function mc(n,e,r,t){if(arguments.length<3)return un;if(!n||!e)return n;if(t===void 0)return n.split(e).join(r);{if(t=Math.floor(Number(t)),Number.isNaN(t)||t<=0)return k;let i=0,u=0;for(;i>-1&&n.indexOf(e,i)>-1;)if(i=n.indexOf(e,i+1),u++,i>-1&&u===t)return n.substring(0,i)+r+n.substring(i+e.length);return n}}function ue(n){return n instanceof Error||typeof n=="string"?n:""}function Ac(n,e){if(n===void 0||n instanceof Error||e instanceof Error)return un;if(n instanceof Date)return n.toISOString().slice(0,10);if(e==null)return"";if(typeof e=="number")return String(e);if(typeof e!="string")return k;const r=e.startsWith("$")?"$":"",t=e.endsWith("%");e=e.replace(/%/g,"").replace(/\$/g,"");const i=e.includes(".")?e.split(".")[1].match(/0/g).length:0,u=!e.includes(",");return t&&(n=n*100),n=el(n,i,u),n.startsWith("-")?(n=n.replace("-",""),n="-"+r+n):n=r+n,t&&(n=n+"%"),n}function Rc(n,e,...r){if(typeof e!="boolean"&&(e=Ti(e)),arguments.length<3)return un;n=n??"";let t=b(r),i=e?t.filter(u=>u):t;if(Array.isArray(n)){n=b(n);let u=i.map(h=>[h]),a=0;for(let h=0;h<u.length-1;h++)u[h].push(n[a]),a++,a===n.length&&(a=0);return i=b(u),i.join("")}return i.join(n)}function Tc(n){return n=$n(n),n instanceof Error?n:n.replace(/\s+/g," ").trim()}const Ic=_u,Oc=ju;function Sc(n){return n=$n(n),n instanceof Error?n:n.toUpperCase()}function kc(n){const e=gn(n);if(e)return e;if(typeof n=="number")return n;if(Qe(n)||(n=""),typeof n!="string")return k;const r=/(%)$/.test(n)||/^(%)/.test(n);if(n=n.replace(/^[^0-9-]{0,3}/,""),n=n.replace(/[^0-9]{0,3}$/,""),n=n.replace(/[ ,]/g,""),n==="")return 0;let t=Number(n);return isNaN(t)?k:(t=t||0,r&&(t=t*.01),t)}const Mc=2.5066282746310002;function Cc(){const e=b(arguments).filter(Qe);if(e.length===0)return J;const r=j(e);return r instanceof Error?r:K.sum(K(r).subtract(K.mean(r)).abs()[0])/r.length}function Xe(){const e=b(arguments).filter(Qe);if(e.length===0)return Kn;const r=gn.apply(void 0,e);if(r)return r;const t=xe(e),i=t.length;let u=0,a=0,h;for(let d=0;d<i;d++)u+=t[d],a+=1;return h=u/a,isNaN(h)&&(h=J),h}function Oi(){const e=b(arguments).filter(Qe);if(e.length===0)return Kn;const r=gn.apply(void 0,e);if(r)return r;const t=e,i=t.length;let u=0,a=0,h;for(let d=0;d<i;d++){const f=t[d];typeof f=="number"&&(u+=f),f===!0&&u++,f!==null&&a++}return h=u/a,isNaN(h)&&(h=J),h}function Lc(n,e,r){if(arguments.length<=1)return un;r=r||n;const i=b(r).filter(Qe);if(r=j(i),n=b(n),r instanceof Error)return r;let u=0,a=0;const h=e===void 0||e==="*",d=h?null:Ir(e+"");for(let f=0;f<n.length;f++){const o=n[f];if(h)a+=r[f],u++;else{const l=[Me(o,$e)].concat(d);Or(l)&&(a+=r[f],u++)}}return a/u}function Dc(){const n=yt(...arguments),r=n.reduce((t,i)=>t+i,0)/n.length;return isNaN(r)?0:r}const Hr={};Hr.DIST=function(n,e,r,t,i,u){return arguments.length<4||(i=i===void 0?0:i,u=u===void 0?1:u,n=A(n),e=A(e),r=A(r),i=A(i),u=A(u),$(n,e,r,i,u))?k:(n=(n-i)/(u-i),t?K.beta.cdf(n,e,r):K.beta.pdf(n,e,r))};Hr.INV=(n,e,r,t,i)=>(t=t===void 0?0:t,i=i===void 0?1:i,n=A(n),e=A(e),r=A(r),t=A(t),i=A(i),$(n,e,r,t,i)?k:K.beta.inv(n,e,r)*(i-t)+t);const Sr={};Sr.DIST=(n,e,r,t)=>(n=A(n),e=A(e),r=A(r),t=A(t),$(n,e,r,t)?k:t?K.binomial.cdf(n,e,r):K.binomial.pdf(n,e,r));Sr.DIST.RANGE=(n,e,r,t)=>{if(t=t===void 0?r:t,n=A(n),e=A(e),r=A(r),t=A(t),$(n,e,r,t))return k;let i=0;for(let u=r;u<=t;u++)i+=Rr(n,u)*Math.pow(e,u)*Math.pow(1-e,n-u);return i};Sr.INV=(n,e,r)=>{if(n=A(n),e=A(e),r=A(r),$(n,e,r))return k;let t=0;for(;t<=n;){if(K.binomial.cdf(t,n,e)>=r)return t;t++}};const Re={};Re.DIST=(n,e,r)=>(n=A(n),e=A(e),$(n,e)?k:r?K.chisquare.cdf(n,e):K.chisquare.pdf(n,e));Re.DIST.RT=(n,e)=>!n|!e?un:n<1||e>Math.pow(10,10)?J:typeof n!="number"||typeof e!="number"?k:1-K.chisquare.cdf(n,e);Re.INV=(n,e)=>(n=A(n),e=A(e),$(n,e)?k:K.chisquare.inv(n,e));Re.INV.RT=(n,e)=>!n|!e?un:n<0||n>1||e<1||e>Math.pow(10,10)?J:typeof n!="number"||typeof e!="number"?k:K.chisquare.inv(1-n,e);Re.TEST=function(n,e){if(arguments.length!==2)return un;if(!(n instanceof Array)||!(e instanceof Array)||n.length!==e.length||n[0]&&e[0]&&n[0].length!==e[0].length)return k;const r=n.length;let t,i,u;for(i=0;i<r;i++)n[i]instanceof Array||(t=n[i],n[i]=[],n[i].push(t)),e[i]instanceof Array||(t=e[i],e[i]=[],e[i].push(t));const a=n[0].length,h=a===1?r-1:(r-1)*(a-1);let d=0;const f=Math.PI;for(i=0;i<r;i++)for(u=0;u<a;u++)d+=Math.pow(n[i][u]-e[i][u],2)/e[i][u];function o(l,s){let c=Math.exp(-.5*l);s%2===1&&(c=c*Math.sqrt(2*l/f));let g=s;for(;g>=2;)c=c*l/g,g=g-2;let v=c,p=s;for(;v>1e-10*c;)p=p+2,v=v*l/p,c=c+v;return 1-c}return Math.round(o(d,h)*1e6)/1e6};const Si={};Si.NORM=(n,e,r)=>(n=A(n),e=A(e),r=A(r),$(n,e,r)?k:K.normalci(1,n,e,r)[1]-1);Si.T=(n,e,r)=>(n=A(n),e=A(e),r=A(r),$(n,e,r)?k:K.tci(1,n,e,r)[1]-1);function Pc(n,e){return n=j(b(n)),e=j(b(e)),$(n,e)?k:K.corrcoeff(n,e)}function Br(){const n=b(arguments);return xe(n).length}function Jr(){const n=b(arguments);return n.length-rl(n)}function rl(){const n=b(arguments);let e=0,r;for(let t=0;t<n.length;t++)r=n[t],(r==null||r==="")&&e++;return e}function xc(n,e){if(n=b(n),e===void 0||e==="*")return n.length;let t=0;const i=Ir(e+"");for(let u=0;u<n.length;u++){const a=n[u],h=[Me(a,$e)].concat(i);Or(h)&&t++}return t}function Uc(){const n=Nt(arguments),e=new Array(b(n[0]).length);for(let t=0;t<e.length;t++)e[t]=!0;for(let t=0;t<n.length;t+=2){const i=b(n[t]),u=n[t+1];if(!(u===void 0||u==="*")){const h=Ir(u+"");for(let d=0;d<i.length;d++){const f=i[d],o=[Me(f,$e)].concat(h);e[d]=e[d]&&Or(o)}}}let r=0;for(let t=0;t<e.length;t++)e[t]&&r++;return r}const kr={};kr.P=(n,e)=>{if(n=j(b(n)),e=j(b(e)),$(n,e))return k;const r=K.mean(n),t=K.mean(e);let i=0;const u=n.length;for(let a=0;a<u;a++)i+=(n[a]-r)*(e[a]-t);return i/u};kr.S=(n,e)=>(n=j(b(n)),e=j(b(e)),$(n,e)?k:K.covariance(n,e));function Fc(){const n=j(b(arguments));if(n instanceof Error)return n;const e=K.mean(n);let r=0;for(let t=0;t<n.length;t++)r+=Math.pow(n[t]-e,2);return r}const ki={};ki.DIST=(n,e,r)=>(n=A(n),e=A(e),$(n,e)?k:r?K.exponential.cdf(n,e):K.exponential.pdf(n,e));const Te={};Te.DIST=(n,e,r,t)=>(n=A(n),e=A(e),r=A(r),$(n,e,r)?k:t?K.centralF.cdf(n,e,r):K.centralF.pdf(n,e,r));Te.DIST.RT=function(n,e,r){return arguments.length!==3?un:n<0||e<1||r<1?J:typeof n!="number"||typeof e!="number"||typeof r!="number"?k:1-K.centralF.cdf(n,e,r)};Te.INV=(n,e,r)=>(n=A(n),e=A(e),r=A(r),$(n,e,r)?k:n<=0||n>1?J:K.centralF.inv(n,e,r));Te.INV.RT=function(n,e,r){return arguments.length!==3?un:n<0||n>1||e<1||e>Math.pow(10,10)||r<1||r>Math.pow(10,10)?J:typeof n!="number"||typeof e!="number"||typeof r!="number"?k:K.centralF.inv(1-n,e,r)};Te.TEST=(n,e)=>{if(!n||!e||!(n instanceof Array)||!(e instanceof Array))return un;if(n.length<2||e.length<2)return Kn;const r=(h,d)=>{let f=0;for(let o=0;o<h.length;o++)f+=Math.pow(h[o]-d,2);return f},t=De(n)/n.length,i=De(e)/e.length,u=r(n,t)/(n.length-1),a=r(e,i)/(e.length-1);return u/a};function Bc(n){return n=A(n),n instanceof Error?n:Math.log((1+n)/(1-n))/2}function Jc(n){if(n=A(n),n instanceof Error)return n;const e=Math.exp(2*n);return(e-1)/(e+1)}function tl(n,e,r){if(n=A(n),e=j(b(e)),r=j(b(r)),$(n,e,r))return k;const t=K.mean(r),i=K.mean(e),u=r.length;let a=0,h=0;for(let o=0;o<u;o++)a+=(r[o]-t)*(e[o]-i),h+=Math.pow(r[o]-t,2);const d=a/h;return i-d*t+d*n}function Vc(n,e){if(n=j(b(n)),e=j(b(e)),$(n,e))return k;const r=n.length,t=e.length,i=[];for(let u=0;u<=t;u++){i[u]=0;for(let a=0;a<r;a++)u===0?n[a]<=e[0]&&(i[0]+=1):u<t?n[a]>e[u-1]&&n[a]<=e[u]&&(i[u]+=1):u===t&&n[a]>e[t-1]&&(i[t]+=1)}return i}function $r(n){return n=A(n),n instanceof Error?n:n===0||parseInt(n,10)===n&&n<0?J:K.gammafn(n)}$r.DIST=function(n,e,r,t){return arguments.length!==4?un:n<0||e<=0||r<=0||typeof n!="number"||typeof e!="number"||typeof r!="number"?k:t?K.gamma.cdf(n,e,r,!0):K.gamma.pdf(n,e,r,!1)};$r.INV=function(n,e,r){return arguments.length!==3?un:n<0||n>1||e<=0||r<=0?J:typeof n!="number"||typeof e!="number"||typeof r!="number"?k:K.gamma.inv(n,e,r)};function Mi(n){return n=A(n),n instanceof Error?n:K.gammaln(n)}Mi.PRECISE=function(n){return arguments.length!==1?un:n<=0?J:typeof n!="number"?k:K.gammaln(n)};function qc(n){return n=A(n),n instanceof Error?n:K.normal.cdf(n,0,1)-.5}function Hc(){const n=j(b(arguments));return n instanceof Error?n:K.geomean(n)}function $c(n,e,r,t){if(n=j(b(n)),n instanceof Error)return n;let i;if(e===void 0)for(e=[],i=1;i<=n.length;i++)e.push(i);if(r===void 0&&(r=e),e=j(b(e)),r=j(b(r)),$(e,r))return k;t===void 0&&(t=!0);const u=n.length;let a=0,h=0,d=0,f=0;for(i=0;i<u;i++){const c=e[i],g=Math.log(n[i]);a+=c,h+=g,d+=c*g,f+=c*c}a/=u,h/=u,d/=u,f/=u;let o,l;t?(o=(d-a*h)/(f-a*a),l=h-o*a):(o=d/f,l=0);const s=[];for(i=0;i<r.length;i++)s.push(Math.exp(l+o*r[i]));return s}function bc(){const n=j(b(arguments));if(n instanceof Error)return n;const e=n.length;let r=0;for(let t=0;t<e;t++)r+=1/n[t];return e/r}const Ci={};Ci.DIST=(n,e,r,t,i)=>{if(n=A(n),e=A(e),r=A(r),t=A(t),$(n,e,r,t))return k;function u(h,d,f,o){return Rr(f,h)*Rr(o-f,d-h)/Rr(o,d)}function a(h,d,f,o){let l=0;for(let s=0;s<=h;s++)l+=u(s,d,f,o);return l}return i?a(n,e,r,t):u(n,e,r,t)};function Gc(n,e){return n=j(n),e=j(e),$(n,e)?k:n.length!==e.length?un:tl(0,n,e)}function Wc(){const n=j(b(arguments));if(n instanceof Error)return n;const e=K.mean(n),r=n.length;let t=0;for(let i=0;i<r;i++)t+=Math.pow(n[i]-e,4);return t=t/Math.pow(K.stdev(n,!0),4),r*(r+1)/((r-1)*(r-2)*(r-3))*t-3*(r-1)*(r-1)/((r-2)*(r-3))}function il(n,e){const r=gn.apply(void 0,n);return r||($(e)?e:(n=xe(b(n)),e=A(e),e<0||n.length<e?k:n.sort((t,i)=>i-t)[e-1]))}function Li(n,e){if(n=j(b(n)),e=j(b(e)),$(n,e))return k;const r=K.mean(n),t=K.mean(e),i=e.length;let u=0,a=0;for(let f=0;f<i;f++)u+=(e[f]-t)*(n[f]-r),a+=Math.pow(e[f]-t,2);const h=u/a,d=r-h*t;return[h,d]}function Xc(n,e){if(n=j(b(n)),e=j(b(e)),$(n,e)||n.length!==e.length)return k;for(let t=0;t<n.length;t++)n[t]=Math.log(n[t]);const r=Li(n,e);return r[0]=Math.round(Math.exp(r[0])*1e6)/1e6,r[1]=Math.round(Math.exp(r[1])*1e6)/1e6,r}const Mr={};Mr.DIST=(n,e,r,t)=>(n=A(n),e=A(e),r=A(r),$(n,e,r)?k:t?K.lognormal.cdf(n,e,r):K.lognormal.pdf(n,e,r));Mr.INV=(n,e,r)=>(n=A(n),e=A(e),r=A(r),$(n,e,r)?k:K.lognormal.inv(n,e,r));function st(){const n=b(arguments),e=gn.apply(void 0,n);if(e)return e;const r=xe(n);return r.length===0?0:Math.max.apply(Math,r)}function zc(){const n=b(arguments),e=gn.apply(void 0,n);if(e)return e;let r=Ri(n);return r=r.map(t=>t??0),r.length===0?0:Math.max.apply(Math,r)}function Yc(){const n=yt(...arguments);return n.length===0?0:Math.max.apply(Math,n)}function ol(){const n=b(arguments),e=gn.apply(void 0,n);if(e)return e;const r=Ri(n);let t=K.median(r);return isNaN(t)&&(t=J),t}function ct(){const n=b(arguments),e=gn.apply(void 0,n);if(e)return e;const r=xe(n);return r.length===0?0:Math.min.apply(Math,r)}function Zc(){const n=b(arguments),e=gn.apply(void 0,n);if(e)return e;let r=Ri(n);return r=r.map(t=>t??0),r.length===0?0:Math.min.apply(Math,r)}function Kc(){const n=yt(...arguments);return n.length===0?0:Math.min.apply(Math,n)}const ze={};ze.MULT=function(){const n=j(b(arguments));if(n instanceof Error)return n;const e=n.length,r={};let t=[],i=0,u;for(let a=0;a<e;a++)u=n[a],r[u]=r[u]?r[u]+1:1,r[u]>i&&(i=r[u],t=[]),r[u]===i&&(t[t.length]=u);return t};ze.SNGL=function(){const n=j(b(arguments));return n instanceof Error?n:ze.MULT(n).sort((e,r)=>e-r)[0]};const Di={};Di.DIST=(n,e,r,t)=>(n=A(n),e=A(e),r=A(r),$(n,e,r)?k:t?K.negbin.cdf(n,e,r):K.negbin.pdf(n,e,r));const Ie={};Ie.DIST=(n,e,r,t)=>(n=A(n),e=A(e),r=A(r),$(n,e,r)?k:r<=0?J:t?K.normal.cdf(n,e,r):K.normal.pdf(n,e,r));Ie.INV=(n,e,r)=>(n=A(n),e=A(e),r=A(r),$(n,e,r)?k:K.normal.inv(n,e,r));Ie.S={};Ie.S.DIST=(n,e)=>(n=A(n),n instanceof Error?k:e?K.normal.cdf(n,0,1):K.normal.pdf(n,0,1));Ie.S.INV=n=>(n=A(n),n instanceof Error?k:K.normal.inv(n,0,1));function ul(n,e){if(e=j(b(e)),n=j(b(n)),$(e,n))return k;const r=K.mean(n),t=K.mean(e),i=n.length;let u=0,a=0,h=0;for(let d=0;d<i;d++)u+=(n[d]-r)*(e[d]-t),a+=Math.pow(n[d]-r,2),h+=Math.pow(e[d]-t,2);return u/Math.sqrt(a*h)}const fe={};fe.EXC=(n,e)=>{if(n=j(b(n)),e=A(e),$(n,e))return k;n=n.sort((u,a)=>u-a);const r=n.length;if(e<1/(r+1)||e>1-1/(r+1))return J;const t=e*(r+1)-1,i=Math.floor(t);return Wu(t===i?n[t]:n[i]+(t-i)*(n[i+1]-n[i]))};fe.INC=(n,e)=>{if(n=j(b(n)),e=A(e),$(n,e))return k;n=n.sort((u,a)=>u-a);const r=n.length,t=e*(r-1),i=Math.floor(t);return Wu(t===i?n[t]:n[i]+(t-i)*(n[i+1]-n[i]))};const br={};br.EXC=(n,e,r)=>{if(r=r===void 0?3:r,n=j(b(n)),e=A(e),r=A(r),$(n,e,r))return k;n=n.sort((o,l)=>o-l);const t=Ii.apply(null,n),i=n.length,u=t.length,a=Math.pow(10,r);let h=0,d=!1,f=0;for(;!d&&f<u;)e===t[f]?(h=(n.indexOf(t[f])+1)/(i+1),d=!0):e>=t[f]&&(e<t[f+1]||f===u-1)&&(h=(n.indexOf(t[f])+1+(e-t[f])/(t[f+1]-t[f]))/(i+1),d=!0),f++;return Math.floor(h*a)/a};br.INC=(n,e,r)=>{if(r=r===void 0?3:r,n=j(b(n)),e=A(e),r=A(r),$(n,e,r))return k;n=n.sort((o,l)=>o-l);const t=Ii.apply(null,n),i=n.length,u=t.length,a=Math.pow(10,r);let h=0,d=!1,f=0;for(;!d&&f<u;)e===t[f]?(h=n.indexOf(t[f])/(i-1),d=!0):e>=t[f]&&(e<t[f+1]||f===u-1)&&(h=(n.indexOf(t[f])+(e-t[f])/(t[f+1]-t[f]))/(i-1),d=!0),f++;return Math.floor(h*a)/a};function Qc(n,e){return n=A(n),e=A(e),$(n,e)?k:Ce(n)/Ce(n-e)}function _c(n,e){return n=A(n),e=A(e),$(n,e)?k:Math.pow(n,e)}function jc(n){return n=A(n),n instanceof Error?k:Math.exp(-.5*n*n)/Mc}const Pi={};Pi.DIST=(n,e,r)=>(n=A(n),e=A(e),$(n,e)?k:r?K.poisson.cdf(n,e):K.poisson.pdf(n,e));function na(n,e,r,t){if(r===void 0)return 0;if(t=t===void 0?r:t,n=j(b(n)),e=j(b(e)),r=A(r),t=A(t),$(n,e,r,t))return k;if(r===t)return n.indexOf(r)>=0?e[n.indexOf(r)]:0;const i=n.sort((h,d)=>h-d),u=i.length;let a=0;for(let h=0;h<u;h++)i[h]>=r&&i[h]<=t&&(a+=e[n.indexOf(i[h])]);return a}const Ye={};Ye.EXC=(n,e)=>{if(n=j(xe(b(n))),e=A(e),$(n,e))return k;switch(e){case 1:return fe.EXC(n,.25);case 2:return fe.EXC(n,.5);case 3:return fe.EXC(n,.75);default:return J}};Ye.INC=(n,e)=>{if(n=j(xe(b(n))),e=A(e),$(n,e))return k;switch(e){case 1:return fe.INC(n,.25);case 2:return fe.INC(n,.5);case 3:return fe.INC(n,.75);default:return J}};const Gr={};Gr.AVG=(n,e,r)=>{if(n=A(n),e=j(b(e)),$(n,e))return k;e=b(e),r=r||!1;const t=r?(a,h)=>a-h:(a,h)=>h-a;e=e.sort(t);const i=e.length;let u=0;for(let a=0;a<i;a++)e[a]===n&&u++;return u>1?(2*e.indexOf(n)+u+1)/2:e.indexOf(n)+1};Gr.EQ=(n,e,r)=>{if(n=A(n),e=j(b(e)),$(n,e))return k;r=r||!1;const t=r?(i,u)=>i-u:(i,u)=>u-i;return e=e.sort(t),e.indexOf(n)+1};function ea(n,e){if(arguments.length!==2)return un;if(e<0)return J;if(!(n instanceof Array)||typeof e!="number")return k;if(n.length!==0)return K.row(n,e)}function ra(n,e){return n=j(b(n)),e=j(b(e)),$(n,e)?k:Math.pow(ul(n,e),2)}function xi(){const n=j(b(arguments));if(n instanceof Error)return n;const e=K.mean(n),r=n.length;let t=0;for(let i=0;i<r;i++)t+=Math.pow(n[i]-e,3);return r*t/((r-1)*(r-2)*Math.pow(K.stdev(n,!0),3))}xi.P=function(){const n=j(b(arguments));if(n instanceof Error)return n;const e=K.mean(n),r=n.length;let t=0,i=0;for(let u=0;u<r;u++)i+=Math.pow(n[u]-e,3),t+=Math.pow(n[u]-e,2);return i=i/r,t=t/r,i/Math.pow(t,3/2)};function ta(n,e){if(n=j(b(n)),e=j(b(e)),$(n,e))return k;const r=K.mean(e),t=K.mean(n),i=e.length;let u=0,a=0;for(let h=0;h<i;h++)u+=(e[h]-r)*(n[h]-t),a+=Math.pow(e[h]-r,2);return u/a}function ll(n,e){return n=j(b(n)),e=A(e),$(n,e)?n:n.sort((r,t)=>r-t)[e-1]}function ia(n,e,r){return n=A(n),e=A(e),r=A(r),$(n,e,r)?k:(n-e)/r}const oe={};oe.P=function(){const n=te.P.apply(this,arguments);let e=Math.sqrt(n);return isNaN(e)&&(e=J),e};oe.S=function(){const n=te.S.apply(this,arguments);return Math.sqrt(n)};function oa(){const n=fl.apply(this,arguments);return Math.sqrt(n)}function ua(){const n=sl.apply(this,arguments);let e=Math.sqrt(n);return isNaN(e)&&(e=J),e}function la(n,e){if(n=j(b(n)),e=j(b(e)),$(n,e))return k;const r=K.mean(e),t=K.mean(n),i=e.length;let u=0,a=0,h=0;for(let d=0;d<i;d++)u+=Math.pow(n[d]-t,2),a+=(e[d]-r)*(n[d]-t),h+=Math.pow(e[d]-r,2);return Math.sqrt((u-a*a/h)/(i-2))}ue.DIST=(n,e,r)=>r!==1&&r!==2?J:r===1?ue.DIST.RT(n,e):ue.DIST["2T"](n,e);ue.DIST["2T"]=function(n,e){return arguments.length!==2?un:n<0||e<1?J:typeof n!="number"||typeof e!="number"?k:(1-K.studentt.cdf(n,e))*2};ue.DIST.RT=function(n,e){return arguments.length!==2?un:n<0||e<1?J:typeof n!="number"||typeof e!="number"?k:1-K.studentt.cdf(n,e)};ue.INV=(n,e)=>(n=A(n),e=A(e),$(n,e)?k:K.studentt.inv(n,e));ue.INV["2T"]=(n,e)=>(n=A(n),e=A(e),n<=0||n>1||e<1?J:$(n,e)?k:Math.abs(K.studentt.inv(n/2,e)));ue.TEST=(n,e)=>{if(n=j(b(n)),e=j(b(e)),$(n,e))return k;const r=K.mean(n),t=K.mean(e);let i=0,u=0,a;for(a=0;a<n.length;a++)i+=Math.pow(n[a]-r,2);for(a=0;a<e.length;a++)u+=Math.pow(e[a]-t,2);i=i/(n.length-1),u=u/(e.length-1);const h=Math.abs(r-t)/Math.sqrt(i/n.length+u/e.length);return ue.DIST["2T"](h,n.length+e.length-2)};function fa(n,e,r){if(n=j(b(n)),e=j(b(e)),r=j(b(r)),$(n,e,r))return k;const t=Li(n,e),i=t[0],u=t[1],a=[];return r.forEach(h=>{a.push(i*h+u)}),a}function sa(n,e){if(n=j(b(n)),e=A(e),$(n,e))return k;const r=Ze(n.length*e,2)/2;return K.mean(qs(Fn(n.sort((t,i)=>t-i),r),r))}const te={};te.P=function(){const n=xe(b(arguments)),e=n.length;let r=0;const t=Xe(n);let i;for(let u=0;u<e;u++)r+=Math.pow(n[u]-t,2);return i=r/e,isNaN(i)&&(i=J),i};te.S=function(){const n=xe(b(arguments)),e=n.length;let r=0;const t=Xe(n);for(let i=0;i<e;i++)r+=Math.pow(n[i]-t,2);return r/(e-1)};function fl(){const n=b(arguments),e=n.length;let r=0,t=0;const i=Oi(n);for(let u=0;u<e;u++){const a=n[u];typeof a=="number"?r+=Math.pow(a-i,2):a===!0?r+=Math.pow(1-i,2):r+=Math.pow(0-i,2),a!==null&&t++}return r/(t-1)}function sl(){const n=b(arguments),e=n.length;let r=0,t=0;const i=Oi(n);let u;for(let a=0;a<e;a++){const h=n[a];typeof h=="number"?r+=Math.pow(h-i,2):h===!0?r+=Math.pow(1-i,2):r+=Math.pow(0-i,2),h!==null&&t++}return u=r/t,isNaN(u)&&(u=J),u}const Ui={};Ui.DIST=(n,e,r,t)=>(n=A(n),e=A(e),r=A(r),$(n,e,r)?k:t?1-Math.exp(-Math.pow(n/r,e)):Math.pow(n,e-1)*Math.exp(-Math.pow(n/r,e))*e/Math.pow(r,e));const Fi={};Fi.TEST=(n,e,r)=>{if(n=j(b(n)),e=A(e),$(n,e))return k;r=r||oe.S(n);const t=n.length;return 1-Ie.S.DIST((Xe(n)-e)/(r/Math.sqrt(t)),!0)};function ca(n){return n=A(n),n instanceof Error?n:Math.abs(n)}function aa(n){if(n=A(n),n instanceof Error)return n;let e=Math.acos(n);return isNaN(e)&&(e=J),e}function ha(n){if(n=A(n),n instanceof Error)return n;let e=Math.log(n+Math.sqrt(n*n-1));return isNaN(e)&&(e=J),e}function da(n){return n=A(n),n instanceof Error?n:Math.atan(1/n)}function ga(n){if(n=A(n),n instanceof Error)return n;let e=.5*Math.log((n+1)/(n-1));return isNaN(e)&&(e=J),e}function va(n,e,r,t){if(n=A(n),e=A(n),$(n,e))return k;switch(n){case 1:return Xe(r);case 2:return Br(r);case 3:return Jr(r);case 4:return st(r);case 5:return ct(r);case 6:return at(r);case 7:return oe.S(r);case 8:return oe.P(r);case 9:return De(r);case 10:return te.S(r);case 11:return te.P(r);case 12:return ol(r);case 13:return ze.SNGL(r);case 14:return il(r,t);case 15:return ll(r,t);case 16:return fe.INC(r,t);case 17:return Ye.INC(r,t);case 18:return fe.EXC(r,t);case 19:return Ye.EXC(r,t)}}function pa(n){if(n==null)return 0;if(n instanceof Error)return n;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(n))return k;let e=0;return n.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,r=>{e+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[r]}),e}function Ea(n){if(n=A(n),n instanceof Error)return n;let e=Math.asin(n);return isNaN(e)&&(e=J),e}function Na(n){return n=A(n),n instanceof Error?n:Math.log(n+Math.sqrt(n*n+1))}function wa(n){return n=A(n),n instanceof Error?n:Math.atan(n)}function ya(n,e){n=A(n),e=A(e);const r=gn(n,e);return r||Math.atan2(n,e)}function ma(n){if(n=A(n),n instanceof Error)return n;let e=Math.log((1+n)/(1-n))/2;return isNaN(e)&&(e=J),e}function Aa(n,e,r){n=A(n),e=A(e),r=A(r);const t=gn(n,e,r);if(t)return t;if(e===0)return J;const i=n.toString(e);return new Array(Math.max(r+1-i.length,0)).join("0")+i}function qe(n,e){n=A(n),e=A(e);const r=gn(n,e);return r||(e===0?0:n>0&&e<0?J:Math.ceil(n/e)*e)}qe.MATH=(n,e,r=0)=>{e===void 0&&(e=n>0?1:-1),n=A(n),e=A(e),r=A(r);const t=gn(n,e,r);return t||(e===0?0:(e=Math.abs(e),r===0||n>0?Math.ceil(n/e)*e:Math.floor(n/e)*e))};qe.PRECISE=(n,e)=>qe.MATH(n,e);function Rr(n,e){n=A(n),e=A(e);const r=gn(n,e);return r||(n<e?J:Ce(n)/(Ce(e)*Ce(n-e)))}function Ra(n,e){n=A(n),e=A(e);const r=gn(n,e);return r||(n<e?J:n===0&&e===0?1:Rr(n+e-1,n-1))}function Ta(n){return n=A(n),n instanceof Error?n:Math.cos(n)}function Ia(n){return n=A(n),n instanceof Error?n:(Math.exp(n)+Math.exp(-n))/2}function Oa(n){return n=A(n),n instanceof Error?n:n===0?Kn:1/Math.tan(n)}function Sa(n){if(n=A(n),n instanceof Error)return n;if(n===0)return Kn;const e=Math.exp(2*n);return(e+1)/(e-1)}function ka(n){return n=A(n),n instanceof Error?n:n===0?Kn:1/Math.sin(n)}function Ma(n){return n=A(n),n instanceof Error?n:n===0?Kn:2/(Math.exp(n)-Math.exp(-n))}function Ca(n,e){if(arguments.length<2)return un;n=n||"0",e=A(e);const r=gn(n,e);if(r)return r;if(e===0)return J;const t=parseInt(n,e);return isNaN(t)?J:t}function La(n){return n=A(n),n instanceof Error?n:n*180/Math.PI}function Da(n){return n=A(n),n instanceof Error?n:qe.MATH(n,-2,-1)}function Pa(n){return arguments.length<1?un:arguments.length>1?Ai:(n=A(n),n instanceof Error||(n=Math.exp(n)),n)}const _r=[];function Ce(n){if(n=A(n),n instanceof Error)return n;const e=Math.floor(n);return e===0||e===1?1:(_r[e]>0||(_r[e]=Ce(e-1)*e),_r[e])}function cl(n){if(n=A(n),n instanceof Error)return n;const e=Math.floor(n);return e<=0?1:e*cl(e-2)}function Ze(n,e){n=A(n),e=A(e);const r=gn(n,e);return r||(e?n>0&&e<0?J:Math.floor(n/e)*e:Kn)}Ze.MATH=(n,e=1,r=0)=>{n=A(n),e=A(e),r=A(r);const t=gn(n,e,r);return t||(e===0?0:(e=Math.abs(e),r===0||n>0?Math.floor(n/e)*e:Math.ceil(n/e)*e))};Ze.PRECISE=(n,e)=>Ze.MATH(n,e);function xa(){const n=j(b(arguments));if(n instanceof Error)return n;const e=n.length,r=n[0];let t=r<0?-r:r;for(let i=1;i<e;i++){const u=n[i];let a=u<0?-u:u;for(;t&&a;)t>a?t%=a:a%=t;t+=a}return t}function Ua(n){return n=A(n),n instanceof Error?n:Math.floor(n)}const Fa={CEILING:qe};function Ba(){const n=j(b(arguments));if(n instanceof Error)return n;for(var e,r,t,i,u=1;(t=n.pop())!==void 0;){if(t===0)return 0;for(;t>1;){if(t%2){for(e=3,r=Math.floor(Math.sqrt(t));e<=r&&t%e;e+=2);i=e<=r?e:t}else i=2;for(t/=i,u*=i,e=n.length;e;n[--e]%i===0&&(n[e]/=i)===1&&n.splice(e,1));}}return u}function Ja(n){return n=A(n),n instanceof Error?n:n===0?J:Math.log(n)}function Va(n,e){n=A(n),e=e?A(e):10;const r=gn(n,e);return r||(n===0||e===0?J:Math.log(n)/Math.log(e))}function qa(n){return n=A(n),n instanceof Error?n:n===0?J:Math.log(n)/Math.log(10)}function Ha(n,e){return!Array.isArray(n)||!Array.isArray(e)||n.some(t=>!t.length)||e.some(t=>!t.length)||di(n).some(t=>typeof t!="number")||di(e).some(t=>typeof t!="number")||n[0].length!==e.length?k:Array(n.length).fill(0).map(()=>Array(e[0].length).fill(0)).map((t,i)=>t.map((u,a)=>n[i].reduce((h,d,f)=>h+d*e[f][a],0)))}function $a(n,e){n=A(n),e=A(e);const r=gn(n,e);if(r)return r;if(e===0)return Kn;let t=Math.abs(n%e);return t=n<0?e-t:t,e>0?t:-t}function ba(n,e){n=A(n),e=A(e);const r=gn(n,e);return r||(n*e===0?0:n*e<0?J:Math.round(n/e)*e)}function Ga(){const n=j(b(arguments));if(n instanceof Error)return n;let e=0,r=1;for(let t=0;t<n.length;t++)e+=n[t],r*=Ce(n[t]);return Ce(e)/r}function Wa(n){return arguments.length>1?un:(n=parseInt(n),!n||n<=0?k:Array(n).fill(0).map(()=>Array(n).fill(0)).map((e,r)=>(e[r]=1,e)))}function Xa(n){if(n=A(n),n instanceof Error)return n;let e=Math.ceil(Math.abs(n));return e=e&1?e:e+1,n>=0?e:-e}function za(){return Math.PI}function al(n,e){n=A(n),e=A(e);const r=gn(n,e);if(r)return r;if(n===0&&e===0)return J;const t=Math.pow(n,e);return isNaN(t)?J:t}function at(){const e=b(arguments).filter(i=>i!=null);if(e.length===0)return 0;const r=j(e);if(r instanceof Error)return r;let t=1;for(let i=0;i<r.length;i++)t*=r[i];return t}function Ya(n,e){n=A(n),e=A(e);const r=gn(n,e);return r||parseInt(n/e,10)}function Za(n){return n=A(n),n instanceof Error?n:n*Math.PI/180}function Ka(){return Math.random()}function Qa(n,e){n=A(n),e=A(e);const r=gn(n,e);return r||n+Math.ceil((e-n+1)*Math.random())-1}function _a(n){if(n=A(n),n instanceof Error)return n;const e=String(n).split(""),r=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let t="",i=3;for(;i--;)t=(r[+e.pop()+i*10]||"")+t;return new Array(+e.join("")+1).join("M")+t}function hl(n,e){n=A(n),e=A(e);const r=gn(n,e);return r||+(Math.round(+(n+"e"+e))+"e"+e*-1)}function ja(n,e){n=A(n),e=A(e);const r=gn(n,e);return r||(n>0?1:-1)*Math.floor(Math.abs(n)*Math.pow(10,e))/Math.pow(10,e)}function n0(n,e){n=A(n),e=A(e);const r=gn(n,e);return r||(n>0?1:-1)*Math.ceil(Math.abs(n)*Math.pow(10,e))/Math.pow(10,e)}function e0(n){return n=A(n),n instanceof Error?n:1/Math.cos(n)}function r0(n){return n=A(n),n instanceof Error?n:2/(Math.exp(n)+Math.exp(-n))}function t0(n,e,r,t){if(n=A(n),e=A(e),r=A(r),t=j(t),$(n,e,r,t))return k;let i=t[0]*Math.pow(n,e);for(let u=1;u<t.length;u++)i+=t[u]*Math.pow(n,e+u*r);return i}function i0(n){return n=A(n),n instanceof Error?n:n<0?-1:n===0?0:1}function o0(n){return n=A(n),n instanceof Error?n:Math.sin(n)}function u0(n){return n=A(n),n instanceof Error?n:(Math.exp(n)-Math.exp(-n))/2}function l0(n){return n=A(n),n instanceof Error?n:n<0?J:Math.sqrt(n)}function f0(n){return n=A(n),n instanceof Error?n:Math.sqrt(n*Math.PI)}function s0(n,e){if(n=A(n),n instanceof Error)return n;switch(n){case 1:return Xe(e);case 2:return Br(e);case 3:return Jr(e);case 4:return st(e);case 5:return ct(e);case 6:return at(e);case 7:return oe.S(e);case 8:return oe.P(e);case 9:return De(e);case 10:return te.S(e);case 11:return te.P(e);case 101:return Xe(e);case 102:return Br(e);case 103:return Jr(e);case 104:return st(e);case 105:return ct(e);case 106:return at(e);case 107:return oe.S(e);case 108:return oe.P(e);case 109:return De(e);case 110:return te.S(e);case 111:return te.P(e)}}function De(){let n=0;return ne(Nt(arguments),e=>{if(n instanceof Error)return!1;if(e instanceof Error)n=e;else if(typeof e=="number")n+=e;else if(typeof e=="string"){const r=parseFloat(e);!isNaN(r)&&(n+=r)}else if(Array.isArray(e)){const r=De.apply(null,e);r instanceof Error?n=r:n+=r}}),n}function c0(n,e,r){if(n=b(n),r=r?b(r):n,n instanceof Error)return n;if(e==null||e instanceof Error)return 0;let t=0;const i=e==="*",u=i?null:Ir(e+"");for(let a=0;a<n.length;a++){const h=n[a],d=r[a];if(i)t+=h;else{const f=[Me(h,$e)].concat(u);t+=Or(f)?d:0}}return t}function a0(){const n=yt(...arguments);return De(n)}function h0(){if(!arguments||arguments.length===0)return k;const n=arguments.length+1;let e=0,r,t,i,u;for(let a=0;a<arguments[0].length;a++)if(arguments[0][a]instanceof Array)for(let h=0;h<arguments[0][a].length;h++){for(r=1,t=1;t<n;t++){const d=arguments[t-1][a][h];if(d instanceof Error)return d;if(u=A(d),u instanceof Error)return u;r*=u}e+=r}else{for(r=1,t=1;t<n;t++){const h=arguments[t-1][a];if(h instanceof Error)return h;if(i=A(h),i instanceof Error)return i;r*=i}e+=r}return e}function d0(){const n=j(b(arguments));if(n instanceof Error)return n;let e=0;const r=n.length;for(let t=0;t<r;t++)e+=At(n[t])?n[t]*n[t]:0;return e}function g0(n,e){if(n=j(b(n)),e=j(b(e)),$(n,e))return k;let r=0;for(let t=0;t<n.length;t++)r+=n[t]*n[t]-e[t]*e[t];return r}function v0(n,e){if(n=j(b(n)),e=j(b(e)),$(n,e))return k;let r=0;n=j(b(n)),e=j(b(e));for(let t=0;t<n.length;t++)r+=n[t]*n[t]+e[t]*e[t];return r}function p0(n,e){if(n=j(b(n)),e=j(b(e)),$(n,e))return k;let r=0;n=b(n),e=b(e);for(let t=0;t<n.length;t++)r+=Math.pow(n[t]-e[t],2);return r}function E0(n){return n=A(n),n instanceof Error?n:Math.tan(n)}function N0(n){if(n=A(n),n instanceof Error)return n;const e=Math.exp(2*n);return(e-1)/(e+1)}function w0(n,e){n=A(n),e=A(e);const r=gn(n,e);return r||(n>0?1:-1)*Math.floor(Math.abs(n)*Math.pow(10,e))/Math.pow(10,e)}function y0(n,e){if(arguments.length!==2)return un;n=A(n),e=A(e);const r=gn(n,e);return r||n+e}function m0(n,e){if(arguments.length!==2)return un;n=A(n),e=A(e);const r=gn(n,e);return r||(e===0?Kn:n/e)}function A0(n,e){return arguments.length!==2?un:n instanceof Error?n:e instanceof Error?e:(n===null&&(n=void 0),e===null&&(e=void 0),n===e)}function R0(n,e){if(arguments.length!==2)return un;if(n instanceof Error)return n;if(e instanceof Error)return e;wt(n,e)?(n=$n(n),e=$n(e)):(n=A(n),e=A(e));const r=gn(n,e);return r||n>e}function T0(n,e){if(arguments.length!==2)return un;wt(n,e)?(n=$n(n),e=$n(e)):(n=A(n),e=A(e));const r=gn(n,e);return r||n>=e}function I0(n,e){if(arguments.length!==2)return un;wt(n,e)?(n=$n(n),e=$n(e)):(n=A(n),e=A(e));const r=gn(n,e);return r||n<e}function O0(n,e){if(arguments.length!==2)return un;wt(n,e)?(n=$n(n),e=$n(e)):(n=A(n),e=A(e));const r=gn(n,e);return r||n<=e}function S0(n,e){if(arguments.length!==2)return un;n=A(n),e=A(e);const r=gn(n,e);return r||n-e}function k0(n,e){if(arguments.length!==2)return un;n=A(n),e=A(e);const r=gn(n,e);return r||n*e}function M0(n,e){return arguments.length!==2?un:n instanceof Error?n:e instanceof Error?e:(n===null&&(n=void 0),e===null&&(e=void 0),n!==e)}function C0(n,e){return arguments.length!==2?un:al(n,e)}var L0=Object.freeze({__proto__:null,ADD:y0,DIVIDE:m0,EQ:A0,GT:R0,GTE:T0,LT:I0,LTE:O0,MINUS:S0,MULTIPLY:k0,NE:M0,POW:C0});const D0=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],P0=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],ht=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function x0(n,e,r){let t;return n=A(n),e=A(e),r=A(r),$(n,e,r)?t=k:(t=new Date(n,e-1,r),t.getFullYear()<0&&(t=J)),Pe?Le(t):t}function Je(n,e,r){r=r.toUpperCase(),n=pn(n),e=pn(e);const t=n.getFullYear(),i=n.getMonth(),u=n.getDate(),a=e.getFullYear(),h=e.getMonth(),d=e.getDate();let f;switch(r){case"Y":f=Math.floor(Bi(n,e));break;case"D":f=We(e,n);break;case"M":f=h-i+12*(a-t),d<u&&f--;break;case"MD":u<=d?f=d-u:(h===0?(n.setFullYear(a-1),n.setMonth(12)):(n.setFullYear(a),n.setMonth(h-1)),f=We(e,n));break;case"YM":f=h-i+12*(a-t),d<u&&f--,f=f%12;break;case"YD":h>i||h===i&&d<u?n.setFullYear(a):n.setFullYear(a-1),f=We(e,n);break}return f}function U0(n){if(typeof n!="string")return k;const e=Date.parse(n);if(isNaN(e))return k;const r=new Date(n);return Pe?Le(r):r}function F0(n){const e=pn(n);return e instanceof Error?e:e.getDate()}function dt(n){const e=new Date(n);return e.setHours(0,0,0,0),e}function We(n,e){return n=pn(n),e=pn(e),n instanceof Error?n:e instanceof Error?e:Le(dt(n))-Le(dt(e))}function He(n,e,r){if(r=Ti(r||"false"),n=pn(n),e=pn(e),n instanceof Error)return n;if(e instanceof Error)return e;if(r instanceof Error)return r;const t=n.getMonth();let i=e.getMonth(),u,a;if(r)u=n.getDate()===31?30:n.getDate(),a=e.getDate()===31?30:e.getDate();else{const h=new Date(n.getFullYear(),t+1,0).getDate(),d=new Date(e.getFullYear(),i+1,0).getDate();u=n.getDate()===h?30:n.getDate(),e.getDate()===d?u<30?(i++,a=1):a=30:a=e.getDate()}return 360*(e.getFullYear()-n.getFullYear())+30*(i-t)+(a-u)}function B0(n,e){if(n=pn(n),n instanceof Error)return n;if(isNaN(e))return k;let r=n.getDate();n.setDate(1),e=parseInt(e,10),n.setMonth(n.getMonth()+e);let t=n.getMonth();if(r>28){let i=[31,28,31,30,31,30,31,31,30,31,30,31][t],u=n.getFullYear();t===1&&(u%4===0&&u%100!==0||u%400===0)&&(i=29),r=Math.min(r,i)}return n.setDate(r),Pe?Le(n):n}function J0(n,e){if(n=pn(n),n instanceof Error)return n;if(isNaN(e))return k;e=parseInt(e,10);const r=new Date(n.getFullYear(),n.getMonth()+e+1,0);return Pe?Le(r):r}function V0(n){return n=pn(n),n instanceof Error?n:n.getHours()}function dl(n){if(n=pn(n),n instanceof Error)return n;n=dt(n),n.setDate(n.getDate()+4-(n.getDay()||7));const e=new Date(n.getFullYear(),0,1);return Math.ceil(((n-e)/864e5+1)/7)}function q0(n){return n=pn(n),n instanceof Error?n:n.getMinutes()}function H0(n){return n=pn(n),n instanceof Error?n:n.getMonth()+1}function Rt(n,e,r){return Rt.INTL(n,e,1,r)}Rt.INTL=(n,e,r,t)=>{if(n=pn(n),n instanceof Error)return n;if(e=pn(e),e instanceof Error)return e;let i=!1;const u=[],a=[1,2,3,4,5,6,0],h=new RegExp("^[0|1]{7}$");if(r===void 0)r=ht[1];else if(typeof r=="string"&&h.test(r)){i=!0,r=r.split("");for(let l=0;l<r.length;l++)r[l]==="1"&&u.push(a[l])}else r=ht[r];if(!(r instanceof Array))return k;t===void 0?t=[]:t instanceof Array||(t=[t]);for(let l=0;l<t.length;l++){const s=pn(t[l]);if(s instanceof Error)return s;t[l]=s}const d=Math.round((e-n)/(1e3*60*60*24))+1;let f=d;const o=n;for(let l=0;l<d;l++){const s=new Date().getTimezoneOffset()>0?o.getUTCDay():o.getDay();let c=i?u.includes(s):s===r[0]||s===r[1];for(let g=0;g<t.length;g++){const v=t[g];if(v.getDate()===o.getDate()&&v.getMonth()===o.getMonth()&&v.getFullYear()===o.getFullYear()){c=!0;break}}c&&f--,o.setDate(o.getDate()+1)}return f};function $0(){return Pe?Le(new Date):new Date}function b0(n){return n=pn(n),n instanceof Error?n:n.getSeconds()}function G0(n,e,r){return n=A(n),e=A(e),r=A(r),$(n,e,r)?k:n<0||e<0||r<0?J:(3600*n+60*e+r)/86400}function W0(n){return n=pn(n),n instanceof Error?n:(3600*n.getHours()+60*n.getMinutes()+n.getSeconds())/86400}function X0(){const n=dt(new Date);return Pe?Le(n):n}function z0(n,e){if(n=pn(n),n instanceof Error)return n;e===void 0&&(e=1);const r=n.getDay();return P0[e][r]}function Y0(n,e){if(n=pn(n),n instanceof Error)return n;if(e===void 0&&(e=1),e===21)return dl(n);const r=D0[e];let t=new Date(n.getFullYear(),0,1);const i=t.getDay()<r?1:0;return t-=Math.abs(t.getDay()-r)*24*60*60*1e3,Math.floor((n-t)/(1e3*60*60*24)/7+1)+i}function Tt(n,e,r){return Tt.INTL(n,e,1,r)}Tt.INTL=(n,e,r,t)=>{if(n=pn(n),n instanceof Error)return n;if(e=A(e),e instanceof Error)return e;if(r===void 0?r=ht[1]:r=ht[r],!(r instanceof Array))return k;t===void 0?t=[]:t instanceof Array||(t=[t]);for(let a=0;a<t.length;a++){const h=pn(t[a]);if(h instanceof Error)return h;t[a]=h}let i=0;const u=Math.sign(e);for(;i<e*u;){n.setDate(n.getDate()+u);const a=n.getDay();if(!(a===r[0]||a===r[1])){for(let h=0;h<t.length;h++){const d=t[h];if(d.getDate()===n.getDate()&&d.getMonth()===n.getMonth()&&d.getFullYear()===n.getFullYear()){i--;break}}i++}}return n.getFullYear()<1900?k:n};function Z0(n){return n=pn(n),n instanceof Error?n:n.getFullYear()}function Jt(n){return new Date(n,1,29).getMonth()===1}function jr(n,e){return Math.ceil((e-n)/1e3/60/60/24)}function Bi(n,e,r){if(n=pn(n),n instanceof Error)return n;if(e=pn(e),e instanceof Error)return e;r=r||0;let t=n.getDate();const i=n.getMonth()+1,u=n.getFullYear();let a=e.getDate();const h=e.getMonth()+1,d=e.getFullYear();switch(r){case 0:return t===31&&a===31?(t=30,a=30):t===31?t=30:t===30&&a===31&&(a=30),(a+h*30+d*360-(t+i*30+u*360))/360;case 1:{const f=(g,v)=>{const p=g.getFullYear(),N=new Date(p,2,1);if(Jt(p)&&g<N&&v>=N)return!0;const w=v.getFullYear(),E=new Date(w,2,1);return Jt(w)&&v>=E&&g<E};let o=365;if(u===d||u+1===d&&(i>h||i===h&&t>=a))return(u===d&&Jt(u)||f(n,e)||h===1&&a===29)&&(o=366),jr(n,e)/o;const l=d-u+1,c=(new Date(d+1,0,1)-new Date(u,0,1))/1e3/60/60/24/l;return jr(n,e)/c}case 2:return jr(n,e)/360;case 3:return jr(n,e)/365;case 4:return(a+h*30+d*360-(t+i*30+u*360))/360}}function Ji(n){return/^[01]{1,10}$/.test(n)}function K0(n,e){return n=A(n),e=A(e),$(n,e)?k:pt.besseli(n,e)}function Q0(n,e){return n=A(n),e=A(e),$(n,e)?k:pt.besselj(n,e)}function _0(n,e){return n=A(n),e=A(e),$(n,e)?k:pt.besselk(n,e)}function j0(n,e){return n=A(n),e=A(e),$(n,e)?k:pt.bessely(n,e)}function n1(n){if(!Ji(n))return J;const e=parseInt(n,2),r=n.toString();return r.length===10&&r.substring(0,1)==="1"?parseInt(r.substring(1),2)-512:e}function e1(n,e){if(!Ji(n))return J;const r=n.toString();if(r.length===10&&r.substring(0,1)==="1")return(0xfffffffe00+parseInt(r.substring(1),2)).toString(16);const t=parseInt(n,2).toString(16);return e===void 0?t:isNaN(e)?k:e<0?J:(e=Math.floor(e),e>=t.length?se("0",e-t.length)+t:J)}function r1(n,e){if(!Ji(n))return J;const r=n.toString();if(r.length===10&&r.substring(0,1)==="1")return(1073741312+parseInt(r.substring(1),2)).toString(8);const t=parseInt(n,2).toString(8);return e===void 0?t:isNaN(e)?k:e<0?J:(e=Math.floor(e),e>=t.length?se("0",e-t.length)+t:J)}function t1(n,e){return n=A(n),e=A(e),$(n,e)?k:n<0||e<0||Math.floor(n)!==n||Math.floor(e)!==e||n>0xffffffffffff||e>0xffffffffffff?J:n&e}function i1(n,e){return n=A(n),e=A(e),$(n,e)?k:n<0||Math.floor(n)!==n||n>0xffffffffffff||Math.abs(e)>53?J:e>=0?n<<e:n>>-e}function o1(n,e){return n=A(n),e=A(e),$(n,e)?k:n<0||e<0||Math.floor(n)!==n||Math.floor(e)!==e||n>0xffffffffffff||e>0xffffffffffff?J:n|e}function u1(n,e){return n=A(n),e=A(e),$(n,e)?k:n<0||Math.floor(n)!==n||n>0xffffffffffff||Math.abs(e)>53?J:e>=0?n>>e:n<<-e}function l1(n,e){return n=A(n),e=A(e),$(n,e)?k:n<0||e<0||Math.floor(n)!==n||Math.floor(e)!==e||n>0xffffffffffff||e>0xffffffffffff?J:n^e}function ee(n,e,r){if(n=A(n),e=A(e),$(n,e))return n;if(r=r===void 0?"i":r,r!=="i"&&r!=="j")return k;if(n===0&&e===0)return 0;if(n===0)return e===1?r:e.toString()+r;if(e===0)return n.toString();{const t=e>0?"+":"";return n.toString()+t+(e===1?r:e.toString()+r)}}function f1(n,e,r){if(n=A(n),n instanceof Error)return n;const t=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ngstrm","",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ngstrm","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m3",["m^3"],"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestrke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ngstrm","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],i={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},u={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};let a=null,h=null,d=e,f=r,o=1,l=1,s;for(let c=0;c<t.length;c++)s=t[c][2]===null?[]:t[c][2],(t[c][1]===d||s.indexOf(d)>=0)&&(a=t[c]),(t[c][1]===f||s.indexOf(f)>=0)&&(h=t[c]);if(a===null){const c=i[e.substring(0,2)];let g=u[e.substring(0,1)];e.substring(0,2)==="da"&&(g=["dekao",10,"da"]),c?(o=c[2],d=e.substring(2)):g&&(o=g[1],d=e.substring(g[2].length));for(let v=0;v<t.length;v++)s=t[v][2]===null?[]:t[v][2],(t[v][1]===d||s.indexOf(d)>=0)&&(a=t[v])}if(h===null){const c=i[r.substring(0,2)];let g=u[r.substring(0,1)];r.substring(0,2)==="da"&&(g=["dekao",10,"da"]),c?(l=c[2],f=r.substring(2)):g&&(l=g[1],f=r.substring(g[2].length));for(let v=0;v<t.length;v++)s=t[v][2]===null?[]:t[v][2],(t[v][1]===f||s.indexOf(f)>=0)&&(h=t[v])}return a===null||h===null||a[3]!==h[3]?un:n*a[6]*o/(h[6]*l)}function s1(n,e){if(n=A(n),n instanceof Error)return n;if(!/^-?[0-9]{1,3}$/.test(n)||n<-512||n>511)return J;if(n<0)return"1"+se("0",9-(512+n).toString(2).length)+(512+n).toString(2);const r=parseInt(n,10).toString(2);return typeof e>"u"?r:isNaN(e)?k:e<0?J:(e=Math.floor(e),e>=r.length?se("0",e-r.length)+r:J)}function c1(n,e){if(n=A(n),n instanceof Error)return n;if(!/^-?[0-9]{1,12}$/.test(n)||n<-549755813888||n>549755813887)return J;if(n<0)return(1099511627776+n).toString(16);const r=parseInt(n,10).toString(16);return typeof e>"u"?r:isNaN(e)?k:e<0?J:(e=Math.floor(e),e>=r.length?se("0",e-r.length)+r:J)}function a1(n,e){if(n=A(n),n instanceof Error)return n;if(!/^-?[0-9]{1,9}$/.test(n)||n<-536870912||n>536870911)return J;if(n<0)return(1073741824+n).toString(8);const r=parseInt(n,10).toString(8);return typeof e>"u"?r:isNaN(e)?k:e<0?J:(e=Math.floor(e),e>=r.length?se("0",e-r.length)+r:J)}function h1(n,e){return e=e===void 0?0:e,n=A(n),e=A(e),$(n,e)?k:n===e?1:0}function gl(n,e){return e=e===void 0?0:e,n=A(n),e=A(e),$(n,e)?k:K.erf(n)}function vl(n){return isNaN(n)?k:K.erfc(n)}function d1(n,e){return e=e||0,n=A(n),$(e,n)?n:n>=e?1:0}function g1(n,e){if(!/^[0-9A-Fa-f]{1,10}$/.test(n))return J;const r=n.length===10&&n.substring(0,1).toLowerCase()==="f",t=r?parseInt(n,16)-1099511627776:parseInt(n,16);if(t<-512||t>511)return J;if(r)return"1"+se("0",9-(512+t).toString(2).length)+(512+t).toString(2);const i=t.toString(2);return e===void 0?i:isNaN(e)?k:e<0?J:(e=Math.floor(e),e>=i.length?se("0",e-i.length)+i:J)}function v1(n){if(!/^[0-9A-Fa-f]{1,10}$/.test(n))return J;const e=parseInt(n,16);return e>=549755813888?e-1099511627776:e}function p1(n,e){if(!/^[0-9A-Fa-f]{1,10}$/.test(n))return J;const r=parseInt(n,16);if(r>536870911&&r<0xffe0000000)return J;if(r>=0xffe0000000)return(r-0xffc0000000).toString(8);const t=r.toString(8);return e===void 0?t:isNaN(e)?k:e<0?J:(e=Math.floor(e),e>=t.length?se("0",e-t.length)+t:J)}function Vi(n){const e=xn(n),r=Pn(n);return $(e,r)?k:Math.sqrt(Math.pow(e,2)+Math.pow(r,2))}function Pn(n){if(n===void 0||n===!0||n===!1)return k;if(n===0||n==="0")return 0;if(["i","j"].indexOf(n)>=0)return 1;n=n+"",n=n.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");let e=n.indexOf("+"),r=n.indexOf("-");e===0&&(e=n.indexOf("+",1)),r===0&&(r=n.indexOf("-",1));const t=n.substring(n.length-1,n.length),i=t==="i"||t==="j";return e>=0||r>=0?i?e>=0?isNaN(n.substring(0,e))||isNaN(n.substring(e+1,n.length-1))?J:Number(n.substring(e+1,n.length-1)):isNaN(n.substring(0,r))||isNaN(n.substring(r+1,n.length-1))?J:-Number(n.substring(r+1,n.length-1)):J:i?isNaN(n.substring(0,n.length-1))?J:n.substring(0,n.length-1):isNaN(n)?J:0}function qi(n){const e=xn(n),r=Pn(n);return $(e,r)?k:e===0&&r===0?Kn:e===0&&r>0?Math.PI/2:e===0&&r<0?-Math.PI/2:r===0&&e>0?0:r===0&&e<0?-Math.PI:e>0?Math.atan(r/e):e<0&&r>=0?Math.atan(r/e)+Math.PI:Math.atan(r/e)-Math.PI}function E1(n){const e=xn(n),r=Pn(n);if($(e,r))return k;let t=n.substring(n.length-1);return t=t==="i"||t==="j"?t:"i",r!==0?ee(e,-r,t):n}function It(n){const e=xn(n),r=Pn(n);if($(e,r))return k;let t=n.substring(n.length-1);return t=t==="i"||t==="j"?t:"i",ee(Math.cos(e)*(Math.exp(r)+Math.exp(-r))/2,-Math.sin(e)*(Math.exp(r)-Math.exp(-r))/2,t)}function pl(n){const e=xn(n),r=Pn(n);if($(e,r))return k;let t=n.substring(n.length-1);return t=t==="i"||t==="j"?t:"i",ee(Math.cos(r)*(Math.exp(e)+Math.exp(-e))/2,Math.sin(r)*(Math.exp(e)-Math.exp(-e))/2,t)}function N1(n){const e=xn(n),r=Pn(n);return $(e,r)?k:_e(It(n),Ot(n))}function _e(n,e){const r=xn(n),t=Pn(n),i=xn(e),u=Pn(e);if($(r,t,i,u))return k;const a=n.substring(n.length-1),h=e.substring(e.length-1);let d="i";if((a==="j"||h==="j")&&(d="j"),i===0&&u===0)return J;const f=i*i+u*u;return ee((r*i+t*u)/f,(t*i-r*u)/f,d)}function w1(n){const e=xn(n),r=Pn(n);if($(e,r))return k;let t=n.substring(n.length-1);t=t==="i"||t==="j"?t:"i";const i=Math.exp(e);return ee(i*Math.cos(r),i*Math.sin(r),t)}function y1(n){const e=xn(n),r=Pn(n);if($(e,r))return k;let t=n.substring(n.length-1);return t=t==="i"||t==="j"?t:"i",ee(Math.log(Math.sqrt(e*e+r*r)),Math.atan(r/e),t)}function m1(n){const e=xn(n),r=Pn(n);if($(e,r))return k;let t=n.substring(n.length-1);return t=t==="i"||t==="j"?t:"i",ee(Math.log(Math.sqrt(e*e+r*r))/Math.log(10),Math.atan(r/e)/Math.log(10),t)}function A1(n){const e=xn(n),r=Pn(n);if($(e,r))return k;let t=n.substring(n.length-1);return t=t==="i"||t==="j"?t:"i",ee(Math.log(Math.sqrt(e*e+r*r))/Math.log(2),Math.atan(r/e)/Math.log(2),t)}function R1(n,e){e=A(e);const r=xn(n),t=Pn(n);if($(e,r,t))return k;let i=n.substring(n.length-1);i=i==="i"||i==="j"?i:"i";const u=Math.pow(Vi(n),e),a=qi(n);return ee(u*Math.cos(e*a),u*Math.sin(e*a),i)}function T1(){let n=arguments[0];if(!arguments.length)return k;for(let e=1;e<arguments.length;e++){const r=xn(n),t=Pn(n),i=xn(arguments[e]),u=Pn(arguments[e]);if($(r,t,i,u))return k;n=ee(r*i-t*u,r*u+t*i)}return n}function xn(n){if(n===void 0||n===!0||n===!1)return k;if(n===0||n==="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(n)>=0)return 0;n=n+"";let e=n.indexOf("+"),r=n.indexOf("-");e===0&&(e=n.indexOf("+",1)),r===0&&(r=n.indexOf("-",1));const t=n.substring(n.length-1,n.length),i=t==="i"||t==="j";return e>=0||r>=0?i?e>=0?isNaN(n.substring(0,e))||isNaN(n.substring(e+1,n.length-1))?J:Number(n.substring(0,e)):isNaN(n.substring(0,r))||isNaN(n.substring(r+1,n.length-1))?J:Number(n.substring(0,r)):J:i?isNaN(n.substring(0,n.length-1))?J:0:isNaN(n)?J:n}function I1(n){if(n===!0||n===!1)return k;const e=xn(n),r=Pn(n);return $(e,r)?k:_e("1",It(n))}function O1(n){const e=xn(n),r=Pn(n);return $(e,r)?k:_e("1",pl(n))}function Ot(n){const e=xn(n),r=Pn(n);if($(e,r))return k;let t=n.substring(n.length-1);return t=t==="i"||t==="j"?t:"i",ee(Math.sin(e)*(Math.exp(r)+Math.exp(-r))/2,Math.cos(e)*(Math.exp(r)-Math.exp(-r))/2,t)}function El(n){const e=xn(n),r=Pn(n);if($(e,r))return k;let t=n.substring(n.length-1);return t=t==="i"||t==="j"?t:"i",ee(Math.cos(r)*(Math.exp(e)-Math.exp(-e))/2,Math.sin(r)*(Math.exp(e)+Math.exp(-e))/2,t)}function S1(n){const e=xn(n),r=Pn(n);if($(e,r))return k;let t=n.substring(n.length-1);t=t==="i"||t==="j"?t:"i";const i=Math.sqrt(Vi(n)),u=qi(n);return ee(i*Math.cos(u/2),i*Math.sin(u/2),t)}function k1(n){if(n===!0||n===!1)return k;const e=xn(n),r=Pn(n);return $(e,r)?J:_e("1",Ot(n))}function M1(n){if(n===!0||n===!1)return k;const e=xn(n),r=Pn(n);return $(e,r)?J:_e("1",El(n))}function C1(n,e){const r=xn(n),t=Pn(n),i=xn(e),u=Pn(e);if($(r,t,i,u))return k;const a=n.substring(n.length-1),h=e.substring(e.length-1);let d="i";return(a==="j"||h==="j")&&(d="j"),ee(r-i,t-u,d)}function L1(){if(!arguments.length)return k;const n=b(arguments);let e=0,r=0;for(const t of n){const i=+xn(t),u=+Pn(t);if($(i,u))return k;e+=i,r+=u}return ee(e,r,"i")}function D1(n){if(n===!0||n===!1)return k;const e=xn(n),r=Pn(n);return $(e,r)?k:_e(Ot(n),It(n))}function P1(n,e){if(!/^[0-7]{1,10}$/.test(n))return J;const r=n.length===10&&n.substring(0,1)==="7",t=r?parseInt(n,8)-1073741824:parseInt(n,8);if(t<-512||t>511)return J;if(r)return"1"+se("0",9-(512+t).toString(2).length)+(512+t).toString(2);const i=t.toString(2);return typeof e>"u"?i:isNaN(e)?k:e<0?J:(e=Math.floor(e),e>=i.length?se("0",e-i.length)+i:J)}function x1(n){if(!/^[0-7]{1,10}$/.test(n))return J;const e=parseInt(n,8);return e>=536870912?e-1073741824:e}function U1(n,e){if(!/^[0-7]{1,10}$/.test(n))return J;const r=parseInt(n,8);if(r>=536870912)return"ff"+(r+3221225472).toString(16);const t=r.toString(16);return e===void 0?t:isNaN(e)?k:e<0?J:(e=Math.floor(e),e>=t.length?se("0",e-t.length)+t:J)}const F1=Hr.DIST,B1=Hr.INV,J1=Sr.DIST,V1=qe.MATH,q1=qe.PRECISE,H1=Re.DIST,$1=Re.DIST.RT,b1=Re.INV,G1=Re.INV.RT,W1=Re.TEST,X1=kr.P,z1=kr.P,Y1=kr.S,Z1=Sr.INV,K1=vl.PRECISE,Q1=gl.PRECISE,_1=ki.DIST,j1=Te.DIST,nh=Te.DIST.RT,eh=Te.INV,rh=Te.INV.RT,th=Ze.MATH,ih=Ze.PRECISE,oh=Te.TEST,uh=$r.DIST,lh=$r.INV,fh=Mi.PRECISE,sh=Ci.DIST,ch=Mr.INV,ah=Mr.DIST,hh=Mr.INV,dh=ze.MULT,gh=ze.SNGL,vh=Di.DIST,ph=Rt.INTL,Eh=Ie.DIST,Nh=Ie.INV,wh=Ie.S.DIST,yh=Ie.S.INV,mh=fe.EXC,Ah=fe.INC,Rh=br.EXC,Th=br.INC,Ih=Pi.DIST,Oh=Ye.EXC,Sh=Ye.INC,kh=Gr.AVG,Mh=Gr.EQ,Ch=xi.P,Lh=oe.P,Dh=oe.S,Ph=ue.DIST,xh=ue.DIST.RT,Uh=ue.INV,Fh=ue.TEST,Bh=te.P,Jh=te.S,Vh=Ui.DIST,qh=Tt.INTL,Hh=Fi.TEST;function Hi(n){const e=[];return ne(n,r=>{r&&e.push(r)}),e}function de(n,e){const r={};for(let u=1;u<n[0].length;++u)r[u]=!0;let t=e[0].length;for(let u=1;u<e.length;++u)e[u].length>t&&(t=e[u].length);for(let u=1;u<n.length;++u)for(let a=1;a<n[u].length;++a){let h=!1,d=!1;for(let f=0;f<e.length;++f){const o=e[f];if(o.length<t)continue;const l=o[0];if(n[u][0]===l){d=!0;for(let s=1;s<o.length;++s)if(!h)if(o[s]===void 0||o[s]==="*")h=!0;else{const g=Ir(o[s]+""),v=[Me(n[u][a],$e)].concat(g);h=Or(v)}}}d&&(r[a]=r[a]&&h)}const i=[];for(let u=0;u<n[0].length;++u)r[u]&&i.push(u-1);return i}function $h(n,e,r){if(isNaN(e)&&typeof e!="string")return k;const t=de(n,r);let i=[];if(typeof e=="string"){const a=he(n,e);i=Fn(n[a])}else i=Fn(n[e]);let u=0;return ne(t,a=>{u+=i[a]}),t.length===0?Kn:u/t.length}function bh(n,e,r){if(isNaN(e)&&typeof e!="string")return k;const t=de(n,r);let i=[];if(typeof e=="string"){const a=he(n,e);i=Fn(n[a])}else i=Fn(n[e]);const u=[];return ne(t,a=>{u.push(i[a])}),Br(u)}function Gh(n,e,r){if(isNaN(e)&&typeof e!="string")return k;const t=de(n,r);let i=[];if(typeof e=="string"){const a=he(n,e);i=Fn(n[a])}else i=Fn(n[e]);const u=[];return ne(t,a=>{u.push(i[a])}),Jr(u)}function Wh(n,e,r){if(isNaN(e)&&typeof e!="string")return k;const t=de(n,r);let i=[];if(typeof e=="string"){const u=he(n,e);i=Fn(n[u])}else i=Fn(n[e]);return t.length===0?k:t.length>1?J:i[t[0]]}function Xh(n,e,r){if(isNaN(e)&&typeof e!="string")return k;const t=de(n,r);let i=[];if(typeof e=="string"){const a=he(n,e);i=Fn(n[a])}else i=Fn(n[e]);let u=i[t[0]];return ne(t,a=>{u<i[a]&&(u=i[a])}),u}function zh(n,e,r){if(isNaN(e)&&typeof e!="string")return k;const t=de(n,r);let i=[];if(typeof e=="string"){const a=he(n,e);i=Fn(n[a])}else i=Fn(n[e]);let u=i[t[0]];return ne(t,a=>{u>i[a]&&(u=i[a])}),u}function Yh(n,e,r){if(isNaN(e)&&typeof e!="string")return k;const t=de(n,r);let i=[];if(typeof e=="string"){const h=he(n,e);i=Fn(n[h])}else i=Fn(n[e]);let u=[];ne(t,h=>{u.push(i[h])}),u=Hi(u);let a=1;return ne(u,h=>{a*=h}),a}function Zh(n,e,r){if(isNaN(e)&&typeof e!="string")return k;const t=de(n,r);let i=[];if(typeof e=="string"){const a=he(n,e);i=Fn(n[a])}else i=Fn(n[e]);let u=[];return ne(t,a=>{u.push(i[a])}),u=Hi(u),oe.S(u)}function Kh(n,e,r){if(isNaN(e)&&typeof e!="string")return k;const t=de(n,r);let i=[];if(typeof e=="string"){const a=he(n,e);i=Fn(n[a])}else i=Fn(n[e]);let u=[];return ne(t,a=>{u.push(i[a])}),u=Hi(u),oe.P(u)}function Qh(n,e,r){if(isNaN(e)&&typeof e!="string")return k;const t=de(n,r);let i=[];if(typeof e=="string"){const a=he(n,e);i=Fn(n[a])}else i=Fn(n[e]);const u=[];return ne(t,a=>{u.push(i[a])}),De(u)}function _h(n,e,r){if(isNaN(e)&&typeof e!="string")return k;const t=de(n,r);let i=[];if(typeof e=="string"){const a=he(n,e);i=Fn(n[a])}else i=Fn(n[e]);const u=[];return ne(t,a=>{u.push(i[a])}),te.S(u)}function jh(n,e,r){if(isNaN(e)&&typeof e!="string")return k;const t=de(n,r);let i=[];if(typeof e=="string"){const a=he(n,e);i=Fn(n[a])}else i=Fn(n[e]);const u=[];return ne(t,a=>{u.push(i[a])}),te.P(u)}function Vt(n){return n&&n.getTime&&!isNaN(n.getTime())}function qt(n){return n instanceof Date?n:new Date(n)}function nd(n,e,r){let t=pn(e);for(t.setFullYear(n.getFullYear()),t<n&&t.setFullYear(t.getFullYear()+1);t>n;)t.setMonth(t.getMonth()+-12/r);return t}function Nl(n){return n=A(n),[1,2,4].indexOf(n)===-1?J:n}function wl(n){return n=A(n),[0,1,2,3,4].indexOf(n)===-1?J:n}function ed(n,e,r,t,i,u,a){return n=qt(n),e=qt(e),r=qt(r),u=Nl(u),a=wl(a),gn(u,a)?J:!Vt(n)||!Vt(e)||!Vt(r)?k:t<=0||i<=0||r<=n?J:(i=i||0,a=a||0,i*t*Bi(n,r,a))}function rd(n,e,r,t){if(t=wl(t),r=Nl(r),n=pn(n),e=pn(e),gn(n,e))return k;if(gn(r,t)||n>=e)return J;if(t===1){let u=nd(n,e,r),a=pn(u);return a.setMonth(a.getMonth()+12/r),Je(u,a,"D")}let i;switch(t){case 0:case 2:case 4:i=360;break;case 3:i=365;break;default:return J}return i/r}function td(n,e,r,t,i,u){if(n=A(n),e=A(e),r=A(r),$(n,e,r))return k;if(n<=0||e<=0||r<=0||t<1||i<1||t>i||u!==0&&u!==1)return J;const a=Wr(n,e,r,0,u);let h=0;t===1&&(u===0&&(h=-r),t++);for(let d=t;d<=i;d++)h+=u===1?Ke(n,d-2,a,r,1)-a:Ke(n,d-1,a,r,0);return h*=n,h}function id(n,e,r,t,i,u){if(n=A(n),e=A(e),r=A(r),$(n,e,r))return k;if(n<=0||e<=0||r<=0||t<1||i<1||t>i||u!==0&&u!==1)return J;const a=Wr(n,e,r,0,u);let h=0;t===1&&(h=u===0?a+r*n:a,t++);for(let d=t;d<=i;d++)h+=u>0?a-(Ke(n,d-2,a,r,1)-a)*n:a-Ke(n,d-1,a,r,0)*n;return h}function od(n,e,r,t,i){if(i=i===void 0?12:i,n=A(n),e=A(e),r=A(r),t=A(t),i=A(i),$(n,e,r,t,i))return k;if(n<0||e<0||r<0||t<0||[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(i)===-1||t>r)return J;if(e>=n)return 0;const u=(1-Math.pow(e/n,1/r)).toFixed(3),a=n*u*i/12;let h=a,d=0;const f=t===r?r-1:t;for(let o=2;o<=f;o++)d=(n-h)*u,h+=d;return t===1?a:t===r?(n-h)*u:d}function ud(n,e,r,t,i){if(i=i===void 0?2:i,n=A(n),e=A(e),r=A(r),t=A(t),i=A(i),$(n,e,r,t,i))return k;if(n<0||e<0||r<0||t<0||i<=0||t>r)return J;if(e>=n)return 0;let u=0,a=0;for(let h=1;h<=t;h++)a=Math.min((n-u)*(i/r),n-e-u),u+=a;return a}function ld(n,e,r,t,i){if(n=pn(n),e=pn(e),r=A(r),t=A(t),i=A(i),i=i||0,$(n,e,r,t,i))return k;if(r<=0||t<=0)return J;if(n>=e)return k;let u,a;switch(i){case 0:u=360,a=He(n,e,!1);break;case 1:u=365,a=Je(n,e,"D");break;case 2:u=360,a=Je(n,e,"D");break;case 3:u=365,a=Je(n,e,"D");break;case 4:u=360,a=He(n,e,!0);break;default:return J}return(t-r)/t*u/a}function fd(n,e){if(n=A(n),e=A(e),$(n,e))return k;if(e<0)return J;if(e>=0&&e<1)return Kn;e=parseInt(e,10);let r=parseInt(n,10);r+=n%1*Math.pow(10,Math.ceil(Math.log(e)/Math.LN10))/e;const t=Math.pow(10,Math.ceil(Math.log(e)/Math.LN2)+1);return r=Math.round(r*t)/t,r}function sd(n,e){if(n=A(n),e=A(e),$(n,e))return k;if(e<0)return J;if(e>=0&&e<1)return Kn;e=parseInt(e,10);let r=parseInt(n,10);return r+=n%1*Math.pow(10,-Math.ceil(Math.log(e)/Math.LN10))*e,r}function cd(n,e){return n=A(n),e=A(e),$(n,e)?k:n<=0||e<1?J:(e=parseInt(e,10),Math.pow(1+n/e,e)-1)}function Ke(n,e,r,t,i){if(t=t||0,i=i||0,n=A(n),e=A(e),r=A(r),t=A(t),i=A(i),$(n,e,r,t,i))return k;let u;if(n===0)u=t+r*e;else{const a=Math.pow(1+n,e);u=i===1?t*a+r*(1+n)*(a-1)/n:t*a+r*(a-1)/n}return-u}function ad(n,e){if(n=A(n),e=j(b(e)),$(n,e))return k;const r=e.length;let t=n;for(let i=0;i<r;i++)t*=1+e[i];return t}function yl(n,e,r,t,i,u){if(i=i||0,u=u||0,n=A(n),e=A(e),r=A(r),t=A(t),i=A(i),u=A(u),$(n,e,r,t,i,u))return k;const a=Wr(n,r,t,i,u);return(e===1?u===1?0:-t:u===1?Ke(n,e-2,a,t,1)-a:Ke(n,e-1,a,t,0))*n}function hd(n,e){if(e=typeof e=="number"?e:typeof e>"u"?.1:A(e),n=b(n).filter(Qe),n=j(n),$(n,e))return k;const r=new Float64Array(n.length);let t=!1,i=!1;for(let f=0;f<n.length;f++)r[f]=n[f],r[f]>0&&(t=!0),r[f]<0&&(i=!0);if(!t||!i)return J;const u=f=>{f<=-1&&(f=-.999999999);let o=r[0];const l=1+f;let s=1;for(let c=1;c<r.length;c++)s*=l,o+=r[c]/s;return o},a=new Map,h=function(f){const o=Math.round(f*1e10)/1e10;if(a.has(o))return a.get(o);const l=u(o);return a.set(o,l),l};return function(){let l=e,s=l,c=0;for(;c<1e3;){const w=h(l);if(Math.abs(w)<1e-10)return l;if(c>0&&Math.abs(l-s)<1e-10*10)break;const E=Math.max(1e-4,Math.abs(l*1e-4)),y=(h(l+E)-w)/E;if(Math.abs(y)<1e-10)break;s=l;const R=w/y,I=Math.max(.1,Math.abs(l)*.5);Math.abs(R)>I?l-=Math.sign(R)*I:l-=R,l<=-1&&(l=-.99999999),l>1e3&&(l=1e3),c++}let g=h(l);if(Math.abs(g)<1e-10)return l;let v,p;if(g>0){for(v=l,p=l+.1;h(p)>0&&p<1e3;)p=p*2+.1;if(p>=1e3)return l}else{for(p=l,v=Math.max(-.99999999,l-.1);h(v)<0&&v>-.99999999;)v=Math.max(-.99999999,v-.1);if(v<=-.99999999)return l}let N;for(let w=0;w<1e3;w++){N=(v+p)/2;const E=h(N);if(Math.abs(E)<1e-10||Math.abs(p-v)<1e-10)return N;E*h(v)<0?p=N:v=N}return N}()}function dd(n,e,r,t){return n=A(n),e=A(e),r=A(r),t=A(t),$(n,e,r,t)?k:t*n*(e/r-1)}function gd(n,e,r){if(n=j(b(n)),e=A(e),r=A(r),$(n,e,r))return k;const t=n.length,i=[],u=[];for(let d=0;d<t;d++)n[d]<0?i.push(n[d]):u.push(n[d]);const a=-gi(r,u)*Math.pow(1+r,t-1),h=gi(e,i)*(1+e);return Math.pow(a/h,1/(t-1))-1}function vd(n,e){return n=A(n),e=A(e),$(n,e)?k:n<=0||e<1?J:(e=parseInt(e,10),(Math.pow(n+1,1/e)-1)*e)}function pd(n,e,r,t,i){if(i=i===void 0?0:i,t=t===void 0?0:t,n=A(n),e=A(e),r=A(r),t=A(t),i=A(i),$(n,e,r,t,i))return k;if(n===0)return-(r+t)/e;{const u=e*(1+n*i)-t*n,a=r*n+e*(1+n*i);return Math.log(u/a)/Math.log(1+n)}}function gi(){const n=j(b(arguments));if(n instanceof Error)return n;const e=n[0];let r=0;for(let t=1;t<n.length;t++)r+=n[t]/Math.pow(1+e,t);return r}function Ed(n,e,r){return n=A(n),e=A(e),r=A(r),$(n,e,r)?k:n<=0?J:(Math.log(r)-Math.log(e))/Math.log(1+n)}function Wr(n,e,r,t,i){if(t=t||0,i=i||0,n=A(n),e=A(e),r=A(r),t=A(t),i=A(i),$(n,e,r,t,i))return k;let u;if(n===0)u=(r+t)/e;else{const a=Math.pow(1+n,e);u=i===1?(t*n/(a-1)+r*n/(1-1/a))/(1+n):t*n/(a-1)+r*n/(1-1/a)}return-u}function Nd(n,e,r,t,i,u){return i=i||0,u=u||0,n=A(n),r=A(r),t=A(t),i=A(i),u=A(u),$(n,r,t,i,u)?k:Wr(n,r,t,i,u)-yl(n,e,r,t,i,u)}function wd(n,e,r,t,i){if(n=pn(n),e=pn(e),r=A(r),t=A(t),i=A(i),i=i||0,$(n,e,r,t,i))return k;if(r<=0||t<=0)return J;if(n>=e)return k;let u,a;switch(i){case 0:u=360,a=He(n,e,!1);break;case 1:u=365,a=Je(n,e,"D");break;case 2:u=360,a=Je(n,e,"D");break;case 3:u=365,a=Je(n,e,"D");break;case 4:u=360,a=He(n,e,!0);break;default:return J}return t-r*t*a/u}function yd(n,e,r,t,i){return t=t||0,i=i||0,n=A(n),e=A(e),r=A(r),t=A(t),i=A(i),$(n,e,r,t,i)?k:n===0?-r*e-t:((1-Math.pow(1+n,e))/n*r*(1+n*i)-t)/Math.pow(1+n,e)}function md(n,e,r,t,i,u){if(u=u===void 0?.1:u,t=t===void 0?0:t,i=i===void 0?0:i,n=A(n),e=A(e),r=A(r),t=A(t),i=A(i),u=A(u),$(n,e,r,t,i,u))return k;const a=1e-10,h=100;let d=u;i=i?1:0;for(let f=0;f<h;f++){if(d<=-1)return J;let o,l;if(Math.abs(d)<a?o=r*(1+n*d)+e*(1+d*i)*n+t:(l=Math.pow(1+d,n),o=r*l+e*(1/d+i)*(l-1)+t),Math.abs(o)<a)return d;let s;if(Math.abs(d)<a)s=r*n+e*i*n;else{l=Math.pow(1+d,n);const c=n*Math.pow(1+d,n-1);s=r*c+e*(1/d+i)*c+e*(-1/(d*d))*(l-1)}d-=o/s}return d}function Ad(n,e,r){return n=A(n),e=A(e),r=A(r),$(n,e,r)?k:n===0||e===0?J:Math.pow(r/e,1/n)-1}function Rd(n,e,r){return n=A(n),e=A(e),r=A(r),$(n,e,r)?k:r===0?J:(n-e)/r}function Td(n,e,r,t){return n=A(n),e=A(e),r=A(r),t=A(t),$(n,e,r,t)?k:r===0||t<1||t>r?J:(t=parseInt(t,10),(n-e)*(r-t+1)*2/(r*(r+1)))}function Id(n,e,r){return n=pn(n),e=pn(e),r=A(r),$(n,e,r)?k:r<=0||n>e||e-n>365*24*60*60*1e3?J:365*r/(360-r*He(n,e,!1))}function Od(n,e,r){return n=pn(n),e=pn(e),r=A(r),$(n,e,r)?k:r<=0||n>e||e-n>365*24*60*60*1e3?J:100*(1-r*He(n,e,!1)/360)}function Sd(n,e,r){return n=pn(n),e=pn(e),r=A(r),$(n,e,r)?k:r<=0||n>e||e-n>365*24*60*60*1e3?J:(100-r)*360/(r*He(n,e,!1))}function kd(n,e,r){if(n=j(b(n)),e=Xu(b(e)),r=A(r),$(n,e,r))return k;const t=(c,g,v)=>{const p=v+1;let N=c[0];for(let w=1;w<c.length;w++)N+=c[w]/Math.pow(p,We(g[w],g[0])/365);return N},i=(c,g,v)=>{const p=v+1;let N=0;for(let w=1;w<c.length;w++){const E=We(g[w],g[0])/365;N-=E*c[w]/Math.pow(p,E+1)}return N};let u=!1,a=!1;for(let c=0;c<n.length;c++)n[c]>0&&(u=!0),n[c]<0&&(a=!0);if(!u||!a)return J;r=r||.1;let h=r;const d=1e-10;let f,o,l,s=!0;do l=t(n,e,h),f=h-l/i(n,e,h),o=Math.abs(f-h),h=f,s=o>d&&Math.abs(l)>d;while(s);return h}function Md(n,e,r){if(n=A(n),e=j(b(e)),r=Xu(b(r)),$(n,e,r))return k;let t=0;for(let i=0;i<e.length;i++)t+=e[i]/Math.pow(1+n,We(r[i],r[0])/365);return t}function Cd(){const n=b(arguments);let e=k;for(let r=0;r<n.length;r++){if(n[r]instanceof Error)return n[r];n[r]===void 0||n[r]===null||typeof n[r]=="string"||(e===k&&(e=!0),n[r]||(e=!1))}return e}function Ld(){return!1}function Dd(n,e,r){return n instanceof Error?n:(e=arguments.length>=2?e:!0,e==null&&(e=0),r=arguments.length===3?r:!1,r==null&&(r=0),n?e:r)}function Pd(){for(let n=0;n<arguments.length/2;n++)if(arguments[n*2])return arguments[n*2+1];return un}function xd(n,e){return mt(n)?e:n}function Ud(n,e){return n===un?e:n}function Fd(n){return typeof n=="string"?k:n instanceof Error?n:!n}function Bd(){const n=b(arguments);let e=k;for(let r=0;r<n.length;r++){if(n[r]instanceof Error)return n[r];n[r]===void 0||n[r]===null||typeof n[r]=="string"||(e===k&&(e=!1),n[r]&&(e=!0))}return e}function Jd(){return!0}function Vd(){const n=b(arguments);let e=k;for(let r=0;r<n.length;r++){if(n[r]instanceof Error)return n[r];n[r]===void 0||n[r]===null||typeof n[r]=="string"||(e===k&&(e=0),n[r]&&e++)}return e===k?e:!!(Math.floor(Math.abs(e))&1)}function qd(){let n;if(arguments.length>0){const e=arguments[0],r=arguments.length-1,t=Math.floor(r/2);let i=!1;const u=r%2!==0,a=r%2===0?null:arguments[arguments.length-1];if(t){for(let h=0;h<t;h++)if(e===arguments[h*2+1]){n=arguments[h*2+2],i=!0;break}}i||(n=u?a:un)}else n=k;return n}const Hd={errors:ks,symbols:L0,date:Ls},ml=Object.freeze(Object.defineProperty({__proto__:null,ABS:ca,ACCRINT:ed,ACOS:aa,ACOSH:ha,ACOT:da,ACOTH:ga,AGGREGATE:va,AND:Cd,ARABIC:pa,ASIN:Ea,ASINH:Na,ATAN:wa,ATAN2:ya,ATANH:ma,AVEDEV:Cc,AVERAGE:Xe,AVERAGEA:Oi,AVERAGEIF:Lc,AVERAGEIFS:Dc,BASE:Aa,BESSELI:K0,BESSELJ:Q0,BESSELK:_0,BESSELY:j0,BETA:Hr,BETADIST:F1,BETAINV:B1,BIN2DEC:n1,BIN2HEX:e1,BIN2OCT:r1,BINOM:Sr,BINOMDIST:J1,BITAND:t1,BITLSHIFT:i1,BITOR:o1,BITRSHIFT:u1,BITXOR:l1,CEILING:qe,CEILINGMATH:V1,CEILINGPRECISE:q1,CHAR:_u,CHIDIST:H1,CHIDISTRT:$1,CHIINV:b1,CHIINVRT:G1,CHISQ:Re,CHITEST:W1,CHOOSE:Qs,CLEAN:lc,CODE:ju,COLUMN:_s,COLUMNS:js,COMBIN:Rr,COMBINA:Ra,COMPLEX:ee,CONCAT:fc,CONCATENATE:nl,CONFIDENCE:Si,CONVERT:f1,CORREL:Pc,COS:Ta,COSH:Ia,COT:Oa,COTH:Sa,COUNT:Br,COUNTA:Jr,COUNTBLANK:rl,COUNTIF:xc,COUNTIFS:Uc,COUPDAYS:rd,COVAR:X1,COVARIANCE:kr,COVARIANCEP:z1,COVARIANCES:Y1,CRITBINOM:Z1,CSC:ka,CSCH:Ma,CUMIPMT:td,CUMPRINC:id,DATE:x0,DATEDIF:Je,DATEVALUE:U0,DAVERAGE:$h,DAY:F0,DAYS:We,DAYS360:He,DB:od,DCOUNT:bh,DCOUNTA:Gh,DDB:ud,DEC2BIN:s1,DEC2HEX:c1,DEC2OCT:a1,DECIMAL:Ca,DEGREES:La,DELTA:h1,DEVSQ:Fc,DGET:Wh,DISC:ld,DMAX:Xh,DMIN:zh,DOLLAR:sc,DOLLARDE:fd,DOLLARFR:sd,DPRODUCT:Yh,DSTDEV:Zh,DSTDEVP:Kh,DSUM:Qh,DVAR:_h,DVARP:jh,EDATE:B0,EFFECT:cd,EOMONTH:J0,ERF:gl,ERFC:vl,ERFCPRECISE:K1,ERFPRECISE:Q1,ERROR:zu,EVEN:Da,EXACT:cc,EXP:Pa,EXPON:ki,EXPONDIST:_1,F:Te,FACT:Ce,FACTDOUBLE:cl,FALSE:Ld,FDIST:j1,FDISTRT:nh,FIND:ac,FINV:eh,FINVRT:rh,FISHER:Bc,FISHERINV:Jc,FIXED:el,FLOOR:Ze,FLOORMATH:th,FLOORPRECISE:ih,FORECAST:tl,FREQUENCY:Vc,FTEST:oh,FV:Ke,FVSCHEDULE:ad,GAMMA:$r,GAMMADIST:uh,GAMMAINV:lh,GAMMALN:Mi,GAMMALNPRECISE:fh,GAUSS:qc,GCD:xa,GEOMEAN:Hc,GESTEP:d1,GROWTH:$c,HARMEAN:bc,HEX2BIN:g1,HEX2DEC:v1,HEX2OCT:p1,HLOOKUP:nc,HOUR:V0,HYPGEOM:Ci,HYPGEOMDIST:sh,IF:Dd,IFERROR:xd,IFNA:Ud,IFS:Pd,IMABS:Vi,IMAGINARY:Pn,IMARGUMENT:qi,IMCONJUGATE:E1,IMCOS:It,IMCOSH:pl,IMCOT:N1,IMCSC:k1,IMCSCH:M1,IMDIV:_e,IMEXP:w1,IMLN:y1,IMLOG10:m1,IMLOG2:A1,IMPOWER:R1,IMPRODUCT:T1,IMREAL:xn,IMSEC:I1,IMSECH:O1,IMSIN:Ot,IMSINH:El,IMSQRT:S1,IMSUB:C1,IMSUM:L1,IMTAN:D1,INDEX:ec,INT:Ua,INTERCEPT:Gc,IPMT:yl,IRR:hd,ISBLANK:bs,ISERR:Yu,ISERROR:mt,ISEVEN:Gs,ISLOGICAL:Zu,ISNA:Ws,ISNONTEXT:Xs,ISNUMBER:At,ISO:Fa,ISODD:zs,ISOWEEKNUM:dl,ISPMT:dd,ISTEXT:Ku,KURT:Wc,LARGE:il,LCM:Ba,LEFT:hc,LEN:dc,LINEST:Li,LN:Ja,LOG:Va,LOG10:qa,LOGEST:Xc,LOGINV:ch,LOGNORM:Mr,LOGNORMDIST:ah,LOGNORMINV:hh,LOOKUP:rc,LOWER:gc,MATCH:tc,MAX:st,MAXA:zc,MAXIFS:Yc,MEDIAN:ol,MID:vc,MIN:ct,MINA:Zc,MINIFS:Kc,MINUTE:q0,MIRR:gd,MMULT:Ha,MOD:$a,MODE:ze,MODEMULT:dh,MODESNGL:gh,MONTH:H0,MROUND:ba,MULTINOMIAL:Ga,MUNIT:Wa,N:Ys,NA:Zs,NEGBINOM:Di,NEGBINOMDIST:vh,NETWORKDAYS:Rt,NETWORKDAYSINTL:ph,NOMINAL:vd,NORM:Ie,NORMDIST:Eh,NORMINV:Nh,NORMSDIST:wh,NORMSINV:yh,NOT:Fd,NOW:$0,NPER:pd,NPV:gi,NUMBERVALUE:pc,OCT2BIN:P1,OCT2DEC:x1,OCT2HEX:U1,ODD:Xa,OR:Bd,PDURATION:Ed,PEARSON:ul,PERCENTILE:fe,PERCENTILEEXC:mh,PERCENTILEINC:Ah,PERCENTRANK:br,PERCENTRANKEXC:Rh,PERCENTRANKINC:Th,PERMUT:Qc,PERMUTATIONA:_c,PHI:jc,PI:za,PMT:Wr,POISSON:Pi,POISSONDIST:Ih,POWER:al,PPMT:Nd,PRICEDISC:wd,PROB:na,PRODUCT:at,PROPER:Ec,PV:yd,QUARTILE:Ye,QUARTILEEXC:Oh,QUARTILEINC:Sh,QUOTIENT:Ya,RADIANS:Za,RAND:Ka,RANDBETWEEN:Qa,RANK:Gr,RANKAVG:kh,RANKEQ:Mh,RATE:md,REPLACE:Nc,REPT:se,RIGHT:wc,ROMAN:_a,ROUND:hl,ROUNDDOWN:ja,ROUNDUP:n0,ROW:ea,ROWS:ic,RRI:Ad,RSQ:ra,SEARCH:yc,SEC:e0,SECH:r0,SECOND:b0,SERIESSUM:t0,SIGN:i0,SIN:o0,SINH:u0,SKEW:xi,SKEWP:Ch,SLN:Rd,SLOPE:ta,SMALL:ll,SORT:oc,SQRT:l0,SQRTPI:f0,STANDARDIZE:ia,STDEV:oe,STDEVA:oa,STDEVP:Lh,STDEVPA:ua,STDEVS:Dh,STEYX:la,SUBSTITUTE:mc,SUBTOTAL:s0,SUM:De,SUMIF:c0,SUMIFS:a0,SUMPRODUCT:h0,SUMSQ:d0,SUMX2MY2:g0,SUMX2PY2:v0,SUMXMY2:p0,SWITCH:qd,SYD:Td,T:ue,TAN:E0,TANH:N0,TBILLEQ:Id,TBILLPRICE:Od,TBILLYIELD:Sd,TDIST:Ph,TDISTRT:xh,TEXT:Ac,TEXTJOIN:Rc,TIME:G0,TIMEVALUE:W0,TINV:Uh,TODAY:X0,TRANSPOSE:uc,TREND:fa,TRIM:Tc,TRIMMEAN:sa,TRUE:Jd,TRUNC:w0,TTEST:Fh,TYPE:Ks,UNICHAR:Ic,UNICODE:Oc,UNIQUE:Ii,UPPER:Sc,VALUE:kc,VAR:te,VARA:fl,VARP:Bh,VARPA:sl,VARS:Jh,VLOOKUP:Qu,WEEKDAY:z0,WEEKNUM:Y0,WEIBULL:Ui,WEIBULLDIST:Vh,WORKDAY:Tt,WORKDAYINTL:qh,XIRR:kd,XNPV:Md,XOR:Vd,YEAR:Z0,YEARFRAC:Bi,Z:Fi,ZTEST:Hh,utils:Hd},Symbol.toStringTag,{value:"Module"}));var Ht,Xo;function St(){return Xo||(Xo=1,Ht=function(e){for(var r=e+1,t="",i,u=10;r>0&&u--;)i=(r-1)%26,t=String.fromCharCode(i+65)+t,r=(r-i-1)/26;return t}),Ht}var $t,zo;function kt(){return zo||(zo=1,$t=function(e){for(var r=0,t=e.replace(/[0-9]+$/,""),i=t.length;i--;)r+=Math.pow(26,t.length-i-1)*(t.charCodeAt(i)-64);return r-1}),$t}var bt,Yo;function Xr(){return Yo||(Yo=1,bt=function(e){this.setValue=function(r){e=r},this.calc=function(){return e}}),bt}var Gt,Zo;function Al(){return Zo||(Zo=1,Gt=function(e){var r=e.match(/^'(.*)'$/);return r?r[1]:e}),Gt}var Wt,Ko;function $i(){if(Ko)return Wt;Ko=1;const n=kt(),e=St(),r=Al();return Wt=function(i,u){this.parse=function(){var a,h,d;if(i.indexOf("!")!=-1){var f=i.split("!");h=r(f[0]),a=f[1]}else h=u.sheet_name,a=i;d=u.wb.Sheets[h];var o=a.split(":"),l=parseInt(o[0].replace(/^[A-Z]+/,""),10)||0,s=o[1].replace(/^[A-Z]+/,""),c;s===""&&d["!ref"]&&(s=(d["!ref"].includes(":")?d["!ref"].split(":")[1]:d["!ref"]).replace(/^[A-Z]+/,"")),c=parseInt(s==""?"500000":s,10);var g=n(o[0]),v=n(o[1]);return{sheet_name:h,sheet:d,min_row:l,min_col:g,max_row:c,max_col:v}},this.calc=function(){for(var a=this.parse(),h=a.sheet_name,d=a.sheet,f=a.min_row,o=a.min_col,l=a.max_row,s=a.max_col,c=[],g=f;g<=l;g++){var v=[];c.push(v);for(var p=o;p<=s;p++){var N=e(p)+g,w=h+"!"+N,E=u.formula_ref[w];if(E){if(E.status==="new")u.exec_formula(E);else if(E.status==="working"){if(E.cell.f.includes(u.name))throw new Error("Circular ref");u.exec_formula(E)}d[N].t==="e"?v.push(new Error(d[N].w)):v.push(d[N].v)}else d[N]?d[N].t==="e"?v.push(new Error(d[N].w)):v.push(d[N].v):v.push(null)}}return c}},Wt}var Xt,Qo;function Rl(){if(Qo)return Xt;Qo=1;const n=Al();return Xt=function(r,t){var i=this;this.name="RefValue",this.str_expression=r,this.formula=t,i.parseRef=function(){var u,a,h,d;if(r.indexOf("!")!=-1){var f=r.split("!");a=n(f[0]),u=t.wb.Sheets[a],h=f[1]}else u=t.sheet,a=t.sheet_name,h=r;if(!u)throw Error("Sheet "+a+" not found.");return d=a+"!"+h,{sheet:u,sheet_name:a,cell_name:h,cell_full_name:d}},this.calc=function(){var u=i.parseRef(),a=u.sheet,h=u.cell_name,d=u.cell_full_name,f=a[h];if(!f)return null;var o=t.formula_ref[d];if(o){if(o.status==="new"){if(t.exec_formula(o),f.t==="e")throw console.log("ref is an error with new formula",d,f.w),new Error(f.w);return f.v}else if(o.status==="working"){if(f.f.includes(t.name))throw new Error("Circular ref");return t.exec_formula(o),this.calc()}else if(o.status==="done"){if(f.t==="e")throw console.log("ref is an error after formula eval",d,f.w),new Error(f.w);return f.v}}else{if(f.t==="e")throw console.log("ref is an error with no formula",h),new Error(f.w);return f.v}}},Xt}var zt,_o;function $d(){return _o||(_o=1,zt=function(e){this.calc=function(){return e()}}),zt}var Yt,jo;function Tl(){if(jo)return Yt;jo=1;const n=Xr(),e=Rl(),r=$d(),t=$i();let i,u;function a(h,d){if(!(d.wb.Workbook&&d.wb.Workbook.Names))return null;if(u!==d.wb)return u=d.wb,i=null,a(h,d);if(i)return i[h];const f=Object.values(d.wb.Workbook.Names);if(f.length!==0)return i={},f.forEach(({Name:o,Ref:l})=>{o.includes(".")||(i[o]=l)}),a(h,d)}return Yt=function h(d,f){if(!isNaN(d))return new n(+d);if(d==="TRUE")return new n(1);if(d==="FALSE")return new n(0);if(typeof d!="string")return d;if(d=d.trim().replace(/\$/g,""),d.match(/^[A-Z]+[0-9]+:[A-Z]+[0-9]+$/))return new t(d,f);if(d.match(/^[^!]+![A-Z]+[0-9]+:[A-Z]+[0-9]+$/))return new t(d,f);if(d.match(/^[A-Z]+:[A-Z]+$/))return new t(d,f);if(d.match(/^[^!]+![A-Z]+:[A-Z]+$/))return new t(d,f);if(d.match(/^[A-Z]+[0-9]+$/))return new e(d,f);if(d.match(/^[^!]+![A-Z]+[0-9]+$/))return new e(d,f);if(d.match(/%$/)){var o=h(d.substr(0,d.length-1),f);return new r(()=>o.calc()/100)}return a(d,f)?h(a(d,f),f):d},Yt}var Zt,nu;function zr(){if(nu)return Zt;nu=1;const n=new Error("#NULL!"),e=new Error("#DIV/0!"),r=new Error("#VALUE!"),t=new Error("#REF!"),i=new Error("#NAME?"),u=new Error("#NUM!"),a=new Error("#N/A"),h=new Error("#ERROR!"),d=new Error("#GETTING_DATA"),f=new Error("#CALC!"),o={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#CALC!":0};function l(s){return o[s]}return Zt={nil:n,div0:e,value:r,ref:t,name:i,num:u,na:a,error:h,data:d,calc:f,getErrorValueByMessage:l},Zt}var Kt,eu;function Il(){if(eu)return Kt;eu=1;const n=zr();return Kt=function(r){return function(){for(var t=!1,i=[],u=[],a=[],h=0,d=arguments.length;h<d;h++){var f=arguments[h],o=Array.isArray(f);o&&(t=!0);var l=o?f.map(I=>Array.isArray(I)?I:[I]):[[f]];i[h]=l,u[h]=l.length,a[h]=l[0].length}for(var s=Math.max.apply(null,u),c=Math.max.apply(null,a),g=[],v=0;v<s;v++){g[v]=[];for(var p=0;p<c;p++){for(var N=!1,w=[],h=0,d=i.length;h<d;h++){var E=i[h],y=u[h]===1?0:v,R=a[h]===1?0:p;if(y in E)if(E=E[y],R in E)E=E[R];else{N=!0;break}else{N=!0;break}w[h]=E}g[v][p]=N?n.na:r.apply(null,w)}}return t?g:g[0][0]}},Kt}var Qt,ru;function bd(){if(ru)return Qt;ru=1;const n=Xr();$i();const e=Tl(),r=24*60*60*1e3,t=kt(),i=St(),u=Il(),{getErrorValueByMessage:a}=zr();var h=0;function d(f){return Array.isArray(f)&&(f.length===0||Array.isArray(f[0]))}return Qt=function(o){var l=this;l.id=++h,l.args=[],l.name="Expression",l.update_cell_value=s,l.formula=o;function s(){try{if(o.cell.v=l.calc(),o.cell.t=v(o.cell.v),d(o.cell.v)){const S=o.cell.v;o.cell.v=void 0;let M=o.name.match(/([A-Z]+)([0-9]+)/),V=t(M[1]),G=+M[2];for(let nn=0;nn<S.length;nn++){const X=G+nn;for(let Q=0;Q<S[nn].length;Q++){const Nn=S[nn][Q],yn=Q+V,cn=i(yn)+X;let ln=o.sheet[cn];ln||(ln={},o.sheet[cn]=ln),g(ln,Nn)}}}}catch(S){if(!c(o.cell,S))throw S}finally{o.status="done"}}function c(S,T){const M=T||{};S.t="e";const V=a(M.message);return V!==void 0?(S.w=M.message,S.v=V,!0):!1}function g(S,T){if(T instanceof Error)c(S,T);else{const M=v(T);S.v=T,M&&(S.t=M)}}function v(S){if(typeof S=="string")return"s";if(typeof S=="number")return"n";if(S instanceof Error)return"e"}function p(S){return S==null||S===""}function N(S){if(typeof S.calc!="function")throw new Error("Undefined "+S)}function w(S,T,M){for(var V=0;V<T.length;V++)if(T[V]===S)try{if(V===0&&S==="+"){N(T[V+1]);let G=T[V+1].calc();T.splice(V,2,new n(G))}else{N(T[V-1]),N(T[V+1]);let G=T[V-1].calc(),nn=T[V+1].calc();if(G instanceof Error)throw G;if(nn instanceof Error)throw nn;let X=M(G,nn);T.splice(V-1,3,new n(X)),V--}}catch(G){throw G}}function E(S){return Array.isArray(S)?S.map(E):-S}function y(S){for(var T=S.length;T--;)if(S[T]==="-"){N(S[T+1]);var M=S[T+1].calc();if(T>0&&typeof S[T-1]!="string"){if(S.splice(T,1,"+"),M instanceof Date){M=Date.parse(M),N(S[T-1]);var V=S[T-1].calc();V instanceof Date&&(V=Date.parse(V)/r,M=M/r,S.splice(T-1,1,new n(V)))}S.splice(T+1,1,new n(E(M)))}else{if(typeof M=="string")throw new Error("#VALUE!");S.splice(T,2,new n(E(M)))}}}function R(S,T){for(var M=0;M<S.length-2;M++)if(S[M]==="^"&&S[M+1]==="-")try{N(S[M-1]),N(S[M+2]);let V=S[M-1].calc(),G=S[M+2].calc();Array.isArray(V)&&(V=V[getCurrentCellIndex()-1][0]),Array.isArray(G)&&(G=G[getCurrentCellIndex()-1][0]);let nn=T(V,G);S.splice(M-1,4,new n(nn)),M--}catch(V){throw V}}l.calc=function(){let S=l.args.concat();if(R(S,function(T,M){return Math.pow(+T,0-M)}),w("^",S,u(function(T,M){return Math.pow(+T,+M)})),y(S),w("/",S,u(function(T,M){if(M==0)throw Error("#DIV/0!");return+T/+M})),w("*",S,u(function(T,M){return+T*+M})),w("+",S,u(function(T,M){return T instanceof Date&&typeof M=="number"&&(M=M*r),+T+ +M})),w("&",S,u(function(T,M){var V="";return T!==null&&(V+=T),M!==null&&(V+=M),V})),w("<",S,u(function(T,M){return T<M})),w(">",S,u(function(T,M){return T>M})),w(">=",S,u(function(T,M){return T>=M})),w("<=",S,u(function(T,M){return T<=M})),w("<>",S,u(function(T,M){return T instanceof Date&&M instanceof Date?T.getTime()!==M.getTime():p(T)&&p(M)?!1:T!==M})),w("=",S,u(function(T,M){return T instanceof Date&&M instanceof Date?T.getTime()===M.getTime():p(T)&&p(M)||T==null&&M===0||T===0&&M==null||typeof T=="string"&&typeof M=="string"&&T.toLowerCase()===M.toLowerCase()?!0:T===M})),S.length==1)return typeof S[0].calc!="function"?S[0]:S[0].calc()};var I;l.push=function(S){if(S){var T=e(S,o);T==="="&&(I==">"||I=="<")||I=="<"&&T===">"?l.args[l.args.length-1]+=T:l.args.push(T),I=T}}},Qt}var _t,tu;function Gd(){if(tu)return _t;tu=1;const{getErrorValueByMessage:n}=zr();return _t=function(r){var t=this;t.name="UserFn",t.args=[],t.calc=function(){var i;try{if(i=r.apply(t,t.args.map(u=>u.calc())),i instanceof Error)throw i}catch(u){const a=n(u.message);if(r.name==="is_blank"&&a!==void 0)i=0;else if(r.name==="iserror"&&a!==void 0)i=!0;else throw u}return i},t.push=function(i){t.args.push(i)}},_t}var jt,iu;function Wd(){return iu||(iu=1,jt=function(e,r){var t=this;t.name="UserRawFn",t.args=[],t.calc=function(){try{return e.apply(t,t.args)}catch(i){throw i}},t.push=function(i){t.args.push(i)}}),jt}var ni,ou;function Xd(){if(ou)return ni;ou=1;const n=bd(),e=Xr(),r=Gd(),t=Wd(),i={"*":"multiply","+":"plus","-":"minus","/":"divide","^":"power","&":"concat","<":"lt",">":"gt","=":"eq"};return ni=function(a,h){a.status="working";var d=h.xlsx_Fx||{},f=h.xlsx_raw_Fx||{},o,l=a.cell.f;l[0]=="="&&(l=l.substr(1));var s=o=new n(a),c="",g=!1,v=[{exp:s}];function p(T){T==='"'?(s.push(new e(c)),g=!0,c="",I=R):c+=T}function N(T){T==="'"&&(I=R),c+=T}function w(){var T,M=c.trim(),V=d[M],G=f[M];if(G)V=new t(G,a);else if(V)V=new r(V,a);else if(M)throw new Error('"'+a.sheet_name+'"!'+a.name+": Function "+c+" not found");T=new n(a),v.push({exp:T,special:V}),s=T,c=""}function E(){var T,M=v.pop();s=M.exp,s.push(c),T=s,c="",s=v[v.length-1].exp,M.special?(M.special.push(T),s.push(M.special)):s.push(T)}function y(T){g||s.push(c),g=!1,s.push(T),c=""}function R(T){T==='"'?(I=p,c=""):T==="'"?(I=N,c="'"):T==="("?w():T===")"?E():i[T]?y(T):T===","&&v[v.length-1].special?(g=!1,v[v.length-1].exp.push(c),v[v.length-1].special.push(v[v.length-1].exp),v[v.length-1].exp=s=new n(a),c=""):T!==" "&&(c+=T)}for(var I=R,S=0;S<l.length;S++)I(l[S]);return o.push(c),o},ni}var ei,uu;function zd(){if(uu)return ei;uu=1;const n=zr();function e(t){if(typeof t=="boolean"||t instanceof Error)return t;if(typeof t=="number")return t!==0;if(typeof t=="string"){const i=t.toUpperCase();if(i==="TRUE")return!0;if(i==="FALSE")return!1}return t instanceof Date&&!isNaN(t)?!0:n.value}function r(t,i,u){if(!t||!i||!u||i<0||u<0||!Array.isArray(t)||!t.length)return t;for(let a=0;a<t.length;a++)if(!(t[a]instanceof Array))return t;for(let a=0;a<t.length;a++)if(t[a].length<i)for(let h=t[a].length;h<i;h++)t[a].push("");if(t.length<u)for(let a=t.length;a<u;a++){t.push([]);for(let h=0;h<i;h++)t[a].push("")}return t}return ei={addEmptyValuesToArray:r,parseBool:e},ei}var ri,lu;function Yd(){if(lu)return ri;lu=1;const n=zd(),e=zr();let r={FLOOR:Math.floor,"_xlfn.FLOOR.MATH":Math.floor,"FLOOR.MATH":Math.floor,ABS:Math.abs,SQRT:Math.sqrt,VLOOKUP:ln,MAX:yn,SUM:Nn,MIN:cn,CONCATENATE:Q,PMT:X,COUNTA:nn,IRR:G,"NORM.INV":V,"_xlfn.NORM.INV":V,STDEV:M,AVERAGE:T,EXP:S,LN:Math.log,"_xlfn.VAR.P":I,"VAR.P":I,"_xlfn.COVARIANCE.P":y,"COVARIANCE.P":y,TRIM:w,LEN:N,ISBLANK:E,HLOOKUP:p,INDEX:v,MATCH:g,SUMPRODUCT:f,ISNUMBER:d,TODAY:h,ISERROR:kn,TIME:Dn,DAY:Bn,MONTH:Jn,YEAR:Z,RIGHT:Rn,LEFT:Cn,IFS:Vn,ROUND:a,CORREL:u,SUMIF:i,CHOOSE:t,SUBSTITUTE:D,CEILING:P,FILTER:fn(en),DATEDIF:on,EOMONTH:an};function t(m){return arguments[m]}function i(){let m=arguments[1],O=0;return[].slice.call(arguments)[0][0].forEach((x,F)=>{x!==null&&(x=x.toString(),x.replace(/\'/g,"")===m&&(isNaN([].slice.call(arguments)[2][0][F])||(O+=[].slice.call(arguments)[2][0][F])))}),O}function u(m,O){if(m=R(m),O=R(O),m.length!==O.length)return"N/D";for(var x=1/(m.length-1),F=Nn.apply(this,m)/m.length,C=Nn.apply(this,O)/O.length,H=0,tn=0,Ln=0,An=0;An<m.length;An++)H+=(m[An]-F)*(O[An]-C),tn+=Math.pow(m[An],2),Ln+=Math.pow(O[An],2);return tn=Math.sqrt(tn/x),Ln=Math.sqrt(Ln/x),H/(x*tn*Ln)}function a(m,O){if(arguments.length===0)throw new Error("Err:511");if(arguments.length===1)return Math.round(m);let x=Math.pow(10,O);return Math.round(x*m)/x}function h(){var m=new Date;return m.setHours(0,0,0,0),m}function d(m){return!isNaN(m)}function f(){var m=function(bn){return bn===void 0||bn===""||bn===null||isNaN(bn)?0:parseFloat(bn)},O=function(bn){for(var hn=function(W=[]){return W.length},Y=function(W=[]){return W[0]&&W[0].length},B=hn(bn[0]),q=Y(bn[0]),sn=1;sn<bn.length;sn++)if(hn(bn[sn])!==B||Y(bn[sn])!==q)return!1;return!0};if(!arguments||arguments.length===0||!arguments[0]||!O(arguments))throw Error("#VALUE!");for(var x=0;x<arguments.length;x++){var F=arguments[x];if(Array.isArray(F))for(var C=0;C<F.length;C++){var H=F[C];if(Array.isArray(H))for(var dn=0;dn<H.length;dn++){var tn=H[dn];if(tn instanceof Error)throw tn}else{var tn=H;if(tn instanceof Error)throw tn}}else{var tn=F;if(tn instanceof Error)throw tn}}for(var Ln=arguments.length+1,An=0,Hn,dn,Oe,ge,x=0;x<arguments[0].length;x++)if(arguments[0][x]instanceof Array)for(var C=0;C<arguments[0][x].length;C++){for(Hn=1,dn=1;dn<Ln;dn++)ge=m(arguments[dn-1][x][C]),Hn*=ge;An+=Hn}else{for(Hn=1,dn=1;dn<Ln;dn++)Oe=m(arguments[dn-1][x]),Hn*=Oe;An+=Hn}return An}function o(m,O){for(var x,F,C=0;C<m.length;C++){if(m[C]===O)return C+1;m[C]<O&&(F?m[C]>F&&(x=C+1,F=m[C]):(x=C+1,F=m[C]))}if(!x)throw Error("#N/A");return x}function l(m,O){for(var x=0;x<m.length;x++)if(O=O.replace(/\?/g,"."),Array.isArray(m[x])){if(m[x].length===1&&typeof m[x][0]=="string"&&m[x][0].toLowerCase()===O.toLowerCase())return x+1}else if(typeof m[x]=="string"&&m[x].toLowerCase()===O.toLowerCase())return x+1;throw Error("#N/A")}function s(m,O){for(var x=0;x<m.length;x++)if(Array.isArray(m[x])){if(m[x].length===1&&m[x][0]===O)return x+1}else if(m[x]===O)return x+1;throw Error("#N/A")}function c(m,O){for(var x,F,C=0;C<m.length;C++)if(Array.isArray(m[C])&&m[C].length>0){if(m[C][0]===O)return C+1;m[C][0]>O&&(F?m[C][0]<F&&(x=C+1,F=m[C][0]):(x=C+1,F=m[C][0]))}else{if(m[C]===O)return C+1;m[C]>O&&(F?m[C]<F&&(x=C+1,F=m[C]):(x=C+1,F=m[C]))}if(!x)throw Error("#N/A");return x}function g(m,O,x){if(Array.isArray(O)&&O.length===1&&Array.isArray(O[0])&&(O=O[0]),!m&&!O||(arguments.length===2&&(x=1),!(O instanceof Array)))throw Error("#N/A");if(x===0)return typeof m=="string"?l(O,m):s(O,m);if(x===1)return o(O,m);if(x===-1)return c(O,m);throw Error("#N/A")}function v(m,O,x){if(O<=m.length){var F=m[O-1];if(Array.isArray(F))if(x){if(x<=F.length)return F[x-1]}else return F;else return m[O]}throw Error("#REF!")}function p(m,O,x,F){if(typeof m>"u"||E(m))throw Error("#N/A");x=x||0;let C=O[0],H,tn;if(typeof m=="string"){for(tn=m.toLowerCase(),H=0;H<C.length;H++)if(F&&C[H]===tn||C[H].toLowerCase().indexOf(tn)!==-1)return x<O.length+1?O[x-1][H]:O[0][H]}else for(tn=m,H=0;H<C.length;H++)if(F&&C[H]===tn||C[H]===tn)return x<O.length+1?O[x-1][H]:O[0][H];throw Error("#N/A")}function N(m){return(""+m).length}function w(m){return(""+m).trim()}function E(m){return!m}function y(m,O){if(m=R(m),O=R(O),m.length!=O.length)return"N/D";for(var x=1/m.length,F=Nn.apply(this,m)/m.length,C=Nn.apply(this,O)/O.length,H=0,tn=0;tn<m.length;tn++)H+=(m[tn]-F)*(O[tn]-C);return H*x}function R(m){for(var O=[],x=0;x<m.length;x++){var F=m[x];if(Array.isArray(F)){for(var C=F,H=C.length;H--;)if(typeof C[H]=="number")O.push(C[H]);else if(Array.isArray(C[H]))for(var tn=C[H].length;tn--;)typeof C[H][tn]=="number"&&O.push(C[H][tn])}else typeof F=="number"&&O.push(F)}return O}function I(){for(var m=T.apply(this,arguments),O=0,x=0,F=0;F<arguments.length;F++){var C=arguments[F];if(Array.isArray(C))for(var H=C,tn=H.length;tn--;)for(var Ln=H[tn].length;Ln--;)H[tn][Ln]!==null&&H[tn][Ln]!==void 0&&(O+=Math.pow(H[tn][Ln]-m,2),x++);else O+=Math.pow(C-m,2),x++}return O/x}function S(m){return Math.pow(Math.E,m)}function T(){var m=nn.apply(this,arguments);if(m==0)throw Error("#DIV/0!");return Nn.apply(this,arguments)/m}function M(){var m=R(arguments);function O(C){return C.reduce(function(H,tn){return H+tn})/C.length}var x=O(m),F=m.map(function(C){return(C-x)*(C-x)});return Math.sqrt(F.reduce(function(C,H){return C+H})/(m.length-1))}function V(m,O,x){if(m<0||m>1)throw"The probality p must be bigger than 0 and smaller than 1";if(x<0)throw"The standard deviation sigma must be positive";if(m==0)return-1/0;if(m==1)return 1/0;if(x==0)return O;var F,C,H;return F=m-.5,Math.abs(F)<=.425?(C=.180625-F*F,H=F*(((((((C*2509.0809287301227+33430.57558358813)*C+67265.7709270087)*C+45921.95393154987)*C+13731.69376550946)*C+1971.5909503065513)*C+133.14166789178438)*C+3.3871328727963665)/(((((((C*5226.495278852854+28729.085735721943)*C+39307.89580009271)*C+21213.794301586597)*C+5394.196021424751)*C+687.1870074920579)*C+42.31333070160091)*C+1)):(F>0?C=1-m:C=m,C=Math.sqrt(-Math.log(C)),C<=5?(C+=-1.6,H=(((((((C*.0007745450142783414+.022723844989269184)*C+.2417807251774506)*C+1.2704582524523684)*C+3.6478483247632045)*C+5.769497221460691)*C+4.630337846156546)*C+1.4234371107496835)/(((((((C*10507500716444169e-25+.0005475938084995345)*C+.015198666563616457)*C+.14810397642748008)*C+.6897673349851)*C+1.6763848301838038)*C+2.053191626637759)*C+1)):(C+=-5,H=(((((((C*20103343992922881e-23+27115555687434876e-21)*C+.0012426609473880784)*C+.026532189526576124)*C+.29656057182850487)*C+1.7848265399172913)*C+5.463784911164114)*C+6.657904643501103)/(((((((C*20442631033899397e-31+1421511758316446e-22)*C+18463183175100548e-21)*C+.0007868691311456133)*C+.014875361290850615)*C+.1369298809227358)*C+.599832206555888)*C+1)),F<0&&(H=-H)),O+x*H}function G(m,O){var x=-2,F=1,C=0;do{for(var H=(x+F)/2,tn=0,Ln=0;Ln<m.length;Ln++){var An=m[Ln];tn+=An[0]/Math.pow(1+H,Ln)}tn>0?(x===F&&(F+=Math.abs(H)),x=H):F=H,C++}while(Math.abs(tn)>1e-6&&C<1e5);return H}function nn(){for(var m=0,O=arguments.length;O--;){var x=arguments[O];if(Array.isArray(x))for(var F=x,C=F.length;C--;)for(var H=F[C].length;H--;)F[C][H]!==null&&F[C][H]!==void 0&&m++;else x!=null&&m++}return m}function X(m,O,x,F,C){if(C=C||0,F=F||0,m!=0){var H=Math.pow(1+m,O);return-(m*(F+H*x))/((-1+H)*(1+m*C))}else if(O!=0)return-(F+x)/O;return 0}function Q(){for(var m="",O=0;O<arguments.length;O++){var x=arguments[O];x!=null&&(m+=x)}return m}function Nn(){for(var m=0,O=arguments.length;O--;){var x=arguments[O];if(Array.isArray(x))for(var F=x,C=F.length;C--;)for(var H=F[C].length;H--;)isNaN(F[C][H])||(m+=+F[C][H]);else m+=+x}return m}function yn(){for(var m=null,O=arguments.length;O--;){var x=arguments[O];if(Array.isArray(x))for(var F=x,C=F.length;C--;){var H=F[C];if(Array.isArray(H))for(var tn=H.length;tn--;)(m==null||H[tn]!=null&&m<H[tn])&&(m=H[tn]);else(m==null||H!=null&&m<H)&&(m=H)}else!isNaN(x)&&(m==null||x!=null&&m<x)&&(m=x)}return m}function cn(){for(var m=null,O=arguments.length;O--;){var x=arguments[O];if(Array.isArray(x))for(var F=x,C=F.length;C--;){var H=F[C];if(Array.isArray(H))for(var tn=H.length;tn--;)(m==null||H[tn]!=null&&m>H[tn])&&(m=H[tn]);else(m==null||H!=null&&m>H)&&(m=H)}else!isNaN(x)&&(m==null||x!=null&&m>x)&&(m=x)}return m}function ln(m,O,x,F=!0){for(var C=null,H=0;H<O.length;H++)if(O[H][0]<m)C=O[H][x-1];else if(O[H][0]==m)return O[H][x-1];if(F&&C)return C;throw Error("#N/A")}function kn(){return!1}function Dn(m,O,x){return((m*60+O)*60+x)*1e3/864e5}function Bn(m){if(!m.getDate)throw Error("#VALUE!");var O=m.getUTCDate();if(isNaN(O))throw Error("#VALUE!");return O}function Jn(m){if(!m.getMonth)throw Error("#VALUE!");var O=m.getUTCMonth();if(isNaN(O))throw Error("#VALUE!");return O+1}function Z(m){if(!m.getFullYear)throw Error("#VALUE!");var O=m.getUTCFullYear();if(isNaN(O))throw Error("#VALUE!");return O}function on(m,O,x){if(m=new Date(m),O=new Date(O),!m||!O||m=="Invalid Date"||O=="Invalid Date")throw Error("#VALUE!");switch(x=x.replace(/[^DMY]/ig,""),x){case"M":return O.getMonth()-m.getMonth()+12*(O.getFullYear()-m.getFullYear());case"Y":return Math.abs(O.getUTCFullYear()-m.getUTCFullYear());case"D":default:var F=Math.abs(O-m);return Math.ceil(F/(1e3*3600*24))}}function an(m,O){if(m=new Date(m),!m||m=="Invalid Date")throw Error("#VALUE!");O=O||0;var x=new Date(m.getUTCFullYear(),m.getUTCMonth()+O+1,0);return x.setUTCHours(0),x.setUTCMinutes(0),x.setUTCSeconds(0),x}function Rn(m,O){if(O=O===void 0?1:parseFloat(O),isNaN(O))throw Error("#VALUE!");return m==null?m="":m=""+m,m.substring(m.length-O)}function Cn(m,O){if(O=O===void 0?1:parseFloat(O),isNaN(O))throw Error("#VALUE!");return m==null?m="":m=""+m,m.substring(0,O)}function Vn(){for(var m=0;m+1<arguments.length;m+=2){var O=arguments[m],x=arguments[m+1];if(O)return x}throw Error("#N/A")}function L(m){return m.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function D(m,O,x,F){if(F<=0)throw Error("#VALUE!");if(!m||!O||!x&&x!=="")return m;if(F===void 0)return m.replace(new RegExp(L(O),"g"),x);for(var C=0,H=0;m.indexOf(O,C)>0;)if(C=m.indexOf(O,C+1),H++,H===F)return m.substring(0,C)+x+m.substring(C+O.length)}function P(m,O){return Math.ceil(m/O)*O}function en(m,O,x){if(!m||!O||!(m instanceof Array)||!(O instanceof Array)||m.length===0||O.length===0)return e.na;for(let An=0;An<m.length;An++)if(!(m[An]instanceof Array)||m[An].length===0||m[An].length!==m[0].length)return e.na;for(let An=0;An<O.length;An++)if(!(O[An]instanceof Array)||O[An].length===0||O[An].length!==O[0].length)return e.na;const F=m[0].length,C=m.length,H=O[0].length,tn=O.length;if(F!==H&&C!==tn||C>1&&F>1&&(F===H&&tn!==1||C===tn&&H!==1)||C>1&&F===1&&(H!==1||tn!==1&&tn!==C))return e.na;const Ln=[];for(let An=0;An<C;An++){const Hn=[];for(let dn=0;dn<F;dn++){const Oe=U(O,An,dn)||U(O,0,dn)||U(O,An,0),ge=n.parseBool(Oe);if(ge===!0)Hn.push(m[An][dn]);else if(ge instanceof Error)return n.addEmptyValuesToArray([[ge]],F,C)}Hn.length>0&&Ln.push(Hn)}return Ln.length===0?x!=null?n.addEmptyValuesToArray([[x]],F,C):n.addEmptyValuesToArray([[e.calc]],F,C):n.addEmptyValuesToArray(Ln,F,C)}function U(m,O,x){if(m[O])return m[O][x]===!1?"FALSE":m[O][x]}function fn(m){return function(){const O=m.apply(this,arguments);if(O instanceof Error)throw O;return O}}return ri=r,ri}var ti,fu;function Zd(){if(fu)return ti;fu=1;const n=St(),e=kt(),r=Il(),t=Xr(),i=$i(),u=Rl();function a(g,v,p,N,w){if(N=(N||new t(1)).calc(),w=(w||new t(1)).calc(),g.args.length===1&&g.args[0].name==="RefValue"){var E=g.args[0],y=E.parseRef(),R=e(y.cell_name)+p.calc(),I=n(R),S=+y.cell_name.replace(/^[A-Z]+/g,"")+v.calc(),T=y.sheet_name+"!"+I+S;if(N===1&&w===1)return new u(T,E.formula).calc();var M=n(R+w-1),V=S+N-1,G=M+V,nn=T+":"+G;return new i(nn,E.formula).calc()}}function h(g){if(g.args.length===0){var v=+g.formula.name.replace(/^[A-Z]+/g,"");return v}else if(g.args.length===1&&g.args[0].name==="RefValue"){var p=g.args[0],N=p.parseRef(),v=+N.cell_name.replace(/^[A-Z]+/g,"");return v}else if(g.args.length===1&&g.args[0]instanceof i){for(var w=g.args[0].parse(),E=w.min_row,y=w.max_row,R=[],I=E;I<=y;I++)R.push(I);return R}}function d(g){if(g.args.length===0){var v=e(g.formula.name);return v+1}else if(g.args.length===1&&g.args[0].name==="RefValue"){var p=g.args[0],N=p.parseRef(),v=e(N.cell_name);return v+1}else if(g.args.length===1&&g.args[0]instanceof i){for(var w=g.args[0].parse(),E=w.min_col,y=w.max_col,R=[],I=E;I<=y;I++)R.push(I+1);return R}}function f(g,v){try{var p=g.calc();return typeof p=="number"&&(isNaN(p)||p===1/0||p===-1/0)?v.calc():p}catch{return v.calc()}}function o(g,v,p){var N,w,E;try{N=g.calc()}catch(y){N=y}try{w=v.calc()}catch(y){w=y}try{E=typeof p>"u"?!1:p.calc()}catch(y){E=y}return r(function(y,R,I){return y instanceof Error?y:y?R:I})(N,w,E)}function l(){for(var g=0;g<arguments.length;g++)if(!arguments[g].calc())return!1;return!0}function s(){for(var g=0;g<arguments.length;g++)if(arguments[g].calc())return!0;return!1}function c(g){let p=g.args[0].calc(),w=g.formula.name.match(/([A-Z]+)([0-9]+)/),E=g.formula.sheet,y=e(w[1]),R=+w[2];for(let I=0;I<p.length;I++){let S=p[I];for(let T=0;T<S.length;T++){let M=y+I,V=R+T,G=S[T];E[n(M)+V].v=G}}return p[0][0]}return ti={OFFSET:a,ROW:h,COLUMN:d,IFERROR:f,IF:o,AND:l,OR:s,TRANSPOSE:c},ti}var ii,su;function Kd(){if(su)return ii;su=1;const n=Xd();let e={},r={};i(Yd()),t(Zd());function t(d,f){for(var o in d)r[o]=d[o]}function i(d,f){f=f||{};var o=f.prefix||"";for(var l in d){var s=d[l];typeof s=="function"?(f.override||!e[o+l])&&(e[o+l]=s):typeof s=="object"&&i(s,u(f,{prefix:l+"."}))}}function u(d,f){var o=JSON.parse(JSON.stringify(d));for(var l in f)o[l]=f[l];return o}function a(d){return n(d,{xlsx_Fx:e,xlsx_raw_Fx:r})}function h(d){a(d).update_cell_value()}return h.set_fx=function(f,o){e[f]=o},h.exec_fx=function(f,o){return e[f].apply(this,o)},h.localizeFunctions=function(d){for(let f in d){let o=d[f];e[o]&&(e[f]=e[o]),r[o]&&(r[f]=r[o])}},h.import_functions=i,h.import_raw_functions=t,h.build_expression=a,h.xlsx_Fx=e,ii=h,ii}var oi,cu;function Ol(){return cu||(cu=1,oi=function(e,r){let t={},i=[];for(let u in e.Sheets){let a=e.Sheets[u];for(let h in a)if(a[h]&&a[h].f){let d=t[u+"!"+h]={formula_ref:t,wb:e,sheet:a,sheet_name:u,cell:a[h],name:h,status:"new",exec_formula:r};i.push(d)}}return i}),oi}var ui,au;function Qd(){if(au)return ui;au=1;const n=Xr(),e=Tl(),r=Ol();class t{constructor(u,a){this.workbook=u,this.expressions=[],this.exec_formula=a,this.variables={},this.formulas=r(u,a);for(let h=this.formulas.length-1;h>=0;h--){let d=a.build_expression(this.formulas[h]);this.expressions.push(d)}this.calcNames()}setVar(u,a){let h=this.variables[u];h?h.setValue(a):this.expressions.forEach(d=>{this.setVarOfExpression(d,u,a)})}getVars(){let u={};for(let a in this.variables)u[a]=this.variables[a].calc();return u}calcNames(){!this.workbook||!this.workbook.Workbook||!this.workbook.Workbook.Names||this.workbook.Workbook.Names.forEach(u=>{let a=this.getRef(u.Ref);this.variables[u.Name]=a,this.expressions.forEach(h=>{this.setVarOfExpression(h,u.Name)})})}getRef(u){if(!this.formulas.length)throw new Error("No formula found.");let d={formula_ref:this.formulas[0].formula_ref,wb:this.workbook,exec_formula:this.exec_formula};return e(u,d)}setVarOfExpression(u,a,h){for(let d=0;d<u.args.length;d++){let f=u.args[d];f===a?u.args[d]=this.variables[a]||(this.variables[a]=new n(h)):typeof f=="object"&&(f.name==="Expression"||f.name==="UserFn")&&this.setVarOfExpression(f,a,h)}}execute(){this.expressions.forEach(u=>{u.update_cell_value()})}}return ui=t,ui}var li,hu;function _d(){if(hu)return li;hu=1;const n=St(),e=kt(),r=Kd(),t=Ol(),i=Qd();var u=function(a,h){for(var d=t(a,r),f=d.length-1;f>=0;f--)try{if(d[f].status==="done")continue;r(d[f])}catch(o){if(!h||!h.continue_after_error)throw o;h.log_error&&console.log("error executing formula","sheet",d[f].sheet_name,"cell",d[f].name,o)}};return u.calculator=function(h){return new i(h,r)},u.set_fx=r.set_fx,u.exec_fx=r.exec_fx,u.col_str_2_int=e,u.int_2_col_str=n,u.import_functions=r.import_functions,u.import_raw_functions=r.import_raw_functions,u.xlsx_Fx=r.xlsx_Fx,u.localizeFunctions=r.localizeFunctions,u.XLSX_CALC=u,li=u,li}var jd=_d();const gt=Vr(jd);function ng(n,e=50,r=50){const t={SheetNames:[],Sheets:{}};for(const i of n.sheets){t.SheetNames.push(i.name);const u={};for(const a of i.rows)if(!(a.index>e))for(const h of a.cells){const d=/^[A-Z]+/.exec(h.address);if(!d)continue;const f=d[0];let o=0;for(let s=0;s<f.length;s++)o=o*26+(f.charCodeAt(s)-64);if(o>r)continue;const l={};if(h.value!==""){const s=Number(h.value);l.v=Number.isNaN(s)?h.value:s}h.formula&&(l.f=h.formula),u[h.address]=l}t.Sheets[i.name]=u}gt.import_functions(ml);try{gt(t,{continue_after_error:!0})}catch(i){mr.addError(i)}for(const i of n.sheets){const u=t.Sheets[i.name];for(const a of i.rows)if(!(a.index>e)){for(const h of a.cells)if(h.formula&&h.value===""){const d=u[h.address]?.v;h.value=d!=null?String(d):"This formula is not supported in web preview. Please download to open in your preferred software for the best results."}}}}function Sl(n=0){return n>0?n:self.devicePixelRatio||1}var fi={exports:{}},du;function eg(){return du||(du=1,function(n){var e={},r=function(i){i.version="0.11.2";function u(L){for(var D="",P=L.length-1;P>=0;)D+=L.charAt(P--);return D}function a(L,D){for(var P="";P.length<D;)P+=L;return P}function h(L,D){var P=""+L;return P.length>=D?P:a("0",D-P.length)+P}function d(L,D){var P=""+L;return P.length>=D?P:a(" ",D-P.length)+P}function f(L,D){var P=""+L;return P.length>=D?P:P+a(" ",D-P.length)}function o(L,D){var P=""+Math.round(L);return P.length>=D?P:a("0",D-P.length)+P}function l(L,D){var P=""+L;return P.length>=D?P:a("0",D-P.length)+P}var s=Math.pow(2,32);function c(L,D){if(L>s||L<-s)return o(L,D);var P=Math.round(L);return l(P,D)}function g(L,D){return D=D||0,L.length>=7+D&&(L.charCodeAt(D)|32)===103&&(L.charCodeAt(D+1)|32)===101&&(L.charCodeAt(D+2)|32)===110&&(L.charCodeAt(D+3)|32)===101&&(L.charCodeAt(D+4)|32)===114&&(L.charCodeAt(D+5)|32)===97&&(L.charCodeAt(D+6)|32)===108}var v=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],p=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function N(L){L[0]="General",L[1]="0",L[2]="0.00",L[3]="#,##0",L[4]="#,##0.00",L[9]="0%",L[10]="0.00%",L[11]="0.00E+00",L[12]="# ?/?",L[13]="# ??/??",L[14]="m/d/yy",L[15]="d-mmm-yy",L[16]="d-mmm",L[17]="mmm-yy",L[18]="h:mm AM/PM",L[19]="h:mm:ss AM/PM",L[20]="h:mm",L[21]="h:mm:ss",L[22]="m/d/yy h:mm",L[37]="#,##0 ;(#,##0)",L[38]="#,##0 ;[Red](#,##0)",L[39]="#,##0.00;(#,##0.00)",L[40]="#,##0.00;[Red](#,##0.00)",L[45]="mm:ss",L[46]="[h]:mm:ss",L[47]="mmss.0",L[48]="##0.0E+0",L[49]="@",L[56]='"/ "hh""mm""ss" "'}var w={};N(w);var E=[],y=0;for(y=5;y<=8;++y)E[y]=32+y;for(y=23;y<=26;++y)E[y]=0;for(y=27;y<=31;++y)E[y]=14;for(y=50;y<=58;++y)E[y]=14;for(y=59;y<=62;++y)E[y]=y-58;for(y=67;y<=68;++y)E[y]=y-58;for(y=72;y<=75;++y)E[y]=y-58;for(y=67;y<=68;++y)E[y]=y-57;for(y=76;y<=78;++y)E[y]=y-56;for(y=79;y<=81;++y)E[y]=y-34;var R=[];R[5]=R[63]='"$"#,##0_);\\("$"#,##0\\)',R[6]=R[64]='"$"#,##0_);[Red]\\("$"#,##0\\)',R[7]=R[65]='"$"#,##0.00_);\\("$"#,##0.00\\)',R[8]=R[66]='"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',R[41]='_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',R[42]='_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',R[43]='_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',R[44]='_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)';function I(L,D,P){for(var en=L<0?-1:1,U=L*en,fn=0,m=1,O=0,x=1,F=0,C=0,H=Math.floor(U);F<D&&(H=Math.floor(U),O=H*m+fn,C=H*F+x,!(U-H<5e-8));)U=1/(U-H),fn=m,m=O,x=F,F=C;if(C>D&&(F>D?(C=x,O=fn):(C=F,O=m)),!P)return[0,en*O,C];var tn=Math.floor(en*O/C);return[tn,en*O-tn*C,C]}function S(L,D,P){if(L>2958465||L<0)return null;var en=L|0,U=Math.floor(86400*(L-en)),fn=0,m=[],O={D:en,T:U,u:86400*(L-en)-U,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(O.u)<1e-6&&(O.u=0),D&&D.date1904&&(en+=1462),O.u>.9999&&(O.u=0,++U==86400&&(O.T=U=0,++en,++O.D)),en===60)m=P?[1317,10,29]:[1900,2,29],fn=3;else if(en===0)m=P?[1317,8,29]:[1900,1,0],fn=6;else{en>60&&--en;var x=new Date(1900,0,1);x.setDate(x.getDate()+en-1),m=[x.getFullYear(),x.getMonth()+1,x.getDate()],fn=x.getDay(),en<60&&(fn=(fn+6)%7),P&&(fn=Nn(x,m))}return O.y=m[0],O.m=m[1],O.d=m[2],O.S=U%60,U=Math.floor(U/60),O.M=U%60,U=Math.floor(U/60),O.H=U,O.q=fn,O}i.parse_date_code=S;var T=new Date(1899,11,31,0,0,0),M=T.getTime(),V=new Date(1900,2,1,0,0,0);function G(L,D){var P=L.getTime();return D?P-=1262304e5:L>=V&&(P+=864e5),(P-(M+(L.getTimezoneOffset()-T.getTimezoneOffset())*6e4))/864e5}function nn(L){return L.toString(10)}i._general_int=nn;var X=function(){var D=/(?:\.0*|(\.\d*[1-9])0+)$/;function P(F){return F.indexOf(".")==-1?F:F.replace(D,"$1")}var en=/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,U=/(E[+-])(\d)$/;function fn(F){return F.indexOf("E")==-1?F:F.replace(en,"$1E").replace(U,"$10$2")}function m(F){var C=F<0?12:11,H=P(F.toFixed(12));return H.length<=C||(H=F.toPrecision(10),H.length<=C)?H:F.toExponential(5)}function O(F){var C=P(F.toFixed(11));return C.length>(F<0?12:11)||C==="0"||C==="-0"?F.toPrecision(6):C}function x(F){var C=Math.floor(Math.log(Math.abs(F))*Math.LOG10E),H;return C>=-4&&C<=-1?H=F.toPrecision(10+C):Math.abs(C)<=9?H=m(F):C===10?H=F.toFixed(10).substr(0,12):H=O(F),P(fn(H.toUpperCase()))}return x}();i._general_num=X;function Q(L,D){switch(typeof L){case"string":return L;case"boolean":return L?"TRUE":"FALSE";case"number":return(L|0)===L?L.toString(10):X(L);case"undefined":return"";case"object":if(L==null)return"";if(L instanceof Date)return Cn(14,G(L,D&&D.date1904),D)}throw new Error("unsupported value in General format: "+L)}i._general=Q;function Nn(L,D){D[0]-=581;var P=L.getDay();return L<60&&(P=(P+6)%7),P}function yn(L,D,P,en){var U="",fn=0,m=0,O=P.y,x,F=0;switch(L){case 98:O=P.y+543;case 121:switch(D.length){case 1:case 2:x=O%100,F=2;break;default:x=O%1e4,F=4;break}break;case 109:switch(D.length){case 1:case 2:x=P.m,F=D.length;break;case 3:return p[P.m-1][1];case 5:return p[P.m-1][0];default:return p[P.m-1][2]}break;case 100:switch(D.length){case 1:case 2:x=P.d,F=D.length;break;case 3:return v[P.q][0];default:return v[P.q][1]}break;case 104:switch(D.length){case 1:case 2:x=1+(P.H+11)%12,F=D.length;break;default:throw"bad hour format: "+D}break;case 72:switch(D.length){case 1:case 2:x=P.H,F=D.length;break;default:throw"bad hour format: "+D}break;case 77:switch(D.length){case 1:case 2:x=P.M,F=D.length;break;default:throw"bad minute format: "+D}break;case 115:if(D!="s"&&D!="ss"&&D!=".0"&&D!=".00"&&D!=".000")throw"bad second format: "+D;return P.u===0&&(D=="s"||D=="ss")?h(P.S,D.length):(en>=2?m=en===3?1e3:100:m=en===1?10:1,fn=Math.round(m*(P.S+P.u)),fn>=60*m&&(fn=0),D==="s"?fn===0?"0":""+fn/m:(U=h(fn,2+en),D==="ss"?U.substr(0,2):"."+U.substr(2,D.length-1)));case 90:switch(D){case"[h]":case"[hh]":x=P.D*24+P.H;break;case"[m]":case"[mm]":x=(P.D*24+P.H)*60+P.M;break;case"[s]":case"[ss]":x=((P.D*24+P.H)*60+P.M)*60+Math.round(P.S+P.u);break;default:throw"bad abstime format: "+D}F=D.length===3?1:2;break;case 101:x=O,F=1;break}var C=F>0?h(x,F):"";return C}function cn(L){var D=3;if(L.length<=D)return L;for(var P=L.length%D,en=L.substr(0,P);P!=L.length;P+=D)en+=(en.length>0?",":"")+L.substr(P,D);return en}var ln=function(){var D=/%/g;function P(Y,B,q){var sn=B.replace(D,""),W=B.length-sn.length;return ln(Y,sn,q*Math.pow(10,2*W))+a("%",W)}function en(Y,B,q){for(var sn=B.length-1;B.charCodeAt(sn-1)===44;)--sn;return ln(Y,B.substr(0,sn),q/Math.pow(10,3*(B.length-sn)))}function U(Y,B){var q,sn=Y.indexOf("E")-Y.indexOf(".")-1;if(Y.match(/^#+0.0E\+0$/)){if(B==0)return"0.0E+0";if(B<0)return"-"+U(Y,-B);var W=Y.indexOf(".");W===-1&&(W=Y.indexOf("E"));var z=Math.floor(Math.log(B)*Math.LOG10E)%W;if(z<0&&(z+=W),q=(B/Math.pow(10,z)).toPrecision(sn+1+(W+z)%W),q.indexOf("e")===-1){var En=Math.floor(Math.log(B)*Math.LOG10E);for(q.indexOf(".")===-1?q=q.charAt(0)+"."+q.substr(1)+"E+"+(En-q.length+z):q+="E+"+(En-z);q.substr(0,2)==="0.";)q=q.charAt(0)+q.substr(2,W)+"."+q.substr(2+W),q=q.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");q=q.replace(/\+-/,"-")}q=q.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(qn,Gn,Wn,Tn){return Gn+Wn+Tn.substr(0,(W+z)%W)+"."+Tn.substr(z)+"E"})}else q=B.toExponential(sn);return Y.match(/E\+00$/)&&q.match(/e[+-]\d$/)&&(q=q.substr(0,q.length-1)+"0"+q.charAt(q.length-1)),Y.match(/E\-/)&&q.match(/e\+/)&&(q=q.replace(/e\+/,"e")),q.replace("e","E")}var fn=/# (\?+)( ?)\/( ?)(\d+)/;function m(Y,B,q){var sn=parseInt(Y[4],10),W=Math.round(B*sn),z=Math.floor(W/sn),En=W-z*sn,qn=sn;return q+(z===0?"":""+z)+" "+(En===0?a(" ",Y[1].length+1+Y[4].length):d(En,Y[1].length)+Y[2]+"/"+Y[3]+h(qn,Y[4].length))}function O(Y,B,q){return q+(B===0?"":""+B)+a(" ",Y[1].length+2+Y[4].length)}var x=/^#*0*\.([0#]+)/,F=/\).*[0#]/,C=/\(###\) ###\\?-####/;function H(Y){for(var B="",q,sn=0;sn!=Y.length;++sn)switch(q=Y.charCodeAt(sn)){case 35:break;case 63:B+=" ";break;case 48:B+="0";break;default:B+=String.fromCharCode(q)}return B}function tn(Y,B){var q=Math.pow(10,B);return""+Math.round(Y*q)/q}function Ln(Y,B){var q=Y-Math.floor(Y),sn=Math.pow(10,B);return B<(""+Math.round(q*sn)).length?0:Math.round(q*sn)}function An(Y,B){return B<(""+Math.round((Y-Math.floor(Y))*Math.pow(10,B))).length?1:0}function Hn(Y){return Y<2147483647&&Y>-2147483648?""+(Y>=0?Y|0:Y-1|0):""+Math.floor(Y)}function dn(Y,B,q){if(Y.charCodeAt(0)===40&&!B.match(F)){var sn=B.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return q>=0?dn("n",sn,q):"("+dn("n",sn,-q)+")"}if(B.charCodeAt(B.length-1)===44)return en(Y,B,q);if(B.indexOf("%")!==-1)return P(Y,B,q);if(B.indexOf("E")!==-1)return U(B,q);if(B.charCodeAt(0)===36)return"$"+dn(Y,B.substr(B.charAt(1)==" "?2:1),q);var W,z,En,qn,Gn=Math.abs(q),Wn=q<0?"-":"";if(B.match(/^00+$/))return Wn+c(Gn,B.length);if(B.match(/^[#?]+$/))return W=c(q,0),W==="0"&&(W=""),W.length>B.length?W:H(B.substr(0,B.length-W.length))+W;if(z=B.match(fn))return m(z,Gn,Wn);if(B.match(/^#+0+$/))return Wn+c(Gn,B.length-B.indexOf("0"));if(z=B.match(x))return W=tn(q,z[1].length).replace(/^([^\.]+)$/,"$1."+H(z[1])).replace(/\.$/,"."+H(z[1])).replace(/\.(\d*)$/,function(le,Dr){return"."+Dr+a("0",H(z[1]).length-Dr.length)}),B.indexOf("0.")!==-1?W:W.replace(/^0\./,".");if(B=B.replace(/^#+([0.])/,"$1"),z=B.match(/^(0*)\.(#*)$/))return Wn+tn(Gn,z[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,z[1].length?"0.":".");if(z=B.match(/^#{1,3},##0(\.?)$/))return Wn+cn(c(Gn,0));if(z=B.match(/^#,##0\.([#0]*0)$/))return q<0?"-"+dn(Y,B,-q):cn(""+(Math.floor(q)+An(q,z[1].length)))+"."+h(Ln(q,z[1].length),z[1].length);if(z=B.match(/^#,#*,#0/))return dn(Y,B.replace(/^#,#*,/,""),q);if(z=B.match(/^([0#]+)(\\?-([0#]+))+$/))return W=u(dn(Y,B.replace(/[\\-]/g,""),q)),En=0,u(u(B.replace(/\\/g,"")).replace(/[0#]/g,function(le){return En<W.length?W.charAt(En++):le==="0"?"0":""}));if(B.match(C))return W=dn(Y,"##########",q),"("+W.substr(0,3)+") "+W.substr(3,3)+"-"+W.substr(6);var Tn="";if(z=B.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return En=Math.min(z[4].length,7),qn=I(Gn,Math.pow(10,En)-1,!1),W=""+Wn,Tn=ln("n",z[1],qn[1]),Tn.charAt(Tn.length-1)==" "&&(Tn=Tn.substr(0,Tn.length-1)+"0"),W+=Tn+z[2]+"/"+z[3],Tn=f(qn[2],En),Tn.length<z[4].length&&(Tn=H(z[4].substr(z[4].length-Tn.length))+Tn),W+=Tn,W;if(z=B.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return En=Math.min(Math.max(z[1].length,z[4].length),7),qn=I(Gn,Math.pow(10,En)-1,!0),Wn+(qn[0]||(qn[1]?"":"0"))+" "+(qn[1]?d(qn[1],En)+z[2]+"/"+z[3]+f(qn[2],En):a(" ",2*En+1+z[2].length+z[3].length));if(z=B.match(/^[#0?]+$/))return W=c(q,0),B.length<=W.length?W:H(B.substr(0,B.length-W.length))+W;if(z=B.match(/^([#0?]+)\.([#0]+)$/)){W=""+q.toFixed(Math.min(z[2].length,10)).replace(/([^0])0+$/,"$1"),En=W.indexOf(".");var Cr=B.indexOf(".")-En,Mt=B.length-W.length-Cr;return H(B.substr(0,Cr)+W+B.substr(B.length-Mt))}if(z=B.match(/^00,000\.([#0]*0)$/))return En=Ln(q,z[1].length),q<0?"-"+dn(Y,B,-q):cn(Hn(q)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(le){return"00,"+(le.length<3?h(0,3-le.length):"")+le})+"."+h(En,z[1].length);switch(B){case"###,##0.00":return dn(Y,"#,##0.00",q);case"###,###":case"##,###":case"#,###":var Lr=cn(c(Gn,0));return Lr!=="0"?Wn+Lr:"";case"###,###.00":return dn(Y,"###,##0.00",q).replace(/^0\./,".");case"#,###.00":return dn(Y,"#,##0.00",q).replace(/^0\./,".")}throw new Error("unsupported format |"+B+"|")}function Oe(Y,B,q){for(var sn=B.length-1;B.charCodeAt(sn-1)===44;)--sn;return ln(Y,B.substr(0,sn),q/Math.pow(10,3*(B.length-sn)))}function ge(Y,B,q){var sn=B.replace(D,""),W=B.length-sn.length;return ln(Y,sn,q*Math.pow(10,2*W))+a("%",W)}function bn(Y,B){var q,sn=Y.indexOf("E")-Y.indexOf(".")-1;if(Y.match(/^#+0.0E\+0$/)){if(B==0)return"0.0E+0";if(B<0)return"-"+bn(Y,-B);var W=Y.indexOf(".");W===-1&&(W=Y.indexOf("E"));var z=Math.floor(Math.log(B)*Math.LOG10E)%W;if(z<0&&(z+=W),q=(B/Math.pow(10,z)).toPrecision(sn+1+(W+z)%W),!q.match(/[Ee]/)){var En=Math.floor(Math.log(B)*Math.LOG10E);q.indexOf(".")===-1?q=q.charAt(0)+"."+q.substr(1)+"E+"+(En-q.length+z):q+="E+"+(En-z),q=q.replace(/\+-/,"-")}q=q.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(qn,Gn,Wn,Tn){return Gn+Wn+Tn.substr(0,(W+z)%W)+"."+Tn.substr(z)+"E"})}else q=B.toExponential(sn);return Y.match(/E\+00$/)&&q.match(/e[+-]\d$/)&&(q=q.substr(0,q.length-1)+"0"+q.charAt(q.length-1)),Y.match(/E\-/)&&q.match(/e\+/)&&(q=q.replace(/e\+/,"e")),q.replace("e","E")}function hn(Y,B,q){if(Y.charCodeAt(0)===40&&!B.match(F)){var sn=B.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return q>=0?hn("n",sn,q):"("+hn("n",sn,-q)+")"}if(B.charCodeAt(B.length-1)===44)return Oe(Y,B,q);if(B.indexOf("%")!==-1)return ge(Y,B,q);if(B.indexOf("E")!==-1)return bn(B,q);if(B.charCodeAt(0)===36)return"$"+hn(Y,B.substr(B.charAt(1)==" "?2:1),q);var W,z,En,qn,Gn=Math.abs(q),Wn=q<0?"-":"";if(B.match(/^00+$/))return Wn+h(Gn,B.length);if(B.match(/^[#?]+$/))return W=""+q,q===0&&(W=""),W.length>B.length?W:H(B.substr(0,B.length-W.length))+W;if(z=B.match(fn))return O(z,Gn,Wn);if(B.match(/^#+0+$/))return Wn+h(Gn,B.length-B.indexOf("0"));if(z=B.match(x))return W=(""+q).replace(/^([^\.]+)$/,"$1."+H(z[1])).replace(/\.$/,"."+H(z[1])),W=W.replace(/\.(\d*)$/,function(le,Dr){return"."+Dr+a("0",H(z[1]).length-Dr.length)}),B.indexOf("0.")!==-1?W:W.replace(/^0\./,".");if(B=B.replace(/^#+([0.])/,"$1"),z=B.match(/^(0*)\.(#*)$/))return Wn+(""+Gn).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,z[1].length?"0.":".");if(z=B.match(/^#{1,3},##0(\.?)$/))return Wn+cn(""+Gn);if(z=B.match(/^#,##0\.([#0]*0)$/))return q<0?"-"+hn(Y,B,-q):cn(""+q)+"."+a("0",z[1].length);if(z=B.match(/^#,#*,#0/))return hn(Y,B.replace(/^#,#*,/,""),q);if(z=B.match(/^([0#]+)(\\?-([0#]+))+$/))return W=u(hn(Y,B.replace(/[\\-]/g,""),q)),En=0,u(u(B.replace(/\\/g,"")).replace(/[0#]/g,function(le){return En<W.length?W.charAt(En++):le==="0"?"0":""}));if(B.match(C))return W=hn(Y,"##########",q),"("+W.substr(0,3)+") "+W.substr(3,3)+"-"+W.substr(6);var Tn="";if(z=B.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return En=Math.min(z[4].length,7),qn=I(Gn,Math.pow(10,En)-1,!1),W=""+Wn,Tn=ln("n",z[1],qn[1]),Tn.charAt(Tn.length-1)==" "&&(Tn=Tn.substr(0,Tn.length-1)+"0"),W+=Tn+z[2]+"/"+z[3],Tn=f(qn[2],En),Tn.length<z[4].length&&(Tn=H(z[4].substr(z[4].length-Tn.length))+Tn),W+=Tn,W;if(z=B.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return En=Math.min(Math.max(z[1].length,z[4].length),7),qn=I(Gn,Math.pow(10,En)-1,!0),Wn+(qn[0]||(qn[1]?"":"0"))+" "+(qn[1]?d(qn[1],En)+z[2]+"/"+z[3]+f(qn[2],En):a(" ",2*En+1+z[2].length+z[3].length));if(z=B.match(/^[#0?]+$/))return W=""+q,B.length<=W.length?W:H(B.substr(0,B.length-W.length))+W;if(z=B.match(/^([#0]+)\.([#0]+)$/)){W=""+q.toFixed(Math.min(z[2].length,10)).replace(/([^0])0+$/,"$1"),En=W.indexOf(".");var Cr=B.indexOf(".")-En,Mt=B.length-W.length-Cr;return H(B.substr(0,Cr)+W+B.substr(B.length-Mt))}if(z=B.match(/^00,000\.([#0]*0)$/))return q<0?"-"+hn(Y,B,-q):cn(""+q).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(le){return"00,"+(le.length<3?h(0,3-le.length):"")+le})+"."+h(0,z[1].length);switch(B){case"###,###":case"##,###":case"#,###":var Lr=cn(""+Gn);return Lr!=="0"?Wn+Lr:"";default:if(B.match(/\.[0#?]*$/))return hn(Y,B.slice(0,B.lastIndexOf(".")),q)+H(B.slice(B.lastIndexOf(".")))}throw new Error("unsupported format |"+B+"|")}return function(B,q,sn){return(sn|0)===sn?hn(B,q,sn):dn(B,q,sn)}}();function kn(L){for(var D=[],P=!1,en=0,U=0;en<L.length;++en)switch(L.charCodeAt(en)){case 34:P=!P;break;case 95:case 42:case 92:++en;break;case 59:D[D.length]=L.substr(U,en-U),U=en+1}if(D[D.length]=L.substr(U),P===!0)throw new Error("Format |"+L+"| unterminated string ");return D}i._split=kn;var Dn=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Bn(L){for(var D=0,P="",en="";D<L.length;)switch(P=L.charAt(D)){case"G":g(L,D)&&(D+=6),D++;break;case'"':for(;L.charCodeAt(++D)!==34&&D<L.length;);++D;break;case"\\":D+=2;break;case"_":D+=2;break;case"@":++D;break;case"B":case"b":if(L.charAt(D+1)==="1"||L.charAt(D+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(L.substr(D,3).toUpperCase()==="A/P"||L.substr(D,5).toUpperCase()==="AM/PM"||L.substr(D,5).toUpperCase()==="/")return!0;++D;break;case"[":for(en=P;L.charAt(D++)!=="]"&&D<L.length;)en+=L.charAt(D);if(en.match(Dn))return!0;break;case".":case"0":case"#":for(;D<L.length&&("0#?.,E+-%".indexOf(P=L.charAt(++D))>-1||P=="\\"&&L.charAt(D+1)=="-"&&"0#".indexOf(L.charAt(D+2))>-1););break;case"?":for(;L.charAt(++D)===P;);break;case"*":++D,(L.charAt(D)==" "||L.charAt(D)=="*")&&++D;break;case"(":case")":++D;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;D<L.length&&"0123456789".indexOf(L.charAt(++D))>-1;);break;case" ":++D;break;default:++D;break}return!1}i.is_date=Bn;function Jn(L,D,P,en){for(var U=[],fn="",m=0,O="",x="t",F,C,H,tn="H";m<L.length;)switch(O=L.charAt(m)){case"G":if(!g(L,m))throw new Error("unrecognized character "+O+" in "+L);U[U.length]={t:"G",v:"General"},m+=7;break;case'"':for(fn="";(H=L.charCodeAt(++m))!==34&&m<L.length;)fn+=String.fromCharCode(H);U[U.length]={t:"t",v:fn},++m;break;case"\\":var Ln=L.charAt(++m),An=Ln==="("||Ln===")"?Ln:"t";U[U.length]={t:An,v:Ln},++m;break;case"_":U[U.length]={t:"t",v:" "},m+=2;break;case"@":U[U.length]={t:"T",v:D},++m;break;case"B":case"b":if(L.charAt(m+1)==="1"||L.charAt(m+1)==="2"){if(F==null&&(F=S(D,P,L.charAt(m+1)==="2"),F==null))return"";U[U.length]={t:"X",v:L.substr(m,2)},x=O,m+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":O=O.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(D<0||F==null&&(F=S(D,P),F==null))return"";for(fn=O;++m<L.length&&L.charAt(m).toLowerCase()===O;)fn+=O;O==="m"&&x.toLowerCase()==="h"&&(O="M"),O==="h"&&(O=tn),U[U.length]={t:O,v:fn},x=O;break;case"A":case"a":case"":var Hn={t:O,v:O};if(F==null&&(F=S(D,P)),L.substr(m,3).toUpperCase()==="A/P"?(F!=null&&(Hn.v=F.H>=12?"P":"A"),Hn.t="T",tn="h",m+=3):L.substr(m,5).toUpperCase()==="AM/PM"?(F!=null&&(Hn.v=F.H>=12?"PM":"AM"),Hn.t="T",m+=5,tn="h"):L.substr(m,5).toUpperCase()==="/"?(F!=null&&(Hn.v=F.H>=12?"":""),Hn.t="T",m+=5,tn="h"):(Hn.t="t",++m),F==null&&Hn.t==="T")return"";U[U.length]=Hn,x=O;break;case"[":for(fn=O;L.charAt(m++)!=="]"&&m<L.length;)fn+=L.charAt(m);if(fn.slice(-1)!=="]")throw'unterminated "[" block: |'+fn+"|";if(fn.match(Dn)){if(F==null&&(F=S(D,P),F==null))return"";U[U.length]={t:"Z",v:fn.toLowerCase()},x=fn.charAt(1)}else fn.indexOf("$")>-1&&(fn=(fn.match(/\$([^-\[\]]*)/)||[])[1]||"$",Bn(L)||(U[U.length]={t:"t",v:fn}));break;case".":if(F!=null){for(fn=O;++m<L.length&&(O=L.charAt(m))==="0";)fn+=O;U[U.length]={t:"s",v:fn};break}case"0":case"#":for(fn=O;++m<L.length&&"0#?.,E+-%".indexOf(O=L.charAt(m))>-1;)fn+=O;U[U.length]={t:"n",v:fn};break;case"?":for(fn=O;L.charAt(++m)===O;)fn+=O;U[U.length]={t:O,v:fn},x=O;break;case"*":++m,(L.charAt(m)==" "||L.charAt(m)=="*")&&++m;break;case"(":case")":U[U.length]={t:en===1?"t":O,v:O},++m;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(fn=O;m<L.length&&"0123456789".indexOf(L.charAt(++m))>-1;)fn+=L.charAt(m);U[U.length]={t:"D",v:fn};break;case" ":U[U.length]={t:O,v:O},++m;break;case"$":U[U.length]={t:"t",v:"$"},++m;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(O)===-1)throw new Error("unrecognized character "+O+" in "+L);U[U.length]={t:"t",v:O},++m;break}var dn=0,Oe=0,ge;for(m=U.length-1,x="t";m>=0;--m)switch(U[m].t){case"h":case"H":U[m].t=tn,x="h",dn<1&&(dn=1);break;case"s":(ge=U[m].v.match(/\.0+$/))&&(Oe=Math.max(Oe,ge[0].length-1)),dn<3&&(dn=3);case"d":case"y":case"M":case"e":x=U[m].t;break;case"m":x==="s"&&(U[m].t="M",dn<2&&(dn=2));break;case"X":break;case"Z":dn<1&&U[m].v.match(/[Hh]/)&&(dn=1),dn<2&&U[m].v.match(/[Mm]/)&&(dn=2),dn<3&&U[m].v.match(/[Ss]/)&&(dn=3)}switch(dn){case 0:break;case 1:F.u>=.5&&(F.u=0,++F.S),F.S>=60&&(F.S=0,++F.M),F.M>=60&&(F.M=0,++F.H);break;case 2:F.u>=.5&&(F.u=0,++F.S),F.S>=60&&(F.S=0,++F.M);break}var bn="",hn;for(m=0;m<U.length;++m)switch(U[m].t){case"t":case"T":case" ":case"D":break;case"X":U[m].v="",U[m].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":U[m].v=yn(U[m].t.charCodeAt(0),U[m].v,F,Oe),U[m].t="t";break;case"n":case"?":for(hn=m+1;U[hn]!=null&&((O=U[hn].t)==="?"||O==="D"||(O===" "||O==="t")&&U[hn+1]!=null&&(U[hn+1].t==="?"||U[hn+1].t==="t"&&U[hn+1].v==="/")||U[m].t==="("&&(O===" "||O==="n"||O===")")||O==="t"&&(U[hn].v==="/"||U[hn].v===" "&&U[hn+1]!=null&&U[hn+1].t=="?"));)U[m].v+=U[hn].v,U[hn]={v:"",t:";"},++hn;bn+=U[m].v,m=hn-1;break;case"G":U[m].t="t",U[m].v=Q(D,P);break}var Y="",B,q;if(bn.length>0){bn.charCodeAt(0)==40?(B=D<0&&bn.charCodeAt(0)===45?-D:D,q=ln("n",bn,B)):(B=D<0&&en>1?-D:D,q=ln("n",bn,B),B<0&&U[0]&&U[0].t=="t"&&(q=q.substr(1),U[0].v="-"+U[0].v)),hn=q.length-1;var sn=U.length;for(m=0;m<U.length;++m)if(U[m]!=null&&U[m].t!="t"&&U[m].v.indexOf(".")>-1){sn=m;break}var W=U.length;if(sn===U.length&&q.indexOf("E")===-1){for(m=U.length-1;m>=0;--m)U[m]==null||"n?".indexOf(U[m].t)===-1||(hn>=U[m].v.length-1?(hn-=U[m].v.length,U[m].v=q.substr(hn+1,U[m].v.length)):hn<0?U[m].v="":(U[m].v=q.substr(0,hn+1),hn=-1),U[m].t="t",W=m);hn>=0&&W<U.length&&(U[W].v=q.substr(0,hn+1)+U[W].v)}else if(sn!==U.length&&q.indexOf("E")===-1){for(hn=q.indexOf(".")-1,m=sn;m>=0;--m)if(!(U[m]==null||"n?".indexOf(U[m].t)===-1)){for(C=U[m].v.indexOf(".")>-1&&m===sn?U[m].v.indexOf(".")-1:U[m].v.length-1,Y=U[m].v.substr(C+1);C>=0;--C)hn>=0&&(U[m].v.charAt(C)==="0"||U[m].v.charAt(C)==="#")&&(Y=q.charAt(hn--)+Y);U[m].v=Y,U[m].t="t",W=m}for(hn>=0&&W<U.length&&(U[W].v=q.substr(0,hn+1)+U[W].v),hn=q.indexOf(".")+1,m=sn;m<U.length;++m)if(!(U[m]==null||"n?(".indexOf(U[m].t)===-1&&m!==sn)){for(C=U[m].v.indexOf(".")>-1&&m===sn?U[m].v.indexOf(".")+1:0,Y=U[m].v.substr(0,C);C<U[m].v.length;++C)hn<q.length&&(Y+=q.charAt(hn++));U[m].v=Y,U[m].t="t",W=m}}}for(m=0;m<U.length;++m)U[m]!=null&&"n?".indexOf(U[m].t)>-1&&(B=en>1&&D<0&&m>0&&U[m-1].v==="-"?-D:D,U[m].v=ln(U[m].t,U[m].v,B),U[m].t="t");var z="";for(m=0;m!==U.length;++m)U[m]!=null&&(z+=U[m].v);return z}i._eval=Jn;var Z=/\[[=<>]/,on=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function an(L,D){if(D==null)return!1;var P=parseFloat(D[2]);switch(D[1]){case"=":if(L==P)return!0;break;case">":if(L>P)return!0;break;case"<":if(L<P)return!0;break;case"<>":if(L!=P)return!0;break;case">=":if(L>=P)return!0;break;case"<=":if(L<=P)return!0;break}return!1}function Rn(L,D){var P=kn(L),en=P.length,U=P[en-1].indexOf("@");if(en<4&&U>-1&&--en,P.length>4)throw new Error("cannot find right format for |"+P.join("|")+"|");if(typeof D!="number")return[4,P.length===4||U>-1?P[P.length-1]:"@"];switch(P.length){case 1:P=U>-1?["General","General","General",P[0]]:[P[0],P[0],P[0],"@"];break;case 2:P=U>-1?[P[0],P[0],P[0],P[1]]:[P[0],P[1],P[0],"@"];break;case 3:P=U>-1?[P[0],P[1],P[0],P[2]]:[P[0],P[1],P[2],"@"];break}var fn=D>0?P[0]:D<0?P[1]:P[2];if(P[0].indexOf("[")===-1&&P[1].indexOf("[")===-1)return[en,fn];if(P[0].match(Z)!=null||P[1].match(Z)!=null){var m=P[0].match(on),O=P[1].match(on);return an(D,m)?[en,P[0]]:an(D,O)?[en,P[1]]:[en,P[m!=null&&O!=null?2:1]]}return[en,fn]}function Cn(L,D,P){P==null&&(P={});var en="";switch(typeof L){case"string":L=="m/d/yy"&&P.dateNF?en=P.dateNF:en=L;break;case"number":L==14&&P.dateNF?en=P.dateNF:en=(P.table!=null?P.table:w)[L],en==null&&(en=P.table&&P.table[E[L]]||w[E[L]]),en==null&&(en=R[L]||"General");break}if(g(en,0))return Q(D,P);D instanceof Date&&(D=G(D,P.date1904));var U=Rn(en,D);if(g(U[1]))return Q(D,P);if(D===!0)D="TRUE";else if(D===!1)D="FALSE";else if(D===""||D==null)return"";return Jn(U[1],D,P,U[0])}function Vn(L,D){if(typeof D!="number"){D=+D||-1;for(var P=0;P<392;++P){if(w[P]==null){D<0&&(D=P);continue}if(w[P]==L){D=P;break}}D<0&&(D=391)}return w[D]=L,D}i.load=Vn,i._table=w,i.get_table=function(){return w},i.load_table=function(D){for(var P=0;P!=392;++P)D[P]!==void 0&&Vn(D[P],P)},i.init_table=N,i.format=Cn};r(e),typeof DO_NOT_EXPORT_SSF>"u"&&(n.exports=e)}(fi)),fi.exports}var rg=eg();const kl=Vr(rg),nt=n=>n/9525;function tg(n,e,r,t,i,u,a,h){if(!(!e.charts||e.charts.length===0))for(const d of e.charts){if(!d.chart||!d.fromAnchor||!d.toAnchor)continue;const f=Number(d.fromAnchor.colId),o=Number(d.fromAnchor.rowId),l=Number(d.toAnchor.colId),s=Number(d.toAnchor.rowId)-1,c=ce+r[f]+nt(Number(d.fromAnchor.colOffset))-i,g=ae+t[o]+nt(Number(d.fromAnchor.rowOffset))-u,v=ce+r[l]+nt(Number(d.toAnchor.colOffset))-i,p=ae+t[s]+nt(Number(d.toAnchor.rowOffset))-u;if(v<0||p<0||c>a||g>h)continue;const N={x:c,y:g,width:v-c,height:p-g};n.save(),n.fillStyle="#ffffff",n.strokeStyle="#000000",n.lineWidth=1,n.beginPath(),n.rect(N.x,N.y,N.width,N.height),n.fill(),n.stroke(),n.restore(),rs(n,d.chart,N)}}function ig(n){const e=n?.size??11,r=n?.bold?"bold ":"",t=n?.italic?"italic ":"",i=n?.family?`"${n.family}", sans-serif`:"sans-serif";return`${r}${t}${e}px ${i}`}const gu=kl.get_table();function vu(n,e,r,t){if(!(!n||!e)){if(n.numFmtId!=null){r.numberFormatId=n.numFmtId;const i=e.numberFormats?.find(u=>u.id===n.numFmtId);i?.formatCode?r.numberFormatCode=i.formatCode:gu[n.numFmtId]&&(r.numberFormatCode=gu[n.numFmtId])}if(n.fillId!=null&&(!t||n.applyFill||n.applyFill===void 0)){const i=e.fills[n.fillId],u=i?.fgColor||i?.bgColor;u&&(r.fill=nr(u))}if(n.fontId!=null&&((!t||n.applyFont)??!0)){const i=e.fonts[n.fontId]??{},u=r.font??={};u.size=i.size?i.size:u.size,u.bold=i.bold?i.bold:u.bold,u.italic=i.italic?i.italic:u.italic,u.family=i.name?i.name:u.family,i.color&&(u.color=nr(i.color),r.textColor=u.color)}if(n.horizontalAlignment&&(!t||n.applyAlignment||n.applyAlignment===void 0))switch(n.horizontalAlignment){case"left":case"center":case"right":r.align=n.horizontalAlignment;break}if(n.borderId!=null&&(!t||n.applyBorder||n.applyBorder===void 0)){const i=e.borders[n.borderId];i&&(r.borders??={},i.left&&(r.borders.left=i.left.color?nr(i.left.color):"transparent"),i.right&&(r.borders.right=i.right.color?nr(i.right.color):"transparent"),i.top&&(r.borders.top=i.top.color?nr(i.top.color):"transparent"),i.bottom&&(r.borders.bottom=i.bottom.color?nr(i.bottom.color):"transparent"))}}}function Ml(n){const{styles:e}=n,r={};return e&&e.cellXfs.forEach((t,i)=>{const u={};if(t.xfId!=null&&e.cellStyleXfs&&e.cellStyleXfs[t.xfId]){const a=e.cellStyleXfs[t.xfId].format;vu(a,e,u,!1)}vu(t,e,u,!0),r[i]=u}),r}function og(n){let e="";for(n+=1;n;){const r=(n-1)%26;e=String.fromCharCode(65+r)+e,n=Math.floor((n-r)/26)}return e}function ug(n){const e=n.match(/[A-Z]+/);if(!e)return 0;let r=0;for(const t of e[0])r=r*26+(t.charCodeAt(0)-64);return r-1}function lg(n){const e=n.match(/\d+/);return e?parseInt(e[0],10)-1:0}function fg(n,e){return`${og(n)}${e+1}`}function sg({cols:n,rows:e,selected:r,setSelected:t,enabled:i=!0}){Mn.useEffect(()=>{if(!i)return;function u(a){let h=ug(r.address),d=lg(r.address);const{key:f,shiftKey:o}=a;let l=!1;switch(f){case"ArrowLeft":h>0&&(h-=1,l=!0);break;case"ArrowRight":h<n-1&&(h+=1,l=!0);break;case"ArrowUp":d>0&&(d-=1,l=!0);break;case"ArrowDown":d<e-1&&(d+=1,l=!0);break;case"Tab":a.preventDefault(),(o?h>0:h<n-1)&&(h+=o?-1:1,l=!0);break;case"Enter":a.preventDefault(),(o?d>0:d<e-1)&&(d+=o?-1:1,l=!0);break;default:return}if(l){const s=fg(h,d);t(d,s)}}return window.addEventListener("keydown",u),()=>window.removeEventListener("keydown",u)},[n,e,r.address,t,i])}const Cl=/([$]?[A-Z]+[$]?\d+)/g;function cg(n){return Array.from(new Set(n.match(Cl)??[]))}const ag=Xl().domain(Array.from({length:12},(n,e)=>e.toString())).range(Qf);function vi(n,e){if(n.value===""||n.value==null)return"";const r=e[n.styleIndex??0]??{};if(r.numberFormatCode){const t=Number(n.value);if(!Number.isNaN(t))try{return kl.format(r.numberFormatCode,t)}catch(i){return mr.addError(i),n.value}}return n.value}function Ll(n,e,r,t,i,u,a,h,d,f,o,l,s,c,g,v){function p(T,M,V){let G=r[M];if(!T)return G;let nn=M+1;for(;V>G&&nn<r.length;){const X=nn;if(T.cells.find(Nn=>hi(Nn.address)===X)?.value)break;G+=r[nn],nn++}return G}n.save(),n.scale(o,o);const N=[0];for(let T=0;T<r.length;T++)N[T+1]=N[T]+r[T];const w=[0];for(let T=0;T<t.length;T++)w[T+1]=w[T]+t[T];const E=Math.max(0,N.findIndex(T=>T>=i)-1),y=Math.min(r.length-1,N.findIndex(T=>T>=i+a/o)+1),R=Math.max(0,w.findIndex(T=>T>=u)-1),I=Math.min(t.length-1,w.findIndex(T=>T>=u+h/o)+1);n.clearRect(0,0,a/o,h/o),n.fillStyle="white",n.fillRect(0,0,a/o,h/o);const S=new Map;for(const T of e.rows)S.set(T.index-1,T);for(let T=R;T<=I;T++){const M=S.get(T),V=ae+w[T]-u,G=t[T];for(let nn=E;nn<=y;nn++){const X=ce+N[nn]-i,Q=r[nn],Nn=M?.cells.find(ln=>hi(ln.address)===nn),yn=`${ai(nn)}${T+1}`,cn=l[Nn?.styleIndex??0]??{};if(cn.fill&&(n.fillStyle=cn.fill,n.fillRect(X,V,Q,G)),g.has(`${e.name}:${yn}`)&&(n.fillStyle="#eeeeee",n.fillRect(X,V,Q,G)),v&&d===T&&f===nn&&(n.fillStyle="rgba(255,255,0,0.2)",n.fillRect(X,V,Q,G)),e.showGridLines!==!1&&(n.strokeStyle="#ccc",n.lineWidth=1,n.strokeRect(X,V,Q,G)),cn.borders){const ln=cn.borders;ln.top&&(n.strokeStyle=ln.top,n.beginPath(),n.moveTo(X,V),n.lineTo(X+Q,V),n.stroke()),ln.bottom&&(n.strokeStyle=ln.bottom,n.beginPath(),n.moveTo(X,V+G),n.lineTo(X+Q,V+G),n.stroke()),ln.left&&(n.strokeStyle=ln.left,n.beginPath(),n.moveTo(X,V),n.lineTo(X,V+G),n.stroke()),ln.right&&(n.strokeStyle=ln.right,n.beginPath(),n.moveTo(X+Q,V),n.lineTo(X+Q,V+G),n.stroke())}if(c.has(yn)){const ln=s[yn];ln&&(n.save(),n.fillStyle=ln+"22",n.fillRect(X,V,Q,G),n.restore(),n.strokeStyle=ln,n.lineWidth=2,n.strokeRect(X,V,Q,G))}if(Nn){n.save(),n.fillStyle=cn.textColor??"black",n.font=ig(cn.font);const ln=cn.align??"left";n.textAlign=ln,n.textBaseline="middle";const kn=vi(Nn,l),Dn=n.measureText(kn).width,Bn=X;let Jn=Q;ln==="left"&&(Jn=p(M,nn,Dn)),n.beginPath(),n.rect(Bn,V,Jn,G),n.clip();let Z=X+4;ln==="center"?Z=X+Q/2:ln==="right"&&(Z=X+Q-4),n.fillText(kn,Z,V+G/2),n.restore()}}}tg(n,e,N,w,i,u,a/o,h/o),n.textAlign="center",n.textBaseline="middle",n.font="12px sans-serif";for(let T=E;T<=y;T++){const M=ce+N[T]-i,V=r[T];n.fillStyle=f===T?"#e0e0e0":"#f5f5f5",n.fillRect(M,0,V,ae),n.strokeStyle="#ccc",n.lineWidth=1,n.strokeRect(M,0,V,ae),n.fillStyle="#333",n.fillText(ai(T),M+V/2,ae/2)}for(let T=R;T<=I;T++){const M=ae+w[T]-u,V=t[T];n.fillStyle=d===T?"#e0e0e0":"#f5f5f5",n.fillRect(0,M,ce,V),n.strokeStyle="#ccc",n.lineWidth=1,n.strokeRect(0,M,ce,V),n.fillStyle="#333",n.fillText((T+1).toString(),ce/2,M+V/2)}if(n.fillStyle="#f5f5f5",n.fillRect(0,0,ce,ae),n.strokeStyle="#ccc",n.lineWidth=1,n.strokeRect(0,0,ce,ae),d!=null&&f!=null){const T=ce+N[f]-i,M=ae+w[d]-u;n.strokeStyle="dodgerblue",n.lineWidth=2,n.strokeRect(T,M,r[f],t[d])}n.restore()}function wg({workbook:n,selectedSheetIdx:e}){const{focusedWalnutId:r,setSelectedSheetIdx:t}=pu(),[i,u]=Mn.useState(e),[a,h]=Mn.useState({}),[d,f]=Mn.useState(!1),[o,l]=Mn.useState([]),s=Mn.useRef(new Set),[c,g]=Mn.useState({}),v=n.sheets[i],p=Mn.useMemo(()=>Ml(n),[n]),N=Mn.useMemo(()=>{const on=Array(500).fill(wi);for(const an of v.columns){const Rn=Vu(an.width);for(let Cn=an.min-1;Cn<an.max;Cn++)on[Cn]=Rn}return on},[v.columns]),w=Mn.useMemo(()=>{const on=v.defaultRowHeight&&v.defaultRowHeight!==0?v.defaultRowHeight:yi,an=Array(500).fill(lt(on));for(const Rn of v.rows)(Rn.customHeight||Rn.height!==0)&&Rn.height!=null&&(an[Rn.index-1]=lt(Rn.height));return an},[v]),[E,y]=Mn.useState(0),[R,I]=Mn.useState(""),S=Mn.useRef(null),T=Mn.useRef(null),[M,V]=Mn.useState(1),[G,nn]=Mn.useState("A1"),X=hi(G),Q=As(G);function Nn(){if(f(!0),!R.startsWith("="))return;const Z=cg(R);l(Z),g(Object.fromEntries(Z.map((on,an)=>[on,ag(an.toString())])))}function yn(){f(!1),l([]),g({})}Mn.useEffect(()=>{f(!1),l([])},[G,v]);const cn=Mn.useCallback(()=>{const Z=T.current,on=S.current;if(!Z||!on)return;const an=Z.getContext("2d");if(!an)return;const Rn=on.clientWidth,Cn=on.clientHeight;Z.width=Rn*window.devicePixelRatio,Z.height=Cn*window.devicePixelRatio,Z.style.width=`${Rn}px`,Z.style.height=`${Cn}px`,an.setTransform(window.devicePixelRatio,0,0,window.devicePixelRatio,0,0),Ll(an,v,N,w,on.scrollLeft,on.scrollTop,Rn,Cn,Q,X,M,p,c,new Set(o),s.current,d)},[v,N,w,Q,X,M,p,c,o,d]);Bl(()=>{cn()}),Mn.useEffect(()=>{const Z=S.current;if(!Z)return;const on=()=>cn(),an=()=>cn();return Z.addEventListener("scroll",on),window.addEventListener("resize",an),()=>{Z.removeEventListener("scroll",on),window.removeEventListener("resize",an)}},[cn]);function ln(Z){const on=S.current,an=T.current;if(!an||!on)return;const Rn=an.getBoundingClientRect(),Cn=Z.clientX-Rn.left,Vn=Z.clientY-Rn.top,L=on.scrollLeft+Cn/M-ce,D=on.scrollTop+Vn/M-ae;if(L<0||D<0)return;let P=0,en=0;for(;en<N.length&&P+N[en]<=L;)P+=N[en],en++;P=0;let U=0;for(;U<w.length&&P+w[U]<=D;)P+=w[U],U++;nn(`${ai(en)}${U+1}`),y(U)}Mn.useEffect(()=>{const Z=v.rows[E]?.cells.find(on=>on.address===G);I(Z?Z.formula?`= ${Z.formula}`:vi(Z,p):"")},[E,G,v.rows,p]);function kn(Z){Z.ctrlKey&&(Z.preventDefault(),V(on=>Math.min(4,Math.max(.5,on-Z.deltaY*.001))))}sg({cols:N.length,rows:w.length,selected:{address:G},setSelected:(Z,on)=>{y(Z),nn(on)},enabled:!0}),Mn.useEffect(()=>{const Z={SheetNames:[],Sheets:{}};for(const an of n.sheets){Z.SheetNames.push(an.name);const Rn={};for(const Cn of an.rows)for(const Vn of Cn.cells){const L={};if(Vn.value!==""){const D=Number(Vn.value);L.v=Number.isNaN(D)?Vn.value:D}Vn.formula&&(L.f=Vn.formula),Rn[Vn.address]=L}Z.Sheets[an.name]=Rn}gt.import_functions(ml);try{gt(Z,{continue_after_error:!0})}catch(an){mr.addError(an)}for(const an of n.sheets){const Rn=Z.Sheets[an.name];for(const Cn of an.rows)for(const Vn of Cn.cells)if(Vn.formula&&Vn.value===""){const L=Rn[Vn.address]?.v;L!=null?Vn.value=String(L):Vn.value="This formula is not supported in web preview. Please download the original file to view it fully."}}const on=v.rows[E]?.cells.find(an=>an.address===G);on&&I(on.formula?`= ${on.formula}`:vi(on,p)),cn()},[n,E,G,cn,v,p]);function Dn(Z){const on=S.current;if(on){h(Rn=>({...Rn,[i]:{left:on.scrollLeft,top:on.scrollTop}}));const an=a[i];on.scrollLeft=an?.left??0,on.scrollTop=an?.top??0}u(Z),r&&t(r,Z)}const Bn=N.reduce((Z,on)=>Z+on,0)+ce,Jn=w.reduce((Z,on)=>Z+on,0)+ae;return _n.jsxs("div",{className:"flex h-full flex-col overflow-hidden",children:[_n.jsxs("div",{ref:S,className:"relative flex-1 overflow-auto",onWheel:kn,children:[_n.jsx("canvas",{ref:T,className:"sticky start-0 top-0",onMouseDown:ln}),_n.jsx("div",{style:{width:Bn*M,height:Jn*M}})]}),_n.jsxs("div",{className:"bg-token-bg-tertiary flex flex-row items-center gap-2 p-2 text-sm",children:[_n.jsx("div",{className:"text-token-text-secondary w-14 px-2 text-center text-xs font-medium",children:G}),_n.jsxs("div",{className:"relative w-full",children:[d&&_n.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center px-3 py-1 text-xs whitespace-pre",children:R.split(Cl).map((Z,on)=>c[Z]?_n.jsx("span",{style:{color:c[Z]},children:Z},on):Z)}),_n.jsx("input",{type:"text",readOnly:!0,value:R,className:"bg-token-bg-secondary w-full rounded-md border-none px-3 py-1 text-xs",onFocus:Nn,onBlur:yn})]}),_n.jsx(Fl,{options:[.25,.5,.75,1,1.5,2,3,4].map(Z=>({label:`${Z*100}%`,value:Z.toString()})),value:void 0,placeholder:`${Math.round(M*100)}%`,onValueChange:Z=>V(Number(Z)),triggerClassName:"text-xs w-16 h-6"})]}),_n.jsx("div",{className:"flex flex-row overflow-x-auto p-2 pt-0",children:n.sheets.map((Z,on)=>_n.jsx("button",{onClick:()=>Dn(on),className:["rounded-b-md px-3 py-3 text-xs font-medium whitespace-nowrap",on===i?"text-token-text-primary bg-token-bg-tertiary":"text-token-text-secondary hover:text-token-text-primary"].join(" "),children:Z.name},Z.name))}),!1]})}async function yg(n,e,r=404,t=0){const i=Sl(t),u=n.widthEmu*In,a=n.heightEmu*In,h=Math.min(1,r/Math.max(u,a)),d=Math.round(u*h*i),f=Math.round(a*h*i),o=new OffscreenCanvas(d,f),l=o.getContext("2d");if(!l)throw new Error("Failed to create 2D context");l.scale(i*h,i*h),await Ju(n,e,l,[]);const s=await o.convertToBlob({type:"image/png"});return new Promise(c=>{const g=new FileReader;g.onload=()=>c(g.result),g.readAsDataURL(s)})}async function mg(n,e=20,r=10,t=0,i){const u=Sl(t),a=80,h=20;ng(i,50,50);const d=new OffscreenCanvas(r*a*u,e*h*u),f=d.getContext("2d");if(!f)return Promise.resolve("");f.scale(u,u);const l=Array(50).fill(wi);for(const p of n.columns){const N=Vu(p.width);for(let w=p.min-1;w<p.max;w++)l[w]=N}const c=Array(50).fill(lt(n.defaultRowHeight||yi));for(const p of n.rows)p.customHeight&&(c[p.index-1]=lt(p.height));const g=Ml(i);Ll(f,n,l,c,0,0,800,400,null,null,1,g,{},new Set,new Set,!1);const v=await d.convertToBlob({type:"image/png"});return new Promise(p=>{const N=new FileReader;N.onload=()=>p(N.result),N.readAsDataURL(v)})}export{mn as B,ir as C,In as E,Eg as F,Vf as P,wg as S,Ng as a,rn as b,mg as c,Ju as d,yu as e,qr as g,pg as i,yg as s};
//# sourceMappingURL=nqh4b4c2xubfdrnc.js.map
